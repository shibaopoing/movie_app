<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="utf-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.8">
<title>Learning the Basics</title>
<style>
/*
 * Copyright 2018 the original author or authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/* Lato (normal, regular) */
@font-face {
    font-family: Lato;
    font-weight: 400;
    font-style: normal;
    src: url("https://assets.gradle.com/lato/fonts/lato-normal/lato-normal.woff2") format("woff2"),
    url("https://assets.gradle.com/lato/fonts/lato-normal/lato-normal.woff") format("woff");
}
/* Lato (normal, italic) */
@font-face {
    font-display: swap;
    font-family: Lato;
    font-weight: 400;
    font-style: italic;
    src: url("https://assets.gradle.com/lato/fonts/lato-normal-italic/lato-normal-italic.woff2") format("woff2"),
    url("https://assets.gradle.com/lato/fonts/lato-normal-italic/lato-normal-italic.woff") format("woff");
}
/* Lato (bold, regular) */
@font-face {
    font-display: swap;
    font-family: Lato;
    font-weight: 500;
    font-style: normal;
    src: url("https://assets.gradle.com/lato/fonts/lato-semibold/lato-semibold.woff2") format("woff2"),
    url("https://assets.gradle.com/lato/fonts/lato-semibold/lato-semibold.woff") format("woff");
}
/* Lato (bold, regular) */
@font-face {
    font-display: swap;
    font-family: Lato;
    font-weight: 800;
    font-style: normal;
    src: url("https://assets.gradle.com/lato/fonts/lato-heavy/lato-heavy.woff2") format("woff2"),
    url("https://assets.gradle.com/lato/fonts/lato-heavy/lato-heavy.woff") format("woff");
}


/* BEGIN asciidoc.css */

/*! normalize.css v2.1.2 | MIT License | git.io/normalize */
/* ========================================================================== HTML5 display definitions ========================================================================== */
/** Correct `block` display not defined in IE 8/9. */
article, aside, details, figcaption, figure, footer, header, hgroup, main, nav, section, summary { display: block; }

/** Correct `inline-block` display not defined in IE 8/9. */
audio, canvas, video { display: inline-block; }

/** Prevent modern browsers from displaying `audio` without controls. Remove excess height in iOS 5 devices. */
audio:not([controls]) { display: none; height: 0; }

/** Address `[hidden]` styling not present in IE 8/9. Hide the `template` element in IE, Safari, and Firefox < 22. */
[hidden], template { display: none; }

script { display: none !important; }

/* ========================================================================== Base ========================================================================== */
/** 1. Set default font family to sans-serif. 2. Prevent iOS text size adjust after orientation change, without disabling user zoom. */
html { font-family: sans-serif; /* 1 */ -ms-text-size-adjust: 100%; /* 2 */ -webkit-text-size-adjust: 100%; /* 2 */ }

/** Remove default margin. */
body { margin: 0; }

/* ========================================================================== Links ========================================================================== */
/** Remove the gray background color from active links in IE 10. */
a { background: transparent; }

/** Address `outline` inconsistency between Chrome and other browsers. */
a:focus { outline: thin dotted; }

/** Improve readability when focused and also mouse hovered in all browsers. */
a:active, a:hover { outline: 0; }

/* ========================================================================== Typography ========================================================================== */
/** Address variable `h1` font-size and margin within `section` and `article` contexts in Firefox 4+, Safari 5, and Chrome. */
h1 { font-size: 2em; margin: 0.67em 0; }

/** Address styling not present in IE 8/9, Safari 5, and Chrome. */
abbr[title] { border-bottom: 1px dotted; }

/** Address style set to `bolder` in Firefox 4+, Safari 5, and Chrome. */
b, strong { font-weight: bold; }

/** Address styling not present in Safari 5 and Chrome. */
dfn { font-style: italic; }

/** Address differences between Firefox and other browsers. */
hr { -moz-box-sizing: content-box; box-sizing: content-box; height: 0; }

/** Address styling not present in IE 8/9. */
mark { background: #ff0; color: #000; }

/** Correct font family set oddly in Safari 5 and Chrome. */
code, kbd, pre, samp { font-family: monospace, serif; font-size: 1em; }

/** Improve readability of pre-formatted text in all browsers. */
pre { white-space: pre-wrap; }

/** Set consistent quote types. */
q { quotes: "\201C" "\201D" "\2018" "\2019"; }

/** Address inconsistent and variable font size in all browsers. */
small { font-size: 80%; }

/** Prevent `sub` and `sup` affecting `line-height` in all browsers. */
sub, sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline; }

sup { top: -0.5em; }

sub { bottom: -0.25em; }

/* ========================================================================== Embedded content ========================================================================== */
/** Remove border when inside `a` element in IE 8/9. */
img { border: 0; }

/** Correct overflow displayed oddly in IE 9. */
svg:not(:root) { overflow: hidden; }

/* ========================================================================== Figures ========================================================================== */
/** Address margin not present in IE 8/9 and Safari 5. */
figure { margin: 0; }

/* ========================================================================== Forms ========================================================================== */
/** Define consistent border, margin, and padding. */
fieldset { border: 1px solid #c0c0c0; margin: 0 2px; padding: 0.35em 0.625em 0.75em; }

/** 1. Correct `color` not being inherited in IE 8/9. 2. Remove padding so people aren't caught out if they zero out fieldsets. */
legend { border: 0; /* 1 */ padding: 0; /* 2 */ }

/** 1. Correct font family not being inherited in all browsers. 2. Correct font size not being inherited in all browsers. 3. Address margins set differently in Firefox 4+, Safari 5, and Chrome. */
button, input, select, textarea { font-family: inherit; /* 1 */ font-size: 100%; /* 2 */ margin: 0; /* 3 */ }

/** Address Firefox 4+ setting `line-height` on `input` using `!important` in the UA stylesheet. */
button, input { line-height: normal; }

/** Address inconsistent `text-transform` inheritance for `button` and `select`. All other form control elements do not inherit `text-transform` values. Correct `button` style inheritance in Chrome, Safari 5+, and IE 8+. Correct `select` style inheritance in Firefox 4+ and Opera. */
button, select { text-transform: none; }

/** 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio` and `video` controls. 2. Correct inability to style clickable `input` types in iOS. 3. Improve usability and consistency of cursor style between image-type `input` and others. */
button, html input[type="button"], input[type="reset"], input[type="submit"] { -webkit-appearance: button; /* 2 */ cursor: pointer; /* 3 */ }

/** Re-set default cursor for disabled elements. */
button[disabled], html input[disabled] { cursor: default; }

/** 1. Address box sizing set to `content-box` in IE 8/9. 2. Remove excess padding in IE 8/9. */
input[type="checkbox"], input[type="radio"] { box-sizing: border-box; /* 1 */ padding: 0; /* 2 */ }

/** 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome. 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome (include `-moz` to future-proof). */
input[type="search"] { -webkit-appearance: textfield; /* 1 */ -moz-box-sizing: content-box; -webkit-box-sizing: content-box; /* 2 */ box-sizing: content-box; }

/** Remove inner padding and search cancel button in Safari 5 and Chrome on OS X. */
input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration { -webkit-appearance: none; }

/** Remove inner padding and border in Firefox 4+. */
button::-moz-focus-inner, input::-moz-focus-inner { border: 0; padding: 0; }

/** 1. Remove default vertical scrollbar in IE 8/9. 2. Improve readability and alignment in all browsers. */
textarea { overflow: auto; /* 1 */ vertical-align: top; /* 2 */ }

/* ========================================================================== Tables ========================================================================== */
/** Remove most spacing between table cells. */
table { border-collapse: collapse; border-spacing: 0; }

meta.foundation-mq-small { font-family: "only screen and (min-width: 768px)"; width: 768px; }

meta.foundation-mq-medium { font-family: "only screen and (min-width:1280px)"; width: 1280px; }

meta.foundation-mq-large { font-family: "only screen and (min-width:1440px)"; width: 1440px; }

*, *:before, *:after { -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box; }

html, body { font-size: 100%; }

body { background: white; color: rgba(0, 0, 0, 0.8); padding: 0; margin: 0; font-family: "Noto Serif", "DejaVu Serif", serif; font-weight: normal; font-style: normal; line-height: 1; position: relative; cursor: auto; }

a:hover { cursor: pointer; }

img, object, embed { max-width: 100%; height: auto; }

object, embed { height: 100%; }

img { -ms-interpolation-mode: bicubic; }

#map_canvas img, #map_canvas embed, #map_canvas object, .map_canvas img, .map_canvas embed, .map_canvas object { max-width: none !important; }

.left { float: left !important; }

.right { float: right !important; }

.text-left { text-align: left !important; }

.text-right { text-align: right !important; }

.text-center { text-align: center !important; }

.text-justify { text-align: justify !important; }

.hide { display: none; }

.antialiased { -webkit-font-smoothing: antialiased; }

img { display: inline-block; vertical-align: middle; }

textarea { height: auto; min-height: 50px; }

select { width: 100%; }

object, svg { display: inline-block; vertical-align: middle; }

.center { margin-left: auto; margin-right: auto; }

.spread { width: 100%; }

p.lead, .paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { font-size: 1.21875em; line-height: 1.6; }

.subheader, .admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { line-height: 1.45; color: #7a2518; font-weight: normal; margin-top: 0; margin-bottom: 0.25em; }

/* Typography resets */
div, dl, dt, dd, ul, ol, li, h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6, pre, form, p, blockquote, th, td { margin: 0; padding: 0; direction: ltr; }

/* Default Link Styles */
a { color: #2156a5; text-decoration: underline; line-height: inherit; }
a:hover, a:focus { color: #1d4b8f; }
a img { border: none; }

/* Default paragraph styles */
p { font-family: inherit; font-weight: normal; font-size: 1em; line-height: 1.6; margin-bottom: 1.25em; text-rendering: optimizeLegibility; }
p aside { font-size: 0.875em; line-height: 1.35; font-style: italic; }

/* Default header styles */
h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { font-family: "Open Sans", "DejaVu Sans", sans-serif; font-weight: 300; font-style: normal; color: #ba3925; text-rendering: optimizeLegibility; margin-top: 1em; margin-bottom: 0.5em; line-height: 1.0125em; }
h1 small, h2 small, h3 small, #toctitle small, .sidebarblock > .content > .title small, h4 small, h5 small, h6 small { font-size: 60%; color: #e99b8f; line-height: 0; }

h1 { font-size: 2.125em; }

h2 { font-size: 1.6875em; }

h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.375em; }

h4 { font-size: 1.125em; }

h5 { font-size: 1.125em; }

h6 { font-size: 1em; }

hr { border: solid #ddddd8; border-width: 1px 0 0; clear: both; margin: 1.25em 0 1.1875em; height: 0; }

/* Helpful Typography Defaults */
em, i { font-style: italic; line-height: inherit; }

strong, b { font-weight: bold; line-height: inherit; }

small { font-size: 60%; line-height: inherit; }

code { font-family: "Droid Sans Mono", "DejaVu Sans Mono", monospace; font-weight: normal; color: rgba(0, 0, 0, 0.9); }

/* Lists */
ul, ol, dl { font-size: 1em; line-height: 1.6; margin-bottom: 1.25em; list-style-position: outside; font-family: inherit; }

ul, ol { margin-left: 1.5em; }
ul.no-bullet, ol.no-bullet { margin-left: 1.5em; }

/* Unordered Lists */
ul li ul, ul li ol { margin-left: 1.25em; margin-bottom: 0; font-size: 1em; /* Override nested font-size change */ }
ul.square li ul, ul.circle li ul, ul.disc li ul { list-style: inherit; }
ul.square { list-style-type: square; }
ul.circle { list-style-type: circle; }
ul.disc { list-style-type: disc; }
ul.no-bullet { list-style: none; }

/* Ordered Lists */
ol li ul, ol li ol { margin-left: 1.25em; margin-bottom: 0; }

/* Definition Lists */
dl dt { margin-bottom: 0.3125em; font-weight: bold; }
dl dd { margin-bottom: 1.25em; }

/* Abbreviations */
abbr, acronym { text-transform: uppercase; font-size: 90%; color: rgba(0, 0, 0, 0.8); border-bottom: 1px dotted #dddddd; cursor: help; }

abbr { text-transform: none; }

/* Blockquotes */
blockquote { margin: 0 0 1.25em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
blockquote cite { display: block; font-size: 0.9375em; color: rgba(0, 0, 0, 0.6); }
blockquote cite:before { content: "\2014 \0020"; }
blockquote cite a, blockquote cite a:visited { color: rgba(0, 0, 0, 0.6); }

blockquote, blockquote p { line-height: 1.6; color: rgba(0, 0, 0, 0.85); }

/* Microformats */
.vcard { display: inline-block; margin: 0 0 1.25em 0; border: 1px solid #dddddd; padding: 0.625em 0.75em; }
.vcard li { margin: 0; display: block; }
.vcard .fn { font-weight: bold; font-size: 0.9375em; }

.vevent .summary { font-weight: bold; }
.vevent abbr { cursor: auto; text-decoration: none; font-weight: bold; border: none; padding: 0 0.0625em; }

@media only screen and (min-width: 768px) { h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.2; }
    h1 { font-size: 2.75em; }
    h2 { font-size: 2.3125em; }
    h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.6875em; }
    h4 { font-size: 1.4375em; } }
/* Tables */
table { background: white; margin-bottom: 1.25em; border: solid 1px #dedede; }
table thead, table tfoot { background: #f7f8f7; font-weight: bold; }
table thead tr th, table thead tr td, table tfoot tr th, table tfoot tr td { padding: 0.5em 0.625em 0.625em; font-size: inherit; color: rgba(0, 0, 0, 0.8); text-align: left; }
table tr th, table tr td { padding: 0.5625em 0.625em; font-size: inherit; color: rgba(0, 0, 0, 0.8); }
table tr.even, table tr.alt, table tr:nth-of-type(even) { background: #f8f8f7; }
table thead tr th, table tfoot tr th, table tbody tr td, table tr td, table tfoot tr td { display: table-cell; line-height: 1.6; }

body { tab-size: 4; }

h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.2; word-spacing: -0.05em; }
h1 strong, h2 strong, h3 strong, #toctitle strong, .sidebarblock > .content > .title strong, h4 strong, h5 strong, h6 strong { font-weight: 400; }

.clearfix:before, .clearfix:after, .float-group:before, .float-group:after { content: " "; display: table; }
.clearfix:after, .float-group:after { clear: both; }

*:not(pre) > code { font-size: 0.9375em; font-style: normal !important; letter-spacing: 0; padding: 0.1em 0.5ex; word-spacing: -0.15em; background-color: #f7f7f8; -webkit-border-radius: 4px; border-radius: 4px; line-height: 1.45; text-rendering: optimizeSpeed; word-wrap: break-word; }
*:not(pre) > code.nobreak { word-wrap: normal; }
*:not(pre) > code.nowrap { white-space: nowrap; }

pre, pre > code { line-height: 1.45; color: rgba(0, 0, 0, 0.9); font-family: "Droid Sans Mono", "DejaVu Sans Mono", "Monospace", monospace; font-weight: normal; text-rendering: optimizeSpeed; }

em em { font-style: normal; }

strong strong { font-weight: normal; }

.keyseq { color: rgba(51, 51, 51, 0.8); }

kbd { font-family: "Droid Sans Mono", "DejaVu Sans Mono", monospace; display: inline-block; color: rgba(0, 0, 0, 0.8); font-size: 0.65em; line-height: 1.45; background-color: #f7f7f7; border: 1px solid #ccc; -webkit-border-radius: 3px; border-radius: 3px; -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; margin: 0 0.15em; padding: 0.2em 0.5em; vertical-align: middle; position: relative; top: -0.1em; white-space: nowrap; }

.keyseq kbd:first-child { margin-left: 0; }

.keyseq kbd:last-child { margin-right: 0; }

.menuseq, .menu { color: rgba(0, 0, 0, 0.8); }

b.button:before, b.button:after { position: relative; top: -1px; font-weight: normal; }

b.button:before { content: "["; padding: 0 3px 0 2px; }

b.button:after { content: "]"; padding: 0 2px 0 3px; }

p a > code:hover { color: rgba(0, 0, 0, 0.9); }

#header, #content, #footnotes, #footer { width: 100%; margin-left: auto; margin-right: auto; margin-top: 0; margin-bottom: 0; max-width: 62.5em; *zoom: 1; position: relative; padding-left: 0.9375em; padding-right: 0.9375em; }
#header:before, #header:after, #content:before, #content:after, #footnotes:before, #footnotes:after, #footer:before, #footer:after { content: " "; display: table; }
#header:after, #content:after, #footnotes:after, #footer:after { clear: both; }

#content { margin-top: 1.25em; }

#content:before { content: none; }

#header > h1:first-child { color: rgba(0, 0, 0, 0.85); margin-top: 2.25rem; margin-bottom: 0; }
#header > h1:first-child + #toc { margin-top: 8px; border-top: 1px solid #ddddd8; }
#header > h1:only-child, body.toc2 #header > h1:nth-last-child(2) { border-bottom: 1px solid #ddddd8; padding-bottom: 8px; }
#header .details { border-bottom: 1px solid #ddddd8; line-height: 1.45; padding-top: 0.25em; padding-bottom: 0.25em; padding-left: 0.25em; color: rgba(0, 0, 0, 0.6); display: -ms-flexbox; display: -webkit-flex; display: flex; -ms-flex-flow: row wrap; -webkit-flex-flow: row wrap; flex-flow: row wrap; }
#header .details span:first-child { margin-left: -0.125em; }
#header .details span.email a { color: rgba(0, 0, 0, 0.85); }
#header .details br { display: none; }
#header .details br + span:before { content: "\00a0\2013\00a0"; }
#header .details br + span.author:before { content: "\00a0\22c5\00a0"; color: rgba(0, 0, 0, 0.85); }
#header .details br + span#revremark:before { content: "\00a0|\00a0"; }
#header #revnumber { text-transform: capitalize; }
#header #revnumber:after { content: "\00a0"; }

#content > h1:first-child:not([class]) { color: rgba(0, 0, 0, 0.85); border-bottom: 1px solid #ddddd8; padding-bottom: 8px; margin-top: 0; padding-top: 1rem; margin-bottom: 1.25rem; }

#toc { border-bottom: 1px solid #efefed; padding-bottom: 0.5em; }
#toc > ul { margin-left: 0.125em; }
#toc ul.sectlevel0 > li > a { font-style: italic; }
#toc ul.sectlevel0 ul.sectlevel1 { margin: 0.5em 0; }
#toc ul { font-family: "Open Sans", "DejaVu Sans", sans-serif; list-style-type: none; }
#toc li { line-height: 1.3334; margin-top: 0.3334em; }
#toc a { text-decoration: none; }
#toc a:active { text-decoration: underline; }

#toctitle { color: #7a2518; font-size: 1.2em; }

@media only screen and (min-width: 768px) { #toctitle { font-size: 1.375em; }
    body.toc2 { padding-left: 15em; padding-right: 0; }
    #toc.toc2 { margin-top: 0 !important; background-color: #f8f8f7; position: fixed; width: 15em; left: 0; top: 0; border-right: 1px solid #efefed; border-top-width: 0 !important; border-bottom-width: 0 !important; z-index: 1000; padding: 1.25em 1em; height: 100%; overflow: auto; }
    #toc.toc2 #toctitle { margin-top: 0; margin-bottom: 0.8rem; font-size: 1.2em; }
    #toc.toc2 > ul { font-size: 0.9em; margin-bottom: 0; }
    #toc.toc2 ul ul { margin-left: 0; padding-left: 1em; }
    #toc.toc2 ul.sectlevel0 ul.sectlevel1 { padding-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
    body.toc2.toc-right { padding-left: 0; padding-right: 15em; }
    body.toc2.toc-right #toc.toc2 { border-right-width: 0; border-left: 1px solid #efefed; left: auto; right: 0; } }
@media only screen and (min-width: 1280px) { body.toc2 { padding-left: 20em; padding-right: 0; }
    #toc.toc2 { width: 20em; }
    #toc.toc2 #toctitle { font-size: 1.375em; }
    #toc.toc2 > ul { font-size: 0.95em; }
    #toc.toc2 ul ul { padding-left: 1.25em; }
    body.toc2.toc-right { padding-left: 0; padding-right: 20em; } }
#content #toc { border-style: solid; border-width: 1px; border-color: #e0e0dc; margin-bottom: 1.25em; padding: 1.25em; background: #f8f8f7; -webkit-border-radius: 4px; border-radius: 4px; }
#content #toc > :first-child { margin-top: 0; }
#content #toc > :last-child { margin-bottom: 0; }

#footer { max-width: 100%; background-color: rgba(0, 0, 0, 0.8); padding: 1.25em; }

#footer-text { color: rgba(255, 255, 255, 0.8); line-height: 1.44; }

.sect1 { padding-bottom: 0.625em; }

@media only screen and (min-width: 768px) { .sect1 { padding-bottom: 1.25em; } }
.sect1 + .sect1 { border-top: 1px solid #efefed; }

#content h1 > a.anchor, h2 > a.anchor, h3 > a.anchor, #toctitle > a.anchor, .sidebarblock > .content > .title > a.anchor, h4 > a.anchor, h5 > a.anchor, h6 > a.anchor { position: absolute; z-index: 1001; width: 1.5ex; margin-left: -1.5ex; display: block; text-decoration: none !important; visibility: hidden; text-align: center; font-weight: normal; }
#content h1 > a.anchor:before, h2 > a.anchor:before, h3 > a.anchor:before, #toctitle > a.anchor:before, .sidebarblock > .content > .title > a.anchor:before, h4 > a.anchor:before, h5 > a.anchor:before, h6 > a.anchor:before { content: "\00A7"; font-size: 0.85em; display: block; padding-top: 0.1em; }
#content h1:hover > a.anchor, #content h1 > a.anchor:hover, h2:hover > a.anchor, h2 > a.anchor:hover, h3:hover > a.anchor, #toctitle:hover > a.anchor, .sidebarblock > .content > .title:hover > a.anchor, h3 > a.anchor:hover, #toctitle > a.anchor:hover, .sidebarblock > .content > .title > a.anchor:hover, h4:hover > a.anchor, h4 > a.anchor:hover, h5:hover > a.anchor, h5 > a.anchor:hover, h6:hover > a.anchor, h6 > a.anchor:hover { visibility: visible; }
#content h1 > a.link, h2 > a.link, h3 > a.link, #toctitle > a.link, .sidebarblock > .content > .title > a.link, h4 > a.link, h5 > a.link, h6 > a.link { color: #ba3925; text-decoration: none; }
#content h1 > a.link:hover, h2 > a.link:hover, h3 > a.link:hover, #toctitle > a.link:hover, .sidebarblock > .content > .title > a.link:hover, h4 > a.link:hover, h5 > a.link:hover, h6 > a.link:hover { color: #a53221; }

.audioblock, .imageblock, .literalblock, .listingblock, .stemblock, .videoblock { margin-bottom: 1.25em; }

.admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { text-rendering: optimizeLegibility; text-align: left; font-family: "Noto Serif", "DejaVu Serif", serif; font-size: 1rem; font-style: italic; }

table.tableblock > caption.title { white-space: nowrap; overflow: visible; max-width: 0; }

.paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { color: rgba(0, 0, 0, 0.85); }

table.tableblock #preamble > .sectionbody > .paragraph:first-of-type p { font-size: inherit; }

.admonitionblock > table { border-collapse: separate; border: 0; background: none; width: 100%; }
.admonitionblock > table td.icon { text-align: center; width: 80px; }
.admonitionblock > table td.icon img { max-width: initial; }
.admonitionblock > table td.icon .title { font-weight: bold; font-family: "Open Sans", "DejaVu Sans", sans-serif; text-transform: uppercase; }
.admonitionblock > table td.content { padding-left: 1.125em; padding-right: 1.25em; border-left: 1px solid #ddddd8; color: rgba(0, 0, 0, 0.6); }
.admonitionblock > table td.content > :last-child > :last-child { margin-bottom: 0; }

.exampleblock > .content { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: white; -webkit-border-radius: 4px; border-radius: 4px; }
.exampleblock > .content > :first-child { margin-top: 0; }
.exampleblock > .content > :last-child { margin-bottom: 0; }

.sidebarblock { border-style: solid; border-width: 1px; border-color: #e0e0dc; margin-bottom: 1.25em; padding: 1.25em; background: #f8f8f7; -webkit-border-radius: 4px; border-radius: 4px; }
.sidebarblock > :first-child { margin-top: 0; }
.sidebarblock > :last-child { margin-bottom: 0; }
.sidebarblock > .content > .title { color: #7a2518; margin-top: 0; text-align: center; }

.exampleblock > .content > :last-child > :last-child, .exampleblock > .content .olist > ol > li:last-child > :last-child, .exampleblock > .content .ulist > ul > li:last-child > :last-child, .exampleblock > .content .qlist > ol > li:last-child > :last-child, .sidebarblock > .content > :last-child > :last-child, .sidebarblock > .content .olist > ol > li:last-child > :last-child, .sidebarblock > .content .ulist > ul > li:last-child > :last-child, .sidebarblock > .content .qlist > ol > li:last-child > :last-child { margin-bottom: 0; }

.literalblock pre, .listingblock pre:not(.highlight), .listingblock pre[class="highlight"], .listingblock pre[class^="highlight "], .listingblock pre.CodeRay, .listingblock pre.prettyprint { background: #f7f7f8; }
.sidebarblock .literalblock pre, .sidebarblock .listingblock pre:not(.highlight), .sidebarblock .listingblock pre[class="highlight"], .sidebarblock .listingblock pre[class^="highlight "], .sidebarblock .listingblock pre.CodeRay, .sidebarblock .listingblock pre.prettyprint { background: #f2f1f1; }

.literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { -webkit-border-radius: 4px; border-radius: 4px; word-wrap: break-word; padding: 1em; font-size: 0.8125em; }
.literalblock pre.nowrap, .literalblock pre[class].nowrap, .listingblock pre.nowrap, .listingblock pre[class].nowrap { overflow-x: auto; white-space: pre; word-wrap: normal; }
@media only screen and (min-width: 768px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 0.90625em; } }
@media only screen and (min-width: 1280px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 1em; } }

.literalblock.output pre { color: #f7f7f8; background-color: rgba(0, 0, 0, 0.9); }

.listingblock pre.highlightjs { padding: 0; }
.listingblock pre.highlightjs > code { padding: 1em; -webkit-border-radius: 4px; border-radius: 4px; }

.listingblock pre.prettyprint { border-width: 0; }

.listingblock > .content { position: relative; }

.listingblock code[data-lang]:before { display: none; content: attr(data-lang); position: absolute; font-size: 0.75em; top: 0.425rem; right: 0.5rem; line-height: 1; text-transform: uppercase; color: #999; }

.listingblock:hover code[data-lang]:before { display: block; }

.listingblock.terminal pre .command:before { content: attr(data-prompt); padding-right: 0.5em; color: #999; }

.listingblock.terminal pre .command:not([data-prompt]):before { content: "$"; }

table.pyhltable { border-collapse: separate; border: 0; margin-bottom: 0; background: none; }

table.pyhltable td { vertical-align: top; padding-top: 0; padding-bottom: 0; line-height: 1.45; }

table.pyhltable td.code { padding-left: .75em; padding-right: 0; }

pre.pygments .lineno, table.pyhltable td:not(.code) { color: #999; padding-left: 0; padding-right: .5em; border-right: 1px solid #ddddd8; }

pre.pygments .lineno { display: inline-block; margin-right: .25em; }

table.pyhltable .linenodiv { background: none !important; padding-right: 0 !important; }

.quoteblock { margin: 0 1em 1.25em 1.5em; display: table; }
.quoteblock > .title { margin-left: -1.5em; margin-bottom: 0.75em; }
.quoteblock blockquote, .quoteblock blockquote p { color: rgba(0, 0, 0, 0.85); font-size: 1.15rem; line-height: 1.75; word-spacing: 0.1em; letter-spacing: 0; font-style: italic; text-align: justify; }
.quoteblock blockquote { margin: 0; padding: 0; border: 0; }
.quoteblock blockquote:before { content: "\201c"; float: left; font-size: 2.75em; font-weight: bold; line-height: 0.6em; margin-left: -0.6em; color: #7a2518; text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1); }
.quoteblock blockquote > .paragraph:last-child p { margin-bottom: 0; }
.quoteblock .attribution { margin-top: 0.5em; margin-right: 0.5ex; text-align: right; }
.quoteblock .quoteblock { margin-left: 0; margin-right: 0; padding: 0.5em 0; border-left: 3px solid rgba(0, 0, 0, 0.6); }
.quoteblock .quoteblock blockquote { padding: 0 0 0 0.75em; }
.quoteblock .quoteblock blockquote:before { display: none; }

.verseblock { margin: 0 1em 1.25em 1em; }
.verseblock pre { font-family: "Open Sans", "DejaVu Sans", sans; font-size: 1.15rem; color: rgba(0, 0, 0, 0.85); font-weight: 300; text-rendering: optimizeLegibility; }
.verseblock pre strong { font-weight: 400; }
.verseblock .attribution { margin-top: 1.25rem; margin-left: 0.5ex; }

.quoteblock .attribution, .verseblock .attribution { font-size: 0.9375em; line-height: 1.45; font-style: italic; }
.quoteblock .attribution br, .verseblock .attribution br { display: none; }
.quoteblock .attribution cite, .verseblock .attribution cite { display: block; letter-spacing: -0.025em; color: rgba(0, 0, 0, 0.6); }

.quoteblock.abstract { margin: 0 0 1.25em 0; display: block; }
.quoteblock.abstract blockquote, .quoteblock.abstract blockquote p { text-align: left; word-spacing: 0; }
.quoteblock.abstract blockquote:before, .quoteblock.abstract blockquote p:first-of-type:before { display: none; }

table.tableblock { max-width: 100%; border-collapse: separate; }
table.tableblock td > .paragraph:last-child p > p:last-child, table.tableblock th > p:last-child, table.tableblock td > p:last-child { margin-bottom: 0; }

table.tableblock, th.tableblock, td.tableblock { border: 0 solid #dedede; }

table.grid-all th.tableblock, table.grid-all td.tableblock { border-width: 0 1px 1px 0; }

table.grid-all tfoot > tr > th.tableblock, table.grid-all tfoot > tr > td.tableblock { border-width: 1px 1px 0 0; }

table.grid-cols th.tableblock, table.grid-cols td.tableblock { border-width: 0 1px 0 0; }

table.grid-all * > tr > .tableblock:last-child, table.grid-cols * > tr > .tableblock:last-child { border-right-width: 0; }

table.grid-rows th.tableblock, table.grid-rows td.tableblock { border-width: 0 0 1px 0; }

table.grid-all tbody > tr:last-child > th.tableblock, table.grid-all tbody > tr:last-child > td.tableblock, table.grid-all thead:last-child > tr > th.tableblock, table.grid-rows tbody > tr:last-child > th.tableblock, table.grid-rows tbody > tr:last-child > td.tableblock, table.grid-rows thead:last-child > tr > th.tableblock { border-bottom-width: 0; }

table.grid-rows tfoot > tr > th.tableblock, table.grid-rows tfoot > tr > td.tableblock { border-width: 1px 0 0 0; }

table.frame-all { border-width: 1px; }

table.frame-sides { border-width: 0 1px; }

table.frame-topbot { border-width: 1px 0; }

th.halign-left, td.halign-left { text-align: left; }

th.halign-right, td.halign-right { text-align: right; }

th.halign-center, td.halign-center { text-align: center; }

th.valign-top, td.valign-top { vertical-align: top; }

th.valign-bottom, td.valign-bottom { vertical-align: bottom; }

th.valign-middle, td.valign-middle { vertical-align: middle; }

table thead th, table tfoot th { font-weight: bold; }

tbody tr th { display: table-cell; line-height: 1.6; background: #f7f8f7; }

tbody tr th, tbody tr th p, tfoot tr th, tfoot tr th p { color: rgba(0, 0, 0, 0.8); font-weight: bold; }

p.tableblock > code:only-child { background: none; padding: 0; }

p.tableblock { font-size: 1em; }

td > div.verse { white-space: pre; }

ol { margin-left: 1.75em; }

ul li ol { margin-left: 1.5em; }

dl dd { margin-left: 1.125em; }

dl dd:last-child, dl dd:last-child > :last-child { margin-bottom: 0; }

ol > li p, ul > li p, ul dd, ol dd, .olist .olist, .ulist .ulist, .ulist .olist, .olist .ulist { margin-bottom: 0.625em; }

ul.unstyled, ol.unnumbered, ul.checklist, ul.none { list-style-type: none; }

ul.unstyled, ol.unnumbered, ul.checklist { margin-left: 0.625em; }

ul.checklist li > p:first-child > .fa-square-o:first-child, ul.checklist li > p:first-child > .fa-check-square-o:first-child { width: 1em; font-size: 0.85em; }

ul.checklist li > p:first-child > input[type="checkbox"]:first-child { width: 1em; position: relative; top: 1px; }

ul.inline { margin: 0 auto 0.625em auto; margin-left: -1.375em; margin-right: 0; padding: 0; list-style: none; overflow: hidden; }
ul.inline > li { list-style: none; float: left; margin-left: 1.375em; display: block; }
ul.inline > li > * { display: block; }

.unstyled dl dt { font-weight: normal; font-style: normal; }

ol.arabic { list-style-type: decimal; }

ol.decimal { list-style-type: decimal-leading-zero; }

ol.loweralpha { list-style-type: lower-alpha; }

ol.upperalpha { list-style-type: upper-alpha; }

ol.lowerroman { list-style-type: lower-roman; }

ol.upperroman { list-style-type: upper-roman; }

ol.lowergreek { list-style-type: lower-greek; }

.hdlist > table, .colist > table { border: 0; background: none; }
.hdlist > table > tbody > tr, .colist > table > tbody > tr { background: none; }

td.hdlist1, td.hdlist2 { vertical-align: top; padding: 0 0.625em; }

td.hdlist1 { font-weight: bold; padding-bottom: 1.25em; }

.literalblock + .colist, .listingblock + .colist { margin-top: -0.5em; }

.colist > table tr > td:first-of-type { padding: 0 0.75em; line-height: 1; }
.colist > table tr > td:first-of-type img { max-width: initial; }
.colist > table tr > td:last-of-type { padding: 0.25em 0; }

.thumb, .th { line-height: 0; display: inline-block; border: solid 4px white; -webkit-box-shadow: 0 0 0 1px #dddddd; box-shadow: 0 0 0 1px #dddddd; }

.imageblock.left, .imageblock[style*="float: left"] { margin: 0.25em 0.625em 1.25em 0; }
.imageblock.right, .imageblock[style*="float: right"] { margin: 0.25em 0 1.25em 0.625em; }
.imageblock > .title { margin-bottom: 0; }
.imageblock.thumb, .imageblock.th { border-width: 6px; }
.imageblock.thumb > .title, .imageblock.th > .title { padding: 0 0.125em; }

.image.left, .image.right { margin-top: 0.25em; margin-bottom: 0.25em; display: inline-block; line-height: 0; }
.image.left { margin-right: 0.625em; }
.image.right { margin-left: 0.625em; }

a.image { text-decoration: none; display: inline-block; }
a.image object { pointer-events: none; }

sup.footnote, sup.footnoteref { font-size: 0.875em; position: static; vertical-align: super; }
sup.footnote a, sup.footnoteref a { text-decoration: none; }
sup.footnote a:active, sup.footnoteref a:active { text-decoration: underline; }

#footnotes { padding-top: 0.75em; padding-bottom: 0.75em; margin-bottom: 0.625em; }
#footnotes hr { width: 20%; min-width: 6.25em; margin: -0.25em 0 0.75em 0; border-width: 1px 0 0 0; }
#footnotes .footnote { padding: 0 0.375em 0 0.225em; line-height: 1.3334; font-size: 0.875em; margin-left: 1.2em; text-indent: -1.05em; margin-bottom: 0.2em; }
#footnotes .footnote a:first-of-type { font-weight: bold; text-decoration: none; }
#footnotes .footnote:last-of-type { margin-bottom: 0; }
#content #footnotes { margin-top: -0.625em; margin-bottom: 0; padding: 0.75em 0; }

.gist .file-data > table { border: 0; background: #fff; width: 100%; margin-bottom: 0; }
.gist .file-data > table td.line-data { width: 99%; }

div.unbreakable { page-break-inside: avoid; }

.big { font-size: larger; }

.small { font-size: smaller; }

.underline { text-decoration: underline; }

.overline { text-decoration: overline; }

.line-through { text-decoration: line-through; }

.aqua { color: #00bfbf; }

.aqua-background { background-color: #00fafa; }

.black { color: black; }

.black-background { background-color: black; }

.blue { color: #0000bf; }

.blue-background { background-color: #0000fa; }

.fuchsia { color: #bf00bf; }

.fuchsia-background { background-color: #fa00fa; }

.gray { color: #606060; }

.gray-background { background-color: #7d7d7d; }

.green { color: #006000; }

.green-background { background-color: #007d00; }

.lime { color: #00bf00; }

.lime-background { background-color: #00fa00; }

.maroon { color: #600000; }

.maroon-background { background-color: #7d0000; }

.navy { color: #000060; }

.navy-background { background-color: #00007d; }

.olive { color: #606000; }

.olive-background { background-color: #7d7d00; }

.purple { color: #600060; }

.purple-background { background-color: #7d007d; }

.red { color: #bf0000; }

.red-background { background-color: #fa0000; }

.silver { color: #909090; }

.silver-background { background-color: #bcbcbc; }

.teal { color: #006060; }

.teal-background { background-color: #007d7d; }

.white { color: #bfbfbf; }

.white-background { background-color: #fafafa; }

.yellow { color: #bfbf00; }

.yellow-background { background-color: #fafa00; }

span.icon > .fa { cursor: default; }

.admonitionblock td.icon [class^="fa icon-"] {
    cursor: default;
    color: transparent;
    font-size: 3.5em;
    text-shadow: 0 0 #00c489;
    opacity: 0.7;
}
.admonitionblock td.icon .icon-note:before { content: "\2728"; }
.admonitionblock td.icon .icon-tip:before { content: "\1F4A1"; }
.admonitionblock td.icon .icon-warning:before { content: "\2757"; }
.admonitionblock td.icon .icon-caution:before { content: "\26A0"; }
.admonitionblock td.icon .icon-important:before { content: "\26A0"; }

.conum[data-value] { display: inline-block; color: #fff !important; background-color: rgba(0, 0, 0, 0.8); -webkit-border-radius: 100px; border-radius: 100px; text-align: center; font-size: 0.75em; width: 1.67em; height: 1.67em; line-height: 1.67em; font-family: "Open Sans", "DejaVu Sans", sans-serif; font-style: normal; font-weight: bold; }
.conum[data-value] * { color: #fff !important; }
.conum[data-value] + b { display: none; }
.conum[data-value]:after { content: attr(data-value); }
pre .conum[data-value] { position: relative; top: -0.125em; }

b.conum * { color: inherit !important; }

.conum:not([data-value]):empty { display: none; }

dt, th.tableblock, td.content, div.footnote { text-rendering: optimizeLegibility; }

h1, h2, p, td.content, span.alt { letter-spacing: -0.01em; }

p strong, td.content strong, div.footnote strong { letter-spacing: -0.005em; }

p, blockquote, dt, td.content, span.alt { font-size: 1.0625rem; }

p { margin-bottom: 1.25rem; }

.sidebarblock p, .sidebarblock dt, .sidebarblock td.content, p.tableblock { font-size: 1em; }

.exampleblock > .content { background-color: #fffef7; border-color: #e0e0dc; -webkit-box-shadow: 0 1px 4px #e0e0dc; box-shadow: 0 1px 4px #e0e0dc; }

.print-only { display: none !important; }

@media print { @page { margin: 1.25cm 0.75cm; }
    * { -webkit-box-shadow: none !important; box-shadow: none !important; text-shadow: none !important; }
    a { color: inherit !important; text-decoration: underline !important; }
    a.bare, a[href^="#"], a[href^="mailto:"] { text-decoration: none !important; }
    a[href^="http:"]:not(.bare):after, a[href^="https:"]:not(.bare):after { content: "(" attr(href) ")"; display: inline-block; font-size: 0.875em; padding-left: 0.25em; }
    abbr[title]:after { content: " (" attr(title) ")"; }
    pre, blockquote, tr, img, object, svg { page-break-inside: avoid; }
    thead { display: table-header-group; }
    svg { max-width: 100%; }
    p, blockquote, dt, td.content { font-size: 1em; orphans: 3; widows: 3; }
    h2, h3, #toctitle, .sidebarblock > .content > .title, #toctitle, .sidebarblock > .content > .title { page-break-after: avoid; }
    #toc, .sidebarblock, .exampleblock > .content { background: none !important; }
    #toc { border-bottom: 1px solid #ddddd8 !important; padding-bottom: 0 !important; }
    .sect1 { padding-bottom: 0 !important; }
    .sect1 + .sect1 { border: 0 !important; }
    #header > h1:first-child { margin-top: 1.25rem; }
    body.book #header { text-align: center; }
    body.book #header > h1:first-child { border: 0 !important; margin: 2.5em 0 1em 0; }
    body.book #header .details { border: 0 !important; display: block; padding: 0 !important; }
    body.book #header .details span:first-child { margin-left: 0 !important; }
    body.book #header .details br { display: block; }
    body.book #header .details br + span:before { content: none !important; }
    body.book #toc { border: 0 !important; text-align: left !important; padding: 0 !important; margin: 0 !important; }
    body.book #toc, body.book #preamble, body.book h1.sect0, body.book .sect1 > h2 { page-break-before: always; }
    .listingblock code[data-lang]:before { display: block; }
    #footer { background: none !important; padding: 0 0.9375em; }
    #footer-text { color: rgba(0, 0, 0, 0.6) !important; font-size: 0.9em; }
    .hide-on-print { display: none !important; }
    .print-only { display: block !important; }
    .hide-for-print { display: none !important; }
    .show-for-print { display: inherit !important; } }

/* END asciidoc.css */

html,
body {
    margin: 0;
    padding: 0;
}

html {
    font-size: 16px;
    font-weight: 400;
    line-height: 1.5;
}

body {
    color: #02303A;
    background-color: #f7f7f8;
    font-family: "Lato", "Helvetica Neue", Arial, sans-serif;
    line-height: 1.5;
    -webkit-text-size-adjust: 100%;
    -ms-text-size-adjust: 100%;
}

/* Links */
a {
    color: #1DA2BD;
    text-decoration: none;
}

a:hover,
a:focus {
    text-decoration: underline;
}

#content a[href^='../dsl/'],
#content a[href^='../javadoc/'] {
    font-family: 'Inconsolata', monospace;
    font-style: normal;
    border-bottom: 1px dotted rgba(29, 162, 189, 0.5);
    padding: 0 1px;
}

#content a[href^='../dsl/']:hover,
#content a[href^='../dsl/']:focus,
#content a[href^='../javadoc/']:hover,
#content a[href^='../javadoc/']:focus {
    text-decoration: none;
}

/* Copy */

p {
    font-size: 1rem;
}

pre,
pre > code,
code {
    font-family: 'Inconsolata', monospace;
}

h1,
h2,
h3,
h4,
h5,
h6,
#toctitle,
.sidebarblock > .content > .title {
    font-family: inherit;
    font-weight: 500;
    color: inherit;
}

h1 {
    font-size: 2rem;
}

h2 {
    font-size: 1.5rem;
}

h3 {
    font-size: 1.125rem;
}

h4 {
    font-size: 1.0625rem;
}

h5, h6 {
    font-size: 1rem;
}

b, strong {
    font-weight: 500;
}

dl {
    margin: 0 0 1.25rem 1.5rem;
}

.dlist dt code {
    color: #02303A;
    font-size: 1em;
    font-weight: bold;
}

.dlist p {
    margin-bottom: 0.625rem;
}

.sr-only {
    border: 0;
    clip: rect(0, 0, 0, 0);
    height: 1px;
    margin: -1px;
    overflow: hidden;
    padding: 0;
    position: absolute;
    width: 1px;
}

/* Layout */
.main-content > .appendix,
.main-content > .book,
.main-content > .chapter,
.main-content > .footer {
    background-color: white;
    border-radius: 5px;
    max-width: 45rem;
    padding: 1.5rem;
}

@media screen and (max-width: 45em) {
    .footer {
        max-width: 100%;
    }

    .main-content > .appendix,
    .main-content > .book,
    .main-content > .chapter {
        margin-top: 0;
        margin-bottom: 0;
    }
}

/* Override asciidoc styles */
#header {
    position: static;
}

#header, #content {
    padding: 0;
}

#header .details {
    /* TODO: Pretty sure there's a way to avoid Asciidoc generating details */
    display: none;
}

p {
    color: #02303A;
}

h1,
h2,
p,
p strong,
td.content,
td.content strong,
div.footnote strong,
span.alt {
    letter-spacing: normal;
}

.subheader,
.admonitionblock td.content > .title,
.audioblock > .title,
.exampleblock > .title,
.imageblock > .title,
.listingblock > .title,
.literalblock > .title,
.stemblock > .title,
.openblock > .title,
.paragraph > .title,
.quoteblock > .title,
table.tableblock > .title,
.verseblock > .title,
.videoblock > .title,
.dlist > .title,
.olist > .title,
.ulist > .title,
.qlist > .title,
.hdlist > .title {
    color: inherit;
    font-family: inherit;
}

.listingblock .title,
.listingblock .title code {
    font-style: normal;
    font-weight: bold;
}

.admonitionblock td.content > .title {
    font-family: inherit;
    font-style: normal;
    font-size: 1.25em;
    color: #555;
}

.admonitionblock table tr td {
    padding: 0;
}

.imageblock,
.videoblock {
    padding: 0.25em;
}

p.lead,
.paragraph.lead > p,
#preamble > .sectionbody > .paragraph:first-of-type p {
    font-size: 1.0625rem;
}

.paragraph.lead > p,
#preamble > .sectionbody > .paragraph:first-of-type p {
    color: inherit;
}

.sect1 {
    padding-bottom: 0;
}

.sect1 + .sect1 {
    border: 0 none;
}

.admonitionblock .icon .title {
    font-size: 2.3em;
}

.admonitionblock > table td.icon .title {
    font-family: "Lato", Arial, sans-serif;
}

.admonitionblock .content,
.admonitionblock p {
    color: #666;
}

.verseblock pre {
    font-family: "Lato", Arial, sans-serif;
}

td.hdlist1 {
    padding-bottom: 0.625rem;
}

td.hdlist2 p {
    margin-bottom: 0.625rem;
}

body.book #header > h1 {
    border: 0;
}

#header > h1:first-child {
    margin-top: 0;
}

#content a.link {
    color: #02303A;
}

.highlight .com {
    color: #777;
}

.listingblock pre.highlightjs > code {
    overflow-x: auto;
}

.listingblock pre.highlight {
    overflow-x: auto;
}

.listingblock pre.highlight > code {
    white-space: pre;
}

.conum[data-value] {
    font-family: "Lato", Arial, sans-serif;
}

.colist > table tr > td:first-of-type {
    padding-top: 0.25em;
    padding-bottom: 0.25em;
    line-height: 1.4;
    vertical-align: baseline;
}

/*
 * Samples
 */
.exampleblock > .content {
    background-color: inherit;
    border: 0 none;
    box-shadow: none;
    padding: 0;
}

.exampleblock > .content .title {
    background-color: #f7f7f8;
    border-top: 1px solid #ccc;
    font-family: 'Inconsolata', monospace;
    margin: 0;
    padding: 1em 1em 0;
}

.exampleblock .listingblock {
    margin: 0;
}

/* Multi-language selection */
.multi-language-selector .language-option[data-lang='groovy'],
.exampleblock[data-lang=groovy] > .content .title {
    background-image: url('data:image/svg+xml;base64,PHN2Zw0KICAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIg0KICAgd2lkdGg9IjYxNC4wNjA4NSINCiAgIGhlaWdodD0iMzAzLjU5ODYiDQogICB2ZXJzaW9uPSIxLjEiPg0KICA8Zw0KICAgICB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMzUuMzk2NTk5LC0zMC41NTgxOTYpIj4NCiAgICA8cGF0aA0KICAgICAgIGQ9Im0gMTU0Ljk3Njg3LDMzMi42OTE2MiBjIDAsLTAuODA1ODcgMTAuODMxMjMsLTE4LjYyMTcyIDI0LjA2OTQsLTM5LjU5MDc2IDEzLjIzODE5LC0yMC45NjkwNSAyMi42NjA1NywtMzguNjIwNjYgMjAuOTM4NjcsLTM5LjIyNTc3IC0xLjcyMTkxLC0wLjYwNTEgLTcuNjc5OTIsMC40ODU2NyAtMTMuMjQwMDIsMi40MjM5MyAtMTYuNzQ1MjQsNS44Mzc0MyAtMjAuMTg2MDUsNC4yOTAxNiAtMzIuNjkzMDgsLTE0LjcwMTU1IC0xMy41MzI2NSwtMjAuNTQ5MDYgLTE0LjAxNzI0LC0yMi42Njk4MyAtNi45NjE1OCwtMzAuNDY2MjQgNC42MDg3NiwtNS4wOTI1NiA0LjMzMTU5LC02LjI3OTY3IC0zLjIzMTksLTEzLjg0MzE2IC00LjU1MDA5LC00LjU1MDEgLTguMjcyODksLTkuNjQzMDkgLTguMjcyODksLTExLjMxNzc2IDAsLTIuODE2NzkgLTMwLjk5MTQ1LC0xNS41ODkzMyAtNzkuOTg5NDk2LC0zMi45NjYxNSAtMTEuMTA5NjYsLTMuOTM5OTcgLTIwLjE5OTM3NSwtNy44MjkyOCAtMjAuMTk5Mzc1LC04LjY0MjkxIDAsLTAuODEzNjYgMjMuNDcwNzM4LC0xLjAwNDc2IDUyLjE1NzE5MSwtMC40MjQ2OSBsIDUyLjE1NzIxLDEuMDU0NjYgNS4wOTEyNywtOC4wMzAwMSBjIDIxLjUxNjQ0LC0zMy45MzU5MiA1NC4wMDk1MiwtNjQuNTg4MjEyIDY4LjQ2NzA1LC02NC41ODgyMTIgMy4wMTA2LDAgOS4xMjE0MSwyLjg2OTE4IDEzLjU3OTUzLDYuMzc1OTQ1IDcuMjU5NDYsNS43MTAyODMgOC4yNTY1LDkuMjQ4NjMyIDkuNTQ5OTQsMzMuODkxOTY3IDAuNzk0MywxNS4xMzM4MiAyLjQyNDIyLDI4LjQ5NjAxIDMuNjIxOTgsMjkuNjkzNzkgMS4xOTc3NSwxLjE5Nzc2IDQuOTk3NjksLTAuMzc0MjUgOC40NDQzMSwtMy40OTMzOSA0LjQwMTQsLTMuOTgzMjMgOS4wMzQ4NCwtNS4wNjMxMyAxNS41Njc2MSwtMy42MjgzIDYuNzY3NTYsMS40ODY0MSAxMC42MjcxLDAuNDY4OTUgMTQuMTY5MzgsLTMuNzM1NDMgNS4zMTM2LC02LjMwNjY2IDMxLjkwNTk2LC00OC45MzcyMDEgMzEuOTA1OTYsLTUxLjE0ODc0NCAwLC0wLjc1MTU4OCA1LjI2NTA5LC05Ljc1NzMwNiAxMS43MDAyMywtMjAuMDEyNzAzIDYuNDM1MDksLTEwLjI1NTM5NyAxMy44NDY2NCwtMjIuMDgwNjMxIDE2LjQ3MDA3LC0yNi4yNzgyODMgNC42NjU1OCwtNy40NjUyMDEgNS4zOTY2LC02LjU4MTczNSAzMy40MjY5Miw0MC4zOTg3MzYgMjguOTQxMjEsNDguNTA3MTY0IDQ0LjUxNzY3LDY2LjQwNjU1NCA1Mi4zMTU3LDYwLjExNzYzNCA1LjQ0MiwtNC4zODg4OSAzNC4wMDA1NSwtNC42Mzc5NCA0MS45ODI0NiwtMC4zNjYxNCA0LjUzNjY1LDIuNDI3OTMgNy40MTkxNiwyLjM5NjEgOS45MjQ4NCwtMC4xMDk2MiA1LjIwMDA3LC01LjIwMDA2IDE3LjY0OTgyLC00LjI5NDM3IDIwLjkwNDEyLDEuNTIwNzggMi41NjM5Myw0LjU4MTQ2IDMuMjE3ODQsNC41ODE0NiA3LjAyMDE0LDAgMi4zMDYwNiwtMi43Nzg2NyA5LjEzNjE5LC01LjA1MjA4IDE1LjE3ODAzLC01LjA1MjA4IDguNTM4ODQsMCAxMS43OTMzNiwxLjc3MzY3IDE0LjYxNDAzLDcuOTY0MzcgbCAzLjYyODgxLDcuOTY0MzYgNTYuMDkyMDMsLTEuOTg1OCBjIDMwLjg1MDYyLC0xLjA5MjIyIDU2LjA5MjA0LC0xLjI4Njg4IDU2LjA5MjA0LC0wLjQzMjU1IDAsMC44NTQyNyAtMjIuOTA2MDgsMTAuMDcxOTUgLTUwLjkwMjQxLDIwLjQ4MzcxIC0yNy45OTYzMiwxMC40MTE3MiAtNTEuMzY3LDE5LjI0MzA1IC01MS45MzQ4NCwxOS42MjUxMiAtMC41Njc4NSwwLjM4MjA3IDAuNjk4NDcsOS40OTI3MyAyLjgxNDA1LDIwLjI0NTg4IDUuNTA0NTcsMjcuOTc5MTcgMS45MTQ1OCw0Ni42MjU4OSAtMTEuOTI2MjksNjEuOTQ2MDQgLTYuMjA5LDYuODcyNjMgLTE2LjI4MzM4LDE0LjE0Mzk1IC0yMi4zODc1MywxNi4xNTg0OSAtNi4xMDQxNSwyLjAxNDU0IC0xMS4wOTg0NCw0LjM4NjE0IC0xMS4wOTg0NCw1LjI3MDE5IDAsMC44ODQwNiA2LjUxNTI1LDExLjY3ODkzIDE0LjQ3ODM1LDIzLjk4ODU5IDcuOTYzMDksMTIuMzA5NjkgMTMuMjgyOCwyMi4zODEyNSAxMS44MjE1MiwyMi4zODEyNSAtMi4zODUwNCwwIC02MC40Njk4NywtMjIuNDQyMzggLTE1MC43ODg5OCwtNTguMjYwNyAtMTcuODA5LC03LjA2MjU4IC0zNC4wMjY4MywtMTIuODQxMDkgLTM2LjAzOTYxLC0xMi44NDEwOSAtMy43NTM2MywwIC0zNi4xNjY5LDEyLjI4NjYyIC0xMzEuMjI0MjMsNDkuNzQyMDYgLTU1LjEyNTI1LDIxLjcyMTAzIC01Ny4yOTIxNywyMi40NzM0OCAtNTcuMjkyMTcsMTkuODk0NTEgeiBtIDExMy4xMTY0OCwtNTEuMjUyNjUgYyAyOS4zMjk0OSwtMTEuMzk1MDYgNTguNDE2NTcsLTIyLjUzMDggNjQuNjM3OTgsLTI0Ljc0NjA3IDEwLjcwMDY4LC0zLjgxMDE5IDE0LjI3OTE4LC0yLjg1NDkzIDY2LjI1Mzk0LDE3LjY4NjM0IDMwLjIxODI1LDExLjk0Mjc0IDYwLjAzMjUyLDIzLjU3NTg3IDY2LjI1MzkyLDI1Ljg1MTM0IDYuMjIxNDEsMi4yNzU1MiAxOS4wNDMxNyw3LjIyMDU5IDI4LjQ5Mjc1LDEwLjk4OTA4IDEwLjc3NTAzLDQuMjk3MDQgMTYuMjgyNTEsNS4zMzE2NiAxNC43NzEwOCwyLjc3NDg0IC0xNi44ODM3LC0yOC41NjExMyAtMTcuMzk5OCwtMjkuMDM3MTYgLTI5LjEwMDgzLC0yNi44NDIwNSAtMTQuMTEzNjEsMi42NDc3MiAtMjIuODc4OTcsLTAuMDY4NSAtMjcuMzgzNjksLTguNDg1NTQgLTIuOTIxMTIsLTUuNDU4MTYgLTIuMDI5NDQsLTguMTI3NTkgNS4yNTQ0MiwtMTUuNzMwMzEgMTAuODQ4ODcsLTExLjMyMzc3IDkuMTQ0NTcsLTIxLjc0MTQ0IC00Ljg0NDI5LC0yOS42MTA5OSAtNS4zNjc2NCwtMy4wMTk1OSAtMTIuMTQwNTksLTEwLjQ4MzcyIC0xNS4wNTEwMiwtMTYuNTg2OTcgbCAtNS4yOTE2OSwtMTEuMDk2ODIgLTExLjM0NTUxLDcuNjk5MjggYyAtMTMuOTQ0NTgsOS40NjMwNCAtMzAuOTUwNjIsOS45NTA2MyAtNDUuMTQ3NjQsMS4yOTQ0OCBsIC0xMC40NjQ4OCwtNi4zODA2NSAtMTIuMTU4NDEsOC4yNjI4NCBjIC0xMi4xNzQ2Miw4LjI3Mzg2IC0yNi4xOTEwOCw5LjM0MjggLTQwLjQzNzUyLDMuMDgzOTIgLTMuOTI0OTgsLTEuNzI0MzkgLTUuNjU1ODMsLTEuMDU0MTUgLTUuNjU1ODMsMi4xOTAwOCAwLDIuNTcxMTggLTMuNzA0MjksNi4zNjI2NSAtOC4yMzE4MSw4LjQyNTUzIC0xMy41NzQyLDYuMTg0NzkgLTI2LjgyMTA3LDQuNTQyNDcgLTM1LjgwMjI5LC00LjQzODc1IGwgLTguMTg5NDQsLTguMTg5NDQgLTYuNjA5ODIsOC40MDMwMyBjIC0zLjYzNTM5LDQuNjIxNjYgLTEyLjA0OTUyLDExLjgzNjk4IC0xOC42OTgwNSwxNi4wMzM5OCAtOC4yMjk2NSw1LjE5NTE4IC0xOC40MTc0MSwxNy44NzE4MiAtMzEuOTE2NCwzOS43MTM2MSAtMTAuOTA1NDksMTcuNjQ1NDYgLTE5LjgyODE2LDMyLjk4MDQyIC0xOS44MjgxNiwzNC4wNzc3NiAwLDEuMDk3MyA4LjM2MjU1LC0xLjUyNzM2IDE4LjU4MzQyLC01LjgzMjU5IDEwLjIyMDg5LC00LjMwNTIxIDQyLjU4MDI4LC0xNy4xNTA4NyA3MS45MDk3NywtMjguNTQ1OTMgeiBtIDI0OC43NjcyOSwtMTIuMjU4NDYgYyAyMi4yNTU1NywtMTIuNTA4MzMgMjcuNDE0MjQsLTM1LjY0ODA4IDE3LjU3Njg1LC03OC44NDMxOCAtOC4yMjE0LC0zNi4wOTk2MSAtMTIuMzI1NSwtNDcuOTEzMjcgLTE3LjE5NDk0LC00OS40OTU5NyAtMy4zNjkwMiwtMS4wOTUwMyAtMy44ODY3NCwwLjEwNjk5IC0xLjk4ODU4LDQuNjE2MzUgMTIuMzE1MTYsMjkuMjU3NzEgMTIuOTk5NjMsNDMuOTQ2NjIgMi4yNDAyMiw0OC4wNzU0MSAtNy4zOTE1MSwyLjgzNjQyIC0xNS4yMzIzOSwtNy43OTA3NSAtMjEuMzk5MDIsLTI5LjAwMzI2IC00Ljc3NTEyLC0xNi40MjU4NyAtOS43Njg2MSwtMjMuODI4MzcgLTEzLjUzMzg3LC0yMC4wNjMxMSAtMC45MDE1NywwLjkwMTYgMC42Nzg0OCw2LjEyMTE3IDMuNTExMjQsMTEuNTk5MTMgMi44MzI3Myw1LjQ3NzkgNi43MTcyMSwyMS45NzQ1NSA4LjYzMjE3LDM2LjY1OTIgMS45MTQ5NywxNC42ODQ2MiA1LjYxMzg1LDMwLjA2MDczIDguMjE5NzMsMzQuMTY5MTIgNi43NzE5OCwxMC42NzY2MSAxNy41NTEyOCw4LjEwMzYgMjQuNTIzODIsLTUuODUzODQgNi44OTM3MywtMTMuNzk5NzUgNy42NzI4NCwtNC42MDc4MSAwLjk2OTMsMTEuNDM2MDIgLTYuOTYwNzQsMTYuNjU5MzcgLTI3LjYzNDQyLDIxLjY1NDgxIC01MS41ODQxOCwxMi40NjQ0MiAtMy44MzMzLC0xLjQ3MDk2IC01LjEzMDM5LDAuMDUxNSAtNS4xMzAzOSw2LjAyMDk3IDAsNC4zOTQzMSAtMi45MzYxOCwxMS43MjI0NSAtNi41MjQ4OCwxNi4yODQ3IGwgLTYuNTI0ODgsOC4yOTUwNiA4Ljk0ODgxLDEuNTExMjMgYyAxNS40NDk0NSwyLjYwOTA5IDM2LjYzMzI4LC0wLjc3NjQyIDQ5LjI1ODYsLTcuODcyMjUgeiBtIC0zMjAuMzY2NSwtMjcuNTM3MzMgYyA0Ni40NTk2NSwtMTMuMzU0NSA1NC43NjE4OCwtMjguOTMwOTMgMzkuMzI4ODUsLTczLjc4NzgyIC0zLjU4MTg1LC0xMC40MTA3OSAtNi41MTI0MywtMjEuNjA5NzEgLTYuNTEyNDMsLTI0Ljg4NjU0IDAsLTExLjE1NzEyIC01LjYxMTUyLC02LjAwMTYxIC05LjgxNzEzLDkuMDE5NDMgLTUuNTYyMDMsMTkuODY1NjEgLTIyLjI5MTE1LDM2Ljc1MDUzIC0zNi4zNDUxNiwzNi42ODM2NCAtMTIuMjA1NDcsLTAuMDU4MiAtMTYuMTgyNTEsLTIuMjgwMDggLTIxLjIyMzc4LC0xMS44NTc2OCAtOS4wNDc0OCwtMTcuMTg4ODIgMC44MTQ2OSwtNDMuNTY3OTcgMjUuOTY5NTQsLTY5LjQ2MjcyIDE4LjQyNDMxLC0xOC45NjYzMDQgMjguNDg4OTMsLTIwLjY4Mzk2NSAyOC40ODg5MywtNC44NjIwNSAwLDI0LjY3MzIgLTE3LjAxMTM0LDYwLjk5NDcgLTI1Ljk3MzA5LDU1LjQ1NjA0IC00LjM4MjA1LC0yLjcwODI2IC0zLjY3MTM4LC0xNC42Njc1MiAxLjQxNzIyLC0yMy44NTAwOSA0LjMyNzM1LC03LjgwODgyIDMuNDQ4MTQsLTE5LjcwNzcxIC0xLjQ1NjIsLTE5LjcwNzcxIC01LjY4Njg5LDAgLTE2Ljk0NTQ3LDIwLjcxMTk2IC0xOC40MzMxOCwzMy45MTA3NCAtMS4zMTUxNSwxMS42NjgyNiAtMC40OTI4NiwxNC41MDU0NSA1LjA2NjUyLDE3LjQ4MDcyIDE5LjQ4MjQ0LDEwLjQyNjcgNDUuMDA1MzEsLTIxLjM5NTQ1IDQ2LjI5MDgzLC01Ny43MTU4NCAwLjY3NTA0LC0xOS4wNzMxODEgLTMuMDE2NzYsLTI0LjQ0MTEwNSAtMTQuNzc5MDYsLTIxLjQ4ODk1MSAtMTcuMTE4NzksNC4yOTY1NDMgLTYzLjIzNDgzLDYzLjc4NjY0MSAtNjMuMjM0ODMsODEuNTczNDYxIDAsMTMuOTEyOCA2Ljk4NzM3LDIzLjY5NzI4IDE5LjI4ODI3LDI3LjAwOTYgMjAuOTE0MTksNS42MzE2MiA0MS4xMzUzOSwtNC4zNzM4OSA1NS40NjMzLC0yNy40NDMzOCBsIDYuMDIxNzUsLTkuNjk1NzEgMC4wMTMyLDEzLjE3MjIzIGMgMC4wMTYyLDE5LjA3MzggLTEyLjQyNjE5LDI5LjEyNzQgLTUxLjY5ODE3LDQxLjc2NzkzIC05Ljc3NjQ5LDMuMTQ2OCAtMTguMTgzMzIsNi4wNTQ0MSAtMTguNjgxOCw2LjQ2MTM3IC0xLjgyMDU2LDEuNDg2MzIgMTYuNjg3MzksMjcuNDc1NzEgMTkuNTY2NDQsMjcuNDc1NzEgMS42MzI2MiwwIDExLjE5MTE1LC0yLjM2MzU5IDIxLjI0MTIzLC01LjI1MjM4IHogTSA0NzYuNDExLDIxNy45NjMwMSBjIDQuNjYzNDcsLTUuMTUzMSA1LjQ4NTUxLC0xMC43NTEwMyA0LjQ4NTc5LC0zMC41NDgyMyAtMS4wODczOSwtMjEuNTMzMzEgLTIuMjc3NDYsLTI1LjMzODUxIC0xMC42NjE0MywtMzQuMDg5NDkgLTE1LjE0ODgyLC0xNS44MTE5NCAtMzMuODYxMjMsLTExLjc3ODI4IC0yMi45MDgxOSw0LjkzODE0IDUuODIyNTYsOC44ODYzNyAxMi45MjU0LDcuMzY4NjQgMTAuNDE2NDEsLTIuMjI1ODEgLTEuOTk4NjQsLTcuNjQyNzYgMS43Mjk5OCwtNy44NDM1OCA4LjIyODM5LC0wLjQ0MzIyIDEyLjE5MzAxLDEzLjg4NTM3IDkuMTE1MzQsMzMuMTI2OTggLTUuMjk4NiwzMy4xMjY5OCAtOS44NjcxNiwwIC0xMi45NDE5NSwtNC4yMzE3NiAtMTkuMzczNTMsLTI2LjY2MzE4IC0yLjkzMDU5LC0xMC4yMjA4NyAtNi40OTk2NCwtMTguNTgzNDMgLTcuOTMxMjcsLTE4LjU4MzQzIC00Ljc2ODk5LDAgLTYuODkyODcsNC4yMDg3OCAtMy45MjcyMSw3Ljc4MjQgMS42MTA4OCwxLjk0MTEgNi4wNzIxOCwxNS44OTEyNyA5LjkxNDA0LDMxLjAwMDQxIDkuNjY5MDMsMzguMDI1OTYgMjMuMTc2NjYsNTEuMDQxNDUgMzcuMDU1NiwzNS43MDU0MyB6IG0gLTE4My43NzEyNSwwLjYwMzk1IGMgMS45ODk3OCwtMS4zMzUgMi44OTk3NSwtNy42NDg5MyAyLjA3ODY1LC0xNC40MjMgLTEuMzI0NDksLTEwLjkyNzAyIC0yLjA2NjYyLC0xMS43MjQxIC03Ljk3MjcsLTguNTYzMjcgLTguNDg3MzMsNC41NDIyNyAtMTcuNjA4MzksLTQuMDYzNTEgLTIwLjcwMjIyLC0xOS41MzI2IC0yLjM0NzA3LC0xMS43MzUzOCAtMy4wNjUyNiwtMTEuNTA0ODkgMTQuMDI1NzYsLTQuNTAxNDkgMi4xNDI4OCwwLjg3ODA4IDcuNTk2NzEsLTIuMTA0MDIgMTIuMTE5NjMsLTYuNjI2OTQgOC4yNzQwOCwtOC4yNzQwOCAxMC45OTgwMiwtMTguMjEyOTkgNC45OTE1NiwtMTguMjEyOTkgLTEuNzc3NTQsMCAtMy4yMzE5LDEuNDU0MzYgLTMuMjMxOSwzLjIzMTkgMCw0LjY0OTIzIC04Ljg0MjMxLDMuOTg5ODIgLTEwLjgzNDY1LC0wLjgwNzk3IC0xLjE2MjI0LC0yLjc5ODc5IC0zLjYzODA3LC0xLjgwNTkxIC04LjA1OTE1LDMuMjMxOSAtMy41MDk4NSwzLjk5OTQ4IC03Ljc5NjczLDcuMjcxNzggLTkuNTI2NDEsNy4yNzE3OCAtMS43Mjk2OSwwIC00LjA2NTYsLTMuMjcyMyAtNS4xOTA4OCwtNy4yNzE3OCAtMS45NzE5NSwtNy4wMDg1NiAtMi4yMTM2NiwtNy4wNTI3NyAtNi42NzczNywtMS4yMjE2OSAtMy45MTA2LDUuMTA4NTQgLTMuOTQ1NTcsNi43MzU4MyAtMC4yMjQ2MSwxMC40NTY2MSAzLjk0MDYyLDMuOTQwNjQgMTEuNDI2MTUsMzAuODcxMDIgMTEuNDI2MTUsNDEuMTA3NDQgMCwxMi43Mjg2NyAxNy41MjkzMywyMi43MzgzMiAyNy43NzgzLDE1Ljg2MjEgeiBtIDU4Ljk0MzA5LC0xNi44NzUzMSBjIDEyLjE0NTY3LC0xMi4xNDU2NyAxNS43NDQ1MiwtMzAuMzUxNDMgOS4xMjk0MywtNDYuMTgzNTcgLTUuMTcwMTYsLTEyLjM3Mzk3IC0xNC4xNDQ2NiwtMTcuMDA1MTYgLTI2Ljc5ODc4LC0xMy44MjkxOCAtOS40MDI2MywyLjM1OTkxIC0yMy43MjMxMSwyOS43NzY1OSAtMjMuNzczODcsNDUuNTE1MzYgLTAuMDc5MiwyNC41MjkwMiAyMy4yNTA1MywzMi42OTAwNSA0MS40NDMyMiwxNC40OTczOSB6IG0gLTIyLjA4MzQxLC0xOS40MzQwNyBjIC0zLjU1NTEsLTMuNTU1MSAtNi40MTc1NSwtMTAuNDYzMjggLTYuMzYxMDIsLTE1LjM1MTUzIDAuMDkzNCwtOC4wNzk2NSAwLjQ5MzE1LC04LjM3MzUgNC4zOTYxOSwtMy4yMzE5IDQuODI0NjQsNi4zNTU2OSAxMy4zOTc5Nyw3LjQ1NjY2IDE2LjY4MjQxLDIuMTQyMzIgMS4xOTQzMiwtMS45MzI0MSAwLjU1Mjk1LC01LjEzMjAyIC0xLjQyNTIsLTcuMTEwMTcgLTUuMDgxMzIsLTUuMDgxMzIgLTQuNDY1NjEsLTExLjk5OTYzIDEuMDY3OTIsLTExLjk5OTYzIDYuMTUxMzcsMCAxNC43MjY3OSwxMi41MTQ3NyAxNC43MjY3OSwyMS40OTE5MSAwLDYuNjA2NzQgLTEzLjQ0NDQsMjAuNTIyOCAtMTkuODI3MjQsMjAuNTIyOCAtMS41Mzc4NSwwIC01LjcwNDc2LC0yLjkwODcyIC05LjI1OTg1LC02LjQ2MzggeiBtIDg2LjM0ODk3LDE4LjU4MzQxIGMgMTMuNDEwNzQsLTE0LjYwMjYzIDEyLjEwMzc2LC0zNy4wOTggLTMuMDk4MjUsLTUzLjMyNjM0IC03Ljg1MDU3LC04LjM4MDYgLTI1LjI5Mjk4LC05LjgyNTUyIC0zMi40MzE4NSwtMi42ODY2NCAtNi41ODc2MSw2LjU4NzYxIC0xMy4xNjQ2NSwzMi40OTMwMyAtMTAuNzIxMjIsNDIuMjI4NDEgNS4yMTEyMiwyMC43NjMxOCAzMi40MDA0MSwyOC44NjY1MiA0Ni4yNTEzMiwxMy43ODQ1NyB6IG0gLTI3LjQ1NTY1LC0yMy42MTQ1MiBjIC01LjMwNjIzLC0zLjcxNjY0IC03LjEyOTQxLC04LjE0OTc0IC02Ljk3ODA2LC0xNi45Njc0NyAwLjE2OTM1LC05Ljg2MDMzIDAuNjg0MywtMTAuNzQ5ODEgMi45NjE0NSwtNS4xMTQxNSAzLjM0NTczLDguMjgwMzIgMTAuMzYyOTIsMTEuNDA3MzQgMTYuNTE4MTQsNy4zNjA5IDMuODE3NTMsLTIuNTA5NjMgMy42MzkyOSwtMy42OTU5NyAtMS4xMDEwNCwtNy4zMjkwNyAtNi4zMjE4OSwtNC44NDUyMyAtNy41NTUwOCwtMTEuNzAxOTEgLTIuMTA0NjUsLTExLjcwMTkxIDQuODczNjQsMCAyMi4zMDQwMiwxOS4wNjY2NiAyMi4zMDQwMiwyNC4zOTc3OCAwLDUuMjAzMTYgLTEyLjM3NzM5LDE0LjM4NTAzIC0xOS4zOTEzOSwxNC4zODUwMyAtMi43NjQwNSwwIC04LjI1NzksLTIuMjY0MDIgLTEyLjIwODQ3LC01LjAzMTExIHogbSAxODkuOTYyOTIsLTE0LjI4ODg3IDMzLjkzNDk1LC0xMi43MzY4MiAtMzYuMzU4ODgsLTAuMTMxMjUgYyAtMzIuNTM5MiwtMC4xMTczNiAtMzYuMzU0MjQsMC40NjMwNyAtMzYuMzE0NzUsNS41MjQ3NSAwLjA0MDEsNS4xMjc1NyAzLjMzMDczLDIwLjI4Mzk1IDQuMzcyNywyMC4xMzk2NyAwLjIzNzIyLC0wLjAzMjkgMTUuNzAxNzcsLTUuNzkxMjQgMzQuMzY1OTgsLTEyLjc5NjQ4IHogbSAtNDQzLjQ5MzQzLC0yLjI3OTMgMy40NjgyNSwtMTAuMjg3NjEgLTMwLjQ2Njg2LC0xLjAyNDA0IGMgLTE2Ljc1Njc0NCwtMC41NjMyMiAtMzAuNDYzNTg0LC0wLjEzMjEzIC0zMC40NTk1OCwwLjk1ODA0IDAuMDA1OCwxLjU5NTEzIDUyLjUwNjU3LDIyLjEwNzA3IDUzLjY2MTc0LDIwLjk2NTUyIDAuMTgwMzUsLTAuMTc4NCAxLjg4ODkyLC00Ljk1MzcyIDMuNzk2NDUsLTEwLjYxMTkxIHogbSAyMDguOTA5MiwtMzEuODg2OTUgYyA3LjE2NjY3LDEuMTQ2IDE1LjI0OTgxLDQuMDc5MjQgMTcuOTYyNTYsNi41MTgzNSA0LjIxMjc5LDMuNzg3ODMgNi4wNDUyOCwzLjUyOTY2IDEyLjU2MjA3LC0xLjc2OTg1IDQuMTk2NDMsLTMuNDEyNSA5LjY1MDI2LC02LjIwNDU3IDEyLjExOTYzLC02LjIwNDU3IDIuNDY5MzksMCA0LjQ4OTgyLC0wLjcxMzA4IDQuNDg5ODIsLTEuNTg0NjcgMCwtMy4wMDkxOCAtNDYuNTM5NTQsLTc5LjIxMjUyIC00OC4zMTQ0NywtNzkuMTA5NjEgLTIuMDg1LDAuMTIwODcyIC00OS43ODYwMyw4MC4wODc5OCAtNTEuMjU0NjQsODUuOTI0MzcgLTAuNjE2MzQsMi40NDk1MiAxLjMxODA0LDMuMzUzNzEgNS4wNzM2NCwyLjM3MTYgMy4zMzgzNiwtMC44NzMgNy45NTQxNiwwLjY4MzI2IDEwLjI1NzI3LDMuNDU4MzYgMy43MzU0LDQuNTAwODcgNS4yNjEwOCw0LjE0MjI5IDE0LjEzMDY4LC0zLjMyMDk3IDguNDI2NDcsLTcuMDkwNDEgMTEuOTMwOCwtOC4wNDg4IDIyLjk3MzQ0LC02LjI4MzAxIHoiDQogICAgICAgc3R5bGU9ImZpbGw6IzMzMzMzMztmaWxsLW9wYWNpdHk6MSIgLz4NCiAgICA8cGF0aA0KICAgICAgIHN0eWxlPSJmaWxsOiM2Mzk4YWE7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlOm5vbmUiDQogICAgICAgZD0ibSAzMDkuNTQ1NzksMTQwLjg3OTIyIGMgLTAuNTAwNzUsLTAuMjMzMTEgLTEuMTE4MDQsLTAuNzY3OTkgLTIuNTI3OCwtMi4xOTAzNSAtMS45MTE4OCwtMS45Mjg5NyAtMi42NzE4OCwtMi40OTAxMyAtNC4yNjEwOCwtMy4xNDYyOCAtMi4wODc5MSwtMC44NjIwNCAtNC4zNTQ5LC0xLjA5NDIzIC02LjQ4MjMxLC0wLjY2MzkxIC0xLjg5ODA4LDAuMzgzOTMgLTIuNDI0MzUsMC40MjUyNyAtMy4yODI0MiwwLjI1NzggLTEuNDMyMjQsLTAuMjc5NTMgLTEuOTQxNTcsLTEuMTQ5MjkgLTEuNTM1ODMsLTIuNjIyNzIgMC41MDU3MywtMS44MzY1NyA0LjMzNjkzLC04Ljk0MjU1IDEyLjAwODk5LC0yMi4yNzM4NyAxNS41ODM3LC0yNy4wNzg5ODggMzYuNTM2MjQsLTYxLjIyMDk2OCAzOC44NTA1NiwtNjMuMzA2NjYyIDAuMjU2MzEsLTAuMjMwOTk0IDAuMjY1LC0wLjIzMDk5NCAwLjUyMjQ4LDAgMS4zNzc2OCwxLjIzNTk3NiA5LjQ3NjIsMTMuNzI1ODg5IDIwLjU0MDM2LDMxLjY3ODI5OCAxNC45NjY5NiwyNC4yODUwMDQgMjcuNDExMDIsNDUuNjQzNzE0IDI3LjQxMTAyLDQ3LjA0NzcwNCAwLDAuODU3MjkgLTEuMzE2MDgsMS4zNzIxNSAtNC4wODU5MSwxLjU5ODQ1IC0zLjQ0MjI2LDAuMjgxMjQgLTcuNDI0NzgsMi4zMDE4OCAtMTIuODY4ODcsNi41MjkzNiAtMi41ODcxMiwyLjAwODk4IC0zLjY5MTI2LDIuNzU5MzMgLTQuOTUwNjIsMy4zNjQzOCAtMS4wNDkyOCwwLjUwNDExIC0xLjEzNjkyLDAuNTI0MzcgLTIuMjY4NTQsMC41MjQzNyAtMS4xMTM2OCwwIC0xLjIyNjYxLC0wLjAyNDkgLTIuMDk2MjMsLTAuNDYxMjggLTAuNTEyMTMsLTAuMjU3MDIgLTEuNTA0NjksLTAuOTQ5MyAtMi4yNDE1NSwtMS41NjM0MiAtMi4xNzg0OCwtMS44MTU2MSAtNC43OTkxOCwtMy4xMzYxNCAtOS4wNzE5NywtNC41NzEyNCAtNS40Mjk5NywtMS44MjM3NiAtMTEuMjQ0NTQsLTIuOTE4NCAtMTYuMTk1NTEsLTMuMDQ4OTYgLTMuOTA5MzQsLTAuMTAzMDggLTUuNzEyMDEsMC4yNDc5OCAtOC42NzYwMiwxLjY4OTYzIC0yLjQxOTg4LDEuMTc2OTggLTMuNTg2MjEsMi4wMTMxMSAtOS4xMjQ3NSw2LjU0MTQ1IC01LjYzMzc2LDQuNjA2MTcgLTcuNjM0NDIsNS41NjIwNSAtOS42NjQsNC42MTcyNSB6IiAvPg0KICAgIDxwYXRoDQogICAgICAgc3R5bGU9ImZpbGw6IzYzOThhYTtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZSINCiAgICAgICBkPSJtIDEyOC42Mzc4NiwxNzAuNzM5IGMgLTEwLjE1OSwtMi45NjA3IC00NS41MDMxNzEsLTE2LjkxOTYyIC01MC40NTA5MjQsLTE5LjkyNTIzIC0wLjY4MjkxNiwtMC40MTQ4NCAtMC43MzgwOTgsLTAuNDc3ODcgLTAuNTQzMjA3LC0wLjYyMDM4IDEuMTMxNTYzLC0wLjgyNzQxIDEyLjMzNzk4MywtMS4yMzkwMSAyNS4wMDQwMzEsLTAuOTE4MzYgNS4wNTEzMSwwLjEyNzg4IDM1LjUwMTMyLDEuMTMzMjMgMzUuNTUwOSwxLjE3Mzc3IDAuMDk5NywwLjA4MTUgLTYuNTIxNjQsMTkuMjg4OCAtNy4wMzA1MSwyMC4zOTQzMyAtMC4yMTI1MSwwLjQ2MTcgLTAuNjUwNjMsMC40NDM2NyAtMi41MzAyOSwtMC4xMDQxMyB6IiAvPg0KICAgIDxwYXRoDQogICAgICAgc3R5bGU9ImZpbGw6IzYzOThhYTtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZSINCiAgICAgICBkPSJtIDU0My42OTQxMywxNzUuMzEwNTUgYyAtMS4zODYyLC0yLjcxMjg3IC0zLjg4NzY5LC0xNC45NzA2NyAtMy45NjA3OCwtMTkuNDA4NTggLTAuMDI4NCwtMS43MjQyNCAwLjE4NjY3LC0yLjQyNzQxIDAuOTYwNiwtMy4xNDA4IDEuNzczNzgsLTEuNjM1MDEgNS4zNzkzOCwtMi4yMjMyIDE1LjI5MDE3LC0yLjQ5NDM0IDUuMDAzNDcsLTAuMTM2ODkgMjguMTAxOSwtMC4xNTc5NiA0NC40MTEyNywtMC4wNDA1IGwgMTEuNDI4NTksMC4wODIzIC0yNy41MTc3LDEwLjMxNDI3IGMgLTI1LjA5MjkyLDkuNDA1NCAtMzkuNjg0NzMsMTQuODQxMjYgLTQwLjIyNDkxLDE0Ljk4NDkgLTAuMTM1MTcsMC4wMzYgLTAuMjY5ODEsLTAuMDY3NCAtMC4zODcyNCwtMC4yOTcyMyBsIDAsMCB6IiAvPg0KICAgIDxwYXRoDQogICAgICAgc3R5bGU9ImZpbGw6IzYzOThhYTtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZSINCiAgICAgICBkPSJtIDE3OC4wODgzNSwzMTUuNTE0MzMgYyAwLC0wLjc3MDc4IDMuMjY4OSwtNi41MzMxIDExLjU1Mzk1LC0yMC4zNjY5OCAxOS44NTExOCwtMzMuMTQ2MzEgMjguOTI3MTUsLTQ1LjE2MDEyIDQwLjA3MjkyLC01My4wNDQyOSA5Ljk3MTI3LC03LjA1MzM3IDE1LjMwMjc5LC0xMS45Mjk0IDIxLjI0NTM5LC0xOS40MzAzMyBsIDMuNjY0MDksLTQuNjI0OTIgNC45Mzk5LDQuODU2NTIgYyA4LjY0Nzg0LDguNTAxODkgMTMuODYxMywxMC45NjY2OCAyMy4yOTcxNywxMS4wMTQzMiAxMS41NDA1OCwwLjA1ODMgMjQuMTc4NDksLTYuMzg4MSAyNC4xNzg0OSwtMTIuMzMyOTkgMCwtMS4zMzk4IDAuOTU0MDQsLTIuNzIyMzYgMS44Nzg1NywtMi43MjIzNiAwLjM5MTMyLDAgMi42MTY4NiwwLjY4MzY1IDQuOTQ1NjUsMS41MTkyMyA2LjA2OTkyLDIuMTc3OSA5LjYzMDI4LDIuOTY1NDggMTQuNjA5MTIsMy4yMzE2NSA0LjkzOTk4LDAuMjY0MDkgOC41NDg0OCwtMC4xNzA0IDEzLjM1ODE3LC0xLjYwODQxIDQuNzI1NjEsLTEuNDEyODggNy40NDcwOSwtMi44NTkwNSAxNS41OTgzMywtOC4yODg4MiA0LjEwNzYsLTIuNzM2MTggNy41OTk1NCwtNC45NzQ4NyA3Ljc1OTg4LC00Ljk3NDg3IDAuMTYwMzMsMCAzLjEyNTM0LDEuNzE4OTYgNi41ODg5LDMuODE5OTEgMy40NjM1NiwyLjEwMDk1IDcuNjI1NDIsNC4zODEzMyA5LjI0ODU5LDUuMDY3NTEgMTEuMDY4NjIsNC42NzkxOCAyMy4wMjQ0NSw0LjM3MzkgMzMuOTcxMjYsLTAuODY3NDEgMS45NTc5NSwtMC45Mzc0NyA2LjU2NzkzLC0zLjczMDc0IDEwLjI0NDQsLTYuMjA3MjcgMy42NzY0OCwtMi40NzY1MyA2LjczNjEzLC00LjQ0NTc2IDYuNzk5MjMsLTQuMzc2MDYgMC4wNjMxLDAuMDY5NyAxLjQ1NjA1LDIuOTIwOCAzLjA5NTQ0LDYuMzM1NzggMS42Mzk0LDMuNDE0OTggMy42OTg5NSw3LjI2NjcgNC41NzY3OSw4LjU1OTM3IDMuODAwMDEsNS41OTU3OCA4LjE3NTg4LDkuNzUxNDEgMTQuMDgzNDMsMTMuMzc0NjQgNi4wODEyMiwzLjcyOTc1IDkuODMyMDYsOC42ODY4IDEwLjIxODgyLDEzLjUwNTA3IDAuMzgzNjcsNC43Nzk2OCAtMS43MDMyOSw5LjAxOTM5IC03LjcyMTg5LDE1LjY4NzIxIC00LjY5NzQ3LDUuMjA0MTkgLTUuODczMyw3LjIzNTQgLTUuODYxMTMsMTAuMTI0OTEgMC4wMTIyLDIuODkyNjIgMS43MDEwMyw2LjIyODU0IDQuNjY5NjQsOS4yMjM3OSA0LjgwNTMzLDQuODQ4NDQgMTIuMzQ2MDUsNi4yODc3NyAyMy40MzUzNCw0LjQ3MzE5IDIuNDc0MDgsLTAuNDA0ODQgNS41OTQ3OSwtMC43Mzc1NyA2LjkzNDkxLC0wLjczOTM4IDQuMjg1NTEsLTAuMDA2IDYuOTAzMTksMi4wOTU5NSAxMS44OTI1MSw5LjU0ODU5IDMuNDQzNTEsNS4xNDM2NSAxMC45NzM5NiwxNy43NTUwOCAxMC45NzM5NiwxOC4zNzgzNiAwLDAuMzI0MDcgLTAuMzUxNDUsMC41NTIwOCAtMC44NTA5NywwLjU1MjA4IC0xLjA1MTA5LDAgLTUuNjIzMTQsLTEuMjQzOCAtOC45MzIxNCwtMi40Mjk5NCAtNC4zNDg1LC0xLjU1ODc1IC01Ny4yNzIzOCwtMjIuMDA1MjYgLTc0Ljc0Nzg2LC0yOC44Nzc5NSAtNDYuNjYzNSwtMTguMzUxNjIgLTYyLjAyODA1LC0yNC4yMTI0NiAtNjkuNTM2NTcsLTI2LjUyNDg5IC04LjExNDE3LC0yLjQ5ODk1IC0xMy42NDAyOSwtMy4wODUyMiAtMTguMTI2NjEsLTEuOTIzMDYgLTUuNTc5OTYsMS40NDU0NiAtODEuNzIwNjcsMzAuODY4ODggLTEyNi4xMzI0NSw0OC43NDE5NSAtMjEuOTMxMTksOC44MjYgLTI0LjY3NzQ5LDkuODc1NzcgLTI4Ljc4MTE2LDExLjAwMTU5IC0zLjI2MzAzLDAuODk1MjEgLTMuMTQ0MDcsMC44ODI5NCAtMy4xNDQwNywwLjMyNDI2IHoiIC8+DQogIDwvZz4NCjwvc3ZnPg==');
    background-position: 16px 80%;
    background-repeat: no-repeat;
    background-size: 20px 12px;
    padding-left: 2.5em;
}

.multi-language-selector .language-option[data-lang='kotlin'],
.exampleblock[data-lang=kotlin] > .content .title {
    background-image: url('data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeD0iMHB4IiB5PSIwcHgiDQoJIHZpZXdCb3g9IjAgMCA2MCA2MCIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgNjAgNjA7Ij4NCjxnPg0KICAgIDxsaW5lYXJHcmFkaWVudCBpZD0iWE1MSURfM18iIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIiB4MT0iMTUuOTU5NCIgeTE9Ii0xMy4wMTQzIiB4Mj0iNDQuMzA2OCIgeTI9IjE1LjMzMzIiIGdyYWRpZW50VHJhbnNmb3JtPSJtYXRyaXgoMSAwIDAgLTEgMCA2MSkiPg0KCQk8c3RvcCAgb2Zmc2V0PSI5LjY3NzAwMGUtMDIiIHN0eWxlPSJzdG9wLWNvbG9yOiMwMDk1RDUiLz4NCgkJPHN0b3AgIG9mZnNldD0iMC4zMDA3IiBzdHlsZT0ic3RvcC1jb2xvcjojMjM4QUQ5Ii8+DQoJCTxzdG9wICBvZmZzZXQ9IjAuNjIxMSIgc3R5bGU9InN0b3AtY29sb3I6IzU1N0JERSIvPg0KCQk8c3RvcCAgb2Zmc2V0PSIwLjg2NDMiIHN0eWxlPSJzdG9wLWNvbG9yOiM3NDcyRTIiLz4NCgkJPHN0b3AgIG9mZnNldD0iMSIgc3R5bGU9InN0b3AtY29sb3I6IzgwNkVFMyIvPg0KCTwvbGluZWFyR3JhZGllbnQ+DQoJPHBvbHlnb24gaWQ9IlhNTElEXzJfIiBzdHlsZT0iZmlsbDp1cmwoI1hNTElEXzNfKTsiIHBvaW50cz0iMCw2MCAzMC4xLDI5LjkgNjAsNjAgCSIvPg0KICAgIDxsaW5lYXJHcmFkaWVudCBpZD0iU1ZHSURfMV8iIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIiB4MT0iNC4yMDkyIiB5MT0iNDguOTQwOSIgeDI9IjIwLjY3MzQiIHkyPSI2NS40MDUiIGdyYWRpZW50VHJhbnNmb3JtPSJtYXRyaXgoMSAwIDAgLTEgMCA2MSkiPg0KCQk8c3RvcCAgb2Zmc2V0PSIwLjExODMiIHN0eWxlPSJzdG9wLWNvbG9yOiMwMDk1RDUiLz4NCgkJPHN0b3AgIG9mZnNldD0iMC40MTc4IiBzdHlsZT0ic3RvcC1jb2xvcjojM0M4M0RDIi8+DQoJCTxzdG9wICBvZmZzZXQ9IjAuNjk2MiIgc3R5bGU9InN0b3AtY29sb3I6IzZENzRFMSIvPg0KCQk8c3RvcCAgb2Zmc2V0PSIwLjgzMzMiIHN0eWxlPSJzdG9wLWNvbG9yOiM4MDZFRTMiLz4NCgk8L2xpbmVhckdyYWRpZW50Pg0KCTxwb2x5Z29uIHN0eWxlPSJmaWxsOnVybCgjU1ZHSURfMV8pOyIgcG9pbnRzPSIwLDAgMzAuMSwwIDAsMzIuNSAJIi8+DQogICAgPGxpbmVhckdyYWRpZW50IGlkPSJTVkdJRF8yXyIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiIHgxPSItMTAuMTAxNyIgeTE9IjUuODM2MiIgeDI9IjQ1LjczMTUiIHkyPSI2MS42Njk0IiBncmFkaWVudFRyYW5zZm9ybT0ibWF0cml4KDEgMCAwIC0xIDAgNjEpIj4NCgkJPHN0b3AgIG9mZnNldD0iMC4xMDc1IiBzdHlsZT0ic3RvcC1jb2xvcjojQzc1N0JDIi8+DQoJCTxzdG9wICBvZmZzZXQ9IjAuMjEzOCIgc3R5bGU9InN0b3AtY29sb3I6I0QwNjA5QSIvPg0KCQk8c3RvcCAgb2Zmc2V0PSIwLjQyNTQiIHN0eWxlPSJzdG9wLWNvbG9yOiNFMTcyNUMiLz4NCgkJPHN0b3AgIG9mZnNldD0iMC42MDQ4IiBzdHlsZT0ic3RvcC1jb2xvcjojRUU3RTJGIi8+DQoJCTxzdG9wICBvZmZzZXQ9IjAuNzQzIiBzdHlsZT0ic3RvcC1jb2xvcjojRjU4NjEzIi8+DQoJCTxzdG9wICBvZmZzZXQ9IjAuODIzMiIgc3R5bGU9InN0b3AtY29sb3I6I0Y4ODkwOSIvPg0KCTwvbGluZWFyR3JhZGllbnQ+DQoJPHBvbHlnb24gc3R5bGU9ImZpbGw6dXJsKCNTVkdJRF8yXyk7IiBwb2ludHM9IjMwLjEsMCAwLDMxLjcgMCw2MCAzMC4xLDI5LjkgNjAsMCAJIi8+DQo8L2c+DQo8L3N2Zz4=');
    background-position: 17px 80%;
    background-repeat: no-repeat;
    background-size: 11px 11px;
    padding-left: 2.3em;
}

.multi-language-selector {
    display: block;
}

.multi-language-selector .language-option[data-lang='groovy'] {
    background-position: 20px center;
    padding-left: 32px;
}

.multi-language-selector .language-option[data-lang='kotlin'] {
    background-position: 30px center;
    padding-left: 27px;
}

.multi-language-selector .language-option {
    background-color: white;
    border: 1px solid #f7f7f8;
    border-radius: 4px 4px 0 0;
    cursor: pointer;
    display: inline-block;
    font-weight: normal;
    font-family: 'Lato', Arial, sans-serif;
    margin: 0;
    padding: 4px 20px;
    min-width: 130px;
    max-width: 320px;
    text-align: center;
    filter: grayscale(1);
    -webkit-filter: grayscale(1);
    opacity: 0.7;
}

.multi-language-selector .language-option.selected {
    background-color: #f7f7f8;
    color: #02303a;
    filter: none;
    -webkit-filter: none;
    opacity: 1;
}

.multi-language-text.hidden,
.multi-language-selector ~ .multi-language-sample.hidden {
    display: none;
}

.multi-language-sample {
    border-radius: 0 0 4px 4px;
}

/*
 * Ensure that blocks of code do not wrap by applying the behavior of `[listing%nowrap]` by default.
 *
 * These styles are copied from a CSS ruleset in asciidoctor.css that has the same group of
 * selectors except that they end with `.nowrap`.
 */
.literalblock pre,
.literalblock pre[class],
.listingblock pre,
.listingblock pre[class] {
    overflow-x: auto;
    white-space: pre;
    word-wrap: normal;
}

/*
 * This CSS ruleset solves: https://github.com/gradle/guides/issues/113#issuecomment-314826749.
 */
.literalblock pre::after,
.literalblock pre[class]::after,
.listingblock pre::after,
.listingblock pre[class]::after {
    content: "";
}

.quoteblock blockquote,
.quoteblock blockquote p {
    text-align: left;
    text-align: start;
}

div.screenshot {
    box-shadow: 0 0 20px 1px rgba(0, 0, 0, 0.2);
    margin-left: auto;
    margin-right: auto;
    width: 90%;
}

.inset {
    box-shadow: 0 0 1px 1px rgba(0, 0, 0, 0.1);
    padding: 1em;
}

.image.inline-icon img {
    vertical-align: sub;
}

/* TOC */
#header > h1:first-child + #toc {
    background: none;
    border: 0 none;
    margin-top: 0;
}

#header #toctitle {
    margin-bottom: 0.425rem;
}

#toc,
#content #toc {
    border: 0 none;
}

#toc > ul {
    margin-left: 0;
    font-family: inherit;
}

#toc > ul > li {
    line-height: 1.25;
    margin-top: 0;
    padding-bottom: 0.5rem;
}

#toc > ul > li:last-of-type {
    padding-bottom: 0;
}

#toc a {
    font-style: normal;
}

#toc a:hover,
#toc a:focus,
#toc a:hover code,
#toc a:focus code {
    color: #1DA2BD;
}

#toc a:active {
    text-decoration: none;
}

@media screen and (min-width: 75rem) and (min-height: 48rem) {
    #header #toc {
        font-size: 1rem;
        background: #f7f7f8;
        border-radius: 0;
        margin-bottom: 0;
        padding: 15px 0 0;
    }

    #header #toctitle {
        font-size: 1rem;
        font-weight: 700;
        margin: 0.4rem 0 0.5rem 0;
    }

    #toc a {
        color: #02303A;
    }

    #toc a.active {
        color: #1BA8C4;
    }
}

/* Site header specific styles */
.hamburger {
    background-color: transparent;
    background-image: none;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    margin-left: auto;
    padding: 11px 10px;
}

.hamburger:focus {
    outline: 0;
}

.hamburger__bar {
    display: block;
    width: 22px;
    height: 2px;
    background-color: black;
    border-radius: 1px;
}

.hamburger__bar + .hamburger__bar {
    margin-top: 4px;
}

.site-header {
    background-color: white;
}

/* Override javadoc styles */
.site-header div {
    font-family: 'Lato', Arial, sans-serif;
}

.site-header__navigation-header a {
    align-self: center;
    border-bottom: 0 none;
    height: 36px;
}

.site-header .site-header-version {
    align-self: flex-end;
    color: #1da2bd;
    font-size: 20px;
    padding-left: 1px;
}

.site-header__navigation {
    display: flex;
    flex-direction: column;
}

.site-header__navigation-header {
    display: flex;
    flex: 0 0 auto;
    margin-left: 12px;
}

.site-header__navigation-collapsible {
    flex: 1 1 auto;
    height: 210px;
    overflow: visible;
    transition: height 0.3s ease;
}

.site-header__navigation-items {
    display: flex;
    flex-direction: column;
    flex-wrap: wrap;
    align-items: flex-start;
    max-height: 210px; /* This matches the collapsible height above */
    margin: 0 20px;
    padding-top: 12px;
    padding-left: 0;
    list-style-type: none;
}

.site-header__navigation-item {
    flex: 0 1 auto;
    font-size: 16px;
    width: 250px;
}

.site-header__navigation-item .site-header__navigation-link {
    position: relative;
    display: inline-block;
    cursor: pointer;
    width: 100%;
    padding: 5px;
    line-height: 20px;
    border: 0 none;
    color: #02303A;
    text-decoration: none;
    transition: none;
    -o-transition: none;
    -moz-transition: none;
    -webkit-transition: none;
}

.site-header__navigation-item .site-header__navigation-link:hover {
    color: #1DA2BD;
}

.site-header__navigation-item .site-header__navigation-link.active {
    font-weight: 500;
}

/* Navigation submenu styles */
.site-header__navigation-submenu-section {
    position: relative;
}

.site-header__navigation-submenu-section .site-header__down-arrow {
    width: 8px;
    height: 8px;
    margin-left: 2px;
    margin-top: 0;
}

.site-header__navigation-submenu-section .site-header__navigation-link:hover {
    color: #02303A;
}

.site-header__navigation-submenu-section .site-header__navigation-link:hover path {
    fill: none;
}

.site-header__navigation-submenu-section .site-header__navigation-submenu .site-header__navigation-submenu-item-link:hover {
    color: #1DA2BD;
}

.site-header__navigation-submenu-section .site-header__navigation-submenu {
    display: none;
    width: 170px;
    background-color: white;
    top: 40px;
    left: 21px; /* NOTE: This must match the padding of .site-header__navigation-link */
    padding: 3px 10px 6px 10px;
    z-index: 100;
}

.site-header__navigation-submenu-section .site-header__navigation-submenu .site-header__navigation-submenu-item-link {
    width: 100%;
    color: #02303A;
    white-space: nowrap;
    display: inline-block;
    padding-top: 3px;
    border: 0 none;
    transition: none;
    -o-transition: none;
    -moz-transition: none;
    -webkit-transition: none;
}

.site-header__navigation-submenu-section .site-header__navigation-submenu .site-header__navigation-submenu-item-link .site-header__navigation-submenu-item-link-text {
    display: inline-block;
    font-size: 16px;
}

.site-header__navigation-submenu-section.open .site-header__navigation-submenu {
    display: block;
}

/* Top navigation mobile styles */
@media (max-width: 1023px) {
    .site-header__navigation-collapsible--collapse {
        height: 0;
        overflow-y: hidden;
    }

    .site-header__navigation-submenu-section .site-header__navigation-submenu {
        padding: 0 1rem 0.5rem 1.5rem;
        display: block;
        top: 30px !important;
        left: 0 !important;
    }

    .site-header__navigation-item,
    .site-header__navigation-submenu-section .site-header__navigation-submenu .site-header__navigation-submenu-item-link .site-header__navigation-submenu-item-link-text {
        font-size: 18px;
    }

    .site-header {
        padding: 5px 12px;
    }

    .site-header-version {
        display: none;
    }

    .site-footer__navigation {
        flex-direction: column;
    }

    .site-footer__links {
        flex-wrap: wrap;
    }

    .site-footer__link-group {
        margin-bottom: 1rem;
    }
}

/* Top navigation desktop styles */
@media (min-width: 1024px) {
    .site-header {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        -webkit-box-shadow: 0 2px 4px 0 rgba(0, 0, 0, .15);
        -moz-box-shadow: 0 2px 4px 0 rgba(0, 0, 0, .15);
        box-shadow: 0 2px 4px 0 rgba(0, 0, 0, .15);
        z-index: 1;
    }

    /*
      Pushes the section headings to just below the top nav bar when a user
      navigates directly to section anchors.
     */
    #content h2[id], #content h3[id], #content h4[id], #content h5[id] {
        padding-top: 60px;
    }

    #content h2[id] {
        /* Little extra room above h2s */
        margin-top: -1em;
    }

    #content h3[id], #content h4[id], #content h5[id] {
        margin-top: -60px;
    }

    .site-header__navigation {
        flex-direction: row;
    }

    .site-header__navigation-button {
        display: none;
    }

    .site-header__navigation-items {
        flex-direction: row;
        align-items: center;
        float: right;
        width: auto;
        padding-top: 0;
    }

    .site-header__navigation-item {
        width: auto;
    }

    .site-header__navigation-item .site-header__navigation-link {
        padding: 15px 18px;
    }

    .site-header__navigation-item:last-of-type .site-header__navigation-link {
        padding-right: 0;
    }

    .site-header__navigation-link--button {
        padding: 6px 12px;
    }

    .site-header__navigation-collapsible {
        height: auto;
    }

    .site-header__navigation-submenu-section .site-header__navigation-submenu {
        position: absolute;
        border: 1px solid #9a9a9a;
        border-radius: 3px;
    }

    .site-header__navigation-submenu-section:hover .site-header__navigation-submenu {
        display: block;
    }

    /*
      Pushes the section headings to just below the top nav bar when a user
      navigates directly to section anchors. It doesn't work if you try
      to apply the padding and margin to the `h` elements directly.
     */
    .chapter a[name],
    .chapter .anchor {
        padding-top: 60px;
        margin-top: -60px;
        text-decoration: none;
        border: none;
        display: inline-block;
    }
}

/* Side Navigation styles */
/* Docs Navigation */
.docs-navigation {
    display: none;
    padding-left: 5px;
}

.docs-navigation .search-container {
    display: none;
    margin-bottom: 1rem;
}

.docs-navigation .search-input {
    height: 30px;
    line-height: 30px;
    box-sizing: border-box;
    padding: 0 20px 0 30px;
    border: 1px solid #e3e3e3;
    border-radius: 3px;
    color: #666;
    outline: none;
    margin-right: 10px;
    transition: border-color 0.2s ease;
    background: white url('data:image/svg+xml;utf8,<svg height="20px" version="1.1" viewBox="0 0 32 32" width="20px" xmlns="http://www.w3.org/2000/svg"><g fill="#cccccc" fill-rule="evenodd" stroke="none" stroke-width="1"><path d="M19.4271164,21.4271164 C18.0372495,22.4174803 16.3366522,23 14.5,23 C9.80557939,23 6,19.1944206 6,14.5 C6,9.80557939 9.80557939,6 14.5,6 C19.1944206,6 23,9.80557939 23,14.5 C23,16.3366522 22.4174803,18.0372495 21.4271164,19.4271164 L27.0119176,25.0119176 C27.5621186,25.5621186 27.5575313,26.4424687 27.0117185,26.9882815 L26.9882815,27.0117185 C26.4438648,27.5561352 25.5576204,27.5576204 25.0119176,27.0119176 L19.4271164,21.4271164 L19.4271164,21.4271164 Z M14.5,21 C18.0898511,21 21,18.0898511 21,14.5 C21,10.9101489 18.0898511,8 14.5,8 C10.9101489,8 8,10.9101489 8,14.5 C8,18.0898511 10.9101489,21 14.5,21 L14.5,21 Z"/></g></svg>') no-repeat 8px 5px;
    background-size: 20px;
    vertical-align: middle !important;
    max-width: 100%;
}

.docs-navigation .search-input:focus {
    border-color: #1BA8CB;
}

.docs-navigation .search-input::placeholder {
    color: #ccc;
}

/* Docsearch overrides */
.docs-navigation .algolia-autocomplete {
    display: block !important;
    flex: 1;
}

.docs-navigation .algolia-autocomplete .ds-dropdown-menu {
    width: 100%;
    min-width: 0 !important;
    max-width: none !important;
    padding: .75rem 0 !important;
    background-color: #fff !important;
    background-clip: padding-box;
    border: 1px solid #e3e3e3 !important;
    box-shadow: 0 .5rem 1rem rgba(0, 0, 0, .175) !important;
}

@media (min-width: 768px) {
    .docs-navigation .algolia-autocomplete .ds-dropdown-menu {
        width: 300%;
    }
}

.docs-navigation .algolia-autocomplete .ds-dropdown-menu [class^="ds-dataset-"] {
    padding: 0 !important;
    overflow: visible !important;
    background-color: transparent !important;
    border: 0 !important;
}

.docs-navigation .algolia-autocomplete .ds-dropdown-menu .ds-suggestions {
    margin-top: 0 !important;
}

.docs-navigation .algolia-autocomplete .algolia-docsearch-suggestion {
    padding: 0 15px !important;
}

.docs-navigation .algolia-autocomplete .algolia-docsearch-suggestion--category-header {
    font-weight: 800 !important;
    color: #1BA8CB !important;
}

.docs-navigation .algolia-autocomplete .algolia-docsearch-suggestion--wrapper {}

.docs-navigation .algolia-autocomplete .algolia-docsearch-suggestion--subcategory-column {}

.docs-navigation .algolia-autocomplete .algolia-docsearch-suggestion--content {
    padding: 0 !important;
}

.docs-navigation .algolia-autocomplete .algolia-docsearch-suggestion--title {
    display: block !important;
    color: #02303A;
    padding: .25rem 1rem !important;
    margin-bottom: 0 !important;
    font-weight: 500 !important;
}

.docs-navigation .algolia-autocomplete .algolia-docsearch-suggestion--text {
    padding: 0 1rem .5rem !important;
    margin-top: -.25rem !important;
    font-size: 0.9em !important;
    font-weight: 400 !important;
    line-height: 1.25 !important;
}

.docs-navigation .algolia-autocomplete .algolia-docsearch-footer {
    float: none !important;
    width: auto !important;
    height: auto !important;
    padding: .75rem 1rem 0;
    font-size: .875rem !important;
    line-height: 1 !important;
    color: #767676 !important;
    border-top: 1px solid #e3e3e3 !important;
    text-align: right;
}

.docs-navigation .algolia-autocomplete .algolia-docsearch-footer a {
    font-size: .875rem;
    text-decoration: underline;
}

.docs-navigation .algolia-autocomplete .algolia-docsearch-footer--logo {
    display: inline !important;
    overflow: visible !important;
    color: inherit !important;
    text-indent: 0 !important;
    background: none !important;
}

.docs-navigation .algolia-autocomplete .algolia-docsearch-suggestion--highlight {
    background-color: rgba(143, 187, 237, .1) !important;
}

.docs-navigation .algolia-autocomplete .ds-suggestion .ds-cursor .algolia-docsearch-suggestion--content {
    background-color: rgba(208, 189, 236, .15) !important;
}

.docs-navigation a {
    color: #02303A;
    display: block;
    font-size: 1rem;
    line-height: 1.25;
}

.docs-navigation a code {
    color: #02303A;
    overflow-wrap: break-word;
    padding: 0;
    word-break: break-all;
}

.docs-navigation a.active {
    color: #1BA8C4;
}

.docs-navigation ul {
    list-style-type: none;
    margin: 0.5em 0;
    padding: 0;
}

.docs-navigation ul:last-of-type {
    margin-bottom: 0;
}

.docs-navigation li:first-of-type {
    margin-top: 0;
}

.docs-navigation li {
    margin-bottom: 0.5em;
}

.docs-navigation li:last-of-type {
    margin-bottom: 0;
}

.docs-navigation .nav-dropdown {
    background: transparent url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAiIGhlaWdodD0iNiIgdmlld0JveD0iMCAwIDE5IDExIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIHRyYW5zZm9ybT0icm90YXRlKC0xODAgOS4zNzQgNS40OTQpIiBkPSJNMTcuOTk5MSAxMC40MjI4MjVMOS4zNzQxIDAuNTY1NTc1IDAuNzQ5MSAxMC40MjI4MjUiIHN0cm9rZT0iIzAyMzAzQSIgb3BhY2l0eT0iMC43IiBzdHJva2Utd2lkdGg9IjEuNSIgZmlsbD0ibm9uZSIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIi8+PC9zdmc+') no-repeat center right;
}

.docs-navigation > ul ul,
.docs-navigation > ul ul ul {
    display: none;
    height: 0;
    margin-left: 1rem;
}

.docs-navigation > ul ul:target,
.docs-navigation > ul ul:target ul,
.docs-navigation > ul .nav-dropdown.expanded ~ ul {
    display: block;
    height: auto;
}

.docs-navigation h3 {
    font-size: 1rem;
    font-weight: 700;
    line-height: 1.5;
    margin: 1.5em 0 0;
}

.docs-navigation .docs-home-link {
    position: relative;
}

.docs-navigation .pdf-link-container {
    display: inline-block;
    position: absolute;
    top: -1.25em;
    right: 0;
}

.docs-navigation .pdf-link-container a {
    color: #999;
    font-size: 12px;
}

.docs-navigation .pdf-link-container svg {
    fill: #999;
    height: 12px;
    vertical-align: bottom;
}

@media screen and (min-width: 45rem) {
    .main-content {
        display: flex;
        justify-content: center;
    }
}

/* User guide navigation appears for desktops */
@media screen and (min-width: 64rem) {
    .main-content {
        padding-top: 75px;
    }

    .docs-navigation {
        display: block;
        flex: 0 0 auto;
        width: 13.75rem;
    }

    .main-content > .appendix,
    .main-content > .book,
    .main-content > .chapter {
        flex: 0 0 45rem;
        margin: 0 20px;
    }
}

/* Fixed intra-chapter navigation for desktops */
@media screen and (min-width: 75rem) and (min-height: 48rem) {
    .appendix #header #toc,
    .book #header #toc,
    .chapter #header #toc {
        position: fixed;
        left: calc(50% + 380px);
        top: 50px;
        width: 13.75rem;
        padding-top: 15px;
        font-size: 1rem;
        background-color: #F7F7F8;
    }

    .appendix #toc a,
    .book #toc a,
    .chapter #toc a {
        color: #02303A;
        display: inline-block;
    }

    .appendix #toc a.active,
    .book #toc a.active,
    .chapter #toc a.active {
        color: #1BA8C4;
    }

    .docs-navigation {
        flex-basis: 13.75rem;
    }

    /* Sneaky way to make room for TOC */
    .secondary-navigation {
        flex: 0 0 13.75rem;
    }
}

@media screen and (min-width: 84.375rem) and (min-height: 48rem) {
    .appendix #header #toc,
    .book #header #toc,
    .chapter #header #toc {
        left: calc(50% + 26.25rem);
    }
}

@media screen and (min-width: 93.75rem) and (min-height: 48rem) {
    .appendix #header #toc,
    .book #header #toc,
    .chapter #header #toc {
        left: calc(50% + 31.25rem);
    }
}

/* Userguide Meta */
.chapter-meta {
    float: right;
    text-align: right;
}

.chapter-meta .edit-link {
    color: #999;
    font-size: 0.9em;
    padding-right: 3px;
}

.chapter-meta .edit-link svg {
    margin-right: 1px;
}

/* Clever use of RTL to fill in all stars to left of hover position */
.rating {
    direction: rtl;
}

.rating > .star {
    cursor: pointer;
    display: table-cell;
    padding: 3px;
}

.rating > .star:hover > svg > g,
.rating > .star:hover ~ .star > svg > g,
.rating > .star.selected > svg > g,
.rating > .star.selected ~ .star > svg > g {
    fill: #999;
}

/* Footer styles */
.site-footer {
}

.site-footer__navigation {
    display: flex;
    max-width: 75rem;
    margin: 3rem auto 0 auto;
    padding: 0.5rem 0.75rem;
}

.site-footer__links {
    display: flex;
    flex: 1 1 auto;
}

.site-footer__links .site-footer__links-list {
    list-style-type: none;
    margin: 0;
}

.site-footer__links .site-footer__links-list a {
    color: #666;
}

.site-footer__link-group {
    flex: 1 1 auto;
    flex-basis: 175px;
}

.site-footer__link-group header {
    color: #555;
}

.site-footer__subscribe-newsletter {
    flex: 0 0 350px;
}

.site-footer__subscribe-newsletter .newsletter-form__header h5 {
    color: #555;
    margin-top: 0;
}

.site-footer__subscribe-newsletter p {
    font-size: 0.875rem;
    margin: 2px 0 0 2px;
    opacity: 0.7;
}

.site-footer__subscribe-newsletter .disclaimer {
    font-size: 0.75rem;
    opacity: 0.55;
}

.site-footer__subscribe-newsletter .newsletter-form {
    padding-top: 6px;
    display: flex;
    justify-content: flex-start;
}

.site-footer__subscribe-newsletter .email,
.site-footer__subscribe-newsletter .submit {
    height: 40px;
}

.site-footer__subscribe-newsletter .email {
    line-height: 40px;
    width: 250px;
    color: #1DA2BD;
    font-size: 16px;
    padding-left: 20px;
    border-top-left-radius: 4px;
    border-bottom-left-radius: 4px;
    border-style: none;
}

.site-footer__subscribe-newsletter .submit {
    font-family: inherit;
    font-size: inherit;
    line-height: inherit;
    width: 100px;
    background-color: #1BA8CB;
    color: white;
    font-weight: 500;
    border-top-right-radius: 4px;
    border-bottom-right-radius: 4px;
    border-style: none;
    cursor: pointer;
    transition: all .3s ease;
}

/* Secondary footer (below) */
.site-footer-secondary {
    background-color: white;
}

.site-footer-secondary__contents {
    display: flex;
    align-items: center;
    justify-content: space-between;
    max-width: 75rem;
    margin-left: auto;
    margin-right: auto;
    font-size: 0.875rem;
    padding: 0.5rem 0.75rem;
}

/*
 * 1. Value is the largest computed width among 'site-footer__copy' and 'site-footer__links'.
 */
.site-footer__copy,
.site-footer__secondary-links {
    flex-grow: 0;
    flex-basis: 280px;
    /* 1. */
}

/*
 * 1. 'flex-shrink: 1' is applied to the element with the smallest computed width among
 *    'site-footer__copy' and 'site-footer__links'.
 */
.site-footer__copy {
    flex-shrink: 1;
    /* 1. */
}

.site-footer__logo {
    flex: 0 0 auto;
    margin-right: 10px;
    margin-left: 10px;
}

.site-footer__logo svg {
    width: 35px;
    height: 35px;
}

/*
 * 1. 'flex-shrink: 0' is applied to the element with the largest computed width among
 *    'site-footer__copy' and 'site-footer__links'.
 */
.site-footer__secondary-links {
    flex-shrink: 0;
    /* 1 */
    text-align: right;
    white-space: nowrap;
}

.site-footer-secondary a {
    color: #999;
}

.site-footer-secondary__links a:not(:last-child) {
    padding-right: 10px;
}

.site-footer-secondary__links a:not(:first-child) {
    padding-left: 10px;
}

@media all and (max-width: 29.99rem) {
    .site-footer__rights,
    .site-footer-secondary__links {
        display: none;
    }

    .site-footer__logo {
        order: 1;
        text-align: left;
    }

    .site-footer__copy {
        order: 2;
        text-align: right;
    }
}

/* Avoid the footer taking up much of the screen on short displays */
@media all and (max-height: 56.25rem) {
    .site-footer__navigation {
        margin: 1.5rem auto 0 auto;
        padding-top: 0;
        padding-bottom: 0;
    }
}

@media screen and (min-width: 84.375rem) {
    .ui-logos .ui-logo {
        box-shadow: 0 6px 15px 1px rgba(0, 0, 0, 0.56);
    }

    .main-content > .appendix,
    .main-content > .book,
    .main-content > .chapter {
        flex-basis: 50rem;
        max-width: 50rem;
    }
}

@media screen and (min-width: 93.75rem) {
    .main-content > .appendix,
    .main-content > .book,
    .main-content > .chapter {
        flex-basis: 60rem;
        max-width: 60rem;
    }
}

/* User Manual Home */
.technology-logos,
.ui-logos {
    display: flex;
    flex-direction: row;
    flex-wrap: wrap;
    justify-content: space-around;
}

.technology-logo,
.ui-logo {
    flex: 0 1 auto;
}

.ui-logo {
    width: 224px;
    height: 135px;
    margin: 12px;
}

/* Samples download button */
.download {
  display: flex;
}

.download a {
  border-style: solid;
  border-width: 1px;
  text-decoration: none;
  padding: 5px;
  display: block;
  width: 10em;
  margin: 5px;
}

.download ul {
  list-style: none;
  list-style-type: none;
}

.download li {
  float: right;
}

</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<meta name="adoc-src-path" content="dep-man/dependency_management.adoc">

<link crossorigin href="//assets.gradle.com" rel="preconnect">
<link href="https://fonts.googleapis.com/css?family=Inconsolata:400,700" rel="stylesheet"/>

<style type="text/css">.multi-language-selector .language-option[data-lang='groovy'],
.exampleblock[data-lang=groovy] > .content .title {
    background-image: url('data:image/svg+xml;base64,PHN2Zw0KICAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIg0KICAgd2lkdGg9IjYxNC4wNjA4NSINCiAgIGhlaWdodD0iMzAzLjU5ODYiDQogICB2ZXJzaW9uPSIxLjEiPg0KICA8Zw0KICAgICB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMzUuMzk2NTk5LC0zMC41NTgxOTYpIj4NCiAgICA8cGF0aA0KICAgICAgIGQ9Im0gMTU0Ljk3Njg3LDMzMi42OTE2MiBjIDAsLTAuODA1ODcgMTAuODMxMjMsLTE4LjYyMTcyIDI0LjA2OTQsLTM5LjU5MDc2IDEzLjIzODE5LC0yMC45NjkwNSAyMi42NjA1NywtMzguNjIwNjYgMjAuOTM4NjcsLTM5LjIyNTc3IC0xLjcyMTkxLC0wLjYwNTEgLTcuNjc5OTIsMC40ODU2NyAtMTMuMjQwMDIsMi40MjM5MyAtMTYuNzQ1MjQsNS44Mzc0MyAtMjAuMTg2MDUsNC4yOTAxNiAtMzIuNjkzMDgsLTE0LjcwMTU1IC0xMy41MzI2NSwtMjAuNTQ5MDYgLTE0LjAxNzI0LC0yMi42Njk4MyAtNi45NjE1OCwtMzAuNDY2MjQgNC42MDg3NiwtNS4wOTI1NiA0LjMzMTU5LC02LjI3OTY3IC0zLjIzMTksLTEzLjg0MzE2IC00LjU1MDA5LC00LjU1MDEgLTguMjcyODksLTkuNjQzMDkgLTguMjcyODksLTExLjMxNzc2IDAsLTIuODE2NzkgLTMwLjk5MTQ1LC0xNS41ODkzMyAtNzkuOTg5NDk2LC0zMi45NjYxNSAtMTEuMTA5NjYsLTMuOTM5OTcgLTIwLjE5OTM3NSwtNy44MjkyOCAtMjAuMTk5Mzc1LC04LjY0MjkxIDAsLTAuODEzNjYgMjMuNDcwNzM4LC0xLjAwNDc2IDUyLjE1NzE5MSwtMC40MjQ2OSBsIDUyLjE1NzIxLDEuMDU0NjYgNS4wOTEyNywtOC4wMzAwMSBjIDIxLjUxNjQ0LC0zMy45MzU5MiA1NC4wMDk1MiwtNjQuNTg4MjEyIDY4LjQ2NzA1LC02NC41ODgyMTIgMy4wMTA2LDAgOS4xMjE0MSwyLjg2OTE4IDEzLjU3OTUzLDYuMzc1OTQ1IDcuMjU5NDYsNS43MTAyODMgOC4yNTY1LDkuMjQ4NjMyIDkuNTQ5OTQsMzMuODkxOTY3IDAuNzk0MywxNS4xMzM4MiAyLjQyNDIyLDI4LjQ5NjAxIDMuNjIxOTgsMjkuNjkzNzkgMS4xOTc3NSwxLjE5Nzc2IDQuOTk3NjksLTAuMzc0MjUgOC40NDQzMSwtMy40OTMzOSA0LjQwMTQsLTMuOTgzMjMgOS4wMzQ4NCwtNS4wNjMxMyAxNS41Njc2MSwtMy42MjgzIDYuNzY3NTYsMS40ODY0MSAxMC42MjcxLDAuNDY4OTUgMTQuMTY5MzgsLTMuNzM1NDMgNS4zMTM2LC02LjMwNjY2IDMxLjkwNTk2LC00OC45MzcyMDEgMzEuOTA1OTYsLTUxLjE0ODc0NCAwLC0wLjc1MTU4OCA1LjI2NTA5LC05Ljc1NzMwNiAxMS43MDAyMywtMjAuMDEyNzAzIDYuNDM1MDksLTEwLjI1NTM5NyAxMy44NDY2NCwtMjIuMDgwNjMxIDE2LjQ3MDA3LC0yNi4yNzgyODMgNC42NjU1OCwtNy40NjUyMDEgNS4zOTY2LC02LjU4MTczNSAzMy40MjY5Miw0MC4zOTg3MzYgMjguOTQxMjEsNDguNTA3MTY0IDQ0LjUxNzY3LDY2LjQwNjU1NCA1Mi4zMTU3LDYwLjExNzYzNCA1LjQ0MiwtNC4zODg4OSAzNC4wMDA1NSwtNC42Mzc5NCA0MS45ODI0NiwtMC4zNjYxNCA0LjUzNjY1LDIuNDI3OTMgNy40MTkxNiwyLjM5NjEgOS45MjQ4NCwtMC4xMDk2MiA1LjIwMDA3LC01LjIwMDA2IDE3LjY0OTgyLC00LjI5NDM3IDIwLjkwNDEyLDEuNTIwNzggMi41NjM5Myw0LjU4MTQ2IDMuMjE3ODQsNC41ODE0NiA3LjAyMDE0LDAgMi4zMDYwNiwtMi43Nzg2NyA5LjEzNjE5LC01LjA1MjA4IDE1LjE3ODAzLC01LjA1MjA4IDguNTM4ODQsMCAxMS43OTMzNiwxLjc3MzY3IDE0LjYxNDAzLDcuOTY0MzcgbCAzLjYyODgxLDcuOTY0MzYgNTYuMDkyMDMsLTEuOTg1OCBjIDMwLjg1MDYyLC0xLjA5MjIyIDU2LjA5MjA0LC0xLjI4Njg4IDU2LjA5MjA0LC0wLjQzMjU1IDAsMC44NTQyNyAtMjIuOTA2MDgsMTAuMDcxOTUgLTUwLjkwMjQxLDIwLjQ4MzcxIC0yNy45OTYzMiwxMC40MTE3MiAtNTEuMzY3LDE5LjI0MzA1IC01MS45MzQ4NCwxOS42MjUxMiAtMC41Njc4NSwwLjM4MjA3IDAuNjk4NDcsOS40OTI3MyAyLjgxNDA1LDIwLjI0NTg4IDUuNTA0NTcsMjcuOTc5MTcgMS45MTQ1OCw0Ni42MjU4OSAtMTEuOTI2MjksNjEuOTQ2MDQgLTYuMjA5LDYuODcyNjMgLTE2LjI4MzM4LDE0LjE0Mzk1IC0yMi4zODc1MywxNi4xNTg0OSAtNi4xMDQxNSwyLjAxNDU0IC0xMS4wOTg0NCw0LjM4NjE0IC0xMS4wOTg0NCw1LjI3MDE5IDAsMC44ODQwNiA2LjUxNTI1LDExLjY3ODkzIDE0LjQ3ODM1LDIzLjk4ODU5IDcuOTYzMDksMTIuMzA5NjkgMTMuMjgyOCwyMi4zODEyNSAxMS44MjE1MiwyMi4zODEyNSAtMi4zODUwNCwwIC02MC40Njk4NywtMjIuNDQyMzggLTE1MC43ODg5OCwtNTguMjYwNyAtMTcuODA5LC03LjA2MjU4IC0zNC4wMjY4MywtMTIuODQxMDkgLTM2LjAzOTYxLC0xMi44NDEwOSAtMy43NTM2MywwIC0zNi4xNjY5LDEyLjI4NjYyIC0xMzEuMjI0MjMsNDkuNzQyMDYgLTU1LjEyNTI1LDIxLjcyMTAzIC01Ny4yOTIxNywyMi40NzM0OCAtNTcuMjkyMTcsMTkuODk0NTEgeiBtIDExMy4xMTY0OCwtNTEuMjUyNjUgYyAyOS4zMjk0OSwtMTEuMzk1MDYgNTguNDE2NTcsLTIyLjUzMDggNjQuNjM3OTgsLTI0Ljc0NjA3IDEwLjcwMDY4LC0zLjgxMDE5IDE0LjI3OTE4LC0yLjg1NDkzIDY2LjI1Mzk0LDE3LjY4NjM0IDMwLjIxODI1LDExLjk0Mjc0IDYwLjAzMjUyLDIzLjU3NTg3IDY2LjI1MzkyLDI1Ljg1MTM0IDYuMjIxNDEsMi4yNzU1MiAxOS4wNDMxNyw3LjIyMDU5IDI4LjQ5Mjc1LDEwLjk4OTA4IDEwLjc3NTAzLDQuMjk3MDQgMTYuMjgyNTEsNS4zMzE2NiAxNC43NzEwOCwyLjc3NDg0IC0xNi44ODM3LC0yOC41NjExMyAtMTcuMzk5OCwtMjkuMDM3MTYgLTI5LjEwMDgzLC0yNi44NDIwNSAtMTQuMTEzNjEsMi42NDc3MiAtMjIuODc4OTcsLTAuMDY4NSAtMjcuMzgzNjksLTguNDg1NTQgLTIuOTIxMTIsLTUuNDU4MTYgLTIuMDI5NDQsLTguMTI3NTkgNS4yNTQ0MiwtMTUuNzMwMzEgMTAuODQ4ODcsLTExLjMyMzc3IDkuMTQ0NTcsLTIxLjc0MTQ0IC00Ljg0NDI5LC0yOS42MTA5OSAtNS4zNjc2NCwtMy4wMTk1OSAtMTIuMTQwNTksLTEwLjQ4MzcyIC0xNS4wNTEwMiwtMTYuNTg2OTcgbCAtNS4yOTE2OSwtMTEuMDk2ODIgLTExLjM0NTUxLDcuNjk5MjggYyAtMTMuOTQ0NTgsOS40NjMwNCAtMzAuOTUwNjIsOS45NTA2MyAtNDUuMTQ3NjQsMS4yOTQ0OCBsIC0xMC40NjQ4OCwtNi4zODA2NSAtMTIuMTU4NDEsOC4yNjI4NCBjIC0xMi4xNzQ2Miw4LjI3Mzg2IC0yNi4xOTEwOCw5LjM0MjggLTQwLjQzNzUyLDMuMDgzOTIgLTMuOTI0OTgsLTEuNzI0MzkgLTUuNjU1ODMsLTEuMDU0MTUgLTUuNjU1ODMsMi4xOTAwOCAwLDIuNTcxMTggLTMuNzA0MjksNi4zNjI2NSAtOC4yMzE4MSw4LjQyNTUzIC0xMy41NzQyLDYuMTg0NzkgLTI2LjgyMTA3LDQuNTQyNDcgLTM1LjgwMjI5LC00LjQzODc1IGwgLTguMTg5NDQsLTguMTg5NDQgLTYuNjA5ODIsOC40MDMwMyBjIC0zLjYzNTM5LDQuNjIxNjYgLTEyLjA0OTUyLDExLjgzNjk4IC0xOC42OTgwNSwxNi4wMzM5OCAtOC4yMjk2NSw1LjE5NTE4IC0xOC40MTc0MSwxNy44NzE4MiAtMzEuOTE2NCwzOS43MTM2MSAtMTAuOTA1NDksMTcuNjQ1NDYgLTE5LjgyODE2LDMyLjk4MDQyIC0xOS44MjgxNiwzNC4wNzc3NiAwLDEuMDk3MyA4LjM2MjU1LC0xLjUyNzM2IDE4LjU4MzQyLC01LjgzMjU5IDEwLjIyMDg5LC00LjMwNTIxIDQyLjU4MDI4LC0xNy4xNTA4NyA3MS45MDk3NywtMjguNTQ1OTMgeiBtIDI0OC43NjcyOSwtMTIuMjU4NDYgYyAyMi4yNTU1NywtMTIuNTA4MzMgMjcuNDE0MjQsLTM1LjY0ODA4IDE3LjU3Njg1LC03OC44NDMxOCAtOC4yMjE0LC0zNi4wOTk2MSAtMTIuMzI1NSwtNDcuOTEzMjcgLTE3LjE5NDk0LC00OS40OTU5NyAtMy4zNjkwMiwtMS4wOTUwMyAtMy44ODY3NCwwLjEwNjk5IC0xLjk4ODU4LDQuNjE2MzUgMTIuMzE1MTYsMjkuMjU3NzEgMTIuOTk5NjMsNDMuOTQ2NjIgMi4yNDAyMiw0OC4wNzU0MSAtNy4zOTE1MSwyLjgzNjQyIC0xNS4yMzIzOSwtNy43OTA3NSAtMjEuMzk5MDIsLTI5LjAwMzI2IC00Ljc3NTEyLC0xNi40MjU4NyAtOS43Njg2MSwtMjMuODI4MzcgLTEzLjUzMzg3LC0yMC4wNjMxMSAtMC45MDE1NywwLjkwMTYgMC42Nzg0OCw2LjEyMTE3IDMuNTExMjQsMTEuNTk5MTMgMi44MzI3Myw1LjQ3NzkgNi43MTcyMSwyMS45NzQ1NSA4LjYzMjE3LDM2LjY1OTIgMS45MTQ5NywxNC42ODQ2MiA1LjYxMzg1LDMwLjA2MDczIDguMjE5NzMsMzQuMTY5MTIgNi43NzE5OCwxMC42NzY2MSAxNy41NTEyOCw4LjEwMzYgMjQuNTIzODIsLTUuODUzODQgNi44OTM3MywtMTMuNzk5NzUgNy42NzI4NCwtNC42MDc4MSAwLjk2OTMsMTEuNDM2MDIgLTYuOTYwNzQsMTYuNjU5MzcgLTI3LjYzNDQyLDIxLjY1NDgxIC01MS41ODQxOCwxMi40NjQ0MiAtMy44MzMzLC0xLjQ3MDk2IC01LjEzMDM5LDAuMDUxNSAtNS4xMzAzOSw2LjAyMDk3IDAsNC4zOTQzMSAtMi45MzYxOCwxMS43MjI0NSAtNi41MjQ4OCwxNi4yODQ3IGwgLTYuNTI0ODgsOC4yOTUwNiA4Ljk0ODgxLDEuNTExMjMgYyAxNS40NDk0NSwyLjYwOTA5IDM2LjYzMzI4LC0wLjc3NjQyIDQ5LjI1ODYsLTcuODcyMjUgeiBtIC0zMjAuMzY2NSwtMjcuNTM3MzMgYyA0Ni40NTk2NSwtMTMuMzU0NSA1NC43NjE4OCwtMjguOTMwOTMgMzkuMzI4ODUsLTczLjc4NzgyIC0zLjU4MTg1LC0xMC40MTA3OSAtNi41MTI0MywtMjEuNjA5NzEgLTYuNTEyNDMsLTI0Ljg4NjU0IDAsLTExLjE1NzEyIC01LjYxMTUyLC02LjAwMTYxIC05LjgxNzEzLDkuMDE5NDMgLTUuNTYyMDMsMTkuODY1NjEgLTIyLjI5MTE1LDM2Ljc1MDUzIC0zNi4zNDUxNiwzNi42ODM2NCAtMTIuMjA1NDcsLTAuMDU4MiAtMTYuMTgyNTEsLTIuMjgwMDggLTIxLjIyMzc4LC0xMS44NTc2OCAtOS4wNDc0OCwtMTcuMTg4ODIgMC44MTQ2OSwtNDMuNTY3OTcgMjUuOTY5NTQsLTY5LjQ2MjcyIDE4LjQyNDMxLC0xOC45NjYzMDQgMjguNDg4OTMsLTIwLjY4Mzk2NSAyOC40ODg5MywtNC44NjIwNSAwLDI0LjY3MzIgLTE3LjAxMTM0LDYwLjk5NDcgLTI1Ljk3MzA5LDU1LjQ1NjA0IC00LjM4MjA1LC0yLjcwODI2IC0zLjY3MTM4LC0xNC42Njc1MiAxLjQxNzIyLC0yMy44NTAwOSA0LjMyNzM1LC03LjgwODgyIDMuNDQ4MTQsLTE5LjcwNzcxIC0xLjQ1NjIsLTE5LjcwNzcxIC01LjY4Njg5LDAgLTE2Ljk0NTQ3LDIwLjcxMTk2IC0xOC40MzMxOCwzMy45MTA3NCAtMS4zMTUxNSwxMS42NjgyNiAtMC40OTI4NiwxNC41MDU0NSA1LjA2NjUyLDE3LjQ4MDcyIDE5LjQ4MjQ0LDEwLjQyNjcgNDUuMDA1MzEsLTIxLjM5NTQ1IDQ2LjI5MDgzLC01Ny43MTU4NCAwLjY3NTA0LC0xOS4wNzMxODEgLTMuMDE2NzYsLTI0LjQ0MTEwNSAtMTQuNzc5MDYsLTIxLjQ4ODk1MSAtMTcuMTE4NzksNC4yOTY1NDMgLTYzLjIzNDgzLDYzLjc4NjY0MSAtNjMuMjM0ODMsODEuNTczNDYxIDAsMTMuOTEyOCA2Ljk4NzM3LDIzLjY5NzI4IDE5LjI4ODI3LDI3LjAwOTYgMjAuOTE0MTksNS42MzE2MiA0MS4xMzUzOSwtNC4zNzM4OSA1NS40NjMzLC0yNy40NDMzOCBsIDYuMDIxNzUsLTkuNjk1NzEgMC4wMTMyLDEzLjE3MjIzIGMgMC4wMTYyLDE5LjA3MzggLTEyLjQyNjE5LDI5LjEyNzQgLTUxLjY5ODE3LDQxLjc2NzkzIC05Ljc3NjQ5LDMuMTQ2OCAtMTguMTgzMzIsNi4wNTQ0MSAtMTguNjgxOCw2LjQ2MTM3IC0xLjgyMDU2LDEuNDg2MzIgMTYuNjg3MzksMjcuNDc1NzEgMTkuNTY2NDQsMjcuNDc1NzEgMS42MzI2MiwwIDExLjE5MTE1LC0yLjM2MzU5IDIxLjI0MTIzLC01LjI1MjM4IHogTSA0NzYuNDExLDIxNy45NjMwMSBjIDQuNjYzNDcsLTUuMTUzMSA1LjQ4NTUxLC0xMC43NTEwMyA0LjQ4NTc5LC0zMC41NDgyMyAtMS4wODczOSwtMjEuNTMzMzEgLTIuMjc3NDYsLTI1LjMzODUxIC0xMC42NjE0MywtMzQuMDg5NDkgLTE1LjE0ODgyLC0xNS44MTE5NCAtMzMuODYxMjMsLTExLjc3ODI4IC0yMi45MDgxOSw0LjkzODE0IDUuODIyNTYsOC44ODYzNyAxMi45MjU0LDcuMzY4NjQgMTAuNDE2NDEsLTIuMjI1ODEgLTEuOTk4NjQsLTcuNjQyNzYgMS43Mjk5OCwtNy44NDM1OCA4LjIyODM5LC0wLjQ0MzIyIDEyLjE5MzAxLDEzLjg4NTM3IDkuMTE1MzQsMzMuMTI2OTggLTUuMjk4NiwzMy4xMjY5OCAtOS44NjcxNiwwIC0xMi45NDE5NSwtNC4yMzE3NiAtMTkuMzczNTMsLTI2LjY2MzE4IC0yLjkzMDU5LC0xMC4yMjA4NyAtNi40OTk2NCwtMTguNTgzNDMgLTcuOTMxMjcsLTE4LjU4MzQzIC00Ljc2ODk5LDAgLTYuODkyODcsNC4yMDg3OCAtMy45MjcyMSw3Ljc4MjQgMS42MTA4OCwxLjk0MTEgNi4wNzIxOCwxNS44OTEyNyA5LjkxNDA0LDMxLjAwMDQxIDkuNjY5MDMsMzguMDI1OTYgMjMuMTc2NjYsNTEuMDQxNDUgMzcuMDU1NiwzNS43MDU0MyB6IG0gLTE4My43NzEyNSwwLjYwMzk1IGMgMS45ODk3OCwtMS4zMzUgMi44OTk3NSwtNy42NDg5MyAyLjA3ODY1LC0xNC40MjMgLTEuMzI0NDksLTEwLjkyNzAyIC0yLjA2NjYyLC0xMS43MjQxIC03Ljk3MjcsLTguNTYzMjcgLTguNDg3MzMsNC41NDIyNyAtMTcuNjA4MzksLTQuMDYzNTEgLTIwLjcwMjIyLC0xOS41MzI2IC0yLjM0NzA3LC0xMS43MzUzOCAtMy4wNjUyNiwtMTEuNTA0ODkgMTQuMDI1NzYsLTQuNTAxNDkgMi4xNDI4OCwwLjg3ODA4IDcuNTk2NzEsLTIuMTA0MDIgMTIuMTE5NjMsLTYuNjI2OTQgOC4yNzQwOCwtOC4yNzQwOCAxMC45OTgwMiwtMTguMjEyOTkgNC45OTE1NiwtMTguMjEyOTkgLTEuNzc3NTQsMCAtMy4yMzE5LDEuNDU0MzYgLTMuMjMxOSwzLjIzMTkgMCw0LjY0OTIzIC04Ljg0MjMxLDMuOTg5ODIgLTEwLjgzNDY1LC0wLjgwNzk3IC0xLjE2MjI0LC0yLjc5ODc5IC0zLjYzODA3LC0xLjgwNTkxIC04LjA1OTE1LDMuMjMxOSAtMy41MDk4NSwzLjk5OTQ4IC03Ljc5NjczLDcuMjcxNzggLTkuNTI2NDEsNy4yNzE3OCAtMS43Mjk2OSwwIC00LjA2NTYsLTMuMjcyMyAtNS4xOTA4OCwtNy4yNzE3OCAtMS45NzE5NSwtNy4wMDg1NiAtMi4yMTM2NiwtNy4wNTI3NyAtNi42NzczNywtMS4yMjE2OSAtMy45MTA2LDUuMTA4NTQgLTMuOTQ1NTcsNi43MzU4MyAtMC4yMjQ2MSwxMC40NTY2MSAzLjk0MDYyLDMuOTQwNjQgMTEuNDI2MTUsMzAuODcxMDIgMTEuNDI2MTUsNDEuMTA3NDQgMCwxMi43Mjg2NyAxNy41MjkzMywyMi43MzgzMiAyNy43NzgzLDE1Ljg2MjEgeiBtIDU4Ljk0MzA5LC0xNi44NzUzMSBjIDEyLjE0NTY3LC0xMi4xNDU2NyAxNS43NDQ1MiwtMzAuMzUxNDMgOS4xMjk0MywtNDYuMTgzNTcgLTUuMTcwMTYsLTEyLjM3Mzk3IC0xNC4xNDQ2NiwtMTcuMDA1MTYgLTI2Ljc5ODc4LC0xMy44MjkxOCAtOS40MDI2MywyLjM1OTkxIC0yMy43MjMxMSwyOS43NzY1OSAtMjMuNzczODcsNDUuNTE1MzYgLTAuMDc5MiwyNC41MjkwMiAyMy4yNTA1MywzMi42OTAwNSA0MS40NDMyMiwxNC40OTczOSB6IG0gLTIyLjA4MzQxLC0xOS40MzQwNyBjIC0zLjU1NTEsLTMuNTU1MSAtNi40MTc1NSwtMTAuNDYzMjggLTYuMzYxMDIsLTE1LjM1MTUzIDAuMDkzNCwtOC4wNzk2NSAwLjQ5MzE1LC04LjM3MzUgNC4zOTYxOSwtMy4yMzE5IDQuODI0NjQsNi4zNTU2OSAxMy4zOTc5Nyw3LjQ1NjY2IDE2LjY4MjQxLDIuMTQyMzIgMS4xOTQzMiwtMS45MzI0MSAwLjU1Mjk1LC01LjEzMjAyIC0xLjQyNTIsLTcuMTEwMTcgLTUuMDgxMzIsLTUuMDgxMzIgLTQuNDY1NjEsLTExLjk5OTYzIDEuMDY3OTIsLTExLjk5OTYzIDYuMTUxMzcsMCAxNC43MjY3OSwxMi41MTQ3NyAxNC43MjY3OSwyMS40OTE5MSAwLDYuNjA2NzQgLTEzLjQ0NDQsMjAuNTIyOCAtMTkuODI3MjQsMjAuNTIyOCAtMS41Mzc4NSwwIC01LjcwNDc2LC0yLjkwODcyIC05LjI1OTg1LC02LjQ2MzggeiBtIDg2LjM0ODk3LDE4LjU4MzQxIGMgMTMuNDEwNzQsLTE0LjYwMjYzIDEyLjEwMzc2LC0zNy4wOTggLTMuMDk4MjUsLTUzLjMyNjM0IC03Ljg1MDU3LC04LjM4MDYgLTI1LjI5Mjk4LC05LjgyNTUyIC0zMi40MzE4NSwtMi42ODY2NCAtNi41ODc2MSw2LjU4NzYxIC0xMy4xNjQ2NSwzMi40OTMwMyAtMTAuNzIxMjIsNDIuMjI4NDEgNS4yMTEyMiwyMC43NjMxOCAzMi40MDA0MSwyOC44NjY1MiA0Ni4yNTEzMiwxMy43ODQ1NyB6IG0gLTI3LjQ1NTY1LC0yMy42MTQ1MiBjIC01LjMwNjIzLC0zLjcxNjY0IC03LjEyOTQxLC04LjE0OTc0IC02Ljk3ODA2LC0xNi45Njc0NyAwLjE2OTM1LC05Ljg2MDMzIDAuNjg0MywtMTAuNzQ5ODEgMi45NjE0NSwtNS4xMTQxNSAzLjM0NTczLDguMjgwMzIgMTAuMzYyOTIsMTEuNDA3MzQgMTYuNTE4MTQsNy4zNjA5IDMuODE3NTMsLTIuNTA5NjMgMy42MzkyOSwtMy42OTU5NyAtMS4xMDEwNCwtNy4zMjkwNyAtNi4zMjE4OSwtNC44NDUyMyAtNy41NTUwOCwtMTEuNzAxOTEgLTIuMTA0NjUsLTExLjcwMTkxIDQuODczNjQsMCAyMi4zMDQwMiwxOS4wNjY2NiAyMi4zMDQwMiwyNC4zOTc3OCAwLDUuMjAzMTYgLTEyLjM3NzM5LDE0LjM4NTAzIC0xOS4zOTEzOSwxNC4zODUwMyAtMi43NjQwNSwwIC04LjI1NzksLTIuMjY0MDIgLTEyLjIwODQ3LC01LjAzMTExIHogbSAxODkuOTYyOTIsLTE0LjI4ODg3IDMzLjkzNDk1LC0xMi43MzY4MiAtMzYuMzU4ODgsLTAuMTMxMjUgYyAtMzIuNTM5MiwtMC4xMTczNiAtMzYuMzU0MjQsMC40NjMwNyAtMzYuMzE0NzUsNS41MjQ3NSAwLjA0MDEsNS4xMjc1NyAzLjMzMDczLDIwLjI4Mzk1IDQuMzcyNywyMC4xMzk2NyAwLjIzNzIyLC0wLjAzMjkgMTUuNzAxNzcsLTUuNzkxMjQgMzQuMzY1OTgsLTEyLjc5NjQ4IHogbSAtNDQzLjQ5MzQzLC0yLjI3OTMgMy40NjgyNSwtMTAuMjg3NjEgLTMwLjQ2Njg2LC0xLjAyNDA0IGMgLTE2Ljc1Njc0NCwtMC41NjMyMiAtMzAuNDYzNTg0LC0wLjEzMjEzIC0zMC40NTk1OCwwLjk1ODA0IDAuMDA1OCwxLjU5NTEzIDUyLjUwNjU3LDIyLjEwNzA3IDUzLjY2MTc0LDIwLjk2NTUyIDAuMTgwMzUsLTAuMTc4NCAxLjg4ODkyLC00Ljk1MzcyIDMuNzk2NDUsLTEwLjYxMTkxIHogbSAyMDguOTA5MiwtMzEuODg2OTUgYyA3LjE2NjY3LDEuMTQ2IDE1LjI0OTgxLDQuMDc5MjQgMTcuOTYyNTYsNi41MTgzNSA0LjIxMjc5LDMuNzg3ODMgNi4wNDUyOCwzLjUyOTY2IDEyLjU2MjA3LC0xLjc2OTg1IDQuMTk2NDMsLTMuNDEyNSA5LjY1MDI2LC02LjIwNDU3IDEyLjExOTYzLC02LjIwNDU3IDIuNDY5MzksMCA0LjQ4OTgyLC0wLjcxMzA4IDQuNDg5ODIsLTEuNTg0NjcgMCwtMy4wMDkxOCAtNDYuNTM5NTQsLTc5LjIxMjUyIC00OC4zMTQ0NywtNzkuMTA5NjEgLTIuMDg1LDAuMTIwODcyIC00OS43ODYwMyw4MC4wODc5OCAtNTEuMjU0NjQsODUuOTI0MzcgLTAuNjE2MzQsMi40NDk1MiAxLjMxODA0LDMuMzUzNzEgNS4wNzM2NCwyLjM3MTYgMy4zMzgzNiwtMC44NzMgNy45NTQxNiwwLjY4MzI2IDEwLjI1NzI3LDMuNDU4MzYgMy43MzU0LDQuNTAwODcgNS4yNjEwOCw0LjE0MjI5IDE0LjEzMDY4LC0zLjMyMDk3IDguNDI2NDcsLTcuMDkwNDEgMTEuOTMwOCwtOC4wNDg4IDIyLjk3MzQ0LC02LjI4MzAxIHoiDQogICAgICAgc3R5bGU9ImZpbGw6IzMzMzMzMztmaWxsLW9wYWNpdHk6MSIgLz4NCiAgICA8cGF0aA0KICAgICAgIHN0eWxlPSJmaWxsOiM2Mzk4YWE7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlOm5vbmUiDQogICAgICAgZD0ibSAzMDkuNTQ1NzksMTQwLjg3OTIyIGMgLTAuNTAwNzUsLTAuMjMzMTEgLTEuMTE4MDQsLTAuNzY3OTkgLTIuNTI3OCwtMi4xOTAzNSAtMS45MTE4OCwtMS45Mjg5NyAtMi42NzE4OCwtMi40OTAxMyAtNC4yNjEwOCwtMy4xNDYyOCAtMi4wODc5MSwtMC44NjIwNCAtNC4zNTQ5LC0xLjA5NDIzIC02LjQ4MjMxLC0wLjY2MzkxIC0xLjg5ODA4LDAuMzgzOTMgLTIuNDI0MzUsMC40MjUyNyAtMy4yODI0MiwwLjI1NzggLTEuNDMyMjQsLTAuMjc5NTMgLTEuOTQxNTcsLTEuMTQ5MjkgLTEuNTM1ODMsLTIuNjIyNzIgMC41MDU3MywtMS44MzY1NyA0LjMzNjkzLC04Ljk0MjU1IDEyLjAwODk5LC0yMi4yNzM4NyAxNS41ODM3LC0yNy4wNzg5ODggMzYuNTM2MjQsLTYxLjIyMDk2OCAzOC44NTA1NiwtNjMuMzA2NjYyIDAuMjU2MzEsLTAuMjMwOTk0IDAuMjY1LC0wLjIzMDk5NCAwLjUyMjQ4LDAgMS4zNzc2OCwxLjIzNTk3NiA5LjQ3NjIsMTMuNzI1ODg5IDIwLjU0MDM2LDMxLjY3ODI5OCAxNC45NjY5NiwyNC4yODUwMDQgMjcuNDExMDIsNDUuNjQzNzE0IDI3LjQxMTAyLDQ3LjA0NzcwNCAwLDAuODU3MjkgLTEuMzE2MDgsMS4zNzIxNSAtNC4wODU5MSwxLjU5ODQ1IC0zLjQ0MjI2LDAuMjgxMjQgLTcuNDI0NzgsMi4zMDE4OCAtMTIuODY4ODcsNi41MjkzNiAtMi41ODcxMiwyLjAwODk4IC0zLjY5MTI2LDIuNzU5MzMgLTQuOTUwNjIsMy4zNjQzOCAtMS4wNDkyOCwwLjUwNDExIC0xLjEzNjkyLDAuNTI0MzcgLTIuMjY4NTQsMC41MjQzNyAtMS4xMTM2OCwwIC0xLjIyNjYxLC0wLjAyNDkgLTIuMDk2MjMsLTAuNDYxMjggLTAuNTEyMTMsLTAuMjU3MDIgLTEuNTA0NjksLTAuOTQ5MyAtMi4yNDE1NSwtMS41NjM0MiAtMi4xNzg0OCwtMS44MTU2MSAtNC43OTkxOCwtMy4xMzYxNCAtOS4wNzE5NywtNC41NzEyNCAtNS40Mjk5NywtMS44MjM3NiAtMTEuMjQ0NTQsLTIuOTE4NCAtMTYuMTk1NTEsLTMuMDQ4OTYgLTMuOTA5MzQsLTAuMTAzMDggLTUuNzEyMDEsMC4yNDc5OCAtOC42NzYwMiwxLjY4OTYzIC0yLjQxOTg4LDEuMTc2OTggLTMuNTg2MjEsMi4wMTMxMSAtOS4xMjQ3NSw2LjU0MTQ1IC01LjYzMzc2LDQuNjA2MTcgLTcuNjM0NDIsNS41NjIwNSAtOS42NjQsNC42MTcyNSB6IiAvPg0KICAgIDxwYXRoDQogICAgICAgc3R5bGU9ImZpbGw6IzYzOThhYTtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZSINCiAgICAgICBkPSJtIDEyOC42Mzc4NiwxNzAuNzM5IGMgLTEwLjE1OSwtMi45NjA3IC00NS41MDMxNzEsLTE2LjkxOTYyIC01MC40NTA5MjQsLTE5LjkyNTIzIC0wLjY4MjkxNiwtMC40MTQ4NCAtMC43MzgwOTgsLTAuNDc3ODcgLTAuNTQzMjA3LC0wLjYyMDM4IDEuMTMxNTYzLC0wLjgyNzQxIDEyLjMzNzk4MywtMS4yMzkwMSAyNS4wMDQwMzEsLTAuOTE4MzYgNS4wNTEzMSwwLjEyNzg4IDM1LjUwMTMyLDEuMTMzMjMgMzUuNTUwOSwxLjE3Mzc3IDAuMDk5NywwLjA4MTUgLTYuNTIxNjQsMTkuMjg4OCAtNy4wMzA1MSwyMC4zOTQzMyAtMC4yMTI1MSwwLjQ2MTcgLTAuNjUwNjMsMC40NDM2NyAtMi41MzAyOSwtMC4xMDQxMyB6IiAvPg0KICAgIDxwYXRoDQogICAgICAgc3R5bGU9ImZpbGw6IzYzOThhYTtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZSINCiAgICAgICBkPSJtIDU0My42OTQxMywxNzUuMzEwNTUgYyAtMS4zODYyLC0yLjcxMjg3IC0zLjg4NzY5LC0xNC45NzA2NyAtMy45NjA3OCwtMTkuNDA4NTggLTAuMDI4NCwtMS43MjQyNCAwLjE4NjY3LC0yLjQyNzQxIDAuOTYwNiwtMy4xNDA4IDEuNzczNzgsLTEuNjM1MDEgNS4zNzkzOCwtMi4yMjMyIDE1LjI5MDE3LC0yLjQ5NDM0IDUuMDAzNDcsLTAuMTM2ODkgMjguMTAxOSwtMC4xNTc5NiA0NC40MTEyNywtMC4wNDA1IGwgMTEuNDI4NTksMC4wODIzIC0yNy41MTc3LDEwLjMxNDI3IGMgLTI1LjA5MjkyLDkuNDA1NCAtMzkuNjg0NzMsMTQuODQxMjYgLTQwLjIyNDkxLDE0Ljk4NDkgLTAuMTM1MTcsMC4wMzYgLTAuMjY5ODEsLTAuMDY3NCAtMC4zODcyNCwtMC4yOTcyMyBsIDAsMCB6IiAvPg0KICAgIDxwYXRoDQogICAgICAgc3R5bGU9ImZpbGw6IzYzOThhYTtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZSINCiAgICAgICBkPSJtIDE3OC4wODgzNSwzMTUuNTE0MzMgYyAwLC0wLjc3MDc4IDMuMjY4OSwtNi41MzMxIDExLjU1Mzk1LC0yMC4zNjY5OCAxOS44NTExOCwtMzMuMTQ2MzEgMjguOTI3MTUsLTQ1LjE2MDEyIDQwLjA3MjkyLC01My4wNDQyOSA5Ljk3MTI3LC03LjA1MzM3IDE1LjMwMjc5LC0xMS45Mjk0IDIxLjI0NTM5LC0xOS40MzAzMyBsIDMuNjY0MDksLTQuNjI0OTIgNC45Mzk5LDQuODU2NTIgYyA4LjY0Nzg0LDguNTAxODkgMTMuODYxMywxMC45NjY2OCAyMy4yOTcxNywxMS4wMTQzMiAxMS41NDA1OCwwLjA1ODMgMjQuMTc4NDksLTYuMzg4MSAyNC4xNzg0OSwtMTIuMzMyOTkgMCwtMS4zMzk4IDAuOTU0MDQsLTIuNzIyMzYgMS44Nzg1NywtMi43MjIzNiAwLjM5MTMyLDAgMi42MTY4NiwwLjY4MzY1IDQuOTQ1NjUsMS41MTkyMyA2LjA2OTkyLDIuMTc3OSA5LjYzMDI4LDIuOTY1NDggMTQuNjA5MTIsMy4yMzE2NSA0LjkzOTk4LDAuMjY0MDkgOC41NDg0OCwtMC4xNzA0IDEzLjM1ODE3LC0xLjYwODQxIDQuNzI1NjEsLTEuNDEyODggNy40NDcwOSwtMi44NTkwNSAxNS41OTgzMywtOC4yODg4MiA0LjEwNzYsLTIuNzM2MTggNy41OTk1NCwtNC45NzQ4NyA3Ljc1OTg4LC00Ljk3NDg3IDAuMTYwMzMsMCAzLjEyNTM0LDEuNzE4OTYgNi41ODg5LDMuODE5OTEgMy40NjM1NiwyLjEwMDk1IDcuNjI1NDIsNC4zODEzMyA5LjI0ODU5LDUuMDY3NTEgMTEuMDY4NjIsNC42NzkxOCAyMy4wMjQ0NSw0LjM3MzkgMzMuOTcxMjYsLTAuODY3NDEgMS45NTc5NSwtMC45Mzc0NyA2LjU2NzkzLC0zLjczMDc0IDEwLjI0NDQsLTYuMjA3MjcgMy42NzY0OCwtMi40NzY1MyA2LjczNjEzLC00LjQ0NTc2IDYuNzk5MjMsLTQuMzc2MDYgMC4wNjMxLDAuMDY5NyAxLjQ1NjA1LDIuOTIwOCAzLjA5NTQ0LDYuMzM1NzggMS42Mzk0LDMuNDE0OTggMy42OTg5NSw3LjI2NjcgNC41NzY3OSw4LjU1OTM3IDMuODAwMDEsNS41OTU3OCA4LjE3NTg4LDkuNzUxNDEgMTQuMDgzNDMsMTMuMzc0NjQgNi4wODEyMiwzLjcyOTc1IDkuODMyMDYsOC42ODY4IDEwLjIxODgyLDEzLjUwNTA3IDAuMzgzNjcsNC43Nzk2OCAtMS43MDMyOSw5LjAxOTM5IC03LjcyMTg5LDE1LjY4NzIxIC00LjY5NzQ3LDUuMjA0MTkgLTUuODczMyw3LjIzNTQgLTUuODYxMTMsMTAuMTI0OTEgMC4wMTIyLDIuODkyNjIgMS43MDEwMyw2LjIyODU0IDQuNjY5NjQsOS4yMjM3OSA0LjgwNTMzLDQuODQ4NDQgMTIuMzQ2MDUsNi4yODc3NyAyMy40MzUzNCw0LjQ3MzE5IDIuNDc0MDgsLTAuNDA0ODQgNS41OTQ3OSwtMC43Mzc1NyA2LjkzNDkxLC0wLjczOTM4IDQuMjg1NTEsLTAuMDA2IDYuOTAzMTksMi4wOTU5NSAxMS44OTI1MSw5LjU0ODU5IDMuNDQzNTEsNS4xNDM2NSAxMC45NzM5NiwxNy43NTUwOCAxMC45NzM5NiwxOC4zNzgzNiAwLDAuMzI0MDcgLTAuMzUxNDUsMC41NTIwOCAtMC44NTA5NywwLjU1MjA4IC0xLjA1MTA5LDAgLTUuNjIzMTQsLTEuMjQzOCAtOC45MzIxNCwtMi40Mjk5NCAtNC4zNDg1LC0xLjU1ODc1IC01Ny4yNzIzOCwtMjIuMDA1MjYgLTc0Ljc0Nzg2LC0yOC44Nzc5NSAtNDYuNjYzNSwtMTguMzUxNjIgLTYyLjAyODA1LC0yNC4yMTI0NiAtNjkuNTM2NTcsLTI2LjUyNDg5IC04LjExNDE3LC0yLjQ5ODk1IC0xMy42NDAyOSwtMy4wODUyMiAtMTguMTI2NjEsLTEuOTIzMDYgLTUuNTc5OTYsMS40NDU0NiAtODEuNzIwNjcsMzAuODY4ODggLTEyNi4xMzI0NSw0OC43NDE5NSAtMjEuOTMxMTksOC44MjYgLTI0LjY3NzQ5LDkuODc1NzcgLTI4Ljc4MTE2LDExLjAwMTU5IC0zLjI2MzAzLDAuODk1MjEgLTMuMTQ0MDcsMC44ODI5NCAtMy4xNDQwNywwLjMyNDI2IHoiIC8+DQogIDwvZz4NCjwvc3ZnPg==');
    background-position: 16px 80%;
    background-repeat: no-repeat;
    background-size: 20px 12px;
    padding-left: 2.5em;
}

.multi-language-selector .language-option[data-lang='kotlin'],
.exampleblock[data-lang=kotlin] > .content .title {
    background-image: url('data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeD0iMHB4IiB5PSIwcHgiDQoJIHZpZXdCb3g9IjAgMCA2MCA2MCIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgNjAgNjA7Ij4NCjxnPg0KICAgIDxsaW5lYXJHcmFkaWVudCBpZD0iWE1MSURfM18iIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIiB4MT0iMTUuOTU5NCIgeTE9Ii0xMy4wMTQzIiB4Mj0iNDQuMzA2OCIgeTI9IjE1LjMzMzIiIGdyYWRpZW50VHJhbnNmb3JtPSJtYXRyaXgoMSAwIDAgLTEgMCA2MSkiPg0KCQk8c3RvcCAgb2Zmc2V0PSI5LjY3NzAwMGUtMDIiIHN0eWxlPSJzdG9wLWNvbG9yOiMwMDk1RDUiLz4NCgkJPHN0b3AgIG9mZnNldD0iMC4zMDA3IiBzdHlsZT0ic3RvcC1jb2xvcjojMjM4QUQ5Ii8+DQoJCTxzdG9wICBvZmZzZXQ9IjAuNjIxMSIgc3R5bGU9InN0b3AtY29sb3I6IzU1N0JERSIvPg0KCQk8c3RvcCAgb2Zmc2V0PSIwLjg2NDMiIHN0eWxlPSJzdG9wLWNvbG9yOiM3NDcyRTIiLz4NCgkJPHN0b3AgIG9mZnNldD0iMSIgc3R5bGU9InN0b3AtY29sb3I6IzgwNkVFMyIvPg0KCTwvbGluZWFyR3JhZGllbnQ+DQoJPHBvbHlnb24gaWQ9IlhNTElEXzJfIiBzdHlsZT0iZmlsbDp1cmwoI1hNTElEXzNfKTsiIHBvaW50cz0iMCw2MCAzMC4xLDI5LjkgNjAsNjAgCSIvPg0KICAgIDxsaW5lYXJHcmFkaWVudCBpZD0iU1ZHSURfMV8iIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIiB4MT0iNC4yMDkyIiB5MT0iNDguOTQwOSIgeDI9IjIwLjY3MzQiIHkyPSI2NS40MDUiIGdyYWRpZW50VHJhbnNmb3JtPSJtYXRyaXgoMSAwIDAgLTEgMCA2MSkiPg0KCQk8c3RvcCAgb2Zmc2V0PSIwLjExODMiIHN0eWxlPSJzdG9wLWNvbG9yOiMwMDk1RDUiLz4NCgkJPHN0b3AgIG9mZnNldD0iMC40MTc4IiBzdHlsZT0ic3RvcC1jb2xvcjojM0M4M0RDIi8+DQoJCTxzdG9wICBvZmZzZXQ9IjAuNjk2MiIgc3R5bGU9InN0b3AtY29sb3I6IzZENzRFMSIvPg0KCQk8c3RvcCAgb2Zmc2V0PSIwLjgzMzMiIHN0eWxlPSJzdG9wLWNvbG9yOiM4MDZFRTMiLz4NCgk8L2xpbmVhckdyYWRpZW50Pg0KCTxwb2x5Z29uIHN0eWxlPSJmaWxsOnVybCgjU1ZHSURfMV8pOyIgcG9pbnRzPSIwLDAgMzAuMSwwIDAsMzIuNSAJIi8+DQogICAgPGxpbmVhckdyYWRpZW50IGlkPSJTVkdJRF8yXyIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiIHgxPSItMTAuMTAxNyIgeTE9IjUuODM2MiIgeDI9IjQ1LjczMTUiIHkyPSI2MS42Njk0IiBncmFkaWVudFRyYW5zZm9ybT0ibWF0cml4KDEgMCAwIC0xIDAgNjEpIj4NCgkJPHN0b3AgIG9mZnNldD0iMC4xMDc1IiBzdHlsZT0ic3RvcC1jb2xvcjojQzc1N0JDIi8+DQoJCTxzdG9wICBvZmZzZXQ9IjAuMjEzOCIgc3R5bGU9InN0b3AtY29sb3I6I0QwNjA5QSIvPg0KCQk8c3RvcCAgb2Zmc2V0PSIwLjQyNTQiIHN0eWxlPSJzdG9wLWNvbG9yOiNFMTcyNUMiLz4NCgkJPHN0b3AgIG9mZnNldD0iMC42MDQ4IiBzdHlsZT0ic3RvcC1jb2xvcjojRUU3RTJGIi8+DQoJCTxzdG9wICBvZmZzZXQ9IjAuNzQzIiBzdHlsZT0ic3RvcC1jb2xvcjojRjU4NjEzIi8+DQoJCTxzdG9wICBvZmZzZXQ9IjAuODIzMiIgc3R5bGU9InN0b3AtY29sb3I6I0Y4ODkwOSIvPg0KCTwvbGluZWFyR3JhZGllbnQ+DQoJPHBvbHlnb24gc3R5bGU9ImZpbGw6dXJsKCNTVkdJRF8yXyk7IiBwb2ludHM9IjMwLjEsMCAwLDMxLjcgMCw2MCAzMC4xLDI5LjkgNjAsMCAJIi8+DQo8L2c+DQo8L3N2Zz4=');
    background-position: 17px 80%;
    background-repeat: no-repeat;
    background-size: 11px 11px;
    padding-left: 2.3em;
}

.multi-language-selector {
    display: block;
}

.multi-language-selector .language-option[data-lang='groovy'] {
    background-position: 20px center;
    padding-left: 32px;
}

.multi-language-selector .language-option[data-lang='kotlin'] {
    background-position: 30px center;
    padding-left: 27px;
}

.multi-language-selector .language-option {
    background-color: white;
    border: 1px solid #f7f7f8;
    border-radius: 4px 4px 0 0;
    cursor: pointer;
    display: inline-block;
    font-weight: normal;
    font-family: 'Lato', Arial, sans-serif;
    margin: 0;
    padding: 4px 20px;
    min-width: 130px;
    max-width: 320px;
    text-align: center;
    filter: grayscale(1);
    -webkit-filter: grayscale(1);
    opacity: 0.7;
}

.multi-language-selector .language-option.selected {
    background-color: #f7f7f8;
    color: #02303a;
    filter: none;
    -webkit-filter: none;
    opacity: 1;
}

.multi-language-text.hidden,
.multi-language-selector ~ .multi-language-sample.hidden {
    display: none;
}

.multi-language-sample {
    border-radius: 0 0 4px 4px;
}
</style><script type="text/javascript">function postProcessCodeBlocks() {
    // Assumptions:
    //  1) All siblings that are marked with class="multi-language-sample" should be grouped
    //  2) Only one language can be selected per domain (to allow selection to persist across all docs pages)
    //  3) There is exactly 1 small set of languages to choose from. This does not allow for multiple language preferences. For example, users cannot prefer both Kotlin and ZSH.
    //  4) Only 1 sample of each language can exist in the same collection.

    var GRADLE_DSLs = ["groovy", "kotlin"];
    var preferredBuildScriptLanguage = initPreferredBuildScriptLanguage();

    // Ensure preferred DSL is valid, defaulting to Groovy DSL
    function initPreferredBuildScriptLanguage() {
        var lang = window.localStorage.getItem("preferred-gradle-dsl");
        if (GRADLE_DSLs.indexOf(lang) === -1) {
            window.localStorage.setItem("preferred-gradle-dsl", "groovy");
            lang = "groovy";
        }
        return lang;
    }

    function capitalizeFirstLetter(string) {
        return string.charAt(0).toUpperCase() + string.slice(1);
    }

    function processSampleEl(sampleEl, prefLangId) {
        var codeEl = sampleEl.querySelector("code[data-lang]");
        if (codeEl != null) {
            sampleEl.setAttribute("data-lang", codeEl.getAttribute("data-lang"));
            if (codeEl.getAttribute("data-lang") !== prefLangId) {
                sampleEl.classList.add("hidden");
            } else {
                sampleEl.classList.remove("hidden");
            }
        }
    }

    function switchSampleLanguage(languageId) {
        var multiLanguageSampleElements = [].slice.call(document.querySelectorAll(".multi-language-sample"));

        // Array of Arrays, each top-level array representing a single collection of samples
        var multiLanguageSets = [];
        for (var i = 0; i < multiLanguageSampleElements.length; i++) {
            var currentCollection = [multiLanguageSampleElements[i]];
            var currentSampleElement = multiLanguageSampleElements[i];
            processSampleEl(currentSampleElement, languageId);
            while (currentSampleElement.nextElementSibling != null && currentSampleElement.nextElementSibling.classList.contains("multi-language-sample")) {
                currentCollection.push(currentSampleElement.nextElementSibling);
                currentSampleElement = currentSampleElement.nextElementSibling;
                processSampleEl(currentSampleElement, languageId);
                i++;
            }

            multiLanguageSets.push(currentCollection);
        }

        multiLanguageSets.forEach(function (sampleCollection) {
            // Create selector element if not existing
            if (sampleCollection.length > 1 &&
                (sampleCollection[0].previousElementSibling == null ||
                    !sampleCollection[0].previousElementSibling.classList.contains("multi-language-selector"))) {
                var languageSelectorFragment = document.createDocumentFragment();
                var multiLanguageSelectorElement = document.createElement("div");
                multiLanguageSelectorElement.classList.add("multi-language-selector");
                languageSelectorFragment.appendChild(multiLanguageSelectorElement);


                sampleCollection.forEach(function (sampleEl) {
                    var optionEl = document.createElement("code");
                    var sampleLanguage = sampleEl.getAttribute("data-lang");
                    optionEl.setAttribute("data-lang", sampleLanguage);
                    optionEl.setAttribute("role", "button");
                    optionEl.classList.add("language-option");

                    optionEl.innerText = capitalizeFirstLetter(sampleLanguage);

                    optionEl.addEventListener("click", function updatePreferredLanguage(evt) {
                        var preferredLanguageId = optionEl.getAttribute("data-lang");
                        window.localStorage.setItem("preferred-gradle-dsl", preferredLanguageId);

                        // Record how far down the page the clicked element is before switching all samples
                        var beforeOffset = evt.target.offsetTop;

                        switchSampleLanguage(preferredLanguageId);

                        // Scroll the window to account for content height differences between different sample languages
                        window.scrollBy(0, evt.target.offsetTop - beforeOffset);
                    });
                    multiLanguageSelectorElement.appendChild(optionEl);
                });
                sampleCollection[0].parentNode.insertBefore(languageSelectorFragment, sampleCollection[0]);
            }
        });

        [].slice.call(document.querySelectorAll(".multi-language-selector .language-option")).forEach(function (optionEl) {
            if (optionEl.getAttribute("data-lang") === languageId) {
                optionEl.classList.add("selected");
            } else {
                optionEl.classList.remove("selected");
            }
        });

        [].slice.call(document.querySelectorAll(".multi-language-text")).forEach(function (el) {
            if (!el.classList.contains("lang-" + languageId)) {
                el.classList.add("hidden");
            } else {
                el.classList.remove("hidden");
            }
        });
    }

    switchSampleLanguage(preferredBuildScriptLanguage);
}

document.addEventListener("DOMContentLoaded", function () {
    postProcessCodeBlocks();
});
</script>
</head>
<body class="book">
<header class="site-layout__header site-header" itemscope="itemscope" itemtype="https://schema.org/WPHeader">
    <nav class="site-header__navigation" itemscope="itemscope" itemtype="https://schema.org/SiteNavigationElement">
        <div class="site-header__navigation-header">
            <a target="_top" class="logo" href="https://docs.gradle.org" title="Gradle Docs">
                <svg width="139px" height="43px" viewBox="0 0 278 86" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <defs>
                        <style>.cls-1 {
                            fill: #02303a;
                        }</style>
                    </defs>
                    <title>Gradle</title>
                    <path class="cls-1"
                          d="M155,56.32V70.27a18.32,18.32,0,0,1-5.59,2.83,21.82,21.82,0,0,1-6.36.89,21.08,21.08,0,0,1-7.64-1.31A17.12,17.12,0,0,1,129.59,69a16.14,16.14,0,0,1-3.73-5.58,18.78,18.78,0,0,1-1.31-7.08,19.58,19.58,0,0,1,1.26-7.14A15.68,15.68,0,0,1,135,40a20.39,20.39,0,0,1,7.45-1.29,22,22,0,0,1,3.92.33,20.43,20.43,0,0,1,3.39.92,15.16,15.16,0,0,1,2.85,1.42A17.3,17.3,0,0,1,155,43.25l-1.84,2.91a1.72,1.72,0,0,1-1.12.84,2,2,0,0,1-1.5-.34L149,45.75a10.49,10.49,0,0,0-1.75-.79,14.33,14.33,0,0,0-2.17-.54,15.29,15.29,0,0,0-2.78-.22,11.91,11.91,0,0,0-4.61.86,9.66,9.66,0,0,0-3.52,2.46,10.9,10.9,0,0,0-2.24,3.84,14.88,14.88,0,0,0-.79,5,15.23,15.23,0,0,0,.85,5.28,11.06,11.06,0,0,0,2.38,3.94A10.15,10.15,0,0,0,138.05,68a14.28,14.28,0,0,0,8.25.44,17.1,17.1,0,0,0,2.94-1.09V61.14h-4.35a1.3,1.3,0,0,1-1-.35,1.15,1.15,0,0,1-.35-.85V56.32Zm10.47-2.93a10.53,10.53,0,0,1,2.72-3.45,5.77,5.77,0,0,1,3.72-1.25,4.5,4.5,0,0,1,2.72.74l-.38,4.41a1.18,1.18,0,0,1-.34.61,1,1,0,0,1-.61.18,6.76,6.76,0,0,1-1.06-.12,8.22,8.22,0,0,0-1.38-.12,5,5,0,0,0-1.74.28,4.37,4.37,0,0,0-1.37.83,5.55,5.55,0,0,0-1.07,1.3,12.26,12.26,0,0,0-.87,1.74V73.61H160V49.14h3.45a1.94,1.94,0,0,1,1.27.32,1.9,1.9,0,0,1,.48,1.16Zm11.36-.84A14.49,14.49,0,0,1,187,48.69a9.92,9.92,0,0,1,3.84.7,8.06,8.06,0,0,1,2.86,2,8.38,8.38,0,0,1,1.78,3,11.64,11.64,0,0,1,.61,3.82V73.61h-2.68a2.64,2.64,0,0,1-1.28-.25,1.72,1.72,0,0,1-.72-1l-.52-1.77a20.25,20.25,0,0,1-1.82,1.47,10.86,10.86,0,0,1-1.83,1.06,10.36,10.36,0,0,1-2,.66,12,12,0,0,1-2.4.22,9.64,9.64,0,0,1-2.86-.41,6.28,6.28,0,0,1-2.27-1.26,5.6,5.6,0,0,1-1.48-2.07,7.38,7.38,0,0,1-.52-2.89,5.7,5.7,0,0,1,.31-1.85,5.3,5.3,0,0,1,1-1.75,8.25,8.25,0,0,1,1.83-1.57,11.17,11.17,0,0,1,2.75-1.29,23.28,23.28,0,0,1,3.81-.9,36.77,36.77,0,0,1,5-.41V58.16a5.35,5.35,0,0,0-1.05-3.64,3.83,3.83,0,0,0-3-1.18,7.3,7.3,0,0,0-2.38.33,9.39,9.39,0,0,0-1.65.75l-1.3.75a2.52,2.52,0,0,1-1.3.34,1.7,1.7,0,0,1-1.05-.32,2.61,2.61,0,0,1-.69-.76Zm13.5,10.61a31.66,31.66,0,0,0-4.3.45,11,11,0,0,0-2.79.82,3.57,3.57,0,0,0-1.5,1.17,2.89,2.89,0,0,0,.47,3.67,3.93,3.93,0,0,0,2.39.67,7,7,0,0,0,3.14-.66,9.52,9.52,0,0,0,2.59-2Zm32.53-25V73.61h-3.6a1.39,1.39,0,0,1-1.48-1.07l-.5-2.36a12.4,12.4,0,0,1-3.4,2.74,9.17,9.17,0,0,1-4.47,1,7.95,7.95,0,0,1-6.55-3.26A11.61,11.61,0,0,1,201,66.79a19.71,19.71,0,0,1-.66-5.34,16.77,16.77,0,0,1,.74-5.06,12.21,12.21,0,0,1,2.13-4,9.88,9.88,0,0,1,3.31-2.69,9.64,9.64,0,0,1,4.34-1,8.63,8.63,0,0,1,3.51.64,9,9,0,0,1,2.6,1.74V38.17ZM217,55.39a5.94,5.94,0,0,0-2.18-1.72,6.54,6.54,0,0,0-2.54-.5,5.68,5.68,0,0,0-2.41.5A4.87,4.87,0,0,0,208,55.19a7.19,7.19,0,0,0-1.17,2.57,14.83,14.83,0,0,0-.4,3.69,16.34,16.34,0,0,0,.34,3.63,7.14,7.14,0,0,0,1,2.44,3.79,3.79,0,0,0,1.58,1.36,5,5,0,0,0,2.07.41,6,6,0,0,0,3.13-.76A9.19,9.19,0,0,0,217,66.36Zm17.67-17.22V73.61h-5.89V38.17ZM245.1,62.11a11.37,11.37,0,0,0,.67,3.26,6.54,6.54,0,0,0,1.38,2.27,5.39,5.39,0,0,0,2,1.33,7.26,7.26,0,0,0,2.61.44,8.21,8.21,0,0,0,2.47-.33,11.51,11.51,0,0,0,1.81-.74c.52-.27,1-.52,1.36-.74a2.31,2.31,0,0,1,1.13-.33,1.21,1.21,0,0,1,1.1.55L261.36,70a9.45,9.45,0,0,1-2.19,1.92,12.18,12.18,0,0,1-2.54,1.24,14,14,0,0,1-2.7.66,18.78,18.78,0,0,1-2.65.19,12.93,12.93,0,0,1-4.75-.85,10.65,10.65,0,0,1-3.82-2.5,11.8,11.8,0,0,1-2.55-4.1,15.9,15.9,0,0,1-.93-5.67,13.55,13.55,0,0,1,.81-4.71,11.34,11.34,0,0,1,2.33-3.84,11,11,0,0,1,3.69-2.59,12.31,12.31,0,0,1,4.93-1,11.86,11.86,0,0,1,4.27.74,9.25,9.25,0,0,1,3.36,2.16,9.84,9.84,0,0,1,2.21,3.48,13,13,0,0,1,.8,4.71,3.82,3.82,0,0,1-.29,1.8,1.19,1.19,0,0,1-1.1.46Zm11.23-3.55A7.28,7.28,0,0,0,256,56.4a5.16,5.16,0,0,0-1-1.77,4.44,4.44,0,0,0-1.63-1.21,5.68,5.68,0,0,0-2.3-.44,5.46,5.46,0,0,0-4,1.45,7.13,7.13,0,0,0-1.87,4.13ZM112.26,14a13.72,13.72,0,0,0-19.08-.32,1.27,1.27,0,0,0-.41.93,1.31,1.31,0,0,0,.38.95l1.73,1.73a1.31,1.31,0,0,0,1.71.12,7.78,7.78,0,0,1,4.71-1.57,7.87,7.87,0,0,1,5.57,13.43C96,40.2,81.41,9.66,48.4,25.37a4.48,4.48,0,0,0-2,6.29l5.66,9.79a4.49,4.49,0,0,0,6.07,1.67l.14-.08-.11.08,2.51-1.41a57.72,57.72,0,0,0,7.91-5.89,1.37,1.37,0,0,1,1.8-.06h0a1.29,1.29,0,0,1,0,2A59.79,59.79,0,0,1,62.11,44l-.09.05-2.51,1.4a7,7,0,0,1-3.47.91,7.19,7.19,0,0,1-6.23-3.57l-5.36-9.24C34.17,40.81,27.93,54.8,31.28,72.5a1.31,1.31,0,0,0,1.29,1.06h6.09A1.3,1.3,0,0,0,40,72.42a8.94,8.94,0,0,1,17.73,0A1.3,1.3,0,0,0,59,73.56h5.94a1.31,1.31,0,0,0,1.3-1.14,8.93,8.93,0,0,1,17.72,0,1.3,1.3,0,0,0,1.29,1.14h5.87a1.3,1.3,0,0,0,1.3-1.28c.14-8.28,2.37-17.79,8.74-22.55C123.15,33.25,117.36,19.12,112.26,14ZM89.79,38.92l-4.2-2.11h0a2.64,2.64,0,1,1,4.2,2.12Z"/>
                </svg>
            </a>
            <div class="site-header__doc-type sr-only">User Manual</div>
            <div class="site-header-version"></div>
            <button type="button" aria-label="Navigation Menu" class="site-header__navigation-button hamburger">
                <span class="hamburger__bar"></span>
                <span class="hamburger__bar"></span>
                <span class="hamburger__bar"></span>
            </button>
        </div>
        <div class="site-header__navigation-collapsible site-header__navigation-collapsible--collapse">
            <ul class="site-header__navigation-items">
                <li class="site-header__navigation-item site-header__navigation-submenu-section" tabindex="0">
                    <span class="site-header__navigation-link">
                        Community
                        <svg class="site-header__down-arrow site-header__icon-light" width="19" height="11" viewBox="0 0 19 11" xmlns="http://www.w3.org/2000/svg"><title>Open Community Menu</title><path transform="rotate(-180 9.374 5.494)" d="M17.9991 10.422825L9.3741 0.565575 0.7491 10.422825" stroke="#02303A" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/></svg>
                    </span>
                    <div class="site-header__navigation-submenu">
                        <div class="site-header__navigation-submenu-item" itemprop="name">
                            <a target="_top" class="site-header__navigation-submenu-item-link" href="https://gradle.org/" itemprop="url">
                                <span class="site-header__navigation-submenu-item-link-text">Community Home</span>
                            </a>
                        </div>
                        <div class="site-header__navigation-submenu-item" itemprop="name">
                            <a target="_top" class="site-header__navigation-submenu-item-link" href="https://discuss.gradle.org/" itemprop="url">
                                <span class="site-header__navigation-submenu-item-link-text">Community Forums</span>
                            </a>
                        </div>
                        <div class="site-header__navigation-submenu-item" itemprop="name">
                            <a target="_top" class="site-header__navigation-submenu-item-link" href="https://plugins.gradle.org" itemprop="url">
                                <span class="site-header__navigation-submenu-item-link-text">Community Plugins</span>
                            </a>
                        </div>
                    </div>
                </li>
                <li class="site-header__navigation-item" itemprop="name">
                    <a target="_top" class="site-header__navigation-link" href="https://gradle.com/training/" itemprop="url">Training</a>
                </li>
                <li class="site-header__navigation-item site-header__navigation-submenu-section" tabindex="0">
                    <span class="site-header__navigation-link">
                        News
                        <svg class="site-header__down-arrow site-header__icon-light" width="19" height="11" viewBox="0 0 19 11" xmlns="http://www.w3.org/2000/svg"><title>Open Community Menu</title><path transform="rotate(-180 9.374 5.494)" d="M17.9991 10.422825L9.3741 0.565575 0.7491 10.422825" stroke="#02303A" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/></svg>
                    </span>
                    <div class="site-header__navigation-submenu">
                        <div class="site-header__navigation-submenu-item" itemprop="name">
                            <a class="site-header__navigation-submenu-item-link" href="https://newsletter.gradle.com" itemprop="url">
                                <span class="site-header__navigation-submenu-item-link-text">Newsletter</span>
                            </a>
                        </div>
                        <div class="site-header__navigation-submenu-item" itemprop="name">
                            <a class="site-header__navigation-submenu-item-link" href="https://blog.gradle.org" itemprop="url">
                                <span class="site-header__navigation-submenu-item-link-text">Blog</span>
                            </a>
                        </div>
                        <div class="site-header__navigation-submenu-item">
                            <a class="site-header__navigation-submenu-item-link" href="https://twitter.com/gradle">
                                <span class="site-header__navigation-submenu-item-link-text">Twitter</span>
                            </a>
                        </div>
                    </div>
                </li>
                <li class="site-header__navigation-item" itemprop="name">
                    <a target="_top" class="site-header__navigation-link" href="https://gradle.com" itemprop="url">Enterprise</a>
                </li>
                <li class="site-header__navigation-item">
                    <a class="site-header__navigation-link" title="Gradle on GitHub" href="https://github.com/gradle/gradle"><svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><title>github</title><path d="M10 0C4.477 0 0 4.477 0 10c0 4.418 2.865 8.166 6.839 9.489.5.092.682-.217.682-.482 0-.237-.008-.866-.013-1.7-2.782.603-3.369-1.342-3.369-1.342-.454-1.155-1.11-1.462-1.11-1.462-.908-.62.069-.608.069-.608 1.003.07 1.531 1.03 1.531 1.03.892 1.529 2.341 1.087 2.91.831.092-.646.35-1.086.636-1.336-2.22-.253-4.555-1.11-4.555-4.943 0-1.091.39-1.984 1.029-2.683-.103-.253-.446-1.27.098-2.647 0 0 .84-.268 2.75 1.026A9.578 9.578 0 0 1 10 4.836c.85.004 1.705.114 2.504.337 1.909-1.294 2.747-1.026 2.747-1.026.546 1.377.203 2.394.1 2.647.64.699 1.028 1.592 1.028 2.683 0 3.842-2.339 4.687-4.566 4.935.359.309.678.919.678 1.852 0 1.336-.012 2.415-.012 2.743 0 .267.18.579.688.481C17.137 18.163 20 14.418 20 10c0-5.523-4.478-10-10-10" fill="#02303A" fill-rule="evenodd"/></svg></a>
                </li>
            </ul>
        </div>
    </nav>
</header>

<main class="main-content">
    <!-- Primary Navigation -->
    <nav class="docs-navigation">
        <div class="search-container">
            <input type="search" name="q" id="search-input" class="search-input" placeholder="Search the docs"/>
        </div>
        <ul>
            <li><a href="../userguide/userguide.html">Docs Home</a></li>
            <li><a href="https://guides.gradle.org">Tutorials</a></li>
            <li><a href="../samples/index.html">Samples</a></li>
            <li><a href="../release-notes.html">Release Notes</a></li>
            <li><a class="nav-dropdown" data-toggle="collapse" href="#gradle-api" aria-expanded="false" aria-controls="gradle-api">Gradle API</a>
                <ul id="gradle-api">
                    <li><a href="../javadoc/index.html?overview-summary.html">Javadoc</a></li>
                    <li><a href="../dsl/index.html">Groovy DSL Reference</a></li>
                    <li><a href="../userguide/groovy_build_script_primer.html">Groovy DSL Primer</a></li>
                    <li><a href="https://gradle.github.io/kotlin-dsl-docs/api/" target="_blank">Kotlin DSL API</a></li>
                    <li><a href="../userguide/kotlin_dsl.html">Kotlin DSL Primer</a></li>
                </ul>
            </li>
        </ul>

        <h3 id="user-manual">User Manual </h3>
        <div class="docs-home-link">
            <div class="pdf-link-container">
                <a href="../userguide/userguide.pdf">
                    <svg width="10px" height="12px" viewBox="0 0 10 12" version="1.1" xmlns="http://www.w3.org/2000/svg"><path d="M6.01302083,0.857142857 C6.2421875,0.857142857 6.4296875,1.05 6.4296875,1.28571429 L6.4296875,5.14285714 L8.875,5.14285714 C9.05989583,5.14285714 9.15364583,5.37321429 9.0234375,5.50714286 L5.29427083,9.35357143 C5.13020833,9.52232143 4.8671875,9.52232143 4.703125,9.35357143 L0.979166667,5.50714286 C0.848958333,5.37321429 0.940104167,5.14285714 1.12760417,5.14285714 L3.57291667,5.14285714 L3.57291667,1.28571429 C3.57291667,1.05 3.76041667,0.857142857 3.98958333,0.857142857 L6.01302083,0.857142857 Z M6.01302083,0 L3.98958333,0 C3.29947917,0 2.73958333,0.575892857 2.73958333,1.28571429 L2.73958333,4.28571429 L1.12760417,4.28571429 C0.203125,4.28571429 -0.265625,5.4375 0.390625,6.1125 L4.11458333,9.95892857 C4.60416667,10.4625 5.39583333,10.4625 5.88541667,9.95892857 L9.61197917,6.11517857 C10.265625,5.44285714 9.80208333,4.28839286 8.875,4.28839286 L7.26302083,4.28839286 L7.26302083,1.28571429 C7.26302083,0.575892857 6.70052083,0 6.01302083,0 Z M10,11.6785714 L10,11.4642857 C10,11.2875 9.859375,11.1428571 9.6875,11.1428571 L0.3125,11.1428571 C0.140625,11.1428571 0,11.2875 0,11.4642857 L0,11.6785714 C0,11.8553571 0.140625,12 0.3125,12 L9.6875,12 C9.859375,12 10,11.8553571 10,11.6785714 Z"></path></svg>
                    PDF
                </a>
            </div>
        </div>
        <ul>
            <li><a href="../userguide/getting_started.html">Getting Started</a></li>
            <li><a href="../userguide/installation.html">Installing Gradle</a></li>
            <li><a class="nav-dropdown" data-toggle="collapse" href="#upgrading-gradle" aria-expanded="false" aria-controls="upgrading-gradle">Upgrading Gradle...</a>
                <ul id="upgrading-gradle">
                    <li><a href="../userguide/upgrading_version_6.html">version 6.X to latest</a></li>
                    <li><a href="../userguide/upgrading_version_5.html">version 5.X to 6.0</a></li>
                    <li><a href="../userguide/upgrading_version_4.html">version 4.X to 5.0</a></li>
                    <li><a href="../userguide/feature_lifecycle.html">Gradle's Feature Lifecycle</a></li>
                </ul>
            </li>
            <li><a class="nav-dropdown" data-toggle="collapse" href="#migrating-to-gradle" aria-expanded="false" aria-controls="migrating-to-gradle">Migrating to Gradle...</a>
                <ul id="migrating-to-gradle">
                    <li><a href="../userguide/migrating_from_maven.html">from Maven</a></li>
                    <li><a href="../userguide/migrating_from_ant.html">from Ant</a></li>
                </ul>
            </li>
            <li><a href="../userguide/compatibility.html">Compatibility Notes</a></li>
            <li><a href="../userguide/troubleshooting.html">Troubleshooting Builds</a></li>
        </ul>

        <h3 id="running-gradle-builds">Running Gradle Builds</h3>
        <ul>
            <li><a class="nav-dropdown" data-toggle="collapse" href="#customizing-execution" aria-expanded="false" aria-controls="customizing-execution">Customizing Execution</a>
                <ul id="customizing-execution">
                    <li><a href="../userguide/build_environment.html">Configuring the Build Environment</a></li>
                    <li><a href="../userguide/gradle_daemon.html">Configuring the Gradle Daemon</a></li>
                    <li><a href="../userguide/init_scripts.html">Using Initialization Scripts</a></li>
                </ul>
            </li>
            <li><a href="../userguide/intro_multi_project_builds.html">Executing Multi-Project Builds</a></li>
            <li><a href="https://guides.gradle.org/creating-build-scans/">Inspecting Gradle Builds</a></li>
            <li><a class="nav-dropdown" data-toggle="collapse" href="#optimizing-build-performance" aria-expanded="false" aria-controls="optimizing-build-performance">Optimizing Build Times</a>
                <ul id="optimizing-build-performance">
                    <li><a href="https://guides.gradle.org/performance/">Build Performance Guide</a></li>
                    <li><a href="../userguide/build_cache.html">Enabling and Configuring the Build Cache</a></li>
                </ul>
            </li>
        </ul>

        <h3 id="authoring-gradle-builds">Authoring Gradle Builds</h3>
        <ul>
            <li><a class="nav-dropdown" data-toggle="collapse" href="#learning-the-basics" aria-expanded="false" aria-controls="learning-the-basics">Learning the Basics</a>
                <ul id="learning-the-basics">
                    <li><a href="../userguide/tutorial_using_tasks.html">Introducing the Basics of Build Scripts</a></li>
                    <li><a href="../userguide/more_about_tasks.html">Working with Tasks</a></li>
                    <li><a href="../userguide/writing_build_scripts.html">Learning More About Build Scripts</a></li>
                    <li><a href="../userguide/working_with_files.html">Working with Files</a></li>
                    <li><a href="../userguide/plugins.html">Using Gradle Plugins</a></li>
                    <li><a href="../userguide/build_lifecycle.html">Understanding the Build Lifecycle</a></li>
                    <li><a href="../userguide/logging.html">Working with Logging</a></li>
                    <li><a href="../userguide/multi_project_builds.html">Configuring Multi-Project Builds</a></li>
                    <li><a href="../userguide/potential_traps.html">Avoiding Traps</a></li>
                </ul>
            </li>
            <li><a class="nav-dropdown" data-toggle="collapse" href="#authoring-sustainable-builds" aria-expanded="false" aria-controls="authoring-sustainable-builds">Authoring Sustainable Builds</a>
                <ul id="authoring-sustainable-builds">
                    <li><a href="../userguide/organizing_gradle_projects.html">Organizing Build Logic</a></li>
                    <li><a href="../userguide/authoring_maintainable_build_scripts.html">Following Best Practices</a></li>
                </ul>
            </li>
            <li><a class="nav-dropdown" data-toggle="collapse" href="#advanced-techniques" aria-expanded="false" aria-controls="advanced-techniques">Advanced Techniques</a>
            <ul id="advanced-techniques">
                <li><a href="https://guides.gradle.org/using-the-worker-api/">Developing Parallel Tasks</a></li>
                <li><a href="../userguide/test_kit.html">Testing a Build with TestKit</a></li>
                <li><a href="../userguide/ant.html">Using Ant from Gradle</a></li>
            </ul>
        </ul>

        <h3 id="authoring-gradle-builds-java">Authoring JVM Builds</h3>
        <ul>
            <li><a href="../userguide/building_java_projects.html">Building Java &amp; JVM projects</a></li>
            <li><a href="../userguide/java_testing.html">Testing Java &amp; JVM projects</a></li>
            <li><a href="../userguide/dependency_management_for_java_projects.html">Managing Dependencies</a></li>
            <li><a class="nav-dropdown" data-toggle="collapse" href="#jvm-plugins" aria-expanded="false" aria-controls="jvm-plugins">JVM Plugins</a>
                <ul id="jvm-plugins">
                    <li><a href="../userguide/java_library_plugin.html">Java Library Plugin</a></li>
                    <li><a href="../userguide/application_plugin.html">Java Application Plugin</a></li>
                    <li><a href="../userguide/java_platform_plugin.html">Java Platform Plugin</a></li>
                    <li><a href="../userguide/groovy_plugin.html">Groovy Plugin</a></li>
                    <li><a href="../userguide/scala_plugin.html">Scala Plugin</a></li>
                </ul>
            </li>
        </ul>

        <h3 id="authoring-gradle-builds-native">Authoring C++/Swift Builds</h3>
        <ul>
            <li><a href="../userguide/building_cpp_projects.html">Building C++ projects</a></li>
            <li><a href="../userguide/cpp_testing.html">Testing C++ projects</a></li>
            <li><a href="../userguide/building_swift_projects.html">Building Swift projects</a></li>
            <li><a href="../userguide/swift_testing.html">Testing Swift projects</a></li>
        </ul>

        <h3 id="managing-dependencies">Working with Dependencies</h3>
        <ul>
            <li><a class="nav-dropdown" data-toggle="collapse" href="#learning-the-basics-dependency-management" aria-expanded="false" aria-controls="learning-the-basics-dependency-management">Learning the Basics</a>
                <ul id="learning-the-basics-dependency-management">
                    <li><a href="../userguide/core_dependency_management.html">What is Dependency Management?</a></li>
                    <li><a href="../userguide/declaring_repositories.html">Declaring Repositories</a></li>
                    <li><a href="../userguide/declaring_dependencies.html">Declaring Dependencies</a></li>
                    <li><a href="../userguide/library_vs_application.html">Understanding Library and Application Differences</a></li>
                    <li><a href="../userguide/viewing_debugging_dependencies.html">Viewing and Debugging Dependencies</a></li>
                    <li><a href="../userguide/dependency_resolution.html">Understanding Resolution</a></li>
                    <li><a href="../userguide/dependency_verification.html">Verifying dependencies</a></li>
                </ul>
            </li>
            <li><a class="nav-dropdown" data-toggle="collapse" href="#declaring-dependency-versions" aria-expanded="false" aria-controls="declaring-dependency-versions">Declaring Versions</a>
                <ul id="declaring-dependency-versions">
                    <li><a href="../userguide/single_versions.html">Declaring Versions and Ranges</a></li>
                    <li><a href="../userguide/rich_versions.html">Declaring Rich Versions</a></li>
                    <li><a href="../userguide/dynamic_versions.html">Handling Changing Versions</a></li>
                    <li><a href="../userguide/dependency_locking.html">Locking Versions</a></li>
                </ul>
            </li>
            <li><a class="nav-dropdown" data-toggle="collapse" href="#controlling-transitive-dependencies" aria-expanded="false" aria-controls="controlling-transitive-dependencies">Controlling Transitives</a>
                <ul id="controlling-transitive-dependencies">
                    <li><a href="../userguide/dependency_constraints.html">Upgrading Versions</a></li>
                    <li><a href="../userguide/dependency_downgrade_and_exclude.html">Downgrading and Excluding</a></li>
                    <li><a href="../userguide/platforms.html">Sharing Versions</a></li>
                    <li><a href="../userguide/dependency_version_alignment.html">Aligning Dependencies</a></li>
                    <li><a href="../userguide/dependency_capability_conflict.html">Handling Mutually Exclusive Dependencies</a></li>
                    <li><a href="../userguide/component_metadata_rules.html">Fixing Metadata</a></li>
                    <li><a href="../userguide/resolution_rules.html">Customizing Resolution</a></li>
                    <li><a href="../userguide/resolution_strategy_tuning.html">Preventing accidental upgrades</a></li>
                </ul>
            </li>
            <li><a class="nav-dropdown" data-toggle="collapse" href="#modeling-features" aria-expanded="false" aria-controls="modeling-features">Producing and Consuming Variants of Libraries</a>
                <ul id="modeling-features">
                    <li><a href="../userguide/component_capabilities.html">Declaring Capabilities of a Library</a></li>
                    <li><a href="../userguide/feature_variants.html">Modeling Feature Variants and Optional Dependencies</a></li>
                    <li><a href="../userguide/variant_model.html">Understanding Variant Selection</a></li>
                    <li><a href="../userguide/variant_attributes.html">Declaring Variant Attributes</a></li>
                    <li><a href="../userguide/cross_project_publications.html">Sharing Outputs of Projects</a></li>
                    <li><a href="../userguide/artifact_transforms.html">Transforming Artifacts</a></li>
                </ul>
            </li>
            <li><a class="nav-dropdown" data-toggle="collapse" href="#multi-repo" aria-expanded="false" aria-controls="multi-repo">Working in a Multi-repo Environment</a>
                <ul id="multi-repo">
                    <li><a href="../userguide/composite_builds.html">Composing Builds</a></li>
                </ul>
            </li>
            <li><a class="nav-dropdown" data-toggle="collapse" href="#publishing" aria-expanded="false" aria-controls="publishing">Publishing Libraries</a>
                <ul id="publishing">
                    <li><a href="../userguide/publishing_setup.html">Setting up Publishing</a></li>
                    <li><a href="../userguide/publishing_gradle_module_metadata.html">Understanding Gradle Module Metadata</a></li>
                    <li><a href="../userguide/publishing_signing.html">Signing Artifacts</a></li>
                    <li><a href="../userguide/publishing_customization.html">Customizing Publishing</a></li>
                    <li><a href="../userguide/publishing_maven.html">Maven Publish Plugin</a></li>
                    <li><a href="../userguide/publishing_ivy.html">Ivy Publish Plugin</a></li>
                </ul>
            </li>
            <li><a href="../userguide/dependency_management_terminology.html">Terminology</a></li>
        </ul>

        <h3 id="extending-gradle">Extending Gradle</h3>
        <ul>
            <li><a href="https://gradle.org/guides/?q=Plugin%20Development">Plugin Development Tutorials</a></li>
            <li><a href="../userguide/custom_tasks.html">Writing Gradle Task Types</a></li>
            <li><a href="../userguide/custom_plugins.html">Writing Gradle Plugins</a></li>
            <li><a href="../userguide/custom_gradle_types.html">Writing Custom Gradle Types</a></li>
            <li><a href="../userguide/lazy_configuration.html">Configuring Tasks Lazily</a></li>
            <li><a href="../userguide/task_configuration_avoidance.html">Using Task Configuration Avoidance</a></li>
        </ul>

        <h3 id="reference">Reference</h3>
        <ul>
            <li><a href="../userguide/plugin_reference.html">Core Plugins</a></li>
            <li><a href="../userguide/command_line_interface.html">Command-Line Interface</a></li>
            <li id="third-party-integration"><a href="../userguide/third_party_integration.html">Gradle &amp; Third-party Tools</a></li>
            <li><a href="../userguide/gradle_wrapper.html">The Gradle Wrapper</a></li>
            <li><a href="../userguide/directory_layout.html">Gradle-managed Directories</a></li>
        </ul>
    </nav>
    <!-- End Primary Navigation -->
    <div class="chapter">
<div id="header">
<h1>Learning the Basics</h1>
<div class="details">
<span id="revnumber">version 6.4.1</span>
</div>
<div id="toc" class="toc">
<div id="toctitle">Contents</div>
<ul class="sectlevel1">
<li><a href="#dependency_management_in_gradle">Dependency management in Gradle</a></li>
<li><a href="#declaring-repositories">Declaring repositories</a></li>
<li><a href="#declaring-dependencies">Declaring dependencies</a></li>
<li><a href="#sec:understanding-diff-libraries-and-apps">Understanding the difference between libraries and applications</a></li>
<li><a href="#viewing-debugging-dependencies">Viewing and debugging dependencies</a></li>
<li><a href="#understanding_dependency_resolution">Understanding dependency resolution</a></li>
<li><a href="#verifying-dependencies">Verifying dependencies</a></li>
<li><a href="#declaring_versions">Declaring Versions</a>
<ul class="sectlevel1">
<li><a href="#single-version-declarations">Declaring Versions and Ranges</a></li>
<li><a href="#rich-version-constraints">Declaring Rich Versions</a></li>
<li><a href="#sec:dynamic_versions_and_changing_modules">Handling versions which change over time</a></li>
<li><a href="#dependency-locking">Locking dependency versions</a></li>
</ul>
</li>
<li><a href="#controlling_transitive_dependencies">Controlling Transitive Dependencies</a>
<ul class="sectlevel1">
<li><a href="#dependency-constraints">Upgrading versions of transitive dependencies</a></li>
<li><a href="#downgrading_versions_and_excluding_dependencies">Downgrading versions and excluding dependencies</a></li>
<li><a href="#sec:sharing-dep-versions-between-projects">Sharing dependency versions between projects</a></li>
<li><a href="#version_alignment">Aligning dependency versions</a></li>
<li><a href="#sec:handling-mutually-exclusive-deps">Handling mutually exclusive dependencies</a></li>
<li><a href="#sec:component_metadata_rules">Fixing metadata with component metadata rules</a></li>
<li><a href="#resolution_rules">Customizing resolution of a dependency directly</a></li>
</ul>
</li>
<li><a href="#producing_and_consuming_variants_of_libraries">Producing and Consuming Variants of Libraries</a>
<ul class="sectlevel1">
<li><a href="#declaring-component-capabilities">Declaring Capabilities of a Library</a></li>
<li><a href="#feature_variants">Modeling feature variants and optional dependencies</a></li>
<li><a href="#understanding-variant-selection">Understanding variant selection</a></li>
<li><a href="#variant_attributes">Working with Variant Attributes</a></li>
<li><a href="#cross_project_publications">Sharing outputs between projects</a></li>
<li><a href="#sec:abm_artifact_transforms">Transforming dependency artifacts on resolution</a></li>
</ul>
</li>
<li><a href="#working_in_a_multi_repo_environment">Working in a Multi-repo Environment</a>
<ul class="sectlevel1">
<li><a href="#composite_builds">Composing builds</a></li>
</ul>
</li>
<li><a href="#publishing_libraries">Publishing Libraries</a>
<ul class="sectlevel1">
<li><a href="#publishing_components">Publishing a project as module</a></li>
<li><a href="#sec:understanding-gradle-module-md">Understanding Gradle Module Metadata</a></li>
<li><a href="#publishing_maven:signing">Signing artifacts</a></li>
<li><a href="#customizing_publishing">Customizing publishing</a></li>
<li><a href="#dependency_management_terminology">Dependency Management Terminology</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="dependency_management_in_gradle"><a class="anchor" href="#dependency_management_in_gradle"></a><a class="link" href="#dependency_management_in_gradle">Dependency management in Gradle</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="what_is_dependency_management"><a class="anchor" href="#what_is_dependency_management"></a><a class="link" href="#what_is_dependency_management">What is dependency management?</a></h3>
<div class="paragraph">
<p>Software projects rarely work in isolation. In most cases, a project relies on reusable functionality in the form of libraries or is broken up into individual components to compose a modularized system. Dependency management is a technique for declaring, resolving and using dependencies required by the project in an automated fashion.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For a general overview on the terms used throughout the user guide, refer to <a href="#">Dependency Management Terminology</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="sec:dependency-mgmt-in-gradle"><a class="anchor" href="#sec:dependency-mgmt-in-gradle"></a><a class="link" href="#sec:dependency-mgmt-in-gradle">Dependency management in Gradle</a></h3>
<div class="paragraph">
<p>Gradle has built-in support for dependency management and lives up to the task of fulfilling typical scenarios encountered in modern software projects.
Well explore the main concepts with the help of an example project.
The illustration below should give you an rough overview on all the moving parts.</p>
</div>
<div class="imageblock inset">
<div class="content">
<img src="img/dependency-management-resolution.png" alt="dependency management resolution">
</div>
<div class="title">Figure 1. Dependency management big picture</div>
</div>
<div class="paragraph">
<p>The example project builds Java source code.
Some of the Java source files import classes from <a href="https://github.com/google/guava">Google Guava</a>, a open-source library providing a wealth of utility functionality.
In addition to Guava, the project needs the <a href="http://junit.org/junit5/">JUnit</a> libraries for compiling and executing test code.</p>
</div>
<div class="paragraph">
<p>Guava and JUnit represent the <em>dependencies</em> of this project.
A build script developer can <a href="#declaring-dependencies">declare dependencies</a> for different scopes e.g. just for compilation of source code or for executing tests.
In Gradle, the <a href="#sec:what-are-dependency-configurations">scope of a dependency</a> is called a <em>configuration</em>.
For a full overview, see the reference material on <a href="#sec:dependency-types">dependency types</a>.</p>
</div>
<div class="paragraph">
<p>Often times dependencies come in the form of <a href="#sub:terminology_module">modules</a>.
Youll need to tell Gradle where to find those modules so they can be consumed by the build.
The location for storing modules is called a <em>repository</em>.
By <a href="#declaring-repositories">declaring repositories</a> for a build, Gradle will know how to find and retrieve modules.
Repositories can come in different forms: as local directory or a remote repository.
The reference on <a href="#sec:repository-types">repository types</a> provides a broad coverage on this topic.</p>
</div>
<div class="paragraph">
<p>At runtime, Gradle will locate the declared dependencies if needed for operating a specific task.
The dependencies might need to be downloaded from a remote repository, retrieved from a local directory or requires another project to be built in a multi-project setting.
This process is called <em>dependency resolution</em>.
You can find a detailed discussion in <a href="#sec:how-gradle-downloads-deps">How Gradle downloads dependencies</a>.</p>
</div>
<div class="paragraph">
<p>Once resolved, the resolution mechanism <a href="#sec:dependency_cache">stores the underlying files of a dependency in a local cache</a>, also referred to as the <em>dependency cache</em>.
Future builds reuse the files stored in the cache to avoid unnecessary network calls.</p>
</div>
<div class="paragraph">
<p>Modules can provide additional metadata.
Metadata is the data that describes the module in more detail e.g. the coordinates for finding it in a repository, information about the project, or its authors.
As part of the metadata, a module can define that other modules are needed for it to work properly.
For example, the JUnit 5 platform module also requires the platform commons module.
Gradle automatically resolves those additional modules, so called <em>transitive dependencies</em>.
If needed, you can <a href="#">customize the behavior the handling of transitive dependencies</a> to your project&#8217;s requirements.</p>
</div>
<div class="paragraph">
<p>Projects with tens or hundreds of declared dependencies can easily suffer from dependency hell.
Gradle provides sufficient tooling to visualize, navigate and analyze the dependency graph of a project either with the help of a <a href="https://scans.gradle.com/get-started">build scan</a> or built-in tasks.
Learn more in <a href="#viewing-debugging-dependencies">Viewing and debugging dependencies</a>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/gradle-core-test-build-scan-dependencies.png" alt="gradle core test build scan dependencies">
</div>
<div class="title">Figure 2. Build scan dependencies report</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="declaring-repositories"><a class="anchor" href="#declaring-repositories"></a><a class="link" href="#declaring-repositories">Declaring repositories</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Gradle can resolve dependencies from one or many repositories based on Maven, Ivy or flat directory formats.
Check out the <a href="#sec:repository-types">full reference on all types of repositories</a> for more information.</p>
</div>
<div class="sect2">
<h3 id="sec:declaring_public_repository"><a class="anchor" href="#sec:declaring_public_repository"></a><a class="link" href="#sec:declaring_public_repository">Declaring a publicly-available repository</a></h3>
<div class="paragraph">
<p>Organizations building software may want to leverage public binary repositories to download and consume open source dependencies.
Popular public repositories include <a href="#sub:maven_central">Maven Central</a>, <a href="#sub:maven_jcenter">Bintray JCenter</a> and the <a href="#sub:maven_google">Google Android</a> repository.
Gradle provides built-in shorthand notations for these widely-used repositories.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/dependency-management-shortcut-repositories.png" alt="dependency management shortcut repositories">
</div>
<div class="title">Figure 3. Declaring a repository with the help of shorthand notations</div>
</div>
<div class="paragraph">
<p>Under the covers Gradle resolves dependencies from the respective URL of the public repository defined by the shorthand notation.
All shorthand notations are available via the <a href="../dsl/org.gradle.api.artifacts.dsl.RepositoryHandler.html">RepositoryHandler</a> API.
Alternatively, you can <a href="#sec:declaring_custom_repository">spell out the URL of the repository</a> for more fine-grained control.</p>
</div>
<div class="sect3">
<h4 id="sub:maven_central"><a class="anchor" href="#sub:maven_central"></a><a class="link" href="#sub:maven_central">Maven Central repository</a></h4>
<div class="paragraph">
<p>Maven Central is a popular repository hosting open source libraries for consumption by Java projects.</p>
</div>
<div class="paragraph">
<p>To declare the <a href="https://repo.maven.apache.org/maven2/">Maven Central repository</a> for your build add this to your script:</p>
</div>
<div class="exampleblock">
<div class="title">Example 1. Adding central Maven repository</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">repositories {
    mavenCentral()
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">repositories {
    mavenCentral()
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sub:maven_jcenter"><a class="anchor" href="#sub:maven_jcenter"></a><a class="link" href="#sub:maven_jcenter">JCenter Maven repository</a></h4>
<div class="paragraph">
<p><a href="http://bintray.com">Bintray</a>'s JCenter is an up-to-date collection of all popular Maven OSS artifacts, including artifacts published directly to Bintray.</p>
</div>
<div class="paragraph">
<p>To declare the <a href="https://jcenter.bintray.com">JCenter Maven repository</a> add this to your build script:</p>
</div>
<div class="exampleblock">
<div class="title">Example 2. Adding Bintray&#8217;s JCenter Maven repository</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">repositories {
    jcenter()
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">repositories {
    jcenter()
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sub:maven_google"><a class="anchor" href="#sub:maven_google"></a><a class="link" href="#sub:maven_google">Google Maven repository</a></h4>
<div class="paragraph">
<p>The Google repository hosts Android-specific artifacts including the Android SDK. For usage examples, see the <a href="https://developer.android.com/studio/build/dependencies.html#google-maven">relevant Android documentation</a>.</p>
</div>
<div class="paragraph">
<p>To declare the <a href="https://maven.google.com/">Google Maven repository</a> add this to your build script:</p>
</div>
<div class="exampleblock">
<div class="title">Example 3. Adding Google Maven repository</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">repositories {
    google()
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">repositories {
    google()
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec:declaring_custom_repository"><a class="anchor" href="#sec:declaring_custom_repository"></a><a class="link" href="#sec:declaring_custom_repository">Declaring a custom repository by URL</a></h3>
<div class="paragraph">
<p>Most enterprise projects set up a binary repository available only within an intranet.
In-house repositories enable teams to publish internal binaries, setup user management and security measure and ensure uptime and availability.
Specifying a custom URL is also helpful if you want to declare a less popular, but publicly-available repository.</p>
</div>
<div class="paragraph">
<p>Repositories with custom URLs can be specified as Maven or Ivy repositories by calling the corresponding methods available on the <a href="../dsl/org.gradle.api.artifacts.dsl.RepositoryHandler.html">RepositoryHandler</a> API.
Gradle supports other protocols than <code>http</code> or <code>https</code> as part of the custom URL e.g. <code>file</code>, <code>sftp</code> or <code>s3</code>.
For a full coverage see the <a href="#sec:repository-types">section on supported repository types</a>.</p>
</div>
<div class="paragraph">
<p>You can also <a href="#sub:defining_custom_pattern_layout_for_an_ivy_repository">define your own repository layout</a> by using <code>ivy { }</code> repositories as they are very flexible in terms of how modules are organised in a repository.</p>
</div>
</div>
<div class="sect2">
<h3 id="sec:declaring_multiple_repositories"><a class="anchor" href="#sec:declaring_multiple_repositories"></a><a class="link" href="#sec:declaring_multiple_repositories">Declaring multiple repositories</a></h3>
<div class="paragraph">
<p>You can define more than one repository for resolving dependencies.
Declaring multiple repositories is helpful if some dependencies are only available in one repository but not the other.
You can mix any type of repository described in the <a href="#sec:repository-types">reference section</a>.</p>
</div>
<div class="paragraph">
<p>This example demonstrates how to declare various named and custom URL repositories for a project:</p>
</div>
<div class="exampleblock">
<div class="title">Example 4. Declaring multiple repositories</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">repositories {
    jcenter()
    maven {
        url "https://maven.springframework.org/release"
    }
    maven {
        url "https://maven.restlet.com"
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">repositories {
    jcenter()
    maven {
        url = uri("https://maven.springframework.org/release")
    }
    maven {
        url = uri("https://maven.restlet.com")
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The order of declaration determines how Gradle will check for dependencies at runtime.
If Gradle finds a module descriptor in a particular repository, it will attempt to download all of the artifacts for that module from <em>the same repository</em>.
You can learn more about the inner workings of <a href="#sec:how-gradle-downloads-deps">dependency downloads</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="strict_limitation_to_declared_repositories"><a class="anchor" href="#strict_limitation_to_declared_repositories"></a><a class="link" href="#strict_limitation_to_declared_repositories">Strict limitation to declared repositories</a></h4>
<div class="paragraph">
<p>Maven POM metadata can reference additional repositories.
These will be <em>ignored</em> by Gradle, which will only use the repositories declared in the build itself.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This is a reproducibility safe-guard but also a security protection.
Without it, an updated version of a dependency could pull artifacts from anywhere into your build.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec:repository-types"><a class="anchor" href="#sec:repository-types"></a><a class="link" href="#sec:repository-types">Supported repository types</a></h3>
<div class="paragraph">
<p>Gradle supports a wide range of sources for dependencies, both in terms of format and in terms of connectivity.
You may resolve dependencies from:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Different formats</p>
<div class="ulist">
<ul>
<li>
<p>a <a href="#sec:maven_repo">Maven compatible</a> artifact repository (e.g: Maven Central, JCenter, &#8230;&#8203;)</p>
</li>
<li>
<p>an <a href="#sec:ivy_repositories">Ivy compatible</a> artifact repository (including custom layouts)</p>
</li>
<li>
<p><a href="#sub:flat_dir_resolver">local (flat) directories</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>with different connectivity</p>
<div class="ulist">
<ul>
<li>
<p><a href="#sec:authentication_schemes">authenticated repositories</a></p>
</li>
<li>
<p>a wide variety of <a href="#sec:supported_transport_protocols">remote protocols</a> such as HTTPS, SFTP, AWS S3 and Google Cloud Storage</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="sub:flat_dir_resolver"><a class="anchor" href="#sub:flat_dir_resolver"></a><a class="link" href="#sub:flat_dir_resolver">Flat directory repository</a></h4>
<div class="paragraph">
<p>Some projects might prefer to store dependencies on a shared drive or as part of the project source code instead of a binary repository product. If you want to use a (flat) filesystem directory as a repository, simply type:</p>
</div>
<div class="exampleblock">
<div class="title">Example 5. Flat repository resolver</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">repositories {
    flatDir {
        dirs 'lib'
    }
    flatDir {
        dirs 'lib1', 'lib2'
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">repositories {
    flatDir {
        dirs("lib")
    }
    flatDir {
        dirs("lib1", "lib2")
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This adds repositories which look into one or more directories for finding dependencies.</p>
</div>
<div class="paragraph">
<p>This type of repository does not support any meta-data formats like Ivy XML or Maven POM files.
Instead, Gradle will dynamically generate a module descriptor (without any dependency information) based on the presence of artifacts.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>As Gradle prefers to use modules whose descriptor has been created from real meta-data rather than being generated, flat directory repositories cannot be used to override artifacts with real meta-data from other repositories declared in the build.</p>
</div>
<div class="paragraph">
<p>For example, if Gradle finds only <code>jmxri-1.2.1.jar</code> in a flat directory repository, but <code>jmxri-1.2.1.pom</code> in another repository that supports meta-data, it will use the second repository to provide the module.</p>
</div>
<div class="paragraph">
<p>For the use case of overriding remote artifacts with local ones consider using an Ivy or Maven repository instead whose URL points to a local directory.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you only work with flat directory repositories you don&#8217;t need to set all attributes of a dependency.</p>
</div>
</div>
<div class="sect3">
<h4 id="sub:local-repos"><a class="anchor" href="#sub:local-repos"></a><a class="link" href="#sub:local-repos">Local repositories</a></h4>
<div class="paragraph">
<p>The following sections describe repositories format, Maven or Ivy.
These can be declared as local repositories, using a local filesystem path to access them.</p>
</div>
<div class="paragraph">
<p>The difference with the flat directory repository is that they do respect a format and contain metadata.</p>
</div>
<div class="paragraph">
<p>When such a repository is configured, Gradle totally bypasses its <a href="#sec:dependency_cache">dependency cache</a> for it as there can be no guarantee that content may not change between executions.
Because of that limitation, they can have a performance impact.</p>
</div>
<div class="paragraph">
<p>They also make build reproducibility much harder to achieve and their use should be limited to tinkering or prototyping.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec:maven_repo"><a class="anchor" href="#sec:maven_repo"></a><a class="link" href="#sec:maven_repo">Maven repositories</a></h3>
<div class="paragraph">
<p>Many organizations host dependencies in an in-house Maven repository only accessible within the company&#8217;s network.
Gradle can declare Maven repositories by URL.</p>
</div>
<div class="paragraph">
<p>For adding a custom Maven repository you can do:</p>
</div>
<div class="exampleblock">
<div class="title">Example 6. Adding custom Maven repository</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">repositories {
    maven {
        url "http://repo.mycompany.com/maven2"
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">repositories {
    maven {
        url = uri("http://repo.mycompany.com/maven2")
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sub:custom-maven-repo"><a class="anchor" href="#sub:custom-maven-repo"></a><a class="link" href="#sub:custom-maven-repo">Setting up composite Maven repositories</a></h4>
<div class="paragraph">
<p>Sometimes a repository will have the POMs published to one location, and the JARs and other artifacts published at another location.
To define such a repository, you can do:</p>
</div>
<div class="exampleblock">
<div class="title">Example 7. Adding additional Maven repositories for JAR files</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">repositories {
    maven {
        // Look for POMs and artifacts, such as JARs, here
        url "http://repo2.mycompany.com/maven2"
        // Look for artifacts here if not found at the above location
        artifactUrls "http://repo.mycompany.com/jars"
        artifactUrls "http://repo.mycompany.com/jars2"
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">repositories {
    maven {
        // Look for POMs and artifacts, such as JARs, here
        url = uri("http://repo2.mycompany.com/maven2")
        // Look for artifacts here if not found at the above location
        artifactUrls("http://repo.mycompany.com/jars")
        artifactUrls("http://repo.mycompany.com/jars2")
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Gradle will look at the base <code>url</code> location for the POM and the JAR.
If the JAR can&#8217;t be found there, the extra <code>artifactUrls</code> are used to look for JARs.</p>
</div>
</div>
<div class="sect3">
<h4 id="sub:accessing_secured_maven_repositories"><a class="anchor" href="#sub:accessing_secured_maven_repositories"></a><a class="link" href="#sub:accessing_secured_maven_repositories">Accessing authenticated Maven repositories</a></h4>
<div class="paragraph">
<p>You can specify credentials for Maven repositories secured by different type of authentication.</p>
</div>
<div class="paragraph">
<p>See <a href="#sec:supported_transport_protocols">Supported repository transport protocols</a> for authentication options.</p>
</div>
</div>
<div class="sect3">
<h4 id="sub:maven_local"><a class="anchor" href="#sub:maven_local"></a><a class="link" href="#sub:maven_local">Local Maven repository</a></h4>
<div class="paragraph">
<p>Gradle can consume dependencies available in the <a href="https://maven.apache.org/guides/introduction/introduction-to-repositories.html">local Maven repository</a>.
Declaring this repository is beneficial for teams that publish to the local Maven repository with one project and consume the artifacts by Gradle in another project.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Gradle stores resolved dependencies in <a href="#sec:dependency_cache">its own cache</a>.
A build does not need to declare the local Maven repository even if you resolve dependencies from a Maven-based, remote repository.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Before adding Maven local as a repository, you should <a href="#sec:case-for-maven-local">make sure this is really required</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To declare the local Maven cache as a repository add this to your build script:</p>
</div>
<div class="exampleblock">
<div class="title">Example 8. Adding the local Maven cache as a repository</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">repositories {
    mavenLocal()
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">repositories {
    mavenLocal()
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Gradle uses the same logic as Maven to identify the location of your local Maven cache.
If a local repository location is defined in a <code>settings.xml</code>, this location will be used.
The <code>settings.xml</code> in <code><em>USER_HOME</em>/.m2</code> takes precedence over the <code>settings.xml</code> in <code><em>M2_HOME</em>/conf</code>.
If no <code>settings.xml</code> is available, Gradle uses the default location <code><em>USER_HOME</em>/.m2/repository</code>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec:case-for-maven-local"><a class="anchor" href="#sec:case-for-maven-local"></a><a class="link" href="#sec:case-for-maven-local">The case for mavenLocal()</a></h3>
<div class="paragraph">
<p>As a general advice, you should avoid adding <code>mavenLocal()</code> as a repository.
There are different issues with using <code>mavenLocal()</code> that you should be aware of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Maven uses it as a cache, not a repository, meaning it can contain partial modules.</p>
<div class="ulist">
<ul>
<li>
<p>For example, if Maven never downloaded the source or javadoc files for a given module, Gradle will not find them either since it <a href="#sec:how-gradle-downloads-deps">searches for files in a single repository</a> once a module has been found.</p>
</li>
</ul>
</div>
</li>
<li>
<p>As a <a href="#sub:local-repos">local repository</a>, Gradle does not trust its content, because:</p>
<div class="ulist">
<ul>
<li>
<p>Origin of artifacts cannot be tracked, which is a correctness and security problem</p>
</li>
<li>
<p>Artifacts can be easily overwritten, which is a security, correctness and reproducibility problem</p>
</li>
</ul>
</div>
</li>
<li>
<p>To mitigate the fact that metadata and/or artifacts can be changed, Gradle does not perform <a href="#sec:dependency_cache">any caching</a> for <a href="#sub:local-repos">local repositories</a></p>
<div class="ulist">
<ul>
<li>
<p>As a consequence, your builds are slower</p>
</li>
<li>
<p>Given that order of repositories is important, adding <code>mavenLocal()</code> <em>first</em> means that all your builds are going to be slower</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>There are a few cases where you might have to use <code>mavenLocal()</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For interoperability with Maven</p>
<div class="ulist">
<ul>
<li>
<p>For example, project A is built with Maven, project B is built with Gradle, and you need to share the artifacts during development</p>
</li>
<li>
<p>It is <em>always</em> preferable to use an internal full featured repository instead</p>
</li>
<li>
<p>In case this is not possible, you should limit this to <em>local builds only</em></p>
</li>
</ul>
</div>
</li>
<li>
<p>For interoperability with Gradle itself</p>
<div class="ulist">
<ul>
<li>
<p>In a multi-repository world, you want to check that changes to project A work with project B</p>
</li>
<li>
<p>It is preferable to use <a href="#composite_builds">composite builds</a> for this use case</p>
</li>
<li>
<p>If for some reason neither composite builds nor full featured repository are possible, then <code>mavenLocal()</code> is a last resort option</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>After all these warnings, if you end up using <code>mavenLocal()</code>, consider combining it with <a href="#sec:repository-content-filtering">a repository filter</a>.
This will make sure it only provides what is expected and nothing else.</p>
</div>
</div>
<div class="sect2">
<h3 id="sec:ivy_repositories"><a class="anchor" href="#sec:ivy_repositories"></a><a class="link" href="#sec:ivy_repositories">Ivy repositories</a></h3>
<div class="paragraph">
<p>Organizations might decide to host dependencies in an in-house Ivy repository. Gradle can declare Ivy repositories by URL.</p>
</div>
<div class="sect3">
<h4 id="sub:defining_an_ivy_repository_with_a_standard_layout"><a class="anchor" href="#sub:defining_an_ivy_repository_with_a_standard_layout"></a><a class="link" href="#sub:defining_an_ivy_repository_with_a_standard_layout">Defining an Ivy repository with a standard layout</a></h4>
<div class="paragraph">
<p>To declare an Ivy repository using the standard layout no additional customization is needed. You just declare the URL.</p>
</div>
<div class="exampleblock">
<div class="title">Example 9. Ivy repository</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">repositories {
    ivy {
        url "http://repo.mycompany.com/repo"
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">repositories {
    ivy {
        url = uri("http://repo.mycompany.com/repo")
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sub:defining_a_named_layout_for_an_ivy_repository"><a class="anchor" href="#sub:defining_a_named_layout_for_an_ivy_repository"></a><a class="link" href="#sub:defining_a_named_layout_for_an_ivy_repository">Defining a named layout for an Ivy repository</a></h4>
<div class="paragraph">
<p>You can specify that your repository conforms to the Ivy or Maven default layout by using a named layout.</p>
</div>
<div class="exampleblock">
<div class="title">Example 10. Ivy repository with named layout</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">repositories {
    ivy {
        url "http://repo.mycompany.com/repo"
        layout "maven"
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">repositories {
    ivy {
        url = uri("http://repo.mycompany.com/repo")
        layout("maven")
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Valid named layout values are <code>'gradle'</code> (the default), <code>'maven'</code> and <code>'ivy'</code>. See <a href="../dsl/org.gradle.api.artifacts.repositories.IvyArtifactRepository.html#org.gradle.api.artifacts.repositories.IvyArtifactRepository:layout(java.lang.String)">IvyArtifactRepository.layout(java.lang.String)</a> in the API documentation for details of these named layouts.</p>
</div>
</div>
<div class="sect3">
<h4 id="sub:defining_custom_pattern_layout_for_an_ivy_repository"><a class="anchor" href="#sub:defining_custom_pattern_layout_for_an_ivy_repository"></a><a class="link" href="#sub:defining_custom_pattern_layout_for_an_ivy_repository">Defining custom pattern layout for an Ivy repository</a></h4>
<div class="paragraph">
<p>To define an Ivy repository with a non-standard layout, you can define a <em>pattern</em> layout for the repository:</p>
</div>
<div class="exampleblock">
<div class="title">Example 11. Ivy repository with pattern layout</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">repositories {
    ivy {
        url "http://repo.mycompany.com/repo"
        patternLayout {
            artifact "[module]/[revision]/[type]/[artifact].[ext]"
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">repositories {
    ivy {
        url = uri("http://repo.mycompany.com/repo")
        patternLayout {
            artifact("[module]/[revision]/[type]/[artifact].[ext]")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>To define an Ivy repository which fetches Ivy files and artifacts from different locations, you can define separate patterns to use to locate the Ivy files and artifacts:</p>
</div>
<div class="paragraph">
<p>Each <code>artifact</code> or <code>ivy</code> specified for a repository adds an <em>additional</em> pattern to use. The patterns are used in the order that they are defined.</p>
</div>
<div class="exampleblock">
<div class="title">Example 12. Ivy repository with multiple custom patterns</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">repositories {
    ivy {
        url "http://repo.mycompany.com/repo"
        patternLayout {
            artifact "3rd-party-artifacts/[organisation]/[module]/[revision]/[artifact]-[revision].[ext]"
            artifact "company-artifacts/[organisation]/[module]/[revision]/[artifact]-[revision].[ext]"
            ivy "ivy-files/[organisation]/[module]/[revision]/ivy.xml"
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">repositories {
    ivy {
        url = uri("http://repo.mycompany.com/repo")
        patternLayout {
            artifact("3rd-party-artifacts/[organisation]/[module]/[revision]/[artifact]-[revision].[ext]")
            artifact("company-artifacts/[organisation]/[module]/[revision]/[artifact]-[revision].[ext]")
            ivy("ivy-files/[organisation]/[module]/[revision]/ivy.xml")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Optionally, a repository with pattern layout can have its <code>'organisation'</code> part laid out in Maven style, with forward slashes replacing dots as separators. For example, the organisation <code>my.company</code> would then be represented as <code>my/company</code>.</p>
</div>
<div class="exampleblock">
<div class="title">Example 13. Ivy repository with Maven compatible layout</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">repositories {
    ivy {
        url "http://repo.mycompany.com/repo"
        patternLayout {
            artifact "[organisation]/[module]/[revision]/[artifact]-[revision].[ext]"
            m2compatible = true
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">repositories {
    ivy {
        url = uri("http://repo.mycompany.com/repo")
        patternLayout {
            artifact("[organisation]/[module]/[revision]/[artifact]-[revision].[ext]")
            setM2compatible(true)
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sub:accessing_secured_ivy_repositories"><a class="anchor" href="#sub:accessing_secured_ivy_repositories"></a><a class="link" href="#sub:accessing_secured_ivy_repositories">Accessing authenticated Ivy repositories</a></h4>
<div class="paragraph">
<p>You can specify credentials for Ivy repositories secured by basic authentication.</p>
</div>
<div class="exampleblock">
<div class="title">Example 14. Ivy repository with authentication</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">repositories {
    ivy {
        url "http://repo.mycompany.com"
        credentials {
            username "user"
            password "password"
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">repositories {
    ivy {
        url = uri("http://repo.mycompany.com")
        credentials {
            username = "user"
            password = "password"
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>See <a href="#sec:supported_transport_protocols">Supported repository transport protocols</a> for authentication options.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec:repository-content-filtering"><a class="anchor" href="#sec:repository-content-filtering"></a><a class="link" href="#sec:repository-content-filtering">Repository content filtering</a></h3>
<div class="paragraph">
<p>Gradle exposes an API to declare what a repository may or may not contain.
There are different use cases for it:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>performance, when you know a dependency will never be found in a specific repository</p>
</li>
<li>
<p>security, by avoiding leaking what dependencies are used in a private project</p>
</li>
<li>
<p>reliability, when some repositories contain corrupted metadata or artifacts</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It&#8217;s even more important when considering that the declared order of repositories matter.</p>
</div>
<div class="sect3">
<h4 id="sec:declaring-repository-filter"><a class="anchor" href="#sec:declaring-repository-filter"></a><a class="link" href="#sec:declaring-repository-filter">Declaring a repository filter</a></h4>
<div class="exampleblock">
<div class="title">Example 15. Declaring repository contents</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">repositories {
    maven {
        url "https://repo.mycompany.com/maven2"
        content {
            // this repository *only* contains artifacts with group "my.company"
            includeGroup "my.company"
        }
    }
    jcenter {
        content {
            // this repository contains everything BUT artifacts with group starting with "my.company"
            excludeGroupByRegex "my\\.company.*"
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">repositories {
    maven {
        url = uri("https://repo.mycompany.com/maven2")
        content {
            // this repository *only* contains artifacts with group "my.company"
            includeGroup("my.company")
        }
    }
    jcenter {
        content {
            // this repository contains everything BUT artifacts with group starting with "my.company"
            excludeGroupByRegex("my\\.company.*")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>By default, repositories include everything and exclude nothing:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If you declare an include, then it excludes everything <em>but</em> what is included.</p>
</li>
<li>
<p>If you declare an exclude, then it includes everything <em>but</em> what is excluded.</p>
</li>
<li>
<p>If you declare both includes and excludes, then it includes only what is explicitly included and not excluded.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It is possible to filter either by explicit <em>group</em>, <em>module</em> or <em>version</em>, either strictly or using regular expressions.
See <a href="../javadoc/org/gradle/api/artifacts/repositories/RepositoryContentDescriptor.html">RepositoryContentDescriptor</a> for details.</p>
</div>
</div>
<div class="sect3">
<h4 id="declaring_content_exclusively_found_in_one_repository"><a class="anchor" href="#declaring_content_exclusively_found_in_one_repository"></a><a class="link" href="#declaring_content_exclusively_found_in_one_repository">Declaring content exclusively found in one repository</a></h4>
<div class="paragraph">
<p>Filters declared using the <a href="#sec:declaring-repository-filter">repository-level content filter</a> are not exclusive.
This means that declaring that a repository <em>includes</em> an artifact doesn&#8217;t mean that the other repositories can&#8217;t have it either: you must declare what every repository contains in extension.</p>
</div>
<div class="paragraph">
<p>Alternatively, Gradle provides an API which lets you declare that a repository <em>exclusively includes</em> an artifact.
If you do so:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>an artifact declared in a repository <em>can&#8217;t</em> be found in any other</p>
</li>
<li>
<p>exclusive repository content must be declared in extension (just like for <a href="#sec:declaring-repository-filter">repository-level content</a>)</p>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 16. Declaring exclusive repository contents</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">repositories {
    // This repository will _not_ be searched for artifacts in my.company
    // despite being declared first
    jcenter()
    exclusiveContent {
        forRepository {
            maven {
                url "https://repo.mycompany.com/maven2"
            }
        }
        filter {
            // this repository *only* contains artifacts with group "my.company"
            includeGroup "my.company"
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">repositories {
    // This repository will _not_ be searched for artifacts in my.company
    // despite being declared first
    jcenter()
    exclusiveContent {
        forRepository {
            maven {
                url = uri("https://repo.mycompany.com/maven2")
            }
        }
        filter {
            // this repository *only* contains artifacts with group "my.company"
            includeGroup("my.company")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>It is possible to filter either by explicit <em>group</em>, <em>module</em> or <em>version</em>, either strictly or using regular expressions.
See <a href="../javadoc/org/gradle/api/artifacts/repositories/InclusiveRepositoryContentDescriptor.html">InclusiveRepositoryContentDescriptor</a> for details.</p>
</div>
</div>
<div class="sect3">
<h4 id="maven_repository_filtering"><a class="anchor" href="#maven_repository_filtering"></a><a class="link" href="#maven_repository_filtering">Maven repository filtering</a></h4>
<div class="paragraph">
<p>For <a href="#sec:maven_repo">Maven repositories</a>, it&#8217;s often the case that a repository would either contain releases or snapshots.
Gradle lets you declare what kind of artifacts are found in a repository using this DSL:</p>
</div>
<div class="exampleblock">
<div class="title">Example 17. Splitting snapshots and releases</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">repositories {
    maven {
        url "https://repo.mycompany.com/releases"
        mavenContent {
            releasesOnly()
        }
    }
    maven {
        url "https://repo.mycompany.com/snapshots"
        mavenContent {
            snapshotsOnly()
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">repositories {
    maven {
        url = uri("https://repo.mycompany.com/releases")
        mavenContent {
            releasesOnly()
        }
    }
    maven {
        url = uri("https://repo.mycompany.com/snapshots")
        mavenContent {
            snapshotsOnly()
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec:supported_metadata_sources"><a class="anchor" href="#sec:supported_metadata_sources"></a><a class="link" href="#sec:supported_metadata_sources">Supported metadata sources</a></h3>
<div class="paragraph">
<p>When searching for a module in a repository, Gradle, by default, checks for <a href="#sec:supported-metadata-formats">supported metadata file formats</a> in that repository.
In a Maven repository, Gradle looks for a <code>.pom</code> file, in an ivy repository it looks for an <code>ivy.xml</code> file and in a flat directory repository it looks directly for <code>.jar</code> files as it does not expect any metadata.
Starting with 5.0, Gradle also looks for <code>.module</code> (Gradle module metadata) files.</p>
</div>
<div class="paragraph">
<p>However, if you define a customized repository you might want to configure this behavior.
For example, you can define a Maven repository without <code>.pom</code> files but only jars.
To do so, you can configure <em>metadata sources</em> for any repository.</p>
</div>
<div class="exampleblock">
<div class="title">Example 18. Maven repository that supports artifacts without metadata</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">repositories {
    maven {
        url "http://repo.mycompany.com/repo"
        metadataSources {
            mavenPom()
            artifact()
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">repositories {
    maven {
        url = uri("http://repo.mycompany.com/repo")
        metadataSources {
            mavenPom()
            artifact()
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You can specify multiple sources to tell Gradle to keep looking if a file was not found.
In that case, the order of checking for sources is predefined.</p>
</div>
<div class="paragraph">
<p>The following metadata sources are supported:</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 1. Repository transport protocols</caption>
<colgroup>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Metadata source</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Order</th>
<th class="tableblock halign-left valign-top">Maven</th>
<th class="tableblock halign-left valign-top">Ivy / flat dir</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>gradleMetadata()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Look for Gradle <code>.module</code> files</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1st</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mavenPom()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Look for Maven <code>.pom</code> files</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2nd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ivyDescriptor()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Look for <code>ivy.xml</code> files</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2nd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>artifact()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Look directly for artifact</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3rd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The defaults for Ivy and Maven repositories change with Gradle 6.0. Before 6.0, <code>artifact()</code> was included in the defaults.
Leading to some inefficiency when modules are missing completely.
To restore this behavior, for example, for Maven central you can use <code>mavenCentral { metadataSources { mavenPom(); artifact() } }</code>.
In a similar way, you can opt into the new behavior in older Gradle versions using <code>mavenCentral { metadataSources { mavenPom() } }</code></p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Since Gradle 5.3, when parsing a metadata file, be it Ivy or Maven, Gradle will look for a marker indicating that a matching Gradle Module Metadata files exists.
If it is found, it will be used instead of the Ivy or Maven file.</p>
</div>
<div class="paragraph">
<p>Starting with Gradle 5.6, you can disable this behavior by adding <code>ignoreGradleMetadataRedirection()</code> to the metadataSources declaration.</p>
</div>
<div class="exampleblock">
<div class="title">Example 19. Maven repository that does not use gradle metadata redirection</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">repositories {
    maven {
        url "http://repo.mycompany.com/repo"
        metadataSources {
            mavenPom()
            artifact()
            ignoreGradleMetadataRedirection()
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">repositories {
    maven {
        url = uri("http://repo.mycompany.com/repo")
        metadataSources {
            mavenPom()
            artifact()
            ignoreGradleMetadataRedirection()
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec:plugin-vs-build-repos"><a class="anchor" href="#sec:plugin-vs-build-repos"></a><a class="link" href="#sec:plugin-vs-build-repos">Plugin repositories vs. build repositories</a></h3>
<div class="paragraph">
<p>Gradle will use repositories at two different phases during your build.</p>
</div>
<div class="paragraph">
<p>The first phase is when <a href="build_lifecycle.html#sec:build_phases">configuring your build</a> and loading the plugins it applied.
To do that Gradle will use a special set of repositories.</p>
</div>
<div class="paragraph">
<p>The second phase is during dependency resolution.
At this point Gradle will use the repositories declared in your project, as shown in the previous sections.</p>
</div>
<div class="sect3">
<h4 id="sub:plugin-repos"><a class="anchor" href="#sub:plugin-repos"></a><a class="link" href="#sub:plugin-repos">Plugin repositories</a></h4>
<div class="paragraph">
<p>By default Gradle will use the <a href="http://plugins.gradle.org">Gradle plugin portal</a> to look for plugins.</p>
</div>
<div class="paragraph">
<p>However, for different reasons, there are plugins available in other, public or not, repositories.
When a build requires one of these plugins, additional repositories need to be specified so that Gradle knows where to search.</p>
</div>
<div class="paragraph">
<p>As the way to declare the repositories and what they are expected to contain depends on the way the plugin is applied, it is best to refer to <a href="plugins.html#sec:custom_plugin_repositories">Custom Plugin Repositories</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec:supported_transport_protocols"><a class="anchor" href="#sec:supported_transport_protocols"></a><a class="link" href="#sec:supported_transport_protocols">Supported repository transport protocols</a></h3>
<div class="paragraph">
<p>Maven and Ivy repositories support the use of various transport protocols. At the moment the following protocols are supported:</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 2. Repository transport protocols</caption>
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Credential types</th>
<th class="tableblock halign-left valign-top">Link</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>file</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">none</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>http</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">username/password</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#sec:authentication_schemes">Documentation</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>https</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">username/password</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#sec:authentication_schemes">Documentation</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sftp</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">username/password</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#sec:authentication_schemes">Documentation</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>s3</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">access key/secret key/session token or Environment variables</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#sec:s3-repositories">Documentation</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>gcs</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://developers.google.com/identity/protocols/application-default-credentials">default application credentials</a> sourced from well known files, Environment variables etc.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#sec:gcs-repositories">Documentation</a></p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Username and password should never be checked in plain text into version control as part of your build file. You can store the credentials in a local <code>gradle.properties</code> file and use one of the open source Gradle plugins for encrypting and consuming credentials e.g. the <a href="https://plugins.gradle.org/plugin/nu.studer.credentials">credentials plugin</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The transport protocol is part of the URL definition for a repository.
The following build script demonstrates how to create HTTP-based Maven and Ivy repositories:</p>
</div>
<div class="exampleblock">
<div class="title">Example 20. Declaring a Maven and Ivy repository</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">repositories {
    maven {
        url "http://repo.mycompany.com/maven2"
    }

    ivy {
        url "http://repo.mycompany.com/repo"
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">repositories {
    maven {
        url = uri("http://repo.mycompany.com/maven2")
    }

    ivy {
        url = uri("http://repo.mycompany.com/repo")
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The following example shows how to declare SFTP repositories:</p>
</div>
<div class="exampleblock">
<div class="title">Example 21. Using the SFTP protocol for a repository</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">repositories {
    maven {
        url "sftp://repo.mycompany.com:22/maven2"
        credentials {
            username "user"
            password "password"
        }
    }

    ivy {
        url "sftp://repo.mycompany.com:22/repo"
        credentials {
            username "user"
            password "password"
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">repositories {
    maven {
        url = uri("sftp://repo.mycompany.com:22/maven2")
        credentials {
            username = "user"
            password = "password"
        }
    }

    ivy {
        url = uri("sftp://repo.mycompany.com:22/repo")
        credentials {
            username = "user"
            password = "password"
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>For details on HTTP related authentication, see the section <a href="#sec:authentication_schemes">HTTP(S) authentication schemes configuration</a>.</p>
</div>
<div class="paragraph">
<p>When using an AWS S3 backed repository you need to authenticate using <a href="../dsl/org.gradle.api.credentials.AwsCredentials.html">AwsCredentials</a>, providing access-key and a private-key. The following example shows how to declare a S3 backed repository and providing AWS credentials:</p>
</div>
<div class="exampleblock">
<div class="title">Example 22. Declaring a S3 backed Maven and Ivy repository</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">repositories {
    maven {
        url "s3://myCompanyBucket/maven2"
        credentials(AwsCredentials) {
            accessKey "someKey"
            secretKey "someSecret"
            // optional
            sessionToken "someSTSToken"
        }
    }

    ivy {
        url "s3://myCompanyBucket/ivyrepo"
        credentials(AwsCredentials) {
            accessKey "someKey"
            secretKey "someSecret"
            // optional
            sessionToken "someSTSToken"
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">repositories {
    maven {
        url = uri("s3://myCompanyBucket/maven2")
        credentials(AwsCredentials::class) {
            accessKey = "someKey"
            secretKey = "someSecret"
            // optional
            sessionToken = "someSTSToken"
        }
    }

    ivy {
        url = uri("s3://myCompanyBucket/ivyrepo")
        credentials(AwsCredentials::class) {
            accessKey = "someKey"
            secretKey = "someSecret"
            // optional
            sessionToken = "someSTSToken"
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You can also delegate all credentials to the AWS sdk by using the AwsImAuthentication. The following example shows how:</p>
</div>
<div class="exampleblock">
<div class="title">Example 23. Declaring a S3 backed Maven and Ivy repository using IAM</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">repositories {
    maven {
        url "s3://myCompanyBucket/maven2"
        authentication {
           awsIm(AwsImAuthentication) // load from EC2 role or env var
        }
    }

    ivy {
        url "s3://myCompanyBucket/ivyrepo"
        authentication {
           awsIm(AwsImAuthentication)
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">repositories {
    maven {
        url = uri("s3://myCompanyBucket/maven2")
        authentication {
            create&lt;AwsImAuthentication&gt;("awsIm") // load from EC2 role or env var
        }
    }

    ivy {
        url = uri("s3://myCompanyBucket/ivyrepo")
        authentication {
            create&lt;AwsImAuthentication&gt;("awsIm")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>For details on AWS S3 related authentication, see the section <a href="#sec:s3-repositories">AWS S3 repositories configuration</a>.</p>
</div>
<div class="paragraph">
<p>When using a Google Cloud Storage backed repository default application credentials will be used with no further configuration required:</p>
</div>
<div class="exampleblock">
<div class="title">Example 24. Declaring a Google Cloud Storage backed Maven and Ivy repository using default application credentials</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">repositories {
    maven {
        url "gcs://myCompanyBucket/maven2"
    }

    ivy {
        url "gcs://myCompanyBucket/ivyrepo"
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">repositories {
    maven {
        url = uri("gcs://myCompanyBucket/maven2")
    }

    ivy {
        url = uri("gcs://myCompanyBucket/ivyrepo")
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>For details on Google GCS related authentication, see the section <a href="#sec:gcs-repositories">Google Cloud Storage repositories configuration</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="sec:authentication_schemes"><a class="anchor" href="#sec:authentication_schemes"></a><a class="link" href="#sec:authentication_schemes">HTTP(S) authentication schemes configuration</a></h3>
<div class="paragraph">
<p>When configuring a repository using HTTP or HTTPS transport protocols, multiple authentication schemes are available. By default, Gradle will attempt to use all schemes that are supported by the Apache HttpClient library, <a href="http://hc.apache.org/httpcomponents-client-ga/tutorial/html/authentication.html#d5e625">documented here</a>. In some cases, it may be preferable to explicitly specify which authentication schemes should be used when exchanging credentials with a remote server. When explicitly declared, only those schemes are used when authenticating to a remote repository.</p>
</div>
<div class="paragraph">
<p>You can specify credentials for Maven repositories secured by basic authentication using <a href="../javadoc/org/gradle/api/credentials/PasswordCredentials.html">PasswordCredentials</a>.</p>
</div>
<div class="exampleblock">
<div class="title">Example 25. Accessing password-protected Maven repository</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">repositories {
    maven {
        url "http://repo.mycompany.com/maven2"
        credentials {
            username "user"
            password "password"
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">repositories {
    maven {
        url = uri("http://repo.mycompany.com/maven2")
        credentials {
            username = "user"
            password = "password"
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The following example show how to configure a repository to use only <a href="../javadoc/org/gradle/authentication/http/DigestAuthentication.html">DigestAuthentication</a>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 26. Configure repository to use only digest authentication</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">repositories {
    maven {
        url 'https://repo.mycompany.com/maven2'
        credentials {
            username "user"
            password "password"
        }
        authentication {
            digest(DigestAuthentication)
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">repositories {
    maven {
        url = uri("https://repo.mycompany.com/maven2")
        credentials {
            username = "user"
            password = "password"
        }
        authentication {
            create&lt;DigestAuthentication&gt;("digest")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Currently supported authentication schemes are:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="../javadoc/org/gradle/authentication/http/BasicAuthentication.html">BasicAuthentication</a></dt>
<dd>
<p>Basic access authentication over HTTP. When using this scheme, credentials are sent preemptively.</p>
</dd>
<dt class="hdlist1"><a href="../javadoc/org/gradle/authentication/http/DigestAuthentication.html">DigestAuthentication</a></dt>
<dd>
<p>Digest access authentication over HTTP.</p>
</dd>
<dt class="hdlist1"><a href="../javadoc/org/gradle/authentication/http/HttpHeaderAuthentication.html">HttpHeaderAuthentication</a></dt>
<dd>
<p>Authentication based on any custom HTTP header, e.g. private tokens, OAuth tokens, etc.</p>
</dd>
</dl>
</div>
<div class="sect3">
<h4 id="sub:preemptive_authentication"><a class="anchor" href="#sub:preemptive_authentication"></a><a class="link" href="#sub:preemptive_authentication">Using preemptive authentication</a></h4>
<div class="paragraph">
<p>Gradle&#8217;s default behavior is to only submit credentials when a server responds with an authentication challenge in the form of an HTTP 401 response.
In some cases, the server will respond with a different code (ex. for repositories hosted on GitHub a 404 is returned) causing dependency resolution to fail.
To get around this behavior, credentials may be sent to the server preemptively.
To enable preemptive authentication simply configure your repository to explicitly use the <a href="../javadoc/org/gradle/authentication/http/BasicAuthentication.html">BasicAuthentication</a> scheme:</p>
</div>
<div class="exampleblock">
<div class="title">Example 27. Configure repository to use preemptive authentication</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">repositories {
    maven {
        url 'https://repo.mycompany.com/maven2'
        credentials {
            username "user"
            password "password"
        }
        authentication {
            basic(BasicAuthentication)
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">repositories {
    maven {
        url = uri("https://repo.mycompany.com/maven2")
        credentials {
            username = "user"
            password = "password"
        }
        authentication {
            create&lt;BasicAuthentication&gt;("basic")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sub:http-header-auth"><a class="anchor" href="#sub:http-header-auth"></a><a class="link" href="#sub:http-header-auth">Using HTTP header authentication</a></h4>
<div class="paragraph">
<p>You can specify any HTTP header for secured Maven repositories requiring token, OAuth2 or other HTTP header based authentication using <a href="../javadoc/org/gradle/api/credentials/HttpHeaderCredentials.html">HttpHeaderCredentials</a> with <a href="../javadoc/org/gradle/authentication/http/HttpHeaderAuthentication.html">HttpHeaderAuthentication</a>.</p>
</div>
<div class="exampleblock">
<div class="title">Example 28. Accessing header-protected Maven repository</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">repositories {
    maven {
        url "http://repo.mycompany.com/maven2"
        credentials(HttpHeaderCredentials) {
            name = "Private-Token"
            value = "TOKEN"
        }
        authentication {
            header(HttpHeaderAuthentication)
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">repositories {
    maven {
        url = uri("http://repo.mycompany.com/maven2")
        credentials(HttpHeaderCredentials::class) {
            name = "Private-Token"
            value = "TOKEN"
        }
        authentication {
            create&lt;HttpHeaderAuthentication&gt;("header")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec:s3-repositories"><a class="anchor" href="#sec:s3-repositories"></a><a class="link" href="#sec:s3-repositories">AWS S3 repositories configuration</a></h3>
<div class="sect3">
<h4 id="sub:s3_configuration_properties"><a class="anchor" href="#sub:s3_configuration_properties"></a><a class="link" href="#sub:s3_configuration_properties">S3 configuration properties</a></h4>
<div class="paragraph">
<p>The following system properties can be used to configure the interactions with s3 repositories:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>org.gradle.s3.endpoint</code></dt>
<dd>
<p>Used to override the AWS S3 endpoint when using a non AWS, S3 API compatible, storage service.</p>
</dd>
<dt class="hdlist1"><code>org.gradle.s3.maxErrorRetry</code></dt>
<dd>
<p>Specifies the maximum number of times to retry a request in the event that the S3 server responds with a HTTP 5xx status code. When not specified a default value of 3 is used.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="sub:s3_url_formats"><a class="anchor" href="#sub:s3_url_formats"></a><a class="link" href="#sub:s3_url_formats">S3 URL formats</a></h4>
<div class="paragraph">
<p>S3 URL&#8217;s are 'virtual-hosted-style' and must be in the following format</p>
</div>
<div class="listingblock">
<div class="content">
<pre>s3://&lt;bucketName&gt;[.&lt;regionSpecificEndpoint&gt;]/&lt;s3Key&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>e.g. <code>s3://myBucket.s3.eu-central-1.amazonaws.com/maven/release</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>myBucket</code> is the AWS S3 bucket name.</p>
</li>
<li>
<p><code>s3.eu-central-1.amazonaws.com</code> is the <em>optional</em> <a href="http://docs.aws.amazon.com/general/latest/gr/rande.html#s3_region">region specific endpoint</a>.</p>
</li>
<li>
<p><code>/maven/release</code> is the AWS S3 key (unique identifier for an object within a bucket)</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="sub:s3_proxy_settings"><a class="anchor" href="#sub:s3_proxy_settings"></a><a class="link" href="#sub:s3_proxy_settings">S3 proxy settings</a></h4>
<div class="paragraph">
<p>A proxy for S3 can be configured using the following system properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>https.proxyHost</code></p>
</li>
<li>
<p><code>https.proxyPort</code></p>
</li>
<li>
<p><code>https.proxyUser</code></p>
</li>
<li>
<p><code>https.proxyPassword</code></p>
</li>
<li>
<p><code>https.nonProxyHosts</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the <code>org.gradle.s3.endpoint</code> property has been specified with a HTTP (not HTTPS) URI the following system proxy settings can be used:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>http.proxyHost</code></p>
</li>
<li>
<p><code>http.proxyPort</code></p>
</li>
<li>
<p><code>http.proxyUser</code></p>
</li>
<li>
<p><code>http.proxyPassword</code></p>
</li>
<li>
<p><code>http.nonProxyHosts</code></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="sub:s3_v4_signatures"><a class="anchor" href="#sub:s3_v4_signatures"></a><a class="link" href="#sub:s3_v4_signatures">AWS S3 V4 Signatures (AWS4-HMAC-SHA256)</a></h4>
<div class="paragraph">
<p>Some of the AWS S3 regions (eu-central-1 - Frankfurt) require that all HTTP requests are signed in accordance with AWS&#8217;s <a href="http://docs.aws.amazon.com/general/latest/gr/signature-version-4.html">signature version 4</a>. It is recommended to specify S3 URL&#8217;s containing the region specific endpoint when using buckets that require V4 signatures. e.g.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>s3://somebucket.s3.eu-central-1.amazonaws.com/maven/release</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When a region-specific endpoint is not specified for buckets requiring V4 Signatures, Gradle will use the default AWS region (us-east-1) and the
following warning will appear on the console:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Attempting to re-send the request to &#8230;&#8203;. with AWS V4 authentication. To avoid this warning in the future, use region-specific endpoint to access buckets located in regions that require V4 signing.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>Failing to specify the region-specific endpoint for buckets requiring V4 signatures means:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>3 round-trips to AWS, as opposed to one, for every file upload and download.</p>
</li>
<li>
<p>Depending on location - increased network latencies and slower builds.</p>
</li>
<li>
<p>Increased likelihood of transmission failures.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="sub:s3_cross_account"><a class="anchor" href="#sub:s3_cross_account"></a><a class="link" href="#sub:s3_cross_account">AWS S3 Cross Account Access</a></h5>
<div class="paragraph">
<p>Some organizations may have multiple AWS accounts, e.g. one for each team. The AWS account of the bucket owner is often different from the artifact publisher and consumers. The bucket owner needs to be able to grant the consumers access otherwise the artifacts will only be usable by the publisher&#8217;s account. This is done by adding the <code>bucket-owner-full-control</code> <a href="https://docs.aws.amazon.com/AmazonS3/latest/dev/acl-overview.html#canned-acl">Canned ACL</a> to the uploaded objects. Gradle will do this in every upload. Make sure the publisher has the required IAM permission, <code>PutObjectAcl</code> (and <code>PutObjectVersionAcl</code> if bucket versioning is enabled), either directly or via an assumed IAM Role (depending on your case). You can read more at <a href="https://docs.aws.amazon.com/AmazonS3/latest/dev/s3-access-control.html">AWS S3 Access Permissions</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec:gcs-repositories"><a class="anchor" href="#sec:gcs-repositories"></a><a class="link" href="#sec:gcs-repositories">Google Cloud Storage repositories configuration</a></h3>
<div class="sect3">
<h4 id="sub:gcs_configuration_properties"><a class="anchor" href="#sub:gcs_configuration_properties"></a><a class="link" href="#sub:gcs_configuration_properties">GCS configuration properties</a></h4>
<div class="paragraph">
<p>The following system properties can be used to configure the interactions with <a href="https://cloud.google.com/storage/">Google Cloud Storage</a> repositories:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>org.gradle.gcs.endpoint</code></dt>
<dd>
<p>Used to override the Google Cloud Storage endpoint when using a non-Google Cloud Platform, Google Cloud Storage API compatible, storage service.</p>
</dd>
<dt class="hdlist1"><code>org.gradle.gcs.servicePath</code></dt>
<dd>
<p>Used to override the Google Cloud Storage root service path which the Google Cloud Storage client builds requests from, defaults to <code>/</code>.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="sub:gcs_url_formats"><a class="anchor" href="#sub:gcs_url_formats"></a><a class="link" href="#sub:gcs_url_formats">GCS URL formats</a></h4>
<div class="paragraph">
<p>Google Cloud Storage URL&#8217;s are 'virtual-hosted-style' and must be in the following format <code>gcs://&lt;bucketName&gt;/&lt;objectKey&gt;</code></p>
</div>
<div class="paragraph">
<p>e.g. <code>gcs://myBucket/maven/release</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>myBucket</code> is the Google Cloud Storage bucket name.</p>
</li>
<li>
<p><code>/maven/release</code> is the Google Cloud Storage key (unique identifier for an object within a bucket)</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="declaring-dependencies"><a class="anchor" href="#declaring-dependencies"></a><a class="link" href="#declaring-dependencies">Declaring dependencies</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before looking at dependency declarations themselves, the concept of <em>dependency configuration</em> needs to be defined.</p>
</div>
<div class="sect2">
<h3 id="sec:what-are-dependency-configurations"><a class="anchor" href="#sec:what-are-dependency-configurations"></a><a class="link" href="#sec:what-are-dependency-configurations">What are dependency configurations</a></h3>
<div class="paragraph">
<p>Every dependency declared for a Gradle project applies to a specific scope.
For example some dependencies should be used for compiling source code whereas others only need to be available at runtime.
Gradle represents the scope of a dependency with the help of a <a href="../dsl/org.gradle.api.artifacts.Configuration.html">Configuration</a>.
Every configuration can be identified by a unique name.</p>
</div>
<div class="paragraph">
<p>Many Gradle plugins add pre-defined configurations to your project.
The Java plugin, for example, adds configurations to represent the various classpaths it needs for source code compilation, executing tests and the like.
See <a href="java_plugin.html#sec:java_plugin_and_dependency_management">the Java plugin chapter</a> for an example.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/dependency-management-configurations.png" alt="dependency management configurations">
</div>
<div class="title">Figure 4. Configurations use declared dependencies for specific purposes</div>
</div>
<div class="paragraph">
<p>For more examples on the usage of configurations to navigate, inspect and post-process metadata and artifacts of assigned dependencies, have a look at the <a href="#sec:programmatic_api">resolution result APIs</a>.</p>
</div>
<div class="sect3">
<h4 id="sub:config-inheritance-composition"><a class="anchor" href="#sub:config-inheritance-composition"></a><a class="link" href="#sub:config-inheritance-composition">Configuration inheritance and composition</a></h4>
<div class="paragraph">
<p>A configuration can extend other configurations to form an inheritance hierarchy.
Child configurations inherit the whole set of dependencies declared for any of its superconfigurations.</p>
</div>
<div class="paragraph">
<p>Configuration inheritance is heavily used by Gradle core plugins like the <a href="java_plugin.html#sec:java_plugin_and_dependency_management">Java plugin</a>.
For example the <code>testImplementation</code> configuration extends the <code>implementation</code> configuration.
 The configuration hierarchy has a practical purpose: compiling tests requires the dependencies of the source code under test on top of the dependencies needed write the test class.
 A Java project that uses JUnit to write and execute test code also needs Guava if its classes are imported in the production source code.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/dependency-management-configuration-inheritance.png" alt="dependency management configuration inheritance">
</div>
<div class="title">Figure 5. Configuration inheritance provided by the Java plugin</div>
</div>
<div class="paragraph">
<p>Under the covers the <code>testImplementation</code> and <code>implementation</code> configurations form an inheritance hierarchy by calling the method <a href="../dsl/org.gradle.api.artifacts.Configuration.html#org.gradle.api.artifacts.Configuration:extendsFrom(org.gradle.api.artifacts.Configuration[])">Configuration.extendsFrom(org.gradle.api.artifacts.Configuration[])</a>.
A configuration can extend any other configuration irrespective of its definition in the build script or a plugin.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s say you wanted to write a suite of smoke tests.
Each smoke test makes a HTTP call to verify a web service endpoint.
As the underlying test framework the project already uses JUnit.
You can define a new configuration named <code>smokeTest</code> that extends from the <code>testImplementation</code> configuration to reuse the existing test framework dependency.</p>
</div>
<div class="exampleblock">
<div class="title">Example 29. Extending a configuration from another configuration</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">configurations {
    smokeTest.extendsFrom testImplementation
}

dependencies {
    testImplementation 'junit:junit:4.12'
    smokeTest 'org.apache.httpcomponents:httpclient:4.5.5'
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">val smokeTest by configurations.creating {
    extendsFrom(configurations.testImplementation.get())
}

dependencies {
    testImplementation("junit:junit:4.12")
    smokeTest("org.apache.httpcomponents:httpclient:4.5.5")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec:resolvable-consumable-configs"><a class="anchor" href="#sec:resolvable-consumable-configs"></a><a class="link" href="#sec:resolvable-consumable-configs">Resolvable and consumable configurations</a></h3>
<div class="paragraph">
<p>Configurations are a fundamental part of dependency resolution in Gradle.
In the context of dependency resolution, it is useful to distinguish between a <em>consumer</em> and a <em>producer</em>. Along these lines, configurations have at least 3 different roles:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>to declare dependencies</p>
</li>
<li>
<p>as a <em>consumer</em>, to resolve a set of dependencies to files</p>
</li>
<li>
<p>as a <em>producer</em>, to expose artifacts and their dependencies for consumption by other projects
(such <em>consumable</em> configurations usually represent the <a href="#">variants</a> the producer offers to its consumers)</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>For example, to express that an application <code>app</code> <em>depends on</em> library <code>lib</code>, <em>at least</em> one configuration is required:</p>
</div>
<div class="exampleblock">
<div class="title">Example 30. Configurations are used to declare dependencies</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">configurations {
    // declare a "configuration" named "someConfiguration"
    someConfiguration
}
dependencies {
    // add a project dependency to the "someConfiguration" configuration
    someConfiguration project(":lib")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">// declare a "configuration" named "someConfiguration"
val someConfiguration by configurations.creating

dependencies {
    // add a project dependency to the "someConfiguration" configuration
    someConfiguration(project(":lib"))
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Configurations can inherit dependencies from other configurations by extending from them.
Now, notice that the code above doesn&#8217;t tell us anything about the intended <em>consumer</em> of this configuration.
In particular, it doesn&#8217;t tell us how the configuration is meant to be <em>used</em>.
Let&#8217;s say that <code>lib</code> is a Java library: it might expose different things, such as its API, implementation, or test fixtures.
It might be necessary to change how we resolve the dependencies of <code>app</code> depending upon the task we&#8217;re performing (compiling against the API of <code>lib</code>, executing the application, compiling tests, etc.).
To address this problem, you&#8217;ll often find companion configurations, which are meant to unambiguously declare the usage:</p>
</div>
<div class="exampleblock">
<div class="title">Example 31. Configurations representing concrete dependency graphs</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">configurations {
    // declare a configuration that is going to resolve the compile classpath of the application
    compileClasspath.extendsFrom(someConfiguration)

    // declare a configuration that is going to resolve the runtime classpath of the application
    runtimeClasspath.extendsFrom(someConfiguration)
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">configurations {
    // declare a configuration that is going to resolve the compile classpath of the application
    compileClasspath.extendsFrom(someConfiguration)

    // declare a configuration that is going to resolve the runtime classpath of the application
    runtimeClasspath.extendsFrom(someConfiguration)
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>At this point, we have 3 different configurations with different roles:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>someConfiguration</code> declares the dependencies of my application. It&#8217;s just a bucket that can hold a list of dependencies.</p>
</li>
<li>
<p><code>compileClasspath</code> and <code>runtimeClasspath</code> are configurations <em>meant to be resolved</em>: when resolved they should contain the compile classpath, and the runtime classpath of the application respectively.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This distinction is represented by the <code>canBeResolved</code> flag in the <code>Configuration</code> type.
A configuration that <em>can be resolved</em> is a configuration for which we can compute a dependency graph, because it contains all the necessary information for resolution to happen.
That is to say we&#8217;re going to compute a dependency graph, resolve the components in the graph, and eventually get artifacts.
A configuration which has <code>canBeResolved</code> set to <code>false</code> is not meant to be resolved.
Such a configuration is there <em>only to declare dependencies</em>.
The reason is that depending on the usage (compile classpath, runtime classpath), it <em>can</em> resolve to different graphs.
It is an error to try to resolve a configuration which has <code>canBeResolved</code> set to <code>false</code>.
To some extent, this is similar to an <em>abstract class</em> (<code>canBeResolved</code>=false) which is not supposed to be instantiated, and a concrete class extending the abstract class (<code>canBeResolved</code>=true).
A resolvable configuration will extend at least one non-resolvable configuration (and may extend more than one).</p>
</div>
<div class="paragraph">
<p>On the other end, at the library project side (the <em>producer</em>), we also use configurations to represent what can be consumed.
For example, the library may expose an API or a runtime, and we would attach artifacts to either one, the other, or both.
Typically, to compile against <code>lib</code>, we need the API of <code>lib</code>, but we don&#8217;t need its runtime dependencies.
So the <code>lib</code> project will expose an <code>apiElements</code> configuration, which is aimed at consumers looking for its API.
Such a configuration is consumable, but is not meant to be resolved.
This is expressed via the <em>canBeConsumed</em> flag of a <code>Configuration</code>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 32. Setting up configurations</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">configurations {
    // A configuration meant for consumers that need the API of this component
    exposedApi {
        // This configuration is an "outgoing" configuration, it's not meant to be resolved
        canBeResolved = false
        // As an outgoing configuration, explain that consumers may want to consume it
        canBeConsumed = true
    }
    // A configuration meant for consumers that need the implementation of this component
    exposedRuntime {
        canBeResolved = false
        canBeConsumed = true
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">configurations {
    // A configuration meant for consumers that need the API of this component
    create("exposedApi") {
        // This configuration is an "outgoing" configuration, it's not meant to be resolved
        isCanBeResolved = false
        // As an outgoing configuration, explain that consumers may want to consume it
        isCanBeConsumed = true
    }
    // A configuration meant for consumers that need the implementation of this component
    create("exposedRuntime") {
        isCanBeResolved = false
        isCanBeConsumed = true
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In short, a configuration&#8217;s role is determined by the <code>canBeResolved</code> and <code>canBeConsumed</code> flag combinations:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. Configuration roles</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configuration role</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">can be resolved</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">can be consumed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bucket of dependencies</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Resolve for certain usage</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exposed to consumers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Legacy, don&#8217;t use</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>For backwards compatibility, both flags have a default value of <code>true</code>, but as a plugin author, you should always determine the right values for those flags, or you might accidentally introduce resolution errors.</p>
</div>
</div>
<div class="sect2">
<h3 id="sec:choosing-configuration"><a class="anchor" href="#sec:choosing-configuration"></a><a class="link" href="#sec:choosing-configuration">Choosing the right configuration for dependencies</a></h3>
<div class="paragraph">
<p>The choice of the configuration where you declare a dependency is important.
However there is no fixed rule into which configuration a dependency must go.
It mostly depends on the way the configurations are organised, which is most often a property of the applied plugin(s).</p>
</div>
<div class="paragraph">
<p>For example, in the <code>java</code> plugin, the created configuration are <a href="java_plugin.html#tab:configurations">documented</a> and should serve as the basis for determining where to declare a dependency, based on its role for your code.</p>
</div>
<div class="paragraph">
<p>As a recommendation, plugins should clearly document the way their configurations are linked together and should strive as much as possible to isolate their <a href="#sec:resolvable-consumable-configs">roles</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="sec:defining-custom-configurations"><a class="anchor" href="#sec:defining-custom-configurations"></a><a class="link" href="#sec:defining-custom-configurations">Defining custom configurations</a></h3>
<div class="paragraph">
<p>You can define configurations yourself, so-called <em>custom configurations</em>.
A custom configuration is useful for separating the scope of dependencies needed for a dedicated purpose.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s say you wanted to declare a dependency on the <a href="https://tomcat.apache.org/tomcat-9.0-doc/jasper-howto.html">Jasper Ant task</a> for the purpose of pre-compiling JSP files that should <em>not</em> end up in the classpath for compiling your source code.
It&#8217;s fairly simple to achieve that goal by introducing a custom configuration and using it in a task.</p>
</div>
<div class="exampleblock">
<div class="title">Example 33. Declaring and using a custom configuration</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">configurations {
    jasper
}

repositories {
    mavenCentral()
}

dependencies {
    jasper 'org.apache.tomcat.embed:tomcat-embed-jasper:9.0.2'
}

task preCompileJsps {
    doLast {
        ant.taskdef(classname: 'org.apache.jasper.JspC',
                    name: 'jasper',
                    classpath: configurations.jasper.asPath)
        ant.jasper(validateXml: false,
                   uriroot: file('src/main/webapp'),
                   outputDir: file("$buildDir/compiled-jsps"))
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">val jasper by configurations.creating

repositories {
    mavenCentral()
}

dependencies {
    jasper("org.apache.tomcat.embed:tomcat-embed-jasper:9.0.2")
}

tasks.register("preCompileJsps") {
    doLast {
        ant.withGroovyBuilder {
            "taskdef"("classname" to "org.apache.jasper.JspC",
                      "name" to "jasper",
                      "classpath" to jasper.asPath)
            "jasper"("validateXml" to false,
                     "uriroot" to file("src/main/webapp"),
                     "outputDir" to file("$buildDir/compiled-jsps"))
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>A project&#8217;s configurations are managed by a <code>configurations</code> object.
Configurations have a name and can extend each other.
To learn more about this API have a look at <a href="../dsl/org.gradle.api.artifacts.ConfigurationContainer.html">ConfigurationContainer</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="sec:dependency-types"><a class="anchor" href="#sec:dependency-types"></a><a class="link" href="#sec:dependency-types">Different kinds of dependencies</a></h3>
<div class="sect3">
<h4 id="sub:module_dependencies"><a class="anchor" href="#sub:module_dependencies"></a><a class="link" href="#sub:module_dependencies">Module dependencies</a></h4>
<div class="paragraph">
<p>Module dependencies are the most common dependencies. They refer to a module in a repository.</p>
</div>
<div class="exampleblock">
<div class="title">Example 34. Module dependencies</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">dependencies {
    runtimeOnly group: 'org.springframework', name: 'spring-core', version: '2.5'
    runtimeOnly 'org.springframework:spring-core:2.5',
            'org.springframework:spring-aop:2.5'
    runtimeOnly(
        [group: 'org.springframework', name: 'spring-core', version: '2.5'],
        [group: 'org.springframework', name: 'spring-aop', version: '2.5']
    )
    runtimeOnly('org.hibernate:hibernate:3.0.5') {
        transitive = true
    }
    runtimeOnly group: 'org.hibernate', name: 'hibernate', version: '3.0.5', transitive: true
    runtimeOnly(group: 'org.hibernate', name: 'hibernate', version: '3.0.5') {
        transitive = true
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">dependencies {
    runtimeOnly(group = "org.springframework", name = "spring-core", version = "2.5")
    runtimeOnly("org.springframework:spring-aop:2.5")
    runtimeOnly("org.hibernate:hibernate:3.0.5") {
        isTransitive = true
    }
    runtimeOnly(group = "org.hibernate", name = "hibernate", version = "3.0.5") {
        isTransitive = true
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>See the <a href="../dsl/org.gradle.api.artifacts.dsl.DependencyHandler.html">DependencyHandler</a> class in the API documentation for more examples and a complete reference.</p>
</div>
<div class="paragraph">
<p>Gradle provides different notations for module dependencies. There is a string notation and a map notation. A module dependency has an API which allows further configuration. Have a look at <a href="../javadoc/org/gradle/api/artifacts/ExternalModuleDependency.html">ExternalModuleDependency</a> to learn all about the API. This API provides properties and configuration methods. Via the string notation you can define a subset of the properties. With the map notation you can define all properties. To have access to the complete API, either with the map or with the string notation, you can assign a single dependency to a configuration together with a closure.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you declare a module dependency, Gradle looks for a module metadata file (<code>.module</code>, <code>.pom</code> or <code>ivy.xml</code>) in the repositories.
If such a module metadata file exists, it is parsed and the artifacts of this module (e.g. <code>hibernate-3.0.5.jar</code>) as well as its dependencies (e.g. <code>cglib</code>) are downloaded.
If no such module metadata file exists, as of Gradle 6.0, you need to configure <a href="#sec:supported_metadata_sources">metadata sources definitions</a> to look for an artifact file called <code>hibernate-3.0.5.jar</code> directly.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In Maven, a module can have one and only one artifact.</p>
</div>
<div class="paragraph">
<p>In Gradle and Ivy, a module can have multiple artifacts.
Each artifact can have a different set of dependencies.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="sub:file_dependencies"><a class="anchor" href="#sub:file_dependencies"></a><a class="link" href="#sub:file_dependencies">File dependencies</a></h4>
<div class="paragraph">
<p>Projects sometimes do not rely on a binary repository product e.g. JFrog Artifactory or Sonatype Nexus for hosting and resolving external dependencies.
It&#8217;s common practice to host those dependencies on a shared drive or check them into version control alongside the project source code.
Those dependencies are referred to as <em>file dependencies</em>, the reason being that they represent a file without any <a href="#sub:terminology_module_metadata">metadata</a> (like information about transitive dependencies, the origin or its author) attached to them.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/dependency-management-file-dependencies.png" alt="dependency management file dependencies">
</div>
<div class="title">Figure 6. Resolving file dependencies from the local file system and a shared drive</div>
</div>
<div class="paragraph">
<p>The following example resolves file dependencies from the directories <code>ant</code>, <code>libs</code> and <code>tools</code>.</p>
</div>
<div class="exampleblock">
<div class="title">Example 35. Declaring multiple file dependencies</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">configurations {
    antContrib
    externalLibs
    deploymentTools
}

dependencies {
    antContrib files('ant/antcontrib.jar')
    externalLibs files('libs/commons-lang.jar', 'libs/log4j.jar')
    deploymentTools(fileTree('tools') { include '*.exe' })
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">configurations {
    create("antContrib")
    create("externalLibs")
    create("deploymentTools")
}

dependencies {
    "antContrib"(files("ant/antcontrib.jar"))
    "externalLibs"(files("libs/commons-lang.jar", "libs/log4j.jar"))
    "deploymentTools"(fileTree("tools") { include("*.exe") })
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>As you can see in the code example, every dependency has to define its exact location in the file system.
The most prominent methods for creating a file reference are
<a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:files(java.lang.Object[])">Project.files(java.lang.Object&#8230;&#8203;)</a>,
<a href="../javadoc/org/gradle/api/file/ProjectLayout.html#files-java.lang.Object...-">ProjectLayout.files(java.lang.Object&#8230;&#8203;)</a>
and <a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:fileTree(java.lang.Object)">Project.fileTree(java.lang.Object)</a>
Alternatively, you can also define the source directory of one or many file dependencies in the form of a <a href="#sub:flat_dir_resolver">flat directory repository</a>.</p>
</div>
<div class="paragraph">
<p>File dependencies allow you to directly add a set of files to a configuration, without first adding them to a repository. This can be useful if you cannot, or do not want to, place certain files in a repository. Or if you do not want to use any repositories at all for storing your dependencies.</p>
</div>
<div class="paragraph">
<p>To add some files as a dependency for a configuration, you simply pass a <a href="working_with_files.html#sec:file_collections">file collection</a> as a dependency:</p>
</div>
<div class="exampleblock">
<div class="title">Example 36. File dependencies</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">dependencies {
    runtimeOnly files('libs/a.jar', 'libs/b.jar')
    runtimeOnly fileTree('libs') { include '*.jar' }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">dependencies {
    runtimeOnly(files("libs/a.jar", "libs/b.jar"))
    runtimeOnly(fileTree("libs") { include("*.jar") })
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>File dependencies are not included in the published dependency descriptor for your project.
However, file dependencies are included in transitive project dependencies within the same build.
This means they cannot be used outside the current build, but they can be used within the same build.</p>
</div>
<div class="paragraph">
<p>You can declare which tasks produce the files for a file dependency.
You might do this when, for example, the files are generated by the build.</p>
</div>
<div class="exampleblock">
<div class="title">Example 37. Generated file dependencies</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">dependencies {
    implementation files("$buildDir/classes") {
        builtBy 'compile'
    }
}

task compile {
    doLast {
        println 'compiling classes'
    }
}

task list(dependsOn: configurations.compileClasspath) {
    doLast {
        println "classpath = ${configurations.compileClasspath.collect { File file -&gt; file.name }}"
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">dependencies {
    implementation(files("$buildDir/classes") {
        builtBy("compile")
    })
}

tasks.register("compile") {
    doLast {
        println("compiling classes")
    }
}

tasks.register("list") {
    dependsOn(configurations["compileClasspath"])
    doLast {
        println("classpath = ${configurations["compileClasspath"].map { file: File -&gt; file.name }}")
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gradle -q list
compiling classes
classpath = [classes]</pre>
</div>
</div>
<div class="sect4">
<h5 id="sec:versioning_file_dependencies"><a class="anchor" href="#sec:versioning_file_dependencies"></a><a class="link" href="#sec:versioning_file_dependencies">Versioning of file dependencies</a></h5>
<div class="paragraph">
<p>It is recommended to clearly express the intention and a concrete version for file dependencies.
File dependencies are not considered by Gradle&#8217;s <a href="#sec:how-gradle-downloads-deps">version conflict resolution</a>.
Therefore, it is extremely important to assign a version to the file name to indicate the distinct set of changes shipped with it.
For example <code>commons-beanutils-1.3.jar</code> lets you track the changes of the library by the release notes.</p>
</div>
<div class="paragraph">
<p>As a result, the dependencies of the project are easier to maintain and organize.
It is much easier to uncover potential API incompatibilities by the assigned version.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sub:project_dependencies"><a class="anchor" href="#sub:project_dependencies"></a><a class="link" href="#sub:project_dependencies">Project dependencies</a></h4>
<div class="paragraph">
<p>Software projects often break up software components into modules to improve maintainability and prevent strong coupling.
Modules can define dependencies between each other to reuse code within the same project.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/dependency-management-project-dependencies.png" alt="dependency management project dependencies">
</div>
<div class="title">Figure 7. Dependencies between projects</div>
</div>
<div class="paragraph">
<p>Gradle can model dependencies between modules.
Those dependencies are called <em>project dependencies</em> because each module is represented by a Gradle project.</p>
</div>
<div class="exampleblock">
<div class="title">Example 38. Project dependencies</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">dependencies {
    implementation project(':shared')
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">dependencies {
    implementation(project(":shared"))
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>At runtime, the build automatically ensures that project dependencies are built in the correct order and added to the classpath for compilation.
The chapter <a href="multi_project_builds.html#multi_project_builds">Authoring Multi-Project Builds</a> discusses how to set up and configure multi-project builds in more detail.</p>
</div>
<div class="paragraph">
<p>For more information see the API documentation for <a href="../javadoc/org/gradle/api/artifacts/ProjectDependency.html">ProjectDependency</a>.</p>
</div>
<div class="paragraph">
<p>The following example declares the dependencies on the <code>utils</code> and <code>api</code> project from the <code>web-service</code> project. The method <a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:project(java.lang.String)">Project.project(java.lang.String)</a> creates a reference to a specific subproject by path.</p>
</div>
<div class="exampleblock">
<div class="title">Example 39. Declaring project dependencies</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">project(':web-service') {
    dependencies {
        implementation project(':utils')
        implementation project(':api')
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">project(":web-service") {
    dependencies {
        "implementation"(project(":utils"))
        "implementation"(project(":api"))
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="local_forks_of_module_dependencies"><a class="anchor" href="#local_forks_of_module_dependencies"></a><a class="link" href="#local_forks_of_module_dependencies">Local forks of module dependencies</a></h4>
<div class="paragraph">
<p>A module dependency can be substituted by a dependency to a local fork of the sources of that module, if the module itself is built with Gradle.
This can be done by utilising <a href="#defining_composite_builds">composite builds</a>.
This allows you, for example, to fix an issue in a library you use in an application by using, and building, a locally patched version instead of the published binary version.
The details of this are described in the section on <a href="#defining_composite_builds">composite builds</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="sub:gradle_distribution_dependencies"><a class="anchor" href="#sub:gradle_distribution_dependencies"></a><a class="link" href="#sub:gradle_distribution_dependencies">Gradle distribution-specific dependencies</a></h4>
<div class="sect4">
<h5 id="sub:api_dependencies"><a class="anchor" href="#sub:api_dependencies"></a><a class="link" href="#sub:api_dependencies">Gradle API dependency</a></h5>
<div class="paragraph">
<p>You can declare a dependency on the API of the current version of Gradle by using the <a href="../dsl/org.gradle.api.artifacts.dsl.DependencyHandler.html#org.gradle.api.artifacts.dsl.DependencyHandler:gradleApi()">DependencyHandler.gradleApi()</a> method. This is useful when you are developing custom Gradle tasks or plugins.</p>
</div>
<div class="exampleblock">
<div class="title">Example 40. Gradle API dependencies</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">dependencies {
    implementation gradleApi()
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">dependencies {
    implementation(gradleApi())
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sub:testkit_dependencies"><a class="anchor" href="#sub:testkit_dependencies"></a><a class="link" href="#sub:testkit_dependencies">Gradle TestKit dependency</a></h5>
<div class="paragraph">
<p>You can declare a dependency on the TestKit API of the current version of Gradle by using the <a href="../dsl/org.gradle.api.artifacts.dsl.DependencyHandler.html#org.gradle.api.artifacts.dsl.DependencyHandler:gradleTestKit()">DependencyHandler.gradleTestKit()</a> method. This is useful for writing and executing functional tests for Gradle plugins and build scripts.</p>
</div>
<div class="exampleblock">
<div class="title">Example 41. Gradle TestKit dependencies</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">dependencies {
    testImplementation gradleTestKit()
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">dependencies {
    testImplementation(gradleTestKit())
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p><a href="test_kit.html#test_kit">The TestKit chapter</a> explains the use of TestKit by example.</p>
</div>
</div>
<div class="sect4">
<h5 id="sub:groovy_dependencies"><a class="anchor" href="#sub:groovy_dependencies"></a><a class="link" href="#sub:groovy_dependencies">Local Groovy dependency</a></h5>
<div class="paragraph">
<p>You can declare a dependency on the Groovy that is distributed with Gradle by using the <a href="../dsl/org.gradle.api.artifacts.dsl.DependencyHandler.html#org.gradle.api.artifacts.dsl.DependencyHandler:localGroovy()">DependencyHandler.localGroovy()</a> method. This is useful when you are developing custom Gradle tasks or plugins in Groovy.</p>
</div>
<div class="exampleblock">
<div class="title">Example 42. Gradle&#8217;s Groovy dependencies</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">dependencies {
    implementation localGroovy()
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">dependencies {
    implementation(localGroovy())
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec:documenting-dependencies"><a class="anchor" href="#sec:documenting-dependencies"></a><a class="link" href="#sec:documenting-dependencies">Documenting dependencies</a></h3>
<div class="paragraph">
<p>When you declare a dependency or a <a href="#sec:adding-constraints-transitive-deps">dependency constraint</a>, you can provide a custom reason for the declaration.
This makes the dependency declarations in your build script and the <a href="#sec:identifying_reason_dependency_selection">dependency insight report</a> easier to interpret.</p>
</div>
<div class="exampleblock">
<div class="title">Example 43. Giving a reason for choosing a certain module version in a dependency declaration</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">plugins {
    id 'java-library'
}

repositories {
    jcenter()
}

dependencies {
    implementation('org.ow2.asm:asm:7.1') {
        because 'we require a JDK 9 compatible bytecode generator'
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">plugins {
    `java-library`
}

repositories {
    jcenter()
}

dependencies {
    implementation("org.ow2.asm:asm:7.1") {
        because("we require a JDK 9 compatible bytecode generator")
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="example_using_the_dependency_insight_report_with_custom_reasons"><a class="anchor" href="#example_using_the_dependency_insight_report_with_custom_reasons"></a><a class="link" href="#example_using_the_dependency_insight_report_with_custom_reasons">Example: Using the dependency insight report with custom reasons</a></h4>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q dependencyInsight --dependency asm</code></strong></div>
<div class="content">
<pre>&gt; gradle -q dependencyInsight --dependency asm
org.ow2.asm:asm:7.1
   variant "compile" [
      org.gradle.status              = release (not requested)
      org.gradle.usage               = java-api
      org.gradle.libraryelements     = jar (compatible with: classes)
      org.gradle.category            = library

      Requested attributes not found in the selected variant:
         org.gradle.dependency.bundling = external
         org.gradle.jvm.version = 11
   ]
   Selection reasons:
      - Was requested : we require a JDK 9 compatible bytecode generator

org.ow2.asm:asm:7.1
\--- compileClasspath

A web-based, searchable dependency report is available by adding the --scan option.</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec:resolve_specific_artifacts_from_dependency"><a class="anchor" href="#sec:resolve_specific_artifacts_from_dependency"></a><a class="link" href="#sec:resolve_specific_artifacts_from_dependency">Resolving specific artifacts from a module dependency</a></h3>
<div class="paragraph">
<p>Whenever Gradle tries to resolve a module from a Maven or Ivy repository, it looks for a metadata file and the default artifact file, a JAR. The build fails if none of these artifact files can be resolved. Under certain conditions, you might want to tweak the way Gradle resolves artifacts for a dependency.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The dependency only provides a non-standard artifact without any metadata e.g. a ZIP file.</p>
</li>
<li>
<p>The module metadata declares more than one artifact e.g. as part of an Ivy dependency descriptor.</p>
</li>
<li>
<p>You only want to download a specific artifact without any of the transitive dependencies declared in the metadata.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Gradle is a polyglot build tool and not limited to just resolving Java libraries. Let&#8217;s assume you wanted to build a web application using JavaScript as the client technology. Most projects check in external JavaScript libraries into version control. An external JavaScript library is no different than a reusable Java library so why not download it from a repository instead?</p>
</div>
<div class="paragraph">
<p><a href="https://developers.google.com/speed/libraries/">Google Hosted Libraries</a> is a distribution platform for popular, open-source JavaScript libraries. With the help of the artifact-only notation you can download a JavaScript library file e.g. JQuery. The <code>@</code> character separates the dependency&#8217;s coordinates from the artifact&#8217;s file extension.</p>
</div>
<div class="exampleblock">
<div class="title">Example 44. Resolving a JavaScript artifact for a declared dependency</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">repositories {
    ivy {
        url 'https://ajax.googleapis.com/ajax/libs'
        patternLayout {
            artifact '[organization]/[revision]/[module].[ext]'
        }
        metadataSources {
            artifact()
        }
    }
}

configurations {
    js
}

dependencies {
    js 'jquery:jquery:3.2.1@js'
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">repositories {
    ivy {
        url = uri("https://ajax.googleapis.com/ajax/libs")
        patternLayout {
            artifact("[organization]/[revision]/[module].[ext]")
        }
        metadataSources {
            artifact()
        }
    }
}

configurations {
    create("js")
}

dependencies {
    "js"("jquery:jquery:3.2.1@js")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Some modules ship different "flavors" of the same artifact or they publish multiple artifacts that belong to a specific module version but have a different purpose. It&#8217;s common for a Java library to publish the artifact with the compiled class files, another one with just the source code in it and a third one containing the Javadocs.</p>
</div>
<div class="paragraph">
<p>In JavaScript, a library may exist as uncompressed or minified artifact. In Gradle, a specific artifact identifier is called <em>classifier</em>, a term generally used in Maven and Ivy dependency management.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s say we wanted to download the minified artifact of the JQuery library instead of the uncompressed file. You can provide the classifier <code>min</code> as part of the dependency declaration.</p>
</div>
<div class="exampleblock">
<div class="title">Example 45. Resolving a JavaScript artifact with classifier for a declared dependency</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">repositories {
    ivy {
        url 'https://ajax.googleapis.com/ajax/libs'
        patternLayout {
            artifact '[organization]/[revision]/[module](.[classifier]).[ext]'
        }
        metadataSources {
            artifact()
        }
    }
}

configurations {
    js
}

dependencies {
    js 'jquery:jquery:3.2.1:min@js'
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">repositories {
    ivy {
        url = uri("https://ajax.googleapis.com/ajax/libs")
        patternLayout {
            artifact("[organization]/[revision]/[module](.[classifier]).[ext]")
        }
        metadataSources {
            artifact()
        }
    }
}

configurations {
    create("js")
}

dependencies {
    "js"("jquery:jquery:3.2.1:min@js")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec:supported-metadata-formats"><a class="anchor" href="#sec:supported-metadata-formats"></a><a class="link" href="#sec:supported-metadata-formats">Supported Metadata formats</a></h3>
<div class="paragraph">
<p>External module dependencies require module metadata (so that, typically, Gradle can figure out the transitive dependencies of a module).
To do so, Gradle supports different metadata formats.</p>
</div>
<div class="paragraph">
<p>You can also tweak which format will be looked up in the <a href="#sec:supported_metadata_sources">repository definition</a>.</p>
</div>
<div class="sect3">
<h4 id="sub:supported-md-gradle"><a class="anchor" href="#sub:supported-md-gradle"></a><a class="link" href="#sub:supported-md-gradle">Gradle Module Metadata files</a></h4>
<div class="paragraph">
<p>Gradle Module Metadata has been specifically designed to support all features of Gradle&#8217;s dependency management model and is hence the preferred format.
You can find its <a href="https://github.com/gradle/gradle/blob/master/subprojects/docs/src/docs/design/gradle-module-metadata-latest-specification.md">specification here</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="sub:supported-md-pom"><a class="anchor" href="#sub:supported-md-pom"></a><a class="link" href="#sub:supported-md-pom">POM files</a></h4>
<div class="paragraph">
<p>Gradle natively supports <a href="https://maven.apache.org/pom.html">Maven POM files</a>.
It&#8217;s worth noting that by default Gradle will first look for a POM file, but if this file contains a special marker, Gradle will use <a href="#sub:supported-md-gradle">Gradle Module Metadata</a> instead.</p>
</div>
</div>
<div class="sect3">
<h4 id="sub:supported-md-ivy"><a class="anchor" href="#sub:supported-md-ivy"></a><a class="link" href="#sub:supported-md-ivy">Ivy files</a></h4>
<div class="paragraph">
<p>Similarly, Gradle supports <a href="http://ant.apache.org/ivy/">Apache Ivy metadata files</a>.
Again, Gradle will first look for an <code>ivy.xml</code> file, but if this file contains a special marker, Gradle will use <a href="#sub:supported-md-gradle">Gradle Module Metadata</a> instead.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec:understanding-diff-libraries-and-apps"><a class="anchor" href="#sec:understanding-diff-libraries-and-apps"></a><a class="link" href="#sec:understanding-diff-libraries-and-apps">Understanding the difference between libraries and applications</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="sub:producers-vs-consumers"><a class="anchor" href="#sub:producers-vs-consumers"></a><a class="link" href="#sub:producers-vs-consumers">Producers vs consumers</a></h3>
<div class="paragraph">
<p>A key concept in dependency management with Gradle is making the difference between consumers and producers.</p>
</div>
<div class="paragraph">
<p>When you <em>build</em> a library, you are effectively on the <em>producer</em> side: you are producing <em>artifacts</em> which are going to be <em>consumed</em> by someone else, the <em>consumer</em>.</p>
</div>
<div class="paragraph">
<p>A lot of problems with traditional build systems is that they don&#8217;t make the difference between a producer and a consumer.</p>
</div>
<div class="paragraph">
<p>A <em>consumer</em> needs to be understood in the large sense:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a project that depends on another project is a <em>consumer</em></p>
</li>
<li>
<p>a <em>task</em> that depends on an artifact is a finer grained consumer</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In dependency management, a lot of the decisions we make depend on the type of project we are building, that is to say, <a href="#sub:being-respectful-consumers">what kind of <em>consumer</em> we are</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="sub:producer-variants"><a class="anchor" href="#sub:producer-variants"></a><a class="link" href="#sub:producer-variants">Producer variants</a></h3>
<div class="paragraph">
<p>A producer may want to generate different artifacts for different kinds of consumers: for the same source code, different <em>binaries</em> are produced.
Or, a project may produce artifacts which are for consumption by other projects (same repository) but not for external use.</p>
</div>
<div class="paragraph">
<p>A typical example in the Java world is the Guava library which is published in different versions: one for Java projects, and one for Android projects.</p>
</div>
<div class="paragraph">
<p>However, it&#8217;s the consumer responsibility to tell what version to use, and it&#8217;s the dependency management engine responsibility to ensure <em>consistency of the graph</em> (for example making sure that you don&#8217;t end up with both Java and Android versions of Guava on your classpath).
This is where the <a href="#">variant model</a> of Gradle comes into play.</p>
</div>
<div class="paragraph">
<p>In Gradle, <em>producer variants</em> are exposed via <a href="#sec:resolvable-consumable-configs">consumable configurations</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="sub:strong-encapsulation"><a class="anchor" href="#sub:strong-encapsulation"></a><a class="link" href="#sub:strong-encapsulation">Strong encapsulation</a></h3>
<div class="paragraph">
<p>In order for a producer to compile a library, it needs all its <em>implementation dependencies</em> on the compile classpath.
There are dependencies which are only required <em>as an implementation detail</em> of the library and there are libraries which are effectively part of the API.</p>
</div>
<div class="paragraph">
<p>However, a library <em>depending</em> on this produced library only needs to "see" the public API of your library and therefore the dependencies of this API.
It&#8217;s a subset of the compile classpath of the producer: this is strong encapsulation of dependencies.</p>
</div>
<div class="paragraph">
<p>The consequence is that a dependency which is assigned to the <code>implementation</code> configuration of a library <em>does not end up on the compile classpath of the consumer</em>.
On the other hand, a dependency which is assigned to the <code>api</code> configuration of a library <em>would end up on the compile classpath of the consumer</em>.
At <em>runtime</em>, however, all dependencies are required.
Gradle makes the difference between different kinds of consumer even within a single project: the Java compile task, for example, is a different consumer than the Java exec task.</p>
</div>
<div class="paragraph">
<p>More details on the segregation of API and runtime dependencies in the Java world <a href="java_library_plugin.html">can be found here</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="sub:being-respectful-consumers"><a class="anchor" href="#sub:being-respectful-consumers"></a><a class="link" href="#sub:being-respectful-consumers">Being respectful of consumers</a></h3>
<div class="paragraph">
<p>Whenever, as a developer, you decide to include a dependency, you must understand that there are <em>consequences for your consumers</em>.
For example, if you add a dependency to your project, it becomes a <em>transitive dependency</em> of your consumers, and therefore may participate in conflict resolution if the consumer needs a different version.</p>
</div>
<div class="paragraph">
<p>A lot of the problems Gradle handles are about fixing the mismatch between the expectations of a consumer and a producer.</p>
</div>
<div class="paragraph">
<p>However, some projects are easier than others:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>if you are at the end of the consumption chain, that is to say you build an <em>application</em>, then there are effectively <em>no consumer</em> of your project (apart from final customers): adding <a href="#sec:excluding-transitive-deps">exclusions</a> will have no other consequence than fixing your problem.</p>
</li>
<li>
<p>however if you are a library, adding <a href="#sec:excluding-transitive-deps">exclusions</a> may prevent consumers from working properly, because they would exercise a path of the code that you don&#8217;t</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Always keep in mind that the solution you choose to fix a problem can "leak" to your consumers.
This documentation aims at guiding you to find the right solution to the right problem, and more importantly, make decisions which help the resolution engine to take the right decisions in case of conflicts.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="viewing-debugging-dependencies"><a class="anchor" href="#viewing-debugging-dependencies"></a><a class="link" href="#viewing-debugging-dependencies">Viewing and debugging dependencies</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Gradle provides sufficient tooling to navigate large dependency graphs and mitigate situations that can lead to <a href="https://en.wikipedia.org/wiki/Dependency_hell">dependency hell</a>.
Users can choose to render the full graph of dependencies as well as identify the selection reason and origin for a dependency.
The origin of a dependency can be a declared dependency in the build script or a transitive dependency in graph plus their corresponding configuration.
Gradle offers both capabilities through visual representation via build scans and as command line tooling.</p>
</div>
<div class="sect2">
<h3 id="sec:debugging-build-scans"><a class="anchor" href="#sec:debugging-build-scans"></a><a class="link" href="#sec:debugging-build-scans">Build scans</a></h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you do not know what <a href="https://scans.gradle.com/">build scan</a>s are, be sure to check them out!</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A build scan can visualize dependencies as a navigable, searchable tree.
Additional context information can be rendered by clicking on a specific dependency in the graph.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/dependency-management-dependencies-report-build-scan.png" alt="dependency management dependencies report build scan">
</div>
<div class="title">Figure 8. Dependency tree in a build scan</div>
</div>
</div>
<div class="sect2">
<h3 id="sec:listing_dependencies"><a class="anchor" href="#sec:listing_dependencies"></a><a class="link" href="#sec:listing_dependencies">Listing dependencies in a project</a></h3>
<div class="paragraph">
<p>Gradle can visualize the whole dependency tree for every <a href="#sec:what-are-dependency-configurations">configuration</a> available in the project.</p>
</div>
<div class="paragraph">
<p>Rendering the dependency tree is particularly useful if you&#8217;d like to identify which dependencies have been resolved at runtime.
It also provides you with information about any dependency conflict resolution that occurred in the process and clearly indicates the selected version.
The dependency report always contains declared and transitive dependencies.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s say you&#8217;d want to create tasks for your project that use the <a href="https://www.eclipse.org/jgit/">JGit library</a> to execute SCM operations e.g. to model a release process.
You can declare dependencies for any external tooling with the help of a <a href="#sec:what-are-dependency-configurations">custom configuration</a> so that it doesn&#8217;t pollute other contexts like the compilation classpath for your production source code.</p>
</div>
<div class="paragraph">
<p>Every Gradle project provides the task <code>dependencies</code> to render the so-called <em>dependency report</em> from the command line.
By default the dependency report renders dependencies for all configurations.
To focus on the information about one configuration, provide the optional parameter <code>--configuration</code>.</p>
</div>
<div class="exampleblock">
<div class="title">Example 46. Declaring the JGit dependency with a custom configuration</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">repositories {
    jcenter()
}

configurations {
    scm
}

dependencies {
    scm 'org.eclipse.jgit:org.eclipse.jgit:4.9.2.201712150930-r'
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">repositories {
    jcenter()
}

configurations {
    create("scm")
}

dependencies {
    "scm"("org.eclipse.jgit:org.eclipse.jgit:4.9.2.201712150930-r")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="example_rendering_the_dependency_report_for_a_custom_configuration"><a class="anchor" href="#example_rendering_the_dependency_report_for_a_custom_configuration"></a><a class="link" href="#example_rendering_the_dependency_report_for_a_custom_configuration">Example: Rendering the dependency report for a custom configuration</a></h4>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q dependencies --configuration scm</code></strong></div>
<div class="content">
<pre>&gt; gradle -q dependencies --configuration scm

------------------------------------------------------------
Root project
------------------------------------------------------------

scm
\--- org.eclipse.jgit:org.eclipse.jgit:4.9.2.201712150930-r
     +--- com.jcraft:jsch:0.1.54
     +--- com.googlecode.javaewah:JavaEWAH:1.1.6
     +--- org.apache.httpcomponents:httpclient:4.3.6
     |    +--- org.apache.httpcomponents:httpcore:4.3.3
     |    +--- commons-logging:commons-logging:1.1.3
     |    \--- commons-codec:commons-codec:1.6
     \--- org.slf4j:slf4j-api:1.7.2

A web-based, searchable dependency report is available by adding the --scan option.</pre>
</div>
</div>
<div class="paragraph">
<p>The dependencies report provides detailed information about the dependencies available in the graph.
Any dependency that could not be resolved is marked with <code>FAILED</code> in red color.
Dependencies with the same coordinates that can occur multiple times in the graph are omitted and indicated by an asterisk.
Dependencies that had to undergo conflict resolution render the requested and selected version separated by a right arrow character.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec:identifying_reason_dependency_selection"><a class="anchor" href="#sec:identifying_reason_dependency_selection"></a><a class="link" href="#sec:identifying_reason_dependency_selection">Identifying which dependency version was selected and why</a></h3>
<div class="paragraph">
<p>Large software projects inevitably deal with an increased number of dependencies either through direct or transitive dependencies.
The <a href="#sec:listing_dependencies">dependencies report</a> provides you with the raw list of dependencies but does not explain <em>why</em> they have been selected or <em>which</em> dependency is responsible for pulling them into the graph.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s have a look at a concrete example.
A project may request two different versions of the same dependency either as direct or transitive dependency.
Gradle applies <a href="#sec:version-conflict">version conflict resolution</a> to ensure that only one version of the dependency exists in the dependency graph.
In this example the conflicting dependency is represented by <code>commons-codec:commons-codec</code>.</p>
</div>
<div class="exampleblock">
<div class="title">Example 47. Declaring the JGit dependency and a conflicting dependency</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">repositories {
    jcenter()
}

configurations {
    scm
}

dependencies {
    scm 'org.eclipse.jgit:org.eclipse.jgit:4.9.2.201712150930-r'
    scm 'commons-codec:commons-codec:1.7'
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">repositories {
    jcenter()
}

configurations {
    create("scm")
}

dependencies {
    "scm"("org.eclipse.jgit:org.eclipse.jgit:4.9.2.201712150930-r")
    "scm"("commons-codec:commons-codec:1.7")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The dependency tree in a <a href="https://scans.gradle.com/">build scan</a> renders the selection reason (conflict resolution) as well as the origin of a dependency if you click on a dependency and select the "Required By" tab.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/dependency-management-dependency-insight-report-build-scan.png" alt="dependency management dependency insight report build scan">
</div>
<div class="title">Figure 9. Dependency insight capabilities in a build scan</div>
</div>
<div class="paragraph">
<p>Every Gradle project provides the task <code>dependencyInsight</code> to render the so-called  <em>dependency insight report</em> from the command line.
Given a dependency in the dependency graph you can identify the selection reason and track down the origin of the dependency selection. You can think of the dependency insight report as the inverse representation of the dependency report for a given dependency. When executing the task you have to provide the mandatory parameter <code>--dependency</code> to specify the coordinates of the dependency under inspection. The parameters <code>--configuration</code> and <code>--singlepath</code> are optional but help with filtering the output.</p>
</div>
<div class="sect3">
<h4 id="example_using_the_dependency_insight_report_for_a_given_dependency"><a class="anchor" href="#example_using_the_dependency_insight_report_for_a_given_dependency"></a><a class="link" href="#example_using_the_dependency_insight_report_for_a_given_dependency">Example: Using the dependency insight report for a given dependency</a></h4>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q dependencyInsight --dependency commons-codec --configuration scm</code></strong></div>
<div class="content">
<pre>&gt; gradle -q dependencyInsight --dependency commons-codec --configuration scm
commons-codec:commons-codec:1.7
   variant "default" [
      org.gradle.status = release (not requested)
   ]
   Selection reasons:
      - By conflict resolution : between versions 1.7 and 1.6

commons-codec:commons-codec:1.7
\--- scm

commons-codec:commons-codec:1.6 -&gt; 1.7
\--- org.apache.httpcomponents:httpclient:4.3.6
     \--- org.eclipse.jgit:org.eclipse.jgit:4.9.2.201712150930-r
          \--- scm

A web-based, searchable dependency report is available by adding the --scan option.</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec:resolving-version-conflict"><a class="anchor" href="#sec:resolving-version-conflict"></a><a class="link" href="#sec:resolving-version-conflict">Resolving version conflicts</a></h3>
<div class="paragraph">
<p>If the selected version does not match your expectation, Gradle offers a series of tools to help you <a href="#">control transitive dependencies</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="sec:resolving-variant-aware-errors"><a class="anchor" href="#sec:resolving-variant-aware-errors"></a><a class="link" href="#sec:resolving-variant-aware-errors">Resolving variant selection errors</a></h3>
<div class="paragraph">
<p>Sometimes a selection error will happen at the <a href="#">variant selection level</a>.
Have a look at the <a href="#sec:variant-select-errors">dedicated section</a> to understand these errors and how to resolve them.</p>
</div>
</div>
<div class="sect2">
<h3 id="sub:resolving-unsafe-configuration-resolution-errors"><a class="anchor" href="#sub:resolving-unsafe-configuration-resolution-errors"></a><a class="link" href="#sub:resolving-unsafe-configuration-resolution-errors">Resolving unsafe configuration resolution errors</a></h3>
<div class="paragraph">
<p>Configurations need to be resolved safely when crossing project boundaries because resolving a configuration can have side effects on Gradle&#8217;s project model.
Gradle can manage this safe access, but the configuration needs to be accessed in a way that enables Gradle to do so.
There are a number of ways a configuration might be resolved unsafely and Gradle will produce a deprecation warning for each unsafe access.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A task from one project directly resolves a configuration in another project.</p>
</li>
<li>
<p>A task specifies a configuration from another project as an input file collection.</p>
</li>
<li>
<p>A build script for a project resolves a configuration in another project during evaluation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If your build has an unsafe access deprecation warning, it needs to be fixed.
It&#8217;s a symptom of these bad practices and can cause strange and indeterminate errors.</p>
</div>
<div class="paragraph">
<p>In most cases, this issue can be resolved by creating a cross-project dependency on the other project.  See the documentation for <a href="#cross_project_publications">sharing outputs between projects</a> for more information.
If you find a use case that can&#8217;t be resolved using these techniques, please let us know by filing a <a href="https://github.com/gradle/gradle/issues">GitHub Issue</a> adhering to our issue guidelines.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="understanding_dependency_resolution"><a class="anchor" href="#understanding_dependency_resolution"></a><a class="link" href="#understanding_dependency_resolution">Understanding dependency resolution</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter covers the way dependency resolution works <em>inside</em> Gradle.
After covering how you can declare <a href="#">repositories</a> and <a href="#">dependencies</a>, it makes sense to explain how these declarations come together during dependency resolution.</p>
</div>
<div class="paragraph">
<p>Dependency resolution is a process that consists of two phases, which are repeated until the dependency graph is complete:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>When a new dependency is added to the graph, perform conflict resolution to determine which version should be added to the graph.</p>
</li>
<li>
<p>When a specific dependency, that is a module with a version, is identified as part of the graph, retrieve its metadata so that its dependencies can be added in turn.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following section will describe what Gradle identifies as conflict and how it can resolve them automatically.
After that, the retrieval of metadata will be covered, explaining how Gradle can <a href="#sec:how-gradle-downloads-deps">follow dependency links</a>.</p>
</div>
<div class="sect2">
<h3 id="sec:conflict-resolution"><a class="anchor" href="#sec:conflict-resolution"></a><a class="link" href="#sec:conflict-resolution">How Gradle handles conflicts?</a></h3>
<div class="paragraph">
<p>When doing dependency resolution, Gradle handles two types of conflicts:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Version conflicts</dt>
<dd>
<p>That is when two or more dependencies require a given dependency but with different versions.</p>
</dd>
<dt class="hdlist1">Implementation conflicts</dt>
<dd>
<p>That is when the dependency graph contains module that provide the same implementation, or capability in Gradle terminology.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The following sections will explain in detail how Gradle attempts to resolve these conflicts.</p>
</div>
<div class="paragraph">
<p>The dependency resolution process is highly customizable to meet enterprise requirements.
For more information, see the chapter on <a href="#">Controlling transitive dependencies</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="sec:version-conflict"><a class="anchor" href="#sec:version-conflict"></a><a class="link" href="#sec:version-conflict">Version conflict resolution</a></h3>
<div class="paragraph">
<p>A version conflict occurs when two components:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Depend on the same module, let&#8217;s say <code>com.google.guava:guava</code></p>
</li>
<li>
<p>But on different versions, let&#8217;s say <code>20.0</code> and <code>25.1-android</code></p>
<div class="ulist">
<ul>
<li>
<p>Our project itself depends on <code>com.google.guava:guava:20.0</code></p>
</li>
<li>
<p>Our project also depends on <code>com.google.inject:guice:4.2.2</code> which itself depends on <code>com.google.guava:guava:25.1-android</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="sub:resolution-strategy"><a class="anchor" href="#sub:resolution-strategy"></a><a class="link" href="#sub:resolution-strategy">Resolution strategy</a></h4>
<div class="paragraph">
<p>Given the conflict above, there exist multiple ways to handle it, either by selecting a version or failing the resolution.
Different tools that handle dependency management have different ways of handling these type of conflicts.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><a href="https://maven.apache.org/">Apache Maven</a> uses a nearest first strategy.</p>
</div>
<div class="paragraph">
<p>Maven will take the <em>shortest</em> path to a dependency and use that version.
In case there are multiple paths of the same length, the first one wins.</p>
</div>
<div class="paragraph">
<p>This means that in the example above, the version of <code>guava</code> will be <code>20.0</code> because the direct dependency is <em>closer</em> than the <code>guice</code> dependency.</p>
</div>
<div class="paragraph">
<p>The main drawback of this method is that it is ordering dependent.
Keeping order in a very large graph can be a challenge.
For example, what if the new version of a dependency ends up having its own dependency declarations in a different order than the previous version?</p>
</div>
<div class="paragraph">
<p>With Maven, this could have unwanted impact on resolved versions.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><a href="https://ant.apache.org/ivy/">Apache Ivy</a> is a very flexible dependency management tooling.
It offers the possibility to customize dependency resolution, including conflict resolution.</p>
</div>
<div class="paragraph">
<p>This flexibility comes with the price of making it hard to reason about.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Gradle will consider <em>all</em> requested versions, wherever they appear in the dependency graph.
Out of these versions, it will select the <em>highest</em> one.</p>
</div>
<div class="paragraph">
<p>As you have seen, Gradle supports a concept of <a href="#">rich version declaration</a>, so what is the highest version depends on the way versions were declared:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If no ranges are involved, then the highest version that is not rejected will be selected.</p>
<div class="ulist">
<ul>
<li>
<p>If a version declared as <code>strictly</code> is lower than that version, selection will fail.</p>
</li>
</ul>
</div>
</li>
<li>
<p>If ranges are involved:</p>
<div class="ulist">
<ul>
<li>
<p>If there is a non range version that falls within the specified ranges or is higher than their upper bound, it will be selected.</p>
</li>
<li>
<p>If there are only ranges, the highest <em>existing</em> version of the range with the highest upper bound will be selected.</p>
</li>
<li>
<p>If a version declared as <code>strictly</code> is lower than that version, selection will fail.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note that in the case where ranges come into play, Gradle requires metadata to determine which versions do exist for the considered range.
This causes an intermediate lookup for metadata, as described in <a href="#sec:how-gradle-downloads-deps">How Gradle retrieves dependency metadata?</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec:implementation-conflict"><a class="anchor" href="#sec:implementation-conflict"></a><a class="link" href="#sec:implementation-conflict">Implementation conflict resolution</a></h3>
<div class="paragraph">
<p>Gradle uses variants and capabilities to identify what a module <em>provides</em>.</p>
</div>
<div class="paragraph">
<p>This is a unique feature that deserves its <a href="#">own chapter</a> to understand what it means and enables.</p>
</div>
<div class="paragraph">
<p>A conflict occurs the moment two modules either:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Attempt to select incompatible variants,</p>
</li>
<li>
<p>Declare the same capability</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Learn more about handling these type of conflicts in <a href="#sub:selecting-between-candidates">Selecting between candidates</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="sec:how-gradle-downloads-deps"><a class="anchor" href="#sec:how-gradle-downloads-deps"></a><a class="link" href="#sec:how-gradle-downloads-deps">How Gradle retrieves dependency metadata?</a></h3>
<div class="paragraph">
<p>Gradle requires metadata about the modules included in your dependency graph.
That information is required for two main points:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Determine the existing versions of a module when the declared version is dynamic.</p>
</li>
<li>
<p>Determine the dependencies of the module for a given version.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="discovering_versions"><a class="anchor" href="#discovering_versions"></a><a class="link" href="#discovering_versions">Discovering versions</a></h4>
<div class="paragraph">
<p>Faced with a dynamic version, Gradle needs to identify the concrete matching versions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Each repository is inspected, Gradle does not stop on the first one returning some metadata.
When multiple are defined, they are inspected <em>in the order they were added</em>.</p>
</li>
<li>
<p>For Maven repositories, Gradle will use the <code>maven-metadata.xml</code> which provides information about the available versions.</p>
</li>
<li>
<p>For Ivy repositories, Gradle will resort to directory listing.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This process results in a list of candidate versions that are then matched to the dynamic version expressed.
At this point, <a href="#sub:resolution-strategy">version conflict resolution</a> is resumed.</p>
</div>
<div class="paragraph">
<p>Note that Gradle caches the version information, more information can be found in the section <a href="#sec:controlling-dynamic-version-caching">Controlling dynamic version caching</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="obtaining_module_metadata"><a class="anchor" href="#obtaining_module_metadata"></a><a class="link" href="#obtaining_module_metadata">Obtaining module metadata</a></h4>
<div class="paragraph">
<p>Given a required dependency, with a version, Gradle attempts to resolve the dependency by searching for the module the dependency points at.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Each repository is inspected in order.</p>
<div class="ulist">
<ul>
<li>
<p>Depending on the type of repository, Gradle looks for metadata files describing the module (<code>.module</code>, <code>.pom</code> or <code>ivy.xml</code> file) or directly for artifact files.</p>
</li>
<li>
<p>Modules that have a module metadata file (<code>.module</code>, <code>.pom</code> or <code>ivy.xml</code> file) are preferred over modules that have an artifact file only.</p>
</li>
<li>
<p>Once a repository returns a <em>metadata</em> result, following repositories are ignored.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Metadata for the dependency is retrieved and parsed, if found</p>
<div class="ulist">
<ul>
<li>
<p>If the module metadata is a POM file that has a parent POM declared, Gradle will recursively attempt to resolve each of the parent modules for the POM.</p>
</li>
</ul>
</div>
</li>
<li>
<p>All of the artifacts for the module are then requested from the <em>same repository</em> that was chosen in the process above.</p>
</li>
<li>
<p>All of that data, including the repository source and potential misses are then stored in the <a href="#sec:dependency_cache">The Dependency Cache</a>.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The penultimate point above is what can make the integration with <a href="#sec:case-for-maven-local">Maven Local</a> problematic.
As it is a cache for Maven, it will sometimes miss some artifacts of a given module.
If Gradle is sourcing such a module from Maven Local, it will consider the missing artifacts to be missing altogether.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="repository_blacklisting"><a class="anchor" href="#repository_blacklisting"></a><a class="link" href="#repository_blacklisting">Repository blacklisting</a></h4>
<div class="paragraph">
<p>When Gradle fails to retrieve information from a repository, it will blacklist it for the duration of the build and fail all dependency resolution.</p>
</div>
<div class="paragraph">
<p>That last point is important for reproducibility.
If the build was allowed to continue, ignoring the faulty repository, subsequent builds could have a different result once the repository is back online.</p>
</div>
<div class="sect4">
<h5 id="sub:http-retries"><a class="anchor" href="#sub:http-retries"></a><a class="link" href="#sub:http-retries">HTTP Retries</a></h5>
<div class="paragraph">
<p>Gradle will make several attempts to connect to a given repository before blacklisting it.
If connection fails, Gradle will retry on certain errors which have a chance of being transient, increasing the amount of time waiting between each retry.</p>
</div>
<div class="paragraph">
<p>Blacklisting happens when the repository cannot be contacted, either because of a permanent error or because the maximum retries was reached.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec:dependency_cache"><a class="anchor" href="#sec:dependency_cache"></a><a class="link" href="#sec:dependency_cache">The Dependency Cache</a></h3>
<div class="paragraph">
<p>Gradle contains a highly sophisticated dependency caching mechanism, which seeks to minimise the number of remote requests made in dependency resolution, while striving to guarantee that the results of dependency resolution are correct and reproducible.</p>
</div>
<div class="paragraph">
<p>The Gradle dependency cache consists of two storage types located under <code>GRADLE_USER_HOME/caches</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A file-based store of downloaded artifacts, including binaries like jars as well as raw downloaded meta-data like POM files and Ivy files.
The storage path for a downloaded artifact includes the SHA1 checksum, meaning that 2 artifacts with the same name but different content can easily be cached.</p>
</li>
<li>
<p>A binary store of resolved module metadata, including the results of resolving dynamic versions, module descriptors, and artifacts.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The Gradle cache does not allow the local cache to hide problems and create other mysterious and difficult to debug behavior.
Gradle enables reliable and reproducible enterprise builds with a focus on bandwidth and storage efficiency.</p>
</div>
<div class="sect3">
<h4 id="sub:cache_metadata"><a class="anchor" href="#sub:cache_metadata"></a><a class="link" href="#sub:cache_metadata">Separate metadata cache</a></h4>
<div class="paragraph">
<p>Gradle keeps a record of various aspects of dependency resolution in binary format in the metadata cache.
The information stored in the metadata cache includes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The result of resolving a dynamic version (e.g. <code>1.+</code>) to a concrete version (e.g. <code>1.2</code>).</p>
</li>
<li>
<p>The resolved module metadata for a particular module, including module artifacts and module dependencies.</p>
</li>
<li>
<p>The resolved artifact metadata for a particular artifact, including a pointer to the downloaded artifact file.</p>
</li>
<li>
<p>The <em>absence</em> of a particular module or artifact in a particular repository, eliminating repeated attempts to access a resource that does not exist.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Every entry in the metadata cache includes a record of the repository that provided the information as well as a timestamp that can be used for cache expiry.</p>
</div>
</div>
<div class="sect3">
<h4 id="sub:cache_repository_independence"><a class="anchor" href="#sub:cache_repository_independence"></a><a class="link" href="#sub:cache_repository_independence">Repository caches are independent</a></h4>
<div class="paragraph">
<p>As described above, for each repository there is a separate metadata cache.
A repository is identified by its URL, type and layout.
If a module or artifact has not been previously resolved from <em>this repository</em>, Gradle will attempt to resolve the module against the repository.
This will always involve a remote lookup on the repository, however in many cases <a href="#sub:cache_artifact_reuse">no download will be required</a>.</p>
</div>
<div class="paragraph">
<p>Dependency resolution will fail if the required artifacts are not available in any repository specified by the build, even if the local cache has a copy of this artifact which was retrieved from a different repository.
Repository independence allows builds to be isolated from each other in an advanced way that no build tool has done before.
This is a key feature to create builds that are reliable and reproducible in any environment.</p>
</div>
</div>
<div class="sect3">
<h4 id="sub:cache_artifact_reuse"><a class="anchor" href="#sub:cache_artifact_reuse"></a><a class="link" href="#sub:cache_artifact_reuse">Artifact reuse</a></h4>
<div class="paragraph">
<p>Before downloading an artifact, Gradle tries to determine the checksum of the required artifact by downloading the sha file associated with that artifact.
If the checksum can be retrieved, an artifact is not downloaded if an artifact already exists with the same id and checksum.
If the checksum cannot be retrieved from the remote server, the artifact will be downloaded (and ignored if it matches an existing artifact).</p>
</div>
<div class="paragraph">
<p>As well as considering artifacts downloaded from a different repository, Gradle will also attempt to reuse artifacts found in the local Maven Repository.
If a candidate artifact has been downloaded by Maven, Gradle will use this artifact if it can be verified to match the checksum declared by the remote server.</p>
</div>
</div>
<div class="sect3">
<h4 id="sub:cache_checksum_storage"><a class="anchor" href="#sub:cache_checksum_storage"></a><a class="link" href="#sub:cache_checksum_storage">Checksum based storage</a></h4>
<div class="paragraph">
<p>It is possible for different repositories to provide a different binary artifact in response to the same artifact identifier.
This is often the case with Maven SNAPSHOT artifacts, but can also be true for any artifact which is republished without changing its identifier.
By caching artifacts based on their SHA1 checksum, Gradle is able to maintain multiple versions of the same artifact.
This means that when resolving against one repository Gradle will never overwrite the cached artifact file from a different repository.
This is done without requiring a separate artifact file store per repository.</p>
</div>
</div>
<div class="sect3">
<h4 id="sub:cache_locking"><a class="anchor" href="#sub:cache_locking"></a><a class="link" href="#sub:cache_locking">Cache Locking</a></h4>
<div class="paragraph">
<p>The Gradle dependency cache uses file-based locking to ensure that it can safely be used by multiple Gradle processes concurrently.
The lock is held whenever the binary metadata store is being read or written, but is released for slow operations such as downloading remote artifacts.</p>
</div>
<div class="paragraph">
<p>This concurrent access is only supported if the different Gradle processes can communicate together. This is usually <em>not the case</em> for containerized builds.</p>
</div>
<div class="sect4">
<h5 id="sub:cache_cleanup"><a class="anchor" href="#sub:cache_cleanup"></a><a class="link" href="#sub:cache_cleanup">Cache Cleanup</a></h5>
<div class="paragraph">
<p>Gradle keeps track of which artifacts in the dependency cache are accessed.
Using this information, the cache is periodically (at most every 24 hours) scanned for artifacts that have not been used for more than 30 days.
Obsolete artifacts are then deleted to ensure the cache does not grow indefinitely.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sub:ephemeral-ci-cache"><a class="anchor" href="#sub:ephemeral-ci-cache"></a><a class="link" href="#sub:ephemeral-ci-cache">Dealing with ephemeral builds</a></h3>
<div class="paragraph">
<p>It&#8217;s a common practice to run builds in ephemeral containers.
A container is typically spawned to only execute a single build before it is destroyed.
This can become a practical problem when a build depends on a lot of dependencies which each container has to re-download.
To help with this scenario, Gradle provides a couple of options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#sub:cache_copy">copying the dependency cache</a> into each container</p>
</li>
<li>
<p><a href="#sub:shared-readonly-cache">sharing a read-only dependency cache</a> between multiple containers</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="sub:cache_copy"><a class="anchor" href="#sub:cache_copy"></a><a class="link" href="#sub:cache_copy">Copying and reusing the cache</a></h4>
<div class="paragraph">
<p>The dependency cache, both the file and metadata parts, are fully encoded using relative paths.
This means that it is perfectly possible to copy a cache around and see Gradle benefit from it.</p>
</div>
<div class="paragraph">
<p>The path that can be copied is <code>$GRADLE_HOME/caches/modules-&lt;version&gt;</code>.
The only constraint is placing it using the same structure at the destination, where the value of <code>GRADLE_HOME</code> can be different.</p>
</div>
<div class="paragraph">
<p>Do not copy the <code>*.lock</code> or <code>gc.properties</code> files if they exist.</p>
</div>
<div class="paragraph">
<p>Note that creating the cache and consuming it should be done using compatible Gradle version, as shown in the table below.
Otherwise, the build might still require some interactions with remote repositories to complete missing information, which might be available in a different version.
If multiple incompatible Gradle versions are in play, all should be used when seeding the cache.</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 4. Dependency cache compatibility</caption>
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Module cache version</th>
<th class="tableblock halign-left valign-top">File cache version</th>
<th class="tableblock halign-left valign-top">Metadata cache version</th>
<th class="tableblock halign-left valign-top">Gradle version(s)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>modules-2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>files-2.1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>metadata-2.95</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gradle 6.1 to Gradle 6.3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>modules-2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>files-2.1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>metadata-2.96</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gradle 6.4 and above</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="sub:shared-readonly-cache"><a class="anchor" href="#sub:shared-readonly-cache"></a><a class="link" href="#sub:shared-readonly-cache">Sharing the dependency cache with other Gradle instances</a></h4>
<div class="paragraph">
<p>Instead of <a href="#sub:cache_copy">copying the dependency cache into each container</a>, it&#8217;s possible to mount a shared, read-only directory that will act as a dependency cache for all containers.
This cache, unlike the classical dependency cache, is accessed without locking, making it possible for multiple builds to read from the cache concurrently. It&#8217;s important that the read-only cache
is not written to when other builds may be reading from it.</p>
</div>
<div class="paragraph">
<p>When using the shared read-only cache, Gradle looks for dependencies (artifacts or metadata) in both the writable cache in the local Gradle user home directory and the shared read-only cache.
If a dependency is present in the read-only cache, it will not be downloaded.
If a dependency is missing from the read-only cache, it will be downloaded and added to the writable cache.
In practice, this means that the writable cache will only contain dependencies that are unavailable in the read-only cache.</p>
</div>
<div class="paragraph">
<p>The read-only cache should be sourced from a Gradle dependency cache that already contains some of the required dependencies.
The cache can be incomplete; however, an empty shared cache will only add overhead.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The shared read-only dependency cache is an incubating feature.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The first step in using a shared dependency cache is to create one by copying of an existing <em>local</em> cache.
For this you need to follow the <a href="#sub:cache_copy">instructions above</a>.</p>
</div>
<div class="paragraph">
<p>Then set the <code>GRADLE_RO_DEP_CACHE</code> environment variable to point to the directory containing the cache:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$GRADLE_RO_DEP_CACHE
   |-- modules-2 : the read-only dependency cache, should be mounted with read-only privileges

$GRADLE_HOME
   |-- caches
         |-- modules-2 : the container specific dependency cache, should be writable
         |-- ...
   |-- ...</pre>
</div>
</div>
<div class="paragraph">
<p>In a CI environment, it&#8217;s a good idea to have one build which "seeds" a Gradle dependency cache, which is then <em>copied</em> to a different directory.
This directory can then be used as the read-only cache for other builds.
You shouldn&#8217;t use an existing Gradle installation cache as the read-only cache, because this directory may contain locks and may be modified by the seeding build.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec:programmatic_api"><a class="anchor" href="#sec:programmatic_api"></a><a class="link" href="#sec:programmatic_api">Accessing the resolution result programmatically</a></h3>
<div class="paragraph">
<p>While most users only need access to a "flat list" of files, there are cases where it can be interesting to reason on a <em>graph</em> and get more information about the resolution result:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>for tooling integration, where a model of the dependency graph is required</p>
</li>
<li>
<p>for tasks generating a visual representation (image, <code>.dot</code> file, &#8230;&#8203;) of a dependency graph</p>
</li>
<li>
<p>for tasks providing diagnostics (similar to the <code>dependencyInsight</code> task)</p>
</li>
<li>
<p>for tasks which need to perform dependency resolution at execution time (e.g, download files on demand)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For those use cases, Gradle provides lazy, thread-safe APIs, accessible by calling the <a href="../javadoc/org/gradle/api/artifacts/Configuration.html#getIncoming--">Configuration.getIncoming()</a> method:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the <a href="../javadoc/org/gradle/api/artifacts/ResolvableDependencies.html#getResolutionResult--">ResolutionResult API</a> gives access to a resolved dependency graph, whether the resolution was successful or not.</p>
</li>
<li>
<p>the <a href="../javadoc/org/gradle/api/artifacts/ResolvableDependencies.html#getArtifacts--">artifacts API</a> provides a simple access to the resolved artifacts, untransformed, but with lazy download of artifacts (they would only be downloaded on demand).</p>
</li>
<li>
<p>the <a href="../javadoc/org/gradle/api/artifacts/ResolvableDependencies.html#artifactView-org.gradle.api.Action-">artifact view API</a> provides an advanced, filtered view of artifacts, possibly <a href="#sec:abm_artifact_transforms">transformed</a>.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="verifying-dependencies"><a class="anchor" href="#verifying-dependencies"></a><a class="link" href="#verifying-dependencies">Verifying dependencies</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Working with external dependencies and plugins published on third-party repositories puts your build at risk.
In particular, you need to be aware of what binaries are brought in transitively and if they are legit.
To mitigate the security risks and avoid integrating compromised dependencies in your project, Gradle supports <em>dependency verification</em>.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Dependency verification is, by nature, an inconvenient feature to use.
It means that whenever you&#8217;re going to update a dependency, builds are likely to fail.
It means that merging branches are going to be harder because each branch can have different dependencies.
It means that you will be tempted to switch it off.</p>
</div>
<div class="paragraph">
<p>So why should you bother?</p>
</div>
<div class="paragraph">
<p>Dependency verification is about <strong>trust</strong> in what you get and what you ship.</p>
</div>
<div class="paragraph">
<p>Without dependency verification it&#8217;s easy for an attacker to compromise your supply chain.
There are many real world examples of tools compromised by adding a malicious dependency.
Dependency verification is meant to protect yourself from those attacks, by forcing you to ensure that the artifacts you include in your build are the ones that you expect.
It is not meant, however, to prevent you from including <em>vulnerable</em> dependencies.</p>
</div>
<div class="paragraph">
<p>Finding the right balance between security and convenience is hard but Gradle will try to let you choose the "right level" for you.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Dependency verification consists of two different and complementary operations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>checksum verification</em>, which allows asserting the integrity of a dependency</p>
</li>
<li>
<p><em>signature verification</em>, which allows asserting the provenance of a dependency</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Gradle supports both checksum and signature verification out of the box but performs no dependency verification by default.
This section will guide you into configuring dependency verification properly for your needs.</p>
</div>
<div class="paragraph">
<p>This feature can be used for:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>detecting compromised dependencies</p>
</li>
<li>
<p>detecting compromised plugins</p>
</li>
<li>
<p>detecting tampered dependencies in the local dependency caches</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Dependency verification is an incubating feature: details are subject to change.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="sub:enabling-verification"><a class="anchor" href="#sub:enabling-verification"></a><a class="link" href="#sub:enabling-verification">Enabling dependency verification</a></h3>
<div class="sect3">
<h4 id="sub:verification-metadata"><a class="anchor" href="#sub:verification-metadata"></a><a class="link" href="#sub:verification-metadata">The verification metadata file</a></h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Currently the only source of dependency verification metadata is this XML configuration file.
Future versions of Gradle may include other sources (for example via external services).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Dependency verification is automatically enabled once the configuration file for dependency verification is discovered.
This configuration file is located at <code>$PROJECT_ROOT/gradle/verification-metadata.xml</code>.
This file minimally consists of the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;verification-metadata&gt;
   &lt;configuration&gt;
      &lt;verify-metadata&gt;true&lt;/verify-metadata&gt;
      &lt;verify-signatures&gt;false&lt;/verify-signatures&gt;
    &lt;/configuration&gt;
&lt;/verification-metadata&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Doing so, Gradle will verify all artifacts using <a href="#sec:checksum-verification">checksums</a>, but will not verify <a href="#sec:signature-verification">signatures</a>.
Gradle will verify any artifact downloaded using its dependency management engine, which includes, but is not limited to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>artifact files (e.g jar files, zips, &#8230;&#8203;) used during a build</p>
</li>
<li>
<p>metadata artifacts (POM files, Ivy descriptors, Gradle Module Metadata)</p>
</li>
<li>
<p>plugins (both project and settings plugins)</p>
</li>
<li>
<p>artifacts resolved using the advanced dependency resolution APIs</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Gradle will <em>not</em> verify changing dependencies (in particular <code>SNAPSHOT</code> dependencies) nor locally produced artifacts (typically jars produced during the build itself) as by nature their checksums and signatures would always change.</p>
</div>
<div class="paragraph">
<p>With such a minimal configuration file, a project using <em>any</em> external dependency or plugin would immediately start failing because it doesn&#8217;t contain any checksum to verify.</p>
</div>
<div class="paragraph">
<p>A dependency verification configuration is <em>global</em>: a single file is used to configure verification of the whole build.
In particular, the same file is used for both the (sub)projects and <code>buildSrc</code>.</p>
</div>
<div class="paragraph">
<p>An easy way to get started is therefore to generate the minimal configuration for an existing build.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:verification-console-output"><a class="anchor" href="#sec:verification-console-output"></a><a class="link" href="#sec:verification-console-output">Configuring the console output</a></h4>
<div class="paragraph">
<p>By default, if dependency verification fails, Gradle will generate a small summary about the verification failure as well as an HTML report containing the full information about the failures.
If your environment prevents you from reading this HTML report file (for example if you run a build on CI and that it&#8217;s not easy to fetch the remote artifacts), Gradle provides a way to opt-in a verbose console report.
For this, you need to add this Gradle property to your <code>gradle.properties</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>org.gradle.dependency.verification.console=verbose</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:bootstrapping-verification"><a class="anchor" href="#sec:bootstrapping-verification"></a><a class="link" href="#sec:bootstrapping-verification">Bootstrapping dependency verification</a></h4>
<div class="paragraph">
<p>It&#8217;s worth mentioning that while Gradle can generate a dependency verification file for you, you should always check whatever Gradle generated for you because your build may <em>already</em> contain compromised dependencies without you knowing about it.
Please refer to the appropriate <a href="#sec:checksum-verification">checksum verification</a> or <a href="#sec:signature-verification">signature verification</a> section for more information.</p>
</div>
<div class="paragraph">
<p>If you plan on using <a href="#sec:signature-verification">signature verification</a>, please also read the <a href="#sec:bootstrapping-signature-verification">corresponding section</a> of the docs.</p>
</div>
<div class="paragraph">
<p>Bootstrapping can either be used to create a file from the beginning, or also to <em>update</em> an existing file with new information.
Therefore, it&#8217;s recommended to always use the same parameters once you started bootstrapping.</p>
</div>
<div class="paragraph">
<p>The dependency verification file can be generated with the following CLI instructions:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>gradle --write-verification-metadata sha256 help</pre>
</div>
</div>
<div class="paragraph">
<p>The <code>write-verification-metadata</code> flag requires the list of <a href="#sec:checksum-verification">checksums</a> that you want to generate or <code>pgp</code> for <a href="#sec:signature-verification">signatures</a>.</p>
</div>
<div class="paragraph">
<p>Executing this command line will cause Gradle to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>resolve all <a href="#sec:resolvable-consumable-configs">resolvable configurations</a>, which includes:</p>
<div class="ulist">
<ul>
<li>
<p>configurations from the root project</p>
</li>
<li>
<p>configurations from all subprojects</p>
</li>
<li>
<p>configurations from <code>buildSrc</code></p>
</li>
<li>
<p>included builds configurations</p>
</li>
<li>
<p>configurations used by plugins</p>
</li>
</ul>
</div>
</li>
<li>
<p>download all artifacts discovered during resolution</p>
</li>
<li>
<p>compute the requested checksums and possibly verify signatures depending on what you asked</p>
</li>
<li>
<p>At the end of the build, generate the configuration file which will contain the inferred <em>verification metadata</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As a consequence, the <code>verification-metadata.xml</code> file will be used in subsequent builds to verify dependencies.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>There are dependencies that Gradle <em>cannot</em> discover this way.
In particular, you will notice that the CLI above uses the <code>help</code> task.
If you don&#8217;t specify any task, Gradle will automatically run the default task and generate a configuration file at the end of the build too.</p>
</div>
<div class="paragraph">
<p>The difference is that Gradle <em>may</em> discover more dependencies and artifacts depending on the tasks you execute.
As a matter of fact, Gradle cannot automatically discover <em>detached configurations</em>, which are basically dependency graphs resolved as an internal implementation detail of the execution of a task: they are not, in particular, declared as an input of the task because they effectively depend on the configuration of the task at execution time.</p>
</div>
<div class="paragraph">
<p>A good way to start is just to use the simplest task, <code>help</code>, which will discover as much as possible, and if subsequent builds fail with a verification error, you can re-execute generation with the appropriate tasks to "discover" more dependencies.</p>
</div>
<div class="paragraph">
<p>Gradle won&#8217;t verify either checksums or signatures of plugins which use their own HTTP clients.
Only plugins which use the infrastructure provided by Gradle for performing requests will see their requests verified.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If an included build is used:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the configuration file of the <em>current</em> build is used for verification</p>
</li>
<li>
<p>so if the included build itself uses verification, its configuration is ignored in favor of the current one</p>
</li>
<li>
<p>which means that including a build works similarly to upgrading a dependency: it may require you to update your current verification metadata</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="sec:verification-dry-mode"><a class="anchor" href="#sec:verification-dry-mode"></a><a class="link" href="#sec:verification-dry-mode">Using dry mode</a></h4>
<div class="paragraph">
<p>By default, bootstrapping is incremental, which means that if you run it multiple times, information is <em>added</em> to the file and in particular you can rely on your VCS to check the diffs.
There are situations where you would just want to <em>see</em> what the generated verification metadata file would look like without actually changing the existing one or overwriting it.</p>
</div>
<div class="paragraph">
<p>For this purpose, you can just add <code>--dry-run</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>gradle --write-verification-metadata sha256 help --dry-run</pre>
</div>
</div>
<div class="paragraph">
<p>Then instead of generating the <code>verification-metadata.xml</code> file, a <em>new file</em> will be generated, called <code>verification-metadata.dryrun.xml</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Because <code>--dry-run</code> doesn&#8217;t execute tasks, this would be much faster, but it will miss any resolution happening at task execution time.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="sec:disabling-metadata-verification"><a class="anchor" href="#sec:disabling-metadata-verification"></a><a class="link" href="#sec:disabling-metadata-verification">Disabling metadata verification</a></h4>
<div class="paragraph">
<p>By default, Gradle will not only verify artifacts (jars, &#8230;&#8203;) but also the metadata associated with those artifacts (typically POM files).
Verifying this ensures the maximum level of security: metadata files typically tell what transitive dependencies will be included, so a compromised metadata file may cause the introduction of undesired dependencies in the graph.
However, because all artifacts are verified, such artifacts would in general easily be discovered by you, because they would cause a checksum verification failure (checksums would be <em>missing</em> from verification metadata).
Because metadata verification can significantly increase the size of your configuration file, you may therefore want to disable verification of metadata.
If you understand the risks of doing so, set the <code>&lt;verify-metadata&gt;</code> flag to <code>false</code> in the configuration file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;verification-metadata&gt;
   &lt;configuration&gt;
      &lt;verify-metadata&gt;false&lt;/verify-metadata&gt;
      &lt;verify-signatures&gt;false&lt;/verify-signatures&gt;
    &lt;/configuration&gt;
    &lt;!-- the rest of this file doesn't need to declare anything about metadata files --&gt;
&lt;/verification-metadata&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec:checksum-verification"><a class="anchor" href="#sec:checksum-verification"></a><a class="link" href="#sec:checksum-verification">Verifying dependency checksums</a></h3>
<div class="paragraph">
<p>Checksum verification allows you to ensure the integrity of an artifact.
This is the simplest thing that Gradle can do for you to make sure that the artifacts you use are un-tampered.</p>
</div>
<div class="paragraph">
<p>Gradle supports MD5, SHA1, SHA-256 and SHA-512 checksums.
However, only SHA-256 and SHA-512 checksums are considered secure nowadays.</p>
</div>
<div class="sect3">
<h4 id="adding_the_checksum_for_an_artifact"><a class="anchor" href="#adding_the_checksum_for_an_artifact"></a><a class="link" href="#adding_the_checksum_for_an_artifact">Adding the checksum for an artifact</a></h4>
<div class="paragraph">
<p>External components are identified by GAV coordinates, then each of the artifacts by their file names.
To declare the checksums of an artifact, you need to add the corresponding section in the verification metadata file.
For example, to declare the checksum for <a href="https://pdfbox.apache.org">Apache PDFBox</a>.
The GAV coordinates are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>group <code>org.apache.pdfbox</code></p>
</li>
<li>
<p>name <code>pdfbox</code></p>
</li>
<li>
<p>version <code>2.0.17</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Using this dependency will trigger the download of 2 different files:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>pdfbox-2.0.17.jar</code> which is the main artifact</p>
</li>
<li>
<p><code>pdfbox-2.0.17.pom</code> which is the metadata file associated with this artifact</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As as consequence, you need to declare the checksums for both of them (unless you <a href="#sec:disabling-metadata-verification">disabled metadata verification</a>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;verification-metadata&gt;
   &lt;configuration&gt;
      &lt;verify-metadata&gt;true&lt;/verify-metadata&gt;
      &lt;verify-signatures&gt;false&lt;/verify-signatures&gt;
   &lt;/configuration&gt;
   &lt;components&gt;
      &lt;component group="org.apache.pdfbox" name="pdfbox" version="2.0.17"&gt;
         &lt;artifact name="pdfbox-2.0.17.jar"&gt;
            &lt;sha512 value="7e11e54a21c395d461e59552e88b0de0ebaf1bf9d9bcacadf17b240d9bbc29bf6beb8e36896c186fe405d287f5d517b02c89381aa0fcc5e0aa5814e44f0ab331" origin="PDFBox Official site (https://pdfbox.apache.org/download.cgi)"/&gt;
         &lt;/artifact&gt;
         &lt;artifact name="pdfbox-2.0.17.pom"&gt;
            &lt;sha512 value="82de436b38faf6121d8d2e71dda06e79296fc0f7bc7aba0766728c8d306fd1b0684b5379c18808ca724bf91707277eba81eb4fe19518e99e8f2a56459b79742f" origin="Generated by Gradle"/&gt;
         &lt;/artifact&gt;
      &lt;/component&gt;
   &lt;/components&gt;
&lt;/verification-metadata&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="where_to_get_checksums_from"><a class="anchor" href="#where_to_get_checksums_from"></a><a class="link" href="#where_to_get_checksums_from">Where to get checksums from?</a></h4>
<div class="paragraph">
<p>In general, checksums are published alongside artifacts on public repositories.
However, if a dependency is compromised in a repository, it&#8217;s likely its checksum will be too, so it&#8217;s a good practice to get the checksum from a different place, usually the website of the library itself.</p>
</div>
<div class="paragraph">
<p>In fact, it&#8217;s a good security practice to publish the checksums of artifacts on a <em>different server</em> than the server where the artifacts themselves are hosted: it&#8217;s harder to compromise a library both on the repository <em>and</em> the official website.</p>
</div>
<div class="paragraph">
<p>In the example above, the checksum was published on the website for the JAR, but not the POM file.
This is why it&#8217;s usually easier to <a href="#sec:bootstrapping-verification">let Gradle generate the checksums</a> and verify by reviewing the generated file carefully.</p>
</div>
<div class="paragraph">
<p>In this example, not only could we check that the checksum was correct, but we could also find it on the official website, which is why we changed the label of <code>origin</code> from <code>Generated by Gradle</code> to <code>PDFBox Official site</code>.
Changing the <code>origin</code> gives users a sense of how trustworthy your build it.</p>
</div>
<div class="paragraph">
<p>Interestingly, using <code>pdfbox</code> will require <em>much more</em> than those 2 artifacts, because it will also bring in transitive dependencies.
If the dependency verification file only included the checksums for the main artifacts you used, the build would fail with an error like this one:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Execution failed for task ':compileJava'.
&gt; Dependency verification failed for configuration ':compileClasspath':
    - On artifact commons-logging-1.2.jar (commons-logging:commons-logging:1.2) in repository 'MavenRepo': checksum is missing from verification metadata.
    - On artifact commons-logging-1.2.pom (commons-logging:commons-logging:1.2) in repository 'MavenRepo': checksum is missing from verification metadata.</pre>
</div>
</div>
<div class="paragraph">
<p>What this indicates is that your build requires <code>commons-logging</code> when executing <code>compileJava</code>, however the verification file doesn&#8217;t contain enough information for Gradle to verify the integrity of the dependencies, meaning you need to add the required information to the verification metadata file.</p>
</div>
<div class="paragraph">
<p>See <a href="#sec:troubleshooting-verification">troubleshooting dependency verification</a> for more insights on what to do in this situation.</p>
</div>
</div>
<div class="sect3">
<h4 id="what_checksums_are_verified"><a class="anchor" href="#what_checksums_are_verified"></a><a class="link" href="#what_checksums_are_verified">What checksums are verified?</a></h4>
<div class="paragraph">
<p>If a dependency verification metadata file declares more than one checksum for a dependency, Gradle will verify <em>all of them</em> and fail if <em>any of them fails</em>.
For example, the following configuration would check both the <code>md5</code> and <code>sha256</code> checksums:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;component group="org.apache.pdfbox" name="pdfbox" version="2.0.17"&gt;
   &lt;artifact name="pdfbox-2.0.17.jar"&gt;
      &lt;md5 value="c713a8e252d0add65e9282b151adf6b4" origin="official site"/&gt;
      &lt;sha1 value="b5c8dff799bd967c70ccae75e6972327ae640d35" origin="official site"/&gt;
   &lt;/artifact&gt;
&lt;/component&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>There are multiple reasons why you&#8217;d like to do so:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>an official site doesn&#8217;t publish <em>secure</em> checksums (SHA-256, SHA-512) but publishes multiple insecure ones (MD5, SHA1). While it&#8217;s easy to fake a MD5 checksum and hard but possible to fake a SHA1 checksum, it&#8217;s harder to fake both of them for the same artifact.</p>
</li>
<li>
<p>you might want to add generated checksums to the list above</p>
</li>
<li>
<p>when <em>updating</em> dependency verification file with more secure checksums, you don&#8217;t want to accidentally erase checksums</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec:signature-verification"><a class="anchor" href="#sec:signature-verification"></a><a class="link" href="#sec:signature-verification">Verifying dependency signatures</a></h3>
<div class="paragraph">
<p>In addition to <a href="#sec:checksum-verification">checksums</a>, Gradle supports verification of signatures.
Signatures are used to assess the <em>provenance</em> of a dependency (it tells who signed the artifacts, which usually corresponds to who produced it).</p>
</div>
<div class="paragraph">
<p>As enabling signature verification usually means a higher level of security, you might want to replace checksum verification with signature verification.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Signatures <em>can</em> also be used to assess the integrity of a dependency similarly to checksums.
Signatures are signatures of the <em>hash</em> of artifacts, not artifacts themselves.
This means that if the signature is done on an <em>unsafe hash</em> (even SHA1), then you&#8217;re not correctly assessing the <em>integrity</em> of a file.
For this reason, if you care about both, you need to add both signatures <em>and</em> checksums to your verification metadata.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>However:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Gradle only supports verification of signatures published on remote repositories as ASCII-armored PGP files</p>
</li>
<li>
<p>Not all artifacts are published with signatures</p>
</li>
<li>
<p>A good signature doesn&#8217;t mean that the signatory was legit</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As a consequence, signature verification will often be used alongside checksum verification.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">About expired keys</div>
<div class="paragraph">
<p>It&#8217;s very common to find artifacts which are signed with an expired key.
This is not a problem for <em>verification</em>: key expiry is mostly used to avoid signing with a stolen key.
If an artifact was signed before expiry, it&#8217;s still valid.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="enabling_signature_verification"><a class="anchor" href="#enabling_signature_verification"></a><a class="link" href="#enabling_signature_verification">Enabling signature verification</a></h4>
<div class="paragraph">
<p>Because verifying signatures is more expensive (both I/O and CPU wise) and harder to check manually, it&#8217;s not enabled by default.</p>
</div>
<div class="paragraph">
<p>Enabling it requires you to change the configuration option in the <code>verification-metadata.xml</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;verification-metadata&gt;
   &lt;configuration&gt;
      &lt;verify-signatures&gt;true&lt;/verify-signatures&gt;
   &lt;/configuration&gt;
&lt;/verification-metadata&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec:understanding-signature-verification"><a class="anchor" href="#sec:understanding-signature-verification"></a><a class="link" href="#sec:understanding-signature-verification">Understanding signature verification</a></h3>
<div class="paragraph">
<p>Once signature verification is enabled, for each artifact, Gradle will:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>try to download the corresponding <code>.asc</code> file</p>
</li>
<li>
<p>if it&#8217;s present</p>
<div class="ulist">
<ul>
<li>
<p>automatically download the keys required to perform verification of the signature</p>
</li>
<li>
<p>verify the artifact using the downloaded public keys</p>
</li>
<li>
<p>if signature verification passes, perform additional requested checksum verification</p>
</li>
</ul>
</div>
</li>
<li>
<p>if it&#8217;s absent, fallback to checksum verification</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>That is to say that Gradle verification mechanism is much stronger if signature verification is enabled than just with checksum verification.
In particular:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>if an artifact is signed with multiple keys, all of them must pass validation or the build will fail</p>
</li>
<li>
<p>if an artifact passes verification, any additional checksum configured for the artifact <em>will also be checked</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>However, it&#8217;s not because an artifact passes signature verification that you can trust it: you need to <em>trust the keys</em>.</p>
</div>
<div class="paragraph">
<p>In practice, it means you need to list the keys that you trust for each artifact, which is done by adding a <code>pgp</code> entry instead of a <code>sha1</code> for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;component group="com.github.javaparser" name="javaparser-core" version="3.6.11"&gt;
   &lt;artifact name="javaparser-core-3.6.11.jar"&gt;
      &lt;pgp value="8756c4f765c9ac3cb6b85d62379ce192d401ab61"/&gt;
   &lt;/artifact&gt;
&lt;/component&gt;</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Gradle supports both full fingerprint ids or long (64-bit) key ids in <code>pgp</code>, <code>trusted-key</code> and <code>ignore-key</code> elements.
For maximum security, you should use full fingerprints as it&#8217;s possible to have collisions for long key ids.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This effectively means that you trust <code>com.github.javaparser:javaparser-core:3.6.11</code> if it&#8217;s signed with the key <code>8756c4f765c9ac3cb6b85d62379ce192d401ab61</code>.</p>
</div>
<div class="paragraph">
<p>Without this, the build would fail with this error:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt; Dependency verification failed for configuration ':compileClasspath':
    - On artifact javaparser-core-3.6.11.jar (com.github.javaparser:javaparser-core:3.6.11) in repository 'MavenRepo': Artifact was signed with key '8756c4f765c9ac3cb6b85d62379ce192d401ab61' (Bintray (by JFrog) &lt;****&gt;) and passed verification but the key isn't in your trusted keys list.</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The key IDs that Gradle shows in error messages are the key IDs found in the signature file it tries to verify.
It doesn&#8217;t mean that it&#8217;s necessarily the keys that you should trust.
In particular, if the signature is correct but done by a malicious entity, Gradle wouldn&#8217;t tell you.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="sec:trusting-keys-globally"><a class="anchor" href="#sec:trusting-keys-globally"></a><a class="link" href="#sec:trusting-keys-globally">Trusting keys globally</a></h4>
<div class="paragraph">
<p>Signature verification has the advantage that it can make the configuration of dependency verification easier by not having to explicitly list all artifacts like for checksum verification only.
In fact, it&#8217;s common that the same key can be used to sign several artifacts.
If this is the case, you can move the trusted key from the artifact level to the global configuration block:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;verification-metadata&gt;
   &lt;configuration&gt;
      &lt;verify-metadata&gt;true&lt;/verify-metadata&gt;
      &lt;verify-signatures&gt;true&lt;/verify-signatures&gt;
      &lt;trusted-keys&gt;
         &lt;trusted-key id="379ce192d401ab61" group="com.github.javaparser"/&gt;
      &lt;/trusted-keys&gt;
   &lt;/configuration&gt;
   &lt;components/&gt;
&lt;/verification-metadata&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The configuration above means that for any artifact belonging to the group <code>com.github.javaparser</code>, we trust it if it&#8217;s signed with the <code>379ce192d401ab61</code>.</p>
</div>
<div class="paragraph">
<p>The <code>trusted-key</code> element works similarly to the <a href="#sec:trusting-artifacts">trusted-artifact</a> element:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>group</code>, the group of the artifact to trust</p>
</li>
<li>
<p><code>name</code>, the name of the artifact to trust</p>
</li>
<li>
<p><code>version</code>, the version of the artifact to trust</p>
</li>
<li>
<p><code>file</code>, the name of the artifact <em>file</em> to trust</p>
</li>
<li>
<p><code>regex</code>, a boolean saying if the <code>group</code>, <code>name</code>, <code>version</code> and <code>file</code> attributes need to be interpreted as regular expressions (defaults to <code>false</code>)</p>
</li>
</ul>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You should be careful when trusting a key globally: try to limit it to the appropriate groups or artifacts:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a valid key may have been used to sign artifact <code>A</code> which you trust</p>
</li>
<li>
<p>later on, the key is stolen and used to sign artifact <code>B</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It means you can trust the key <code>A</code> for the first artifact, probably only up to the released version before the key was stolen, but not for <code>B</code>.</p>
</div>
<div class="paragraph">
<p>Remember that anybody can put an arbitrary name when generating a PGP key, so never trust the key solely based on the key name.
Verify if the key is listed at the official site.
For example, Apache projects typically provide a KEYS.txt file that you can trust.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="sec:ignoring-keys"><a class="anchor" href="#sec:ignoring-keys"></a><a class="link" href="#sec:ignoring-keys">Specifying key servers and ignoring keys</a></h4>
<div class="paragraph">
<p>Gradle will automatically download the public keys required to verify a signature.
For this it uses a list of well known and trusted key servers (the list may change between Gradle versions, please refer to the implementation to figure out what servers are used by default).</p>
</div>
<div class="paragraph">
<p>You can explicitly set the list of key servers that you want to use by adding them to the configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;verification-metadata&gt;
   &lt;configuration&gt;
      &lt;verify-metadata&gt;true&lt;/verify-metadata&gt;
      &lt;verify-signatures&gt;true&lt;/verify-signatures&gt;
      &lt;key-servers&gt;
         &lt;key-server uri="hkp://my-key-server.org"/&gt;
         &lt;key-server uri="https://my-other-key-server.org"/&gt;
      &lt;/key-servers&gt;
   &lt;/configuration&gt;
&lt;/verification-metadata&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Despite this, it&#8217;s possible that a key is not available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>because it wasn&#8217;t published to a public key server</p>
</li>
<li>
<p>because it was lost</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In this case, you can ignore a key in the configuration block:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;verification-metadata&gt;
   &lt;configuration&gt;
      &lt;verify-metadata&gt;true&lt;/verify-metadata&gt;
      &lt;verify-signatures&gt;true&lt;/verify-signatures&gt;
      &lt;ignored-keys&gt;
         &lt;ignored-key id="abcdef1234567890" reason="Key is not available in any key server"/&gt;
      &lt;/ignored-keys&gt;
   &lt;/configuration&gt;
&lt;/verification-metadata&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>As soon as a key is ignored, it will not be used for verification, even if the signature file mentions it.
However, if the signature cannot be verified with at least one other key, Gradle will mandate that you provide a checksum.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:local-keyring"><a class="anchor" href="#sec:local-keyring"></a><a class="link" href="#sec:local-keyring">Exporting keys for faster verification</a></h4>
<div class="paragraph">
<p>Gradle automatically downloads the required keys but this operation can be quite slow and requires everyone to download the keys.
To avoid this, Gradle offers the ability to use a local keyring file containing the required public keys.</p>
</div>
<div class="paragraph">
<p>If the <code>gradle/verification-keyring.gpg</code> file is present, Gradle will search for keys there in priority.</p>
</div>
<div class="paragraph">
<p>You can generate this file using GPG, for example issuing the following commands (syntax may depend on the tool you use):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">$ gpg --no-default-keyring --keyring gradle/verification-keyring.gpg --recv-keys 379ce192d401ab61

gpg: keybox 'gradle/verification-keyring.gpg' created
gpg: key 379CE192D401AB61: public key "Bintray (by JFrog) &lt;****&gt;" imported
gpg: Total number processed: 1
gpg:               imported: 1

$ gpg --no-default-keyring --keyring gradle/verification-keyring.gpg --recv-keys 6a0975f8b1127b83

gpg: key 0729A0AFF8999A87: public key "Kotlin Release &lt;****&gt;" imported
gpg: Total number processed: 1
gpg:               imported: 1</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or, alternatively, you can <em>ask Gradle to export all keys it used for verification of this build to the keyring</em> during bootstrapping:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>./gradlew --write-verification-metadata pgp,sha256 --export-keys</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>It&#8217;s a good idea to commit this file to VCS (as long as you trust your VCS).
If you use git, make sure to make it treat this file as binary, by adding this to your <code>.gitattributes</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>*.gpg           binary</pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="sec:bootstrapping-signature-verification"><a class="anchor" href="#sec:bootstrapping-signature-verification"></a><a class="link" href="#sec:bootstrapping-signature-verification">Bootstrapping and signature verification</a></h4>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Signature verification bootstrapping takes an <em>optimistic point of view</em> that signature verification is <em>enough</em>.
Therefore, if you also care about <em>integrity</em>, you <strong>must</strong> first bootstrap using checksum verification, <em>then</em> with signature verification.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Similarly to bootstrapping for checksums, Gradle provides a convenience for bootstrapping a configuration file with signature verification enabled.
For this, just add the <code>pgp</code> option to the list of verifications to generate.
However, because there might be verification failures, missing keys or missing signature files, you <strong>must</strong> provide a fallback checksum verification algorithm:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>./gradlew --write-verification-metadata pgp,sha256</pre>
</div>
</div>
<div class="paragraph">
<p>this means that Gradle will verify the signatures and fallback to SHA-256 checksums when there&#8217;s a problem.</p>
</div>
<div class="paragraph">
<p>When bootstrapping, Gradle performs <em>optimistic verification</em> and therefore assumes a sane build environment.
It will therefore:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>automatically add the trusted keys as soon as verification passes</p>
</li>
<li>
<p>automatically add ignored keys for keys which couldn&#8217;t be downloaded from public key servers</p>
</li>
<li>
<p>automatically generate checksums for artifacts without signatures or ignored keys</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If, for some reason, verification fails during the generation, Gradle will automatically generate an ignored key entry but warn you that you must absolutely check what happens.</p>
</div>
<div class="paragraph">
<p>This situation is common as explained for <a href="#sec:trusting-several-checksums">this section</a>: a typical case is when the POM file for a dependency differs from one repository to the other (often in a non-meaningful way).</p>
</div>
<div class="paragraph">
<p>In addition, Gradle will try to group keys automatically and generate the <code>trusted-keys</code> block which reduced the configuration file size as much as possible.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec:troubleshooting-verification"><a class="anchor" href="#sec:troubleshooting-verification"></a><a class="link" href="#sec:troubleshooting-verification">Troubleshooting dependency verification</a></h3>
<div class="sect3">
<h4 id="sec:dealing-verification-failure"><a class="anchor" href="#sec:dealing-verification-failure"></a><a class="link" href="#sec:dealing-verification-failure">Dealing with a verification failure</a></h4>
<div class="paragraph">
<p>Dependency verification can fail in different ways, this section explains how you should deal with the various cases.</p>
</div>
<div class="sect4">
<h5 id="missing_verification_metadata"><a class="anchor" href="#missing_verification_metadata"></a><a class="link" href="#missing_verification_metadata">Missing verification metadata</a></h5>
<div class="paragraph">
<p>The simplest failure you can have is the indication that verification metadata is missing from the dependency verification file.
This is the case for example if you use <a href="#sec:checksum-verification">checksum verification</a>, that you update a dependency and that new versions of the dependency (and potentially its transitive dependencies) are brought in.</p>
</div>
<div class="paragraph">
<p>Gradle will tell you what metadata is missing:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Execution failed for task ':compileJava'.
&gt; Dependency verification failed for configuration ':compileClasspath':
    - On artifact commons-logging-1.2.jar (commons-logging:commons-logging:1.2) in repository 'MavenRepo': checksum is missing from verification metadata.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>the missing module group is <code>commons-logging</code>, it&#8217;s artifact name is <code>commons-logging</code> and its version is <code>1.2</code>. The corresponding artifact is <code>commons-logging-1.2.jar</code> so you need to add the following entry to the verification file:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;component group="commons-logging" name="commons-logging" version="1.2"&gt;
   &lt;artifact name="commons-logging-1.2.jar"&gt;
      &lt;sha256 value="daddea1ea0be0f56978ab3006b8ac92834afeefbd9b7e4e6316fca57df0fa636" origin="official distribution"/&gt;
   &lt;/artifact&gt;
&lt;/component&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, you can ask Gradle to generate the missing information by using the <a href="#sec:bootstrapping-verification">bootstrapping mechanism</a>: existing information in the metadata file will be preserved, Gradle will only add the missing verification metadata.</p>
</div>
</div>
<div class="sect4">
<h5 id="incorrect_checksums"><a class="anchor" href="#incorrect_checksums"></a><a class="link" href="#incorrect_checksums">Incorrect checksums</a></h5>
<div class="paragraph">
<p>A more problematic issue is when the actual checksum verification fails:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Execution failed for task ':compileJava'.
&gt; Dependency verification failed for configuration ':compileClasspath':
    - On artifact commons-logging-1.2.jar (commons-logging:commons-logging:1.2) in repository 'MavenRepo': expected a 'sha256' checksum of '91f7a33096ea69bac2cbaf6d01feb934cac002c48d8c8cfa9c240b40f1ec21df' but was 'daddea1ea0be0f56978ab3006b8ac92834afeefbd9b7e4e6316fca57df0fa636'</pre>
</div>
</div>
<div class="paragraph">
<p>This time, Gradle tells you what dependency is at fault, what was the expected checksum (the one you declared in the verification metadata file) and the one which was actually computed during verification.</p>
</div>
<div class="paragraph">
<p>Such a failure indicates that a <strong>dependency may have been compromised</strong>.
At this stage, you <strong>must</strong> perform manual verification and check what happens.
Several things can happen:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a dependency was tampered in the local dependency cache of Gradle. This is usually harmless: erase the file from the cache and Gradle would redownload the dependency.</p>
</li>
<li>
<p>a dependency is available in multiple sources with slightly different binaries (additional whitespace, &#8230;&#8203;)</p>
<div class="ulist">
<ul>
<li>
<p>please inform the maintainers of the library that they have such an issue</p>
</li>
<li>
<p>you can use <a href="#sec:trusting-several-checksums"><code>also-trust</code></a> to accept the additional checksums</p>
</li>
</ul>
</div>
</li>
<li>
<p>the dependency was compromised</p>
<div class="ulist">
<ul>
<li>
<p>immediately inform the maintainers of the library</p>
</li>
<li>
<p>notify the repository maintainers of the compromised library</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note that a variation of a compromised library is often <em>name squatting</em>, when a hacker would use GAV coordinates which <em>look legit</em> but are actually different by one character, or <em>repository shadowing</em>, when a dependency with the official GAV coordinates is published in a malicious repository which comes first in your build.</p>
</div>
</div>
<div class="sect4">
<h5 id="untrusted_signatures"><a class="anchor" href="#untrusted_signatures"></a><a class="link" href="#untrusted_signatures">Untrusted signatures</a></h5>
<div class="paragraph">
<p>If you have signature verification enabled, Gradle will perform verification of the signatures but will not trust them automatically:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt; Dependency verification failed for configuration ':compileClasspath':
    - On artifact javaparser-core-3.6.11.jar (com.github.javaparser:javaparser-core:3.6.11) in repository 'MavenRepo': Artifact was signed with key '379ce192d401ab61' (Bintray (by JFrog) &lt;****&gt;) and passed verification but the key isn't in your trusted keys list.</pre>
</div>
</div>
<div class="paragraph">
<p>In this case it means you need to check yourself if the key that was used for verification (and therefore the signature) can be trusted, in which case refer to <a href="#sec:understanding-signature-verification">this section of the documentation</a> to figure out how to declare trusted keys.</p>
</div>
</div>
<div class="sect4">
<h5 id="failed_signature_verification"><a class="anchor" href="#failed_signature_verification"></a><a class="link" href="#failed_signature_verification">Failed signature verification</a></h5>
<div class="paragraph">
<p>If Gradle fails to verify a signature, you will need to take action and verify artifacts manually because this <strong>may indicate a compromised dependency</strong>.</p>
</div>
<div class="paragraph">
<p>If such a thing happens, Gradle will fail with:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt; Dependency verification failed for configuration ':compileClasspath':
    - On artifact javaparser-core-3.6.11.jar (com.github.javaparser:javaparser-core:3.6.11) in repository 'MavenRepo': Artifact was signed with key '379ce192d401ab61' (Bintray (by JFrog) &lt;****&gt;) but signature didn't match</pre>
</div>
</div>
<div class="paragraph">
<p>There are several options:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>signature was wrong in the first place, which happens frequently with <a href="#sec:trusting-several-checksums">dependencies published on different repositories</a>.</p>
</li>
<li>
<p>the signature is correct but the artifact has been compromised (either in the local dependency cache or remotely)</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The right approach here is to go to the official site of the dependency and see if they publish signatures for their artifacts.
If they do, verify that the signature that Gradle downloaded matches the one published.</p>
</div>
<div class="paragraph">
<p>If you have <a href="#sec:manual-checking-dependency">checked that the dependency is <em>not</em> compromised</a> and that it&#8217;s "only" the signature which is wrong, you should declare an <em>artifact level key exclusion</em>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">   &lt;components&gt;
       &lt;component group="com.github.javaparser" name="javaparser-core" version="3.6.11"&gt;
          &lt;artifact name="javaparser-core-3.6.11.pom"&gt;
             &lt;ignored-keys&gt;
                &lt;ignored-key id="379ce192d401ab61" reason="internal repo has corrupted POM"/&gt;
             &lt;/ignored-keys&gt;
          &lt;/artifact&gt;
       &lt;/component&gt;
   &lt;/components&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>However, if you only do so, Gradle will still fail because all keys for this artifact will be ignored and you didn&#8217;t provide a checksum:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">   &lt;components&gt;
       &lt;component group="com.github.javaparser" name="javaparser-core" version="3.6.11"&gt;
          &lt;artifact name="javaparser-core-3.6.11.pom"&gt;
             &lt;ignored-keys&gt;
                &lt;ignored-key id="379ce192d401ab61" reason="internal repo has corrupted POM"/&gt;
             &lt;/ignored-keys&gt;
             &lt;sha256 value="a2023504cfd611332177f96358b6f6db26e43d96e8ef4cff59b0f5a2bee3c1e1"/&gt;
          &lt;/artifact&gt;
       &lt;/component&gt;
   &lt;/components&gt;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:manual-checking-dependency"><a class="anchor" href="#sec:manual-checking-dependency"></a><a class="link" href="#sec:manual-checking-dependency">Manual verification of a dependency</a></h5>
<div class="paragraph">
<p>You will likely face a dependency verification failure (either checksum verification or signature verification) and will need to figure out if the dependency has been compromised or not.</p>
</div>
<div class="paragraph">
<p>In this section we give <em>an example</em> how you can manually check if a dependency was compromised.</p>
</div>
<div class="paragraph">
<p>For this we will take this example failure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt; Dependency verification failed for configuration ':compileClasspath':
- On artifact j2objc-annotations-1.1.jar (com.google.j2objc:j2objc-annotations:1.1) in repository 'MyCompany Mirror': Artifact was signed with key '29579f18fa8fd93b' but signature didn't match</pre>
</div>
</div>
<div class="paragraph">
<p>This error message gives us the GAV coordinates of the problematic dependency, as well as an indication of where the dependency was fetched from.
Here, the dependency comes from <code>MyCompany Mirror</code>, which is a repository declared in our build.</p>
</div>
<div class="paragraph">
<p>The first thing to do is therefore to download the artifact and its signature manually from the mirror:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ curl https://my-company-mirror.com/repo/com/google/j2objc/j2objc-annotations/1.1/j2objc-annotations-1.1.jar --output j2objc-annotations-1.1.jar
$ curl https://my-company-mirror.com/repo/com/google/j2objc/j2objc-annotations/1.1/j2objc-annotations-1.1.jar.asc --output j2objc-annotations-1.1.jar.asc</pre>
</div>
</div>
<div class="paragraph">
<p>Then we can use the key information provided in the error message to import the key locally:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gpg --recv-keys 29579f18fa8fd93b</pre>
</div>
</div>
<div class="paragraph">
<p>And perform verification:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gpg --verify j2objc-annotations-1.1.jar.asc
gpg: assuming signed data in 'j2objc-annotations-1.1.jar'
gpg: Signature made Thu 19 Jan 2017 12:06:51 AM CET
gpg:                using RSA key 29579F18FA8FD93B
gpg: BAD signature from "Tom Ball &lt;****&gt;" [unknown]</pre>
</div>
</div>
<div class="paragraph">
<p>What this tells us is that the problem is <em>not</em> on the local machine: the repository <em>already contains a bad signature</em>.</p>
</div>
<div class="paragraph">
<p>The next step is to do the same by downloading what is actually on Maven Central:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ curl https://my-company-mirror.com/repo/com/google/j2objc/j2objc-annotations/1.1/j2objc-annotations-1.1.jar  --output central-j2objc-annotations-1.1.jar
$ curl https://my-company-mirror.com/repo/com/google/j2objc/j2objc-annotations/1/1/j2objc-annotations-1.1.jar.asc  --output central-j2objc-annotations-1.1.jar.asc</pre>
</div>
</div>
<div class="paragraph">
<p>And we can now check the signature again:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gpg --verify central-j2objc-annotations-1.1.jar.asc

gpg: assuming signed data in 'central-j2objc-annotations-1.1.jar'
gpg: Signature made Thu 19 Jan 2017 12:06:51 AM CET
gpg:                using RSA key 29579F18FA8FD93B
gpg: Good signature from "Tom Ball &lt;****&gt;" [unknown]
gpg: WARNING: This key is not certified with a trusted signature!
gpg:          There is no indication that the signature belongs to the owner.
Primary key fingerprint: B801 E2F8 EF03 5068 EC11  39CC 2957 9F18 FA8F D93B</pre>
</div>
</div>
<div class="paragraph">
<p>This indicates that the dependency is <em>valid</em> on Maven Central.
At this stage, we already know that the problem lives in the mirror, it <em>may</em> have been compromised, but we need to verify.</p>
</div>
<div class="paragraph">
<p>A good idea is to compare the 2 artifacts, which you can do with a tool like <a href="https://try.diffoscope.org/">diffoscope</a>.</p>
</div>
<div class="paragraph">
<p>We then figure out that the intent wasn&#8217;t malicious but that somehow a build has been overwritten with a newer version (the version in Central is newer than the one in our repository).</p>
</div>
<div class="paragraph">
<p>In this case, you can decide to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ignore the signature for this artifact and trust the different possible checksums (both for the old artifact and the new version)</p>
</li>
<li>
<p>or cleanup your mirror so that it contains the same version as in Maven Central</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It&#8217;s worth noting that if you choose to delete the version from your repository, you will <em>also</em> need to remove it from the local Gradle cache.</p>
</div>
<div class="paragraph">
<p>This is facilitated by the fact the error message tells you were the file is located:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt; Dependency verification failed for configuration ':compileClasspath':
    - On artifact j2objc-annotations-1.1.jar (com.google.j2objc:j2objc-annotations:1.1) in repository 'MyCompany Mirror': Artifact was signed with key '29579f18fa8fd93b' but signature didn't match

  This can indicate that a dependency has been compromised. Please carefully verify the signatures and checksums.

  For your information here are the path to the files which failed verification:
    - GRADLE_USER_HOME/caches/modules-2/files-2.1/com.google.j2objc/j2objc-annotations/1.1/976d8d30bebc251db406f2bdb3eb01962b5685b3/j2objc-annotations-1.1.jar (signature: GRADLE_USER_HOME/caches/modules-2/files-2.1/com.google.j2objc/j2objc-annotations/1.1/82e922e14f57d522de465fd144ec26eb7da44501/j2objc-annotations-1.1.jar.asc)

  GRADLE_USER_HOME = /home/jiraya/.gradle</pre>
</div>
</div>
<div class="paragraph">
<p>You can safely delete the artifact file as Gradle would automatically re-download it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>rm -rf ~/.gradle/caches/modules-2/files-2.1/com.google.j2objc/j2objc-annotations/1.1</pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:disabling-verification"><a class="anchor" href="#sec:disabling-verification"></a><a class="link" href="#sec:disabling-verification">Disabling verification or making it lenient</a></h4>
<div class="paragraph">
<p>Dependency verification can be expensive, or sometimes verification could get in the way of day to day development (because of frequent dependency upgrades, for example).</p>
</div>
<div class="paragraph">
<p>Alternatively, you might want to enable verification on CI servers but not on local machines.</p>
</div>
<div class="paragraph">
<p>Gradle actually provides 3 different verification modes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>strict</code>, which is the default.
Verification fails <em>as early as possible</em>, in order to avoid the use of compromised dependencies during the build.</p>
</li>
<li>
<p><code>lenient</code>, which will run the build even if there are verification failures.
The verification errors will be displayed during the build without causing a build failure.</p>
</li>
<li>
<p><code>off</code> when verification is totally ignored.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>All those modes can be activated on the CLI using the <code>--dependency-verification</code> flag, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>./gradlew --dependency-verification lenient build</pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, you can set the <code>org.gradle.dependency.verification</code> system property, either on the CLI:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>./gradlew -Dorg.gradle.dependency.verification=lenient build</pre>
</div>
</div>
<div class="paragraph">
<p>or in a <code>gradle.properties</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>org.gradle.dependency.verification=lenient</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:trusting-artifacts"><a class="anchor" href="#sec:trusting-artifacts"></a><a class="link" href="#sec:trusting-artifacts">Trusting some particular artifacts</a></h4>
<div class="paragraph">
<p>You might want to trust some artifacts more than others.
For example, it&#8217;s legitimate to think that artifacts produced in your company and found in your internal repository only are safe, but you want to check every external component.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This is a typical <em>company policy</em>.
In practice, <strong>nothing</strong> prevents your internal repository from being compromised, so it&#8217;s a good idea to check your internal artifacts too!</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For this purpose, Gradle offers a way to automatically trust some artifacts.
You can trust all artifacts in a group by adding this to your configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;verification-metadata&gt;
   &lt;configuration&gt;
      &lt;trusted-artifacts&gt;
         &lt;trust group="com.mycompany"/&gt;
      &lt;/trusted-artifacts&gt;
   &lt;/configuration&gt;
&lt;/verification-metadata&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This means that all components which group is <code>com.mycompany</code> will automatically be trusted.
Trusted means that Gradle will not perform any verification whatsoever.</p>
</div>
<div class="paragraph">
<p>The <code>trust</code> element accepts those attributes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>group</code>, the group of the artifact to trust</p>
</li>
<li>
<p><code>name</code>, the name of the artifact to trust</p>
</li>
<li>
<p><code>version</code>, the version of the artifact to trust</p>
</li>
<li>
<p><code>file</code>, the name of the artifact <em>file</em> to trust</p>
</li>
<li>
<p><code>regex</code>, a boolean saying if the <code>group</code>, <code>name</code>, <code>version</code> and <code>file</code> attributes need to be interpreted as regular expressions (defaults to <code>false</code>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In the example above it means that the trusted artifacts would be artifacts in <code>com.mycompany</code> but not <code>com.mycompany.other</code>.
To trust all artifacts in <code>com.mycompany</code> and all subgroups, you can use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;verification-metadata&gt;
   &lt;configuration&gt;
      &lt;trusted-artifacts&gt;
         &lt;trust group="^com[.]mycompany($|([.].*))" regex="true"/&gt;
      &lt;/trusted-artifacts&gt;
   &lt;/configuration&gt;
&lt;/verification-metadata&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:trusting-several-checksums"><a class="anchor" href="#sec:trusting-several-checksums"></a><a class="link" href="#sec:trusting-several-checksums">Trusting multiple checksums for an artifact</a></h4>
<div class="paragraph">
<p>It&#8217;s quite common to have <em>different checksums for the same artifact</em> in the wild.
How is that possible?
Despite progress, it&#8217;s often the case that developers publish, for example, to Maven Central and JCenter separately, using different builds.
In general, this is not a problem but sometimes it means that the metadata files would be different (different timestamps, additional whitespaces, &#8230;&#8203;).
Add to this that your build may use several repositories or repository mirrors and it makes it quite likely that a single build can "see" different metadata files for the same component!
In general, it&#8217;s not malicious (but you <strong>must</strong> verify that the artifact is actually correct), so Gradle lets you declare the additional artifact checksums.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">      &lt;component group="org.apache" name="apache" version="13"&gt;
         &lt;artifact name="apache-13.pom"&gt;
            &lt;sha256 value="2fafa38abefe1b40283016f506ba9e844bfcf18713497284264166a5dbf4b95e"&gt;
               &lt;also-trust value="ff513db0361fd41237bef4784968bc15aae478d4ec0a9496f811072ccaf3841d"/&gt;
            &lt;/sha256&gt;
         &lt;/artifact&gt;
      &lt;/component&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can have as many <code>also-trust</code> entries as needed, but in general you shouldn&#8217;t have more than 2.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:skipping-javadocs"><a class="anchor" href="#sec:skipping-javadocs"></a><a class="link" href="#sec:skipping-javadocs">Skipping Javadocs and sources</a></h4>
<div class="paragraph">
<p>By default Gradle will verify <em>all</em> downloaded artifacts, which includes Javadocs and sources.
In general this is not a problem but you might face an issue with IDEs which automatically try to download them during import: if you didn&#8217;t set the checksums for those too, importing would fail.</p>
</div>
<div class="paragraph">
<p>To avoid this, you can configure Gradle to trust automatically all javadocs/sources:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;trusted-artifacts&gt;
   &lt;trust file=".*-javadoc[.]jar" regex="true"/&gt;
   &lt;trust file=".*-sources[.]jar" regex="true"/&gt;
&lt;/trusted-artifacts&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:verification-metadata-hygiene"><a class="anchor" href="#sec:verification-metadata-hygiene"></a><a class="link" href="#sec:verification-metadata-hygiene">Cleaning up the verification file</a></h4>
<div class="paragraph">
<p>If you do nothing, the dependency verification metadata will grow over time as you add new dependencies or change versions: Gradle will not automatically remove <em>unused</em> entries from this file.
The reason is that there&#8217;s no way for Gradle to know upfront if a dependency will effectively be used during the build or not.</p>
</div>
<div class="paragraph">
<p>As a consequence, adding dependencies or changing dependency version can easily lead to more entries in the file, while leaving unnecessary entries out there.</p>
</div>
<div class="paragraph">
<p>One option to cleanup the file is to move the existing <code>verification-metadata.xml</code> file to a different location and call Gradle with the <a href="#sec:verification-dry-mode"><code>--dry-run</code> mode</a>: while not perfect (it will not notice dependencies only resolved at configuration time), it generates <em>a new file</em> that you can compare with the existing one.</p>
</div>
<div class="paragraph">
<p>We need to move the existing file because both the bootstrapping mode and the dry-run mode are incremental: they copy information from the existing metadata verification file (in particular, trusted keys).</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:refreshing-missing-keys"><a class="anchor" href="#sec:refreshing-missing-keys"></a><a class="link" href="#sec:refreshing-missing-keys">Refreshing missing keys</a></h4>
<div class="paragraph">
<p>Gradle caches missing keys for 24 hours, meaning it will not attempt to re-download the missing keys for 24 hours after failing.</p>
</div>
<div class="paragraph">
<p>If you want to retry immediately, you can run with the <code>--refresh-keys</code> CLI flag:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>./gradlew build --refresh-keys</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sub:disabling-specific-verification"><a class="anchor" href="#sub:disabling-specific-verification"></a><a class="link" href="#sub:disabling-specific-verification">Disabling dependency verification for some configurations only</a></h3>
<div class="paragraph">
<p>In order to provide the strongest security level possible, dependency verification is enabled globally.
This will ensure, for example, that you trust all the plugins you use.
However, the plugins themselves may need to resolve additional dependencies that it doesn&#8217;t make sense to ask the user to accept.
For this purpose, Gradle provides an API which allows <em>disabling dependency verification on some specific configurations</em>.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Disabling dependency verification, if you care about security, is not a good idea.
This API mostly exist for cases where it doesn&#8217;t make sense to check dependencies.
However, in order to be on the safe side, Gradle will systematically print a warning whenever verification has been disabled for a specific configuration.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>As an example, a plugin may want to check if there are <em>newer</em> versions of a library available and list those versions.
It doesn&#8217;t make sense, in this context, to ask the user to put the checksums of the POM files of the newer releases because by definition, they don&#8217;t know about them.
So the plugin might need to run its code <em>independently of the dependency verification configuration</em>.</p>
</div>
<div class="paragraph">
<p>To do this, you need to call the <code>ResolutionStrategy#disableDependencyVerification</code> method:</p>
</div>
<div class="exampleblock">
<div class="title">Example 48. Disabling dependency verification</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">configurations {
    myPluginClasspath {
        resolutionStrategy {
            disableDependencyVerification()
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">configurations {
    "myPluginClasspath" {
        resolutionStrategy {
            disableDependencyVerification()
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>It&#8217;s also possible to disable verification on detached configurations like in the following example:</p>
</div>
<div class="exampleblock">
<div class="title">Example 49. Disabling dependency verification</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">tasks.register("checkDetachedDependencies") {
    doLast {
        def detachedConf = configurations.detachedConfiguration(dependencies.create("org.apache.commons:commons-lang3:3.3.1"))
        detachedConf.resolutionStrategy.disableDependencyVerification()
        println(detachedConf.files)
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">tasks.register("checkDetachedDependencies") {
    doLast {
        val detachedConf = configurations.detachedConfiguration(dependencies.create("org.apache.commons:commons-lang3:3.3.1"))
        detachedConf.resolutionStrategy.disableDependencyVerification()
        println(detachedConf.files)
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<h1 id="declaring_versions" class="sect0"><a class="anchor" href="#declaring_versions"></a><a class="link" href="#declaring_versions">Declaring Versions</a></h1>
<div class="sect1">
<h2 id="single-version-declarations"><a class="anchor" href="#single-version-declarations"></a><a class="link" href="#single-version-declarations">Declaring Versions and Ranges</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The simplest version declaration is a <em>simple string</em> representing the version to use.
Gradle supports different ways of declaring a version string:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>An exact version: e.g. <code>1.3</code>, <code>1.3.0-beta3</code>, <code>1.0-20150201.131010-1</code></p>
</li>
<li>
<p>A Maven-style version range: e.g. <code>[1.0,)</code>, <code>[1.1, 2.0)</code>, <code>(1.2, 1.5]</code></p>
<div class="ulist">
<ul>
<li>
<p>The <code>[</code> and <code>]</code> symbols indicate an inclusive bound; <code>(</code> and <code>)</code> indicate an exclusive bound.</p>
</li>
<li>
<p>When the upper or lower bound is missing, the range has no upper or lower bound.</p>
</li>
<li>
<p>The symbol <code>]</code> can be used instead of <code>(</code> for an exclusive lower bound, and <code>[</code> instead of <code>)</code> for exclusive upper bound. e.g <code>]1.0, 2.0[</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>A <em>prefix</em> version range: e.g. <code>1.+</code>, <code>1.3.+</code></p>
<div class="ulist">
<ul>
<li>
<p>Only versions exactly matching the portion before the <code>+</code> are included.</p>
</li>
<li>
<p>The range <code>+</code> on it&#8217;s own will include any version.</p>
</li>
</ul>
</div>
</li>
<li>
<p>A <code>latest-status</code> version: e.g. <code>latest.integration</code>, <code>latest.release</code></p>
<div class="ulist">
<ul>
<li>
<p>Will match the highest versioned module with the specified status. See <a href="../javadoc/org/gradle/api/artifacts/ComponentMetadata.html#getStatus--">ComponentMetadata.getStatus()</a>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>A Maven <code>SNAPSHOT</code> version identifier: e.g. <code>1.0-SNAPSHOT</code>, <code>1.4.9-beta1-SNAPSHOT</code></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="version_ordering"><a class="anchor" href="#version_ordering"></a><a class="link" href="#version_ordering">Version ordering</a></h3>
<div class="paragraph">
<p>Versions have an implicit ordering. Version ordering is used to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Determine if a particular version is included in a range.</p>
</li>
<li>
<p>Determine which version is 'newest' when performing conflict resolution.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Versions are ordered based on the following rules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Each version is split into it&#8217;s constituent "parts":</p>
<div class="ulist">
<ul>
<li>
<p>The characters <code>[. - _ +]</code> are used to separate the different "parts" of a version.</p>
</li>
<li>
<p>Any part that contains both digits and letters is split into separate parts for each: <code>1a1 == 1.a.1</code></p>
</li>
<li>
<p>Only the parts of a version are compared. The actual separator characters are not significant: <code>1.a.1 == 1-a+1 == 1.a-1 == 1a1</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>The equivalent parts of 2 versions are compared using the following rules:</p>
<div class="ulist">
<ul>
<li>
<p>If both parts are numeric, the highest numeric value is <strong>higher</strong>: <code>1.1</code> &lt; <code>1.2</code></p>
</li>
<li>
<p>If one part is numeric, it is considered <strong>higher</strong> than the non-numeric part: <code>1.a</code> &lt; <code>1.1</code></p>
</li>
<li>
<p>If both are not numeric, the parts are compared <strong>alphabetically, case-sensitive</strong>: <code>1.A</code> &lt; <code>1.B</code> &lt; <code>1.a</code> &lt; <code>1.b</code></p>
</li>
<li>
<p>A version with an extra numeric part is considered <strong>higher</strong> than a version without: <code>1.1</code> &lt; <code>1.1.0</code></p>
</li>
<li>
<p>A version with an extra non-numeric part is considered <strong>lower</strong> than a version without: <code>1.1.a</code> &lt; <code>1.1</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Certain string values have special meaning for the purposes of ordering:</p>
<div class="ulist">
<ul>
<li>
<p>The string <code>dev</code> is consider <strong>lower</strong> than any other string part: <code>1.0-dev</code> &lt; <code>1.0-alpha</code> &lt; <code>1.0-rc</code>.</p>
</li>
<li>
<p>The strings <code>rc</code>, <code>release</code> and <code>final</code> are considered <strong>higher</strong> than any other string part (sorted in that order): <code>1.0-zeta</code> &lt; <code>1.0-rc</code> &lt; <code>1.0-release</code> &lt; <code>1.0-final</code> &lt; <code>1.0</code>.</p>
</li>
<li>
<p>The string <code>SNAPSHOT</code> has <strong>no special meaning</strong>, and is sorted alphabetically like any other string part: <code>1.0-alpha</code> &lt; <code>1.0-SNAPSHOT</code> &lt; <code>1.0-zeta</code> &lt; <code>1.0-rc</code> &lt; <code>1.0</code>.</p>
</li>
<li>
<p>Numeric snapshot versions have <strong>no special meaning</strong>, and are sorted like any other numeric part: <code>1.0</code> &lt; <code>1.0-20150201.121010-123</code> &lt; <code>1.1</code>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="simple_version_declaration_semantics"><a class="anchor" href="#simple_version_declaration_semantics"></a><a class="link" href="#simple_version_declaration_semantics">Simple version declaration semantics</a></h3>
<div class="paragraph">
<p>When you declare a version using the short-hand notation, for example:</p>
</div>
<div class="exampleblock">
<div class="title">Example 50. A simple declaration</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">dependencies {
    implementation('org.slf4j:slf4j-api:1.7.15')
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">dependencies {
    implementation("org.slf4j:slf4j-api:1.7.15")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Then the version is considered a <a href="#sec:required-version">required version</a> which means that it should <em>minimally</em> be <code>1.7.15</code> but can be upgraded by the engine (optimistic upgrade).</p>
</div>
<div class="paragraph">
<p>There is, however, a shorthand notation for <a href="#sec:strict-version">strict versions</a>, using the <code>!!</code> notation:</p>
</div>
<div class="exampleblock">
<div class="title">Example 51. Shorthand notation for strict dependencies</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">dependencies {
    // short-hand notation with !!
    implementation('org.slf4j:slf4j-api:1.7.15!!')
    // is equivalent to
    implementation("org.slf4j:slf4j-api") {
        version {
           strictly '1.7.15'
        }
    }

    // or...
    implementation('org.slf4j:slf4j-api:[1.7, 1.8[!!1.7.25')
    // is equivalent to
    implementation('org.slf4j:slf4j-api') {
        version {
           strictly '[1.7, 1.8['
           prefer '1.7.25'
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">dependencies {
    // short-hand notation with !!
    implementation("org.slf4j:slf4j-api:1.7.15!!")
    // is equivalent to
    implementation("org.slf4j:slf4j-api") {
        version {
           strictly("1.7.15")
        }
    }

    // or...
    implementation("org.slf4j:slf4j-api:[1.7, 1.8[!!1.7.25")
    // is equivalent to
    implementation("org.slf4j:slf4j-api") {
        version {
           strictly([1.7, 1.8[")
           prefer("1.7.25")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>A strict version <em>cannot be upgraded</em> and overrides whatever transitive dependencies originating from this dependency provide.
It is recommended to use ranges for strict versions.</p>
</div>
<div class="paragraph">
<p>The notation <code>[1.7, 1.8[!!1.7.25</code> above is equivalent to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>strictly <code>[1.7, 1.8[</code></p>
</li>
<li>
<p>prefer <code>1.7.25</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>which means that the engine <strong>must</strong> select a version between 1.7 (included) and 1.8 (excluded), and that if no other component in the graph needs a different version, it should <em>prefer</em> <code>1.7.25</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="sec:declaring_without_version"><a class="anchor" href="#sec:declaring_without_version"></a><a class="link" href="#sec:declaring_without_version">Declaring a dependency without version</a></h3>
<div class="paragraph">
<p>A recommended practice for larger projects is to declare dependencies without versions and use <a href="#sec:adding-constraints-transitive-deps">dependency constraints</a> for version declaration.
The advantage is that dependency constraints allow you to manage versions of all dependencies, including transitive ones, in one place.</p>
</div>
<div class="exampleblock">
<div class="title">Example 52. Declaring a dependency without version</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">dependencies {
    implementation 'org.springframework:spring-web'
}

dependencies {
    constraints {
        implementation 'org.springframework:spring-web:5.0.2.RELEASE'
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">dependencies {
    implementation("org.springframework:spring-web")
}

dependencies {
    constraints {
        implementation("org.springframework:spring-web:5.0.2.RELEASE")
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="rich-version-constraints"><a class="anchor" href="#rich-version-constraints"></a><a class="link" href="#rich-version-constraints">Declaring Rich Versions</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Gradle supports a rich model for declaring versions, which allows to combine different level of version information.
The terms and their meaning are explained below, from the strongest to the weakest:</p>
</div>
<div id="sec:strict-version" class="dlist">
<dl>
<dt class="hdlist1"><code>strictly</code></dt>
<dd>
<p>Any version not matched by this version notation will be excluded.
This is the strongest version declaration.
On a declared dependency, a <code>strictly</code> can downgrade a version.
When on a transitive dependency, it will cause dependency resolution to fail if no version acceptable by this clause can be selected.
See <a href="#sec:enforcing_dependency_version">overriding dependency version</a> for details.
This term supports dynamic versions.</p>
<div class="paragraph">
<p>When defined, overrides previous <code>require</code> declaration and clears previous <code>reject</code>.</p>
</div>
</dd>
</dl>
</div>
<div id="sec:required-version" class="dlist">
<dl>
<dt class="hdlist1"><code>require</code></dt>
<dd>
<p>Implies that the selected version cannot be lower than what <code>require</code> accepts but could be higher through conflict resolution, even if higher has an exclusive higher bound.
This is what a direct version on a dependency translates to.
This term supports dynamic versions.</p>
<div class="paragraph">
<p>When defined, overrides previous <code>strictly</code> declaration and clears previous <code>reject</code>.</p>
</div>
</dd>
</dl>
</div>
<div id="sec:preferred-version" class="dlist">
<dl>
<dt class="hdlist1"><code>prefer</code></dt>
<dd>
<p>This is a very soft version declaration.
It applies only if there is no stronger non dynamic opinion on a version for the module.
This term does not support dynamic versions.</p>
<div class="paragraph">
<p>Definition can complement <code>strictly</code> or <code>require</code>.</p>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>There is also an additional term outside of the level hierarchy:</p>
</div>
<div id="sec:rejected-version" class="dlist">
<dl>
<dt class="hdlist1"><code>reject</code></dt>
<dd>
<p>Declares that specific version(s) are not accepted for the module.
This will cause dependency resolution to fail if the only versions selectable are also rejected.
This term supports dynamic versions.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The following table illustrates a number of use cases and how to combine the different terms for rich version declaration:</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 5. Rich version use cases</caption>
<colgroup>
<col>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Which version(s) of this dependency are acceptable?</th>
<th class="tableblock halign-left valign-top"><code>strictly</code></th>
<th class="tableblock halign-left valign-top"><code>require</code></th>
<th class="tableblock halign-left valign-top"><code>prefer</code></th>
<th class="tableblock halign-left valign-top"><code>rejects</code></th>
<th class="tableblock halign-left valign-top">Selection result</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tested with version <code>1.5</code>, believe all future versions should work.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.5</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any version starting from <code>1.5</code>, equivalent of <code>org:foo:1.5</code>. An upgrade to <code>2.4</code> is accepted.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tested with <code>1.5</code>, soft constraint upgrades according to semantic versioning.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[1.0, 2.0[</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.5</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any version between <code>1.0</code> and <code>2.0</code>, <code>1.5</code> if nobody else cares. An upgrade to <code>2.4</code> is accepted.<br>
</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tested with <code>1.5</code>, but follows semantic versioning.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[1.0, 2.0[</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.5</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any version between <code>1.0</code> and <code>2.0</code> excluded, <code>1.5</code> if nobody else cares.<br>
Overwrites versions from transitive dependencies.<br>
</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Same as above, with <code>1.4</code> known broken.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[1.0, 2.0[</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any version between <code>1.0</code> and <code>2.0</code> excluded except for <code>1.4</code>, <code>1.5</code> if nobody else cares.<br>
Overwrites versions from transitive dependencies.<br>
</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">No opinion, works with <code>1.5</code>.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.5</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.5</code> if no other opinion, any otherwise.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">No opinion, prefer latest release.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>latest.release</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The latest release at build time.<br>
</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">On the edge, latest release, no downgrade.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>latest.release</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The latest release at build time.<br>
</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">No other version than 1.5.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.5</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.5, or failure if another <code>strict</code> or higher <code>require</code> constraint disagrees.<br>
Overwrites versions from transitive dependencies.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.5</code> or a patch version of it exclusively.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[1.5,1.6[</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Latest <code>1.5.x</code> patch release, or failure if another <code>strict</code> or higher <code>require</code> constraint disagrees.<br>
Overwrites versions from transitive dependencies.<br>
</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Lines annotated with a lock () indicate that leveraging <a href="#">dependency locking</a> makes sense in this context.
Another concept that relates with rich version declaration is the ability to publish <a href="publishing_maven.html#publishing_maven:resolved_dependencies">resolved versions</a> instead of declared ones.</p>
</div>
<div class="paragraph">
<p>Using <code>strictly</code>, especially for a library, must be a well thought process as it has an impact on downstream consumers.
At the same time, used correctly, it will help consumers understand what combination of libraries do not work together in their context.
See <a href="#sec:enforcing_dependency_version">overriding dependency version</a> for more information.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Rich version information will be preserved in the Gradle Module Metadata format.
However conversion to Ivy or Maven metadata formats will be lossy.
The highest level will be published, that is <code>strictly</code> or <code>require</code> over <code>prefer</code>.
In addition, any <code>reject</code> will be ignored.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Rich version declaration is accessed through the <code>version</code> DSL method on a dependency or constraint declaration which gives access to <a href="../javadoc/org/gradle/api/artifacts/MutableVersionConstraint.html">MutableVersionConstraint</a>.</p>
</div>
<div class="exampleblock">
<div class="title">Example 53. Rich version declaration</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">dependencies {
    implementation('org.slf4j:slf4j-api') {
        version {
            strictly '[1.7, 1.8['
            prefer '1.7.25'
        }
    }

    constraints {
        implementation('org.springframework:spring-core') {
            version {
                require '4.2.9.RELEASE'
                reject '4.3.16.RELEASE'
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">dependencies {
    implementation("org.slf4j:slf4j-api") {
        version {
            strictly("[1.7, 1.8[")
            prefer("1.7.25")
        }
    }

    constraints {
        add("implementation", "org.springframework:spring-core") {
            version {
                require("4.2.9.RELEASE")
                reject("4.3.16.RELEASE")
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec:dynamic_versions_and_changing_modules"><a class="anchor" href="#sec:dynamic_versions_and_changing_modules"></a><a class="link" href="#sec:dynamic_versions_and_changing_modules">Handling versions which change over time</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>There are many situations when you want to use the latest version of a particular module dependency, or the latest in a range of versions.
This can be a requirement during development, or you may be developing a library that is designed to work with a range of dependency versions.
You can easily depend on these constantly changing dependencies by using a <em>dynamic version</em>.
A <a href="#sub:declaring_dependency_with_dynamic_version">dynamic version</a> can be either a version range (e.g. <code>2.+</code>) or it can be a placeholder for the latest version available e.g. <code>latest.integration</code>.</p>
</div>
<div class="paragraph">
<p>Alternatively, the module you request can change over time even for the same version, a so-called <a href="#sub:declaring_dependency_with_changing_version">changing version</a>.
An example of this type of <em>changing module</em> is a Maven <code>SNAPSHOT</code> module, which always points at the latest artifact published.
In other words, a standard Maven snapshot is a module that is continually evolving, it is a "changing module".</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Using dynamic versions and changing modules can lead to unreproducible builds. As new versions of a particular module are published, its API may become incompatible with your source code. Use this feature with caution!</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="sub:declaring_dependency_with_dynamic_version"><a class="anchor" href="#sub:declaring_dependency_with_dynamic_version"></a><a class="link" href="#sub:declaring_dependency_with_dynamic_version">Declaring a dynamic version</a></h3>
<div class="paragraph">
<p>Projects might adopt a more aggressive approach for consuming dependencies to modules.
For example you might want to always integrate the latest version of a dependency to consume cutting edge features at any given time.
A <em>dynamic version</em> allows for resolving the latest version or the latest version of a version range for a given module.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Using dynamic versions in a build bears the risk of potentially breaking it. As soon as a new version of the dependency is released that contains an incompatible API change your source code might stop compiling.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="exampleblock">
<div class="title">Example 54. Declaring a dependency with a dynamic version</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">plugins {
    id 'java-library'
}

repositories {
    mavenCentral()
}

dependencies {
    implementation 'org.springframework:spring-web:5.+'
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">plugins {
    `java-library`
}

repositories {
    mavenCentral()
}

dependencies {
    implementation("org.springframework:spring-web:5.+")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>A <a href="https://scans.gradle.com/">build scan</a> can effectively visualize dynamic dependency versions and their respective, selected versions.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/dependency-management-dynamic-dependency-build-scan.png" alt="dependency management dynamic dependency build scan">
</div>
<div class="title">Figure 10. Dynamic dependencies in build scan</div>
</div>
<div class="paragraph">
<p>By default, Gradle caches dynamic versions of dependencies for 24 hours. Within this time frame, Gradle does not try to resolve newer versions from the declared repositories.
The <a href="#sec:controlling-dynamic-version-caching">threshold can be configured</a> as needed for example if you want to resolve new versions earlier.</p>
</div>
</div>
<div class="sect2">
<h3 id="sub:declaring_dependency_with_changing_version"><a class="anchor" href="#sub:declaring_dependency_with_changing_version"></a><a class="link" href="#sub:declaring_dependency_with_changing_version">Declaring a changing version</a></h3>
<div class="paragraph">
<p>A team might decide to implement a series of features before releasing a new version of the application or library. A common strategy to allow consumers to integrate an unfinished version of their artifacts early and often is to release a module with a so-called <em>changing version</em>.
A changing version indicates that the feature set is still under active development and hasn&#8217;t released a stable version for general availability yet.</p>
</div>
<div class="paragraph">
<p>In Maven repositories, changing versions are commonly referred to as <a href="https://maven.apache.org/guides/getting-started/index.html#What_is_a_SNAPSHOT_version">snapshot versions</a>.
Snapshot versions contain the suffix <code>-SNAPSHOT</code>.
The following example demonstrates how to declare a snapshot version on the Spring dependency.</p>
</div>
<div class="exampleblock">
<div class="title">Example 55. Declaring a dependency with a changing version</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">plugins {
    id 'java-library'
}

repositories {
    mavenCentral()
    maven {
        url 'https://repo.spring.io/snapshot/'
    }
}

dependencies {
    implementation 'org.springframework:spring-web:5.0.3.BUILD-SNAPSHOT'
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">plugins {
    `java-library`
}

repositories {
    mavenCentral()
    maven {
        url = uri("https://repo.spring.io/snapshot/")
    }
}

dependencies {
    implementation("org.springframework:spring-web:5.0.3.BUILD-SNAPSHOT")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>By default, Gradle caches changing versions of dependencies for 24 hours.
Within this time frame, Gradle does not try to resolve newer versions from the declared repositories. The <a href="#sec:controlling-dynamic-version-caching">threshold can be configured</a> as needed for example if you want to resolve new snapshot versions earlier.</p>
</div>
<div class="paragraph">
<p>Gradle is flexible enough to treat any version as changing version e.g. if you wanted to model snapshot behavior for an Ivy module.
All you need to do is to set the property <a href="../javadoc/org/gradle/api/artifacts/ExternalModuleDependency.html#setChanging-boolean-">ExternalModuleDependency.setChanging(boolean)</a> to <code>true</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="sec:controlling-dynamic-version-caching"><a class="anchor" href="#sec:controlling-dynamic-version-caching"></a><a class="link" href="#sec:controlling-dynamic-version-caching">Controlling dynamic version caching</a></h3>
<div class="paragraph">
<p>By default, Gradle caches dynamic versions and changing modules for 24 hours. During that time frame Gradle does not contact any of the declared, remote repositories for new versions. If you want Gradle to check the remote repository more frequently or with every execution of your build, then you will need to change the time to live (TTL) threshold.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Using a short TTL threshold for dynamic or changing versions may result in longer build times due to the increased number of HTTP(s) calls.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can override the default cache modes using <a href="#sec:controlling_dependency_caching_command_line">command line options</a>. You can also <a href="#sec:controlling_dependency_caching_programmatically">change the cache expiry times in your build programmatically</a> using the resolution strategy.</p>
</div>
</div>
<div class="sect2">
<h3 id="sec:controlling_dependency_caching_programmatically"><a class="anchor" href="#sec:controlling_dependency_caching_programmatically"></a><a class="link" href="#sec:controlling_dependency_caching_programmatically">Controlling dependency caching programmatically</a></h3>
<div class="paragraph">
<p>You can fine-tune certain aspects of caching programmatically using the <a href="../javadoc/org/gradle/api/artifacts/ResolutionStrategy.html">ResolutionStrategy</a> for a configuration. The programmatic approach is useful if you would like to change the settings permanently.</p>
</div>
<div class="paragraph">
<p>By default, Gradle caches dynamic versions for 24 hours. To change how long Gradle will cache the resolved version for a dynamic version, use:</p>
</div>
<div class="exampleblock">
<div class="title">Example 56. Dynamic version cache control</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">configurations.all {
    resolutionStrategy.cacheDynamicVersionsFor 10, 'minutes'
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">configurations.all {
    resolutionStrategy.cacheDynamicVersionsFor(10, "minutes")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>By default, Gradle caches changing modules for 24 hours. To change how long Gradle will cache the meta-data and artifacts for a changing module, use:</p>
</div>
<div class="exampleblock">
<div class="title">Example 57. Changing module cache control</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">configurations.all {
    resolutionStrategy.cacheChangingModulesFor 4, 'hours'
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">configurations.all {
    resolutionStrategy.cacheChangingModulesFor(4, "hours")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec:controlling_dependency_caching_command_line"><a class="anchor" href="#sec:controlling_dependency_caching_command_line"></a><a class="link" href="#sec:controlling_dependency_caching_command_line">Controlling dependency caching from the command line</a></h3>
<div class="sect3">
<h4 id="sec:offline-mode"><a class="anchor" href="#sec:offline-mode"></a><a class="link" href="#sec:offline-mode">Avoiding network access with offline mode</a></h4>
<div class="paragraph">
<p>The <code>--offline</code> command line switch tells Gradle to always use dependency modules from the cache, regardless if they are due to be checked again. When running with offline, Gradle will never attempt to access the network to perform dependency resolution. If required modules are not present in the dependency cache, build execution will fail.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:refreshing-dependencies"><a class="anchor" href="#sec:refreshing-dependencies"></a><a class="link" href="#sec:refreshing-dependencies">Refreshing dependencies</a></h4>
<div class="paragraph">
<p>You can control the behavior of dependency caching for a distinct build invocation from the command line.
Command line options are helpful for making a selective, ad-hoc choice for a single execution of the build.</p>
</div>
<div class="paragraph">
<p>At times, the Gradle Dependency Cache can become out of sync with the actual state of the configured repositories.
Perhaps a repository was initially misconfigured, or perhaps a "non-changing" module was published incorrectly.
To refresh all dependencies in the dependency cache, use the <code>--refresh-dependencies</code> option on the command line.</p>
</div>
<div class="paragraph">
<p>The <code>--refresh-dependencies</code> option tells Gradle to ignore all cached entries for resolved modules and artifacts.
A fresh resolve will be performed against all configured repositories, with dynamic versions recalculated, modules refreshed, and artifacts downloaded.
However, where possible Gradle will check if the previously downloaded artifacts are valid before downloading again.
This is done by comparing published SHA1 values in the repository with the SHA1 values for existing downloaded artifacts.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>new versions of dynamic dependencies</p>
</li>
<li>
<p>new versions of changing modules (modules which use the same version string but can have different contents)</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Refreshing dependencies will cause Gradle to invalidate its listing caches.
However:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>it will perform HTTP HEAD requests on metadata files but <em>will not re-download them</em> if they are identical</p>
</li>
<li>
<p>it will perform HTTP HEAD requests on artifact files but <em>will not re-download them</em> if they are identical</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In other words, refreshing dependencies <em>only</em> has an impact if you actually use dynamic dependencies <em>or</em> that you have changing dependencies that you were not aware of (in which case it is your responsibility to declare them correctly to Gradle as changing dependencies).</p>
</div>
<div class="paragraph">
<p>It&#8217;s a common misconception to think that using <code>--refresh-dependencies</code> will force download of dependencies.
This is <strong>not</strong> the case: Gradle will only perform what is strictly required to refresh the dynamic dependencies.
This <em>may</em> involve downloading new listing or metadata files, or even artifacts, but if nothing changed, the impact is minimal.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec:component_selection_rules"><a class="anchor" href="#sec:component_selection_rules"></a><a class="link" href="#sec:component_selection_rules">Using component selection rules</a></h3>
<div class="paragraph">
<p>Component selection rules may influence which component instance should be selected when multiple versions are available that match a version selector.
Rules are applied against every available version and allow the version to be explicitly rejected by rule.
This allows Gradle to ignore any component instance that does not satisfy conditions set by the rule.
Examples include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For a dynamic version like <code>1.+</code> certain versions may be explicitly rejected from selection.</p>
</li>
<li>
<p>For a static version like <code>1.4</code> an instance may be rejected based on extra component metadata such as the Ivy branch attribute, allowing an instance from a subsequent repository to be used.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Rules are configured via the <a href="../dsl/org.gradle.api.artifacts.ComponentSelectionRules.html">ComponentSelectionRules</a> object.
Each rule configured will be called with a <a href="../dsl/org.gradle.api.artifacts.ComponentSelection.html">ComponentSelection</a> object as an argument which contains information about the candidate version being considered.
Calling <a href="../dsl/org.gradle.api.artifacts.ComponentSelection.html#org.gradle.api.artifacts.ComponentSelection:reject(java.lang.String)">ComponentSelection.reject(java.lang.String)</a> causes the given candidate version to be explicitly rejected, in which case the candidate will not be considered for the selector.</p>
</div>
<div class="paragraph">
<p>The following example shows a rule that disallows a particular version of a module but allows the dynamic version to choose the next best candidate.</p>
</div>
<div class="exampleblock">
<div class="title">Example 58. Component selection rule</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">configurations {
    rejectConfig {
        resolutionStrategy {
            componentSelection {
                // Accept the highest version matching the requested version that isn't '1.5'
                all { ComponentSelection selection -&gt;
                    if (selection.candidate.group == 'org.sample' &amp;&amp; selection.candidate.module == 'api' &amp;&amp; selection.candidate.version == '1.5') {
                        selection.reject("version 1.5 is broken for 'org.sample:api'")
                    }
                }
            }
        }
    }
}

dependencies {
    rejectConfig "org.sample:api:1.+"
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">configurations {
    create("rejectConfig") {
        resolutionStrategy {
            componentSelection {
                // Accept the highest version matching the requested version that isn't '1.5'
                all {
                    if (candidate.group == "org.sample" &amp;&amp; candidate.module == "api" &amp;&amp; candidate.version == "1.5") {
                        reject("version 1.5 is broken for 'org.sample:api'")
                    }
                }
            }
        }
    }
}

dependencies {
    "rejectConfig"("org.sample:api:1.+")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Note that version selection is applied starting with the highest version first.
The version selected will be the first version found that all component selection rules accept.
A version is considered accepted if no rule explicitly rejects it.</p>
</div>
<div class="paragraph">
<p>Similarly, rules can be targeted at specific modules.
Modules must be specified in the form of <code>group:module</code>.</p>
</div>
<div class="exampleblock">
<div class="title">Example 59. Component selection rule with module target</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">configurations {
    targetConfig {
        resolutionStrategy {
            componentSelection {
                withModule("org.sample:api") { ComponentSelection selection -&gt;
                    if (selection.candidate.version == "1.5") {
                        selection.reject("version 1.5 is broken for 'org.sample:api'")
                    }
                }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">configurations {
    create("targetConfig") {
        resolutionStrategy {
            componentSelection {
                withModule("org.sample:api") {
                    if (candidate.version == "1.5") {
                        reject("version 1.5 is broken for 'org.sample:api'")
                    }
                }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Component selection rules can also consider component metadata when selecting a version.
Possible additional metadata that can be considered are <a href="../javadoc/org/gradle/api/artifacts/ComponentMetadata.html">ComponentMetadata</a> and <a href="../javadoc/org/gradle/api/artifacts/ivy/IvyModuleDescriptor.html">IvyModuleDescriptor</a>.
Note that this extra information may not always be available and thus should be checked for <code>null</code> values.</p>
</div>
<div class="exampleblock">
<div class="title">Example 60. Component selection rule with metadata</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">configurations {
    metadataRulesConfig {
        resolutionStrategy {
            componentSelection {
                // Reject any versions with a status of 'experimental'
                all { ComponentSelection selection -&gt;
                    if (selection.candidate.group == 'org.sample' &amp;&amp; selection.metadata?.status == 'experimental') {
                        selection.reject("don't use experimental candidates from 'org.sample'")
                    }
                }
                // Accept the highest version with either a "release" branch or a status of 'milestone'
                withModule('org.sample:api') { ComponentSelection selection -&gt;
                    if (selection.getDescriptor(IvyModuleDescriptor)?.branch != "release" &amp;&amp; selection.metadata?.status != 'milestone') {
                        selection.reject("'org.sample:api' must have testing branch or milestone status")
                    }
                }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">configurations {
    create("metadataRulesConfig") {
        resolutionStrategy {
            componentSelection {
                // Reject any versions with a status of 'experimental'
                all {
                    if (candidate.group == "org.sample" &amp;&amp; metadata?.status == "experimental") {
                        reject("don't use experimental candidates from 'org.sample'")
                    }
                }
                // Accept the highest version with either a "release" branch or a status of 'milestone'
                withModule("org.sample:api") {
                    if (getDescriptor(IvyModuleDescriptor::class)?.branch != "release" &amp;&amp; metadata?.status != "milestone") {
                        reject("'org.sample:api' must have testing branch or milestone status")
                    }
                }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Note that a <a href="../dsl/org.gradle.api.artifacts.ComponentSelection.html">ComponentSelection</a> argument is <em>always</em> required as parameter when declaring a component selection rule.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="dependency-locking"><a class="anchor" href="#dependency-locking"></a><a class="link" href="#dependency-locking">Locking dependency versions</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Use of dynamic dependency versions (e.g. <code>1.+</code> or <code>[1.0,2.0)</code>) makes builds non-deterministic.
This causes builds to break without any obvious change, and worse, can be caused by a transitive dependency that the build author has no control over.</p>
</div>
<div class="paragraph">
<p>To achieve <a href="https://reproducible-builds.org/">reproducible builds</a>, it is necessary to <em>lock</em> versions of dependencies and transitive dependencies such that a build with the same inputs will always resolve the same module versions.
This is called <em>dependency locking</em>.</p>
</div>
<div class="paragraph">
<p>It enables, amongst others, the following scenarios:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Companies dealing with multi repositories no longer need to rely on <code>-SNAPSHOT</code> or changing dependencies,
which sometimes result in cascading failures when a dependency introduces a bug or incompatibility.
Now dependencies can be declared against major or minor version range, enabling to test with the latest versions on CI while leveraging locking for stable developer builds.</p>
</li>
<li>
<p>Teams that want to always use the latest of their dependencies can use dynamic versions, locking their dependencies only for releases.
The release tag will contain the lock states, allowing that build to be fully reproducible when bug fixes need to be developed.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Combined with <a href="publishing_maven.html#publishing_maven:resolved_dependencies">publishing resolved versions</a>, you can also replace the declared dynamic version part at publication time.
Consumers will instead see the versions that your release resolved.</p>
</div>
<div class="paragraph">
<p>Locking is enabled per <a href="#sec:what-are-dependency-configurations">dependency configuration</a>.
Once enabled, you must create an initial lock state.
It will cause Gradle to verify that resolution results do not change, resulting in the same selected dependencies even if newer versions are produced.
Modifications to your build that would impact the resolved set of dependencies will cause it to fail.
This makes sure that changes, either in published dependencies or build definitions, do not alter resolution without adapting the lock state.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Dependency locking makes sense only with <a href="#sub:declaring_dependency_with_dynamic_version">dynamic versions</a>.
It will have no impact on <a href="#sub:declaring_dependency_with_changing_version">changing versions</a> (like <code>-SNAPSHOT</code>) whose coordinates remain the same, though the content may change.
Gradle will even emit a warning when persisting lock state and changing dependencies are present in the resolution result.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="enabling_locking_on_configurations"><a class="anchor" href="#enabling_locking_on_configurations"></a><a class="link" href="#enabling_locking_on_configurations">Enabling locking on configurations</a></h3>
<div class="paragraph">
<p>Locking of a configuration happens through the <a href="../dsl/org.gradle.api.artifacts.ResolutionStrategy.html">ResolutionStrategy</a>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 61. Locking a specific configuration</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">configurations {
    compileClasspath {
        resolutionStrategy.activateDependencyLocking()
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">configurations.compileClasspath {
    resolutionStrategy.activateDependencyLocking()
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Or the following, as a way to lock all configurations:</p>
</div>
<div class="exampleblock">
<div class="title">Example 62. Locking all configurations</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">dependencyLocking {
    lockAllConfigurations()
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">dependencyLocking {
    lockAllConfigurations()
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Only configurations that can be resolved will have lock state attached to them.
Applying locking on non resolvable-configurations is simply a no-op.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The above will lock all <em>project</em> configurations, but not the <em>buildscript</em> ones.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can also disable locking on a specific configuration.
This can be useful if a plugin configured locking on all configurations but you happen to add one that should not be locked.</p>
</div>
<div class="exampleblock">
<div class="title">Example 63. Unlocking a specific configuration</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">configurations {
    compileClasspath {
        resolutionStrategy.deactivateDependencyLocking()
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">configurations.compileClasspath {
    resolutionStrategy.deactivateDependencyLocking()
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="locking_buildscript_classpath_configuration"><a class="anchor" href="#locking_buildscript_classpath_configuration"></a><a class="link" href="#locking_buildscript_classpath_configuration">Locking buildscript classpath configuration</a></h4>
<div class="paragraph">
<p>If you apply plugins to your build, you may want to leverage dependency locking there as well.
In order to lock the <a href="plugins.html#sec:applying_plugins_buildscript"><code>classpath</code> configuration</a> used for script plugins, do the following:</p>
</div>
<div class="exampleblock">
<div class="title">Example 64. Locking buildscript classpath configuration</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">buildscript {
    configurations.classpath {
        resolutionStrategy.activateDependencyLocking()
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">buildscript {
    configurations.classpath {
        resolutionStrategy.activateDependencyLocking()
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="generating_and_updating_dependency_locks"><a class="anchor" href="#generating_and_updating_dependency_locks"></a><a class="link" href="#generating_and_updating_dependency_locks">Generating and updating dependency locks</a></h3>
<div class="paragraph">
<p>In order to generate or update lock state, you specify the <code>--write-locks</code> command line argument in addition to the normal tasks that would trigger configurations to be resolved.
This will cause the creation of lock state for each resolved configuration in that build execution.
Note that if lock state existed previously, it is overwritten.</p>
</div>
<div class="sect3">
<h4 id="lock_all_configurations_in_one_build_execution"><a class="anchor" href="#lock_all_configurations_in_one_build_execution"></a><a class="link" href="#lock_all_configurations_in_one_build_execution">Lock all configurations in one build execution</a></h4>
<div class="paragraph">
<p>When locking multiple configurations, you may want to lock them all at once, during a single build execution.</p>
</div>
<div class="paragraph">
<p>For this, you have two options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Run <code>gradle dependencies --write-locks</code>.
This will effectively lock all resolvable configurations that have locking enabled.
Note that in a multi project setup, <code>dependencies</code> only is executed on <em>one</em> project, the root one in this case.</p>
</li>
<li>
<p>Declare a custom task that will resolve all configurations</p>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 65. Resolving all configurations</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">task resolveAndLockAll {
    doFirst {
        assert gradle.startParameter.writeDependencyLocks
    }
    doLast {
        configurations.findAll {
            // Add any custom filtering on the configurations to be resolved
            it.canBeResolved
        }.each { it.resolve() }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">tasks.register("resolveAndLockAll") {
    doFirst {
        require(gradle.startParameter.isWriteDependencyLocks)
    }
    doLast {
        configurations.filter {
            // Add any custom filtering on the configurations to be resolved
            it.isCanBeResolved
        }.forEach { it.resolve() }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>That second option, with proper choosing of configurations, can be the only option in the native world, where not all configurations can be resolved on a single platform.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="lock_state_location_and_format"><a class="anchor" href="#lock_state_location_and_format"></a><a class="link" href="#lock_state_location_and_format">Lock state location and format</a></h3>
<div class="paragraph">
<p>Lock state will be preserved in a file located in the folder <code>gradle/dependency-locks</code> inside the project or subproject directory.
Each file is named by the configuration it locks and has the <code>lockfile</code> extension.
The one exception to this rule is for configurations for the <a href="plugins.html#sec:applying_plugins_buildscript">buildscript itself</a>.
In that case the configuration name will be prefixed with <code>buildscript-</code>.</p>
</div>
<div class="paragraph">
<p>The content of the file is a module notation per line, with a header giving some context.
Module notations are ordered alphabetically, to ease diffs.</p>
</div>
<div class="listingblock">
<div class="title">gradle/dependency-locks/compileClasspath.lockfile</div>
<div class="content">
<pre># This is a Gradle generated file for dependency locking.
# Manual edits can break the build and are not advised.
# This file is expected to be part of source control.
org.springframework:spring-beans:5.0.5.RELEASE
org.springframework:spring-core:5.0.5.RELEASE
org.springframework:spring-jcl:5.0.5.RELEASE</pre>
</div>
</div>
<div class="paragraph">
<p>which matches the following dependency declaration:</p>
</div>
<div class="exampleblock">
<div class="title">Example 66. Dynamic dependency declaration</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">dependencies {
    implementation 'org.springframework:spring-beans:[5.0,6.0)'
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">dependencies {
    implementation("org.springframework:spring-beans:[5.0,6.0)")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="running_a_build_with_lock_state_present"><a class="anchor" href="#running_a_build_with_lock_state_present"></a><a class="link" href="#running_a_build_with_lock_state_present">Running a build with lock state present</a></h3>
<div class="paragraph">
<p>The moment a build needs to resolve a configuration that has locking enabled and it finds a matching lock state,
it will use it to verify that the given configuration still resolves the same versions.</p>
</div>
<div class="paragraph">
<p>A successful build indicates that the same dependencies are used as stored in the lock state, regardless if new versions matching the dynamic selector have been produced.</p>
</div>
<div class="paragraph">
<p>The complete validation is as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Existing entries in the lock state must be matched in the build</p>
<div class="ulist">
<ul>
<li>
<p>A version mismatch or missing resolved module causes a build failure</p>
</li>
</ul>
</div>
</li>
<li>
<p>Resolution result must not contain extra dependencies compared to the lock state</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="fine_tuning_dependency_locking_behaviour_with_lock_mode"><a class="anchor" href="#fine_tuning_dependency_locking_behaviour_with_lock_mode"></a><a class="link" href="#fine_tuning_dependency_locking_behaviour_with_lock_mode">Fine tuning dependency locking behaviour with lock mode</a></h4>
<div class="paragraph">
<p>While the default lock mode behaves as described above, two other modes are available:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Strict mode</dt>
<dd>
<p>In this mode, in addition to the validations above, dependency locking will fail if a configuration marked as <em>locked</em> does not have lock state associated with it.</p>
</dd>
<dt class="hdlist1">Lenient mode</dt>
<dd>
<p>In this mode, dependency locking will still pin dynamic versions but otherwise changes to the dependency resolution are no longer errors.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The lock mode can be controlled from the <code>dependencyLocking</code> block as shown below:</p>
</div>
<div class="exampleblock">
<div class="title">Example 67. Setting the lock mode</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">dependencyLocking {
    lockMode = LockMode.STRICT
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">dependencyLocking {
    lockMode.set(LockMode.STRICT)
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="selectively_updating_lock_state_entries"><a class="anchor" href="#selectively_updating_lock_state_entries"></a><a class="link" href="#selectively_updating_lock_state_entries">Selectively updating lock state entries</a></h3>
<div class="paragraph">
<p>In order to update only specific modules of a configuration, you can use the <code>--update-locks</code> command line flag.
It takes a comma (<code>,</code>) separated list of module notations.
In this mode, the existing lock state is still used as input to resolution, filtering out the modules targeted by the update.</p>
</div>
<div class="listingblock">
<div class="content">
<pre> gradle classes --update-locks org.apache.commons:commons-lang3,org.slf4j:slf4j-api</pre>
</div>
</div>
<div class="paragraph">
<p>Wildcards, indicated with <code>*</code>, can be used in the group or module name. They can be the only character or appear at the end of the group or module respectively.
The following wildcard notation examples are valid:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>org.apache.commons:*</code>: will let all modules belonging to group <code>org.apache.commons</code> update</p>
</li>
<li>
<p><code>*:guava</code>: will let all modules named <code>guava</code>, whatever their group, update</p>
</li>
<li>
<p><code>org.springframework.spring*:spring*</code>: will let all modules having their group starting with <code>org.springframework.spring</code> and name starting with <code>spring</code> update</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The resolution may cause other module versions to update, as dictated by the Gradle resolution rules.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="disabling_dependency_locking"><a class="anchor" href="#disabling_dependency_locking"></a><a class="link" href="#disabling_dependency_locking">Disabling dependency locking</a></h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Make sure that the configuration for which you no longer want locking is not configured with locking.</p>
</li>
<li>
<p>Remove the file matching the configurations where you no longer want locking.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If you only perform the second step above, then locking will effectively no longer be applied.
However, if that configuration happens to be resolved in the future at a time where lock state is persisted, it will once again be locked.</p>
</div>
</div>
<div class="sect2">
<h3 id="single_lock_file_per_project"><a class="anchor" href="#single_lock_file_per_project"></a><a class="link" href="#single_lock_file_per_project">Single lock file per project</a></h3>
<div class="paragraph">
<p>Gradle supports an improved lock file format.
The goal is to have only a single lock file per project, which contains the lock state for all configurations of said project.
By default, the file is named <code>gradle.lockfile</code> and is located inside the project directory.
The lock state for the buildscript itself is found in a file named <code>buildscript-gradle.lockfile</code> inside the project directory.</p>
</div>
<div class="paragraph">
<p>The main benefit is a substantial reduction in the number of lock files compared to the format requiring one lockfile per locked configuration.</p>
</div>
<div class="paragraph">
<p>This format requires a migration for existing locking users and is thus opt-in.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The objective is to default to this single lock file per project in Gradle 7.0.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The format can be activated by enabling the matching <a href="feature_lifecycle.html#feature_preview">feature preview</a>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 68. Single lock file per project activation</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">rootProject.name = 'locking-single-file'

enableFeaturePreview('ONE_LOCKFILE_PER_PROJECT')</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">rootProject.name = "locking-single-file"

enableFeaturePreview("ONE_LOCKFILE_PER_PROJECT")</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Then with the following dependency declaration and locked configurations:</p>
</div>
<div class="exampleblock">
<div class="title">Example 69. Explicit locking</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">configurations {
    compileClasspath {
        resolutionStrategy.activateDependencyLocking()
    }
    runtimeClasspath {
        resolutionStrategy.activateDependencyLocking()
    }
    annotationProcessor {
        resolutionStrategy.activateDependencyLocking()
    }
}

dependencies {
    implementation 'org.springframework:spring-beans:[5.0,6.0)'
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">configurations {
    compileClasspath {
        resolutionStrategy.activateDependencyLocking()
    }
    runtimeClasspath {
        resolutionStrategy.activateDependencyLocking()
    }
    annotationProcessor {
        resolutionStrategy.activateDependencyLocking()
    }
}

dependencies {
    implementation("org.springframework:spring-beans:[5.0,6.0)")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The lockfile will have the following content:</p>
</div>
<div class="listingblock">
<div class="title">gradle.lockfile</div>
<div class="content">
<pre># This is a Gradle generated file for dependency locking.
# Manual edits can break the build and are not advised.
# This file is expected to be part of source control.
org.springframework:spring-beans:5.0.5.RELEASE=compileClasspath, runtimeClasspath
org.springframework:spring-core:5.0.5.RELEASE=compileClasspath, runtimeClasspath
org.springframework:spring-jcl:5.0.5.RELEASE=compileClasspath, runtimeClasspath
empty=annotationProcessor</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Each line still represents a single dependency in the <code>group:artifact:version</code> notation</p>
</li>
<li>
<p>It then lists all configurations that contain the given dependency</p>
</li>
<li>
<p>The last line of the file lists all empty configurations, that is configurations known to have no dependencies</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="migrating_to_the_single_lockfile_per_project_format"><a class="anchor" href="#migrating_to_the_single_lockfile_per_project_format"></a><a class="link" href="#migrating_to_the_single_lockfile_per_project_format">Migrating to the single lockfile per project format</a></h4>
<div class="paragraph">
<p>Once you have activated the feature preview (see above), you can simply follow the documentation for <a href="#lock_all_configurations_in_one_build_execution">writing</a> or <a href="#selectively_updating_lock_state_entries">updating</a> dependency lock state.</p>
</div>
<div class="paragraph">
<p>Then after confirming the single lock file per project contains the lock state for a given configuration, the matching per configuration lock file can be removed from <code>gradle/dependency-locks</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="configuring_the_per_project_lock_file_name_and_location"><a class="anchor" href="#configuring_the_per_project_lock_file_name_and_location"></a><a class="link" href="#configuring_the_per_project_lock_file_name_and_location">Configuring the per project lock file name and location</a></h4>
<div class="paragraph">
<p>When using the single lock file per project, you can configure its name and location.
The main reason for providing this is to enable having a file name that is determined by some project properties, effectively allowing a single project to store different lock state for different execution contexts.
One trivial example in the JVM ecosystem is the Scala version that is often found in artifact coordinates.</p>
</div>
<div class="exampleblock">
<div class="title">Example 70. Changing the lock file name</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def scalaVersion = "2.12"
dependencyLocking {
    lockFile = file("$projectDir/locking/gradle-${scalaVersion}.lockfile")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">val scalaVersion = "2.12"
dependencyLocking {
    lockFile.set(file("$projectDir/locking/gradle-${scalaVersion}.lockfile"))
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="locking_limitations"><a class="anchor" href="#locking_limitations"></a><a class="link" href="#locking_limitations">Locking limitations</a></h3>
<div class="ulist">
<ul>
<li>
<p>Locking cannot yet be applied to source dependencies.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="nebula_locking_plugin"><a class="anchor" href="#nebula_locking_plugin"></a><a class="link" href="#nebula_locking_plugin">Nebula locking plugin</a></h3>
<div class="paragraph">
<p>This feature is inspired by the <a href="https://github.com/nebula-plugins/gradle-dependency-lock-plugin">Nebula Gradle dependency lock plugin</a>.</p>
</div>
</div>
</div>
</div>
<h1 id="controlling_transitive_dependencies" class="sect0"><a class="anchor" href="#controlling_transitive_dependencies"></a><a class="link" href="#controlling_transitive_dependencies">Controlling Transitive Dependencies</a></h1>
<div class="sect1">
<h2 id="dependency-constraints"><a class="anchor" href="#dependency-constraints"></a><a class="link" href="#dependency-constraints">Upgrading versions of transitive dependencies</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="sec:direct-vs-transitive-deps"><a class="anchor" href="#sec:direct-vs-transitive-deps"></a><a class="link" href="#sec:direct-vs-transitive-deps">Direct dependencies vs dependency constraints</a></h3>
<div class="paragraph">
<p>A component may have two different kinds of dependencies:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>direct dependencies are <em>directly required by the component</em>.
A direct dependency is also referred to as a <em>first level dependency</em>.
For example, if your project source code requires Guava, Guava should be declared as <em>direct dependency</em>.</p>
</li>
<li>
<p>transitive dependencies are dependencies that your component needs, but only because another dependency needs them.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It&#8217;s quite common that issues with dependency management are about <em>transitive dependencies</em>.
Often developers incorrectly fix transitive dependency issues by adding <em>direct dependencies</em>.
To avoid this, Gradle provides the concept of <em>dependency constraints</em>.</p>
</div>
</div>
<div class="sect2">
<h3 id="sec:adding-constraints-transitive-deps"><a class="anchor" href="#sec:adding-constraints-transitive-deps"></a><a class="link" href="#sec:adding-constraints-transitive-deps">Adding constraints on transitive dependencies</a></h3>
<div class="paragraph">
<p>Dependency constraints allow you to define the version or the version range of both dependencies declared in the build script and transitive dependencies.
It is the preferred method to express constraints that should be applied to all dependencies of a configuration.
When Gradle attempts to resolve a dependency to a module version, all <a href="#">dependency declarations with version</a>, all transitive dependencies and all dependency constraints for that module are taken into consideration.
The highest version that matches all conditions is selected.
If no such version is found, Gradle fails with an error showing the conflicting declarations.
If this happens you can adjust your dependencies or dependency constraints declarations, or make other adjustments to the transitive dependencies if needed.
Similar to dependency declarations, dependency constraint declarations are <a href="#sec:what-are-dependency-configurations">scoped by configurations</a> and can therefore be selectively defined for parts of a build.
If a dependency constraint influenced the resolution result, any type of <a href="#sec:dependency_resolve_rules">dependency resolve rules</a> may still be applied afterwards.</p>
</div>
<div class="exampleblock">
<div class="title">Example 71. Define dependency constraints</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">dependencies {
    implementation 'org.apache.httpcomponents:httpclient'
    constraints {
        implementation('org.apache.httpcomponents:httpclient:4.5.3') {
            because 'previous versions have a bug impacting this application'
        }
        implementation('commons-codec:commons-codec:1.11') {
            because 'version 1.9 pulled from httpclient has bugs affecting this application'
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">dependencies {
    implementation("org.apache.httpcomponents:httpclient")
    constraints {
        implementation("org.apache.httpcomponents:httpclient:4.5.3") {
            because("previous versions have a bug impacting this application")
        }
        implementation("commons-codec:commons-codec:1.11") {
            because("version 1.9 pulled from httpclient has bugs affecting this application")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In the example, all versions are omitted from the dependency declaration.
Instead, the versions are defined in the constraints block.
The version definition for <code>commons-codec:1.11</code> is only taken into account if <code>commons-codec</code> is brought in as transitive dependency, since <code>commons-codec</code> is not defined as dependency in the project.
Otherwise, the constraint has no effect.
Dependency constraints can also define a <a href="#">rich version constraint</a> and support <a href="#sec:strict-version">strict versions</a> to enforce a version even if it contradicts with the version defined by a transitive dependency (e.g. if the version needs to be downgraded).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Dependency constraints are only published when using <a href="#sec:understanding-gradle-module-md">Gradle Module Metadata</a>.
This means that currently they are only fully supported if Gradle is used for publishing and consuming (i.e. they are 'lost' when consuming modules with Maven or Ivy).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Dependency constraints themselves can also be added transitively.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="downgrading_versions_and_excluding_dependencies"><a class="anchor" href="#downgrading_versions_and_excluding_dependencies"></a><a class="link" href="#downgrading_versions_and_excluding_dependencies">Downgrading versions and excluding dependencies</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="sec:enforcing_dependency_version"><a class="anchor" href="#sec:enforcing_dependency_version"></a><a class="link" href="#sec:enforcing_dependency_version">Overriding transitive dependency versions</a></h3>
<div class="paragraph">
<p>Gradle resolves any dependency version conflicts by selecting the latest version found in the dependency graph.
Some projects might need to divert from the default behavior and enforce an earlier version of a dependency e.g. if the source code of the project depends on an older API of a dependency than some of the external libraries.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Forcing a version of a dependency requires a conscious decision.
Changing the version of a transitive dependency might lead to runtime errors if external libraries do not properly function without them.
Consider upgrading your source code to use a newer version of the library as an alternative approach.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In general, forcing dependencies is done to downgrade a dependency.
There might be different use cases for downgrading:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a bug was discovered in the latest release</p>
</li>
<li>
<p>your code depends on a lower version which is not binary compatible</p>
</li>
<li>
<p>your code doesn&#8217;t depend on the code paths which need a higher version of a dependency</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In all situations, this is best expressed saying that your code <em>strictly depends on</em> a version of a transitive.
Using <a href="#sec:strict-version">strict versions</a>, you will effectively depend on the version you declare, even if a transitive dependency says otherwise.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Strict dependencies are to some extent similar to Maven&#8217;s <em>nearest first</em> strategy, but there are subtle differences:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>strict dependencies</em> don&#8217;t suffer an ordering problem: they are applied transitively to the subgraph, and it doesn&#8217;t matter in which order dependencies are declared.</p>
</li>
<li>
<p>conflicting strict dependencies will trigger a build failure that you have to resolve</p>
</li>
<li>
<p>strict dependencies can be used with rich versions, meaning that <a href="#sec:strict-version-consequences">it&#8217;s better to express the requirement in terms of a <em>strict range</em> combined with a single <em>preferred version</em></a>.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Let&#8217;s say a project uses the <a href="https://hc.apache.org/httpcomponents-client-ga/">HttpClient library</a> for performing HTTP calls. HttpClient pulls in <a href="https://commons.apache.org/proper/commons-codec/">Commons Codec</a> as transitive dependency with version 1.10.
However, the production source code of the project requires an API from Commons Codec 1.9 which is not available in 1.10 anymore.
A dependency version can be enforced by declaring it as strict it in the build script:</p>
</div>
<div class="exampleblock">
<div class="title">Example 72. Setting a strict version</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">dependencies {
    implementation 'org.apache.httpcomponents:httpclient:4.5.4'
    implementation('commons-codec:commons-codec') {
        version {
            strictly '1.9'
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">dependencies {
    implementation("org.apache.httpcomponents:httpclient:4.5.4")
    implementation("commons-codec:commons-codec") {
        version {
            strictly("1.9")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:strict-version-consequences"><a class="anchor" href="#sec:strict-version-consequences"></a><a class="link" href="#sec:strict-version-consequences">Consequences of using strict versions</a></h4>
<div class="paragraph">
<p>Using a strict version must be carefully considered, in particular by library authors.
As the <em>producer</em>, a strict version will effectively behave like a <em>force</em>: the version declaration takes precedence over whatever is found in the transitive dependency graph.
In particular, a <em>strict version</em> will override any other <em>strict version</em> on the same module found transitively.</p>
</div>
<div class="paragraph">
<p>However, for consumers, strict versions are still considered globally during graph resolution and <em>may trigger an error</em> if the consumer disagrees.</p>
</div>
<div class="paragraph">
<p>For example, imagine that your project <code>B</code> <em>strictly</em> depends on <code>C:1.0</code>.
Now, a consumer, <code>A</code>, depends on both <code>B</code> and <code>C:1.1</code>.</p>
</div>
<div class="paragraph">
<p>Then this would trigger a resolution error because <code>A</code> says it needs <code>C:1.1</code> but <code>B</code>, <em>within its subgraph</em>, strictly needs <code>1.0</code>.
This means that if you choose a <em>single version</em> in a strict constraint, then the version can <em>no longer be upgraded</em>, unless the consumer also sets a strict version constraint on the same module.</p>
</div>
<div class="paragraph">
<p>In the example above, <code>A</code> would have to say it <em>strictly depends on 1.1</em>.</p>
</div>
<div class="paragraph">
<p>For this reason, a good practice is that if you use <em>strict versions</em>, you should express them in terms of ranges and a preferred version within this range.
For example, <code>B</code> might say, instead of <code>strictly 1.0</code>, that it <em>strictly depends</em> on the <code>[1.0, 2.0[</code> range, but <em>prefers</em> <code>1.0</code>.
Then if a consumer chooses 1.1 (or any other version in the range), the build will <em>no longer fail</em> (constraints are resolved).</p>
</div>
</div>
<div class="sect3">
<h4 id="forced_dependencies_vs_strict_dependencies"><a class="anchor" href="#forced_dependencies_vs_strict_dependencies"></a><a class="link" href="#forced_dependencies_vs_strict_dependencies">Forced dependencies vs strict dependencies</a></h4>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Forcing dependencies via <a href="../javadoc/org/gradle/api/artifacts/ExternalDependency.html#setForce-boolean-">ExternalDependency.setForce(boolean)</a> is deprecated and no longer recommended:
forced dependencies suffer an ordering issue which can be hard to diagnose and will not work well together with other rich version constraints.
You should prefer <a href="#sec:enforcing_dependency_version">strict versions</a> instead.
If you are authoring and publishing a <a href="#">library</a>, you also need to be aware that <code>force</code> is <strong>not</strong> published.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If, for some reason, you can&#8217;t use <a href="#sec:enforcing_dependency_version">strict versions</a>, you can force a dependency doing this:</p>
</div>
<div class="exampleblock">
<div class="title">Example 73. Enforcing a dependency version</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">dependencies {
    implementation 'org.apache.httpcomponents:httpclient:4.5.4'
    implementation('commons-codec:commons-codec:1.9') {
        force = true
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">dependencies {
    implementation("org.apache.httpcomponents:httpclient:4.5.4")
    implementation("commons-codec:commons-codec:1.9") {
        isForce = true
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>If the project requires a specific version of a dependency on a configuration-level then it can be achieved by calling the method <a href="../dsl/org.gradle.api.artifacts.ResolutionStrategy.html#org.gradle.api.artifacts.ResolutionStrategy:force(java.lang.Object[])">ResolutionStrategy.force(java.lang.Object[])</a>.</p>
</div>
<div class="exampleblock">
<div class="title">Example 74. Enforcing a dependency version on the configuration-level</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">configurations {
    compileClasspath {
        resolutionStrategy.force 'commons-codec:commons-codec:1.9'
    }
}

dependencies {
    implementation 'org.apache.httpcomponents:httpclient:4.5.4'
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">configurations {
    "compileClasspath" {
        resolutionStrategy.force("commons-codec:commons-codec:1.9")
    }
}

dependencies {
    implementation("org.apache.httpcomponents:httpclient:4.5.4")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec:excluding-transitive-deps"><a class="anchor" href="#sec:excluding-transitive-deps"></a><a class="link" href="#sec:excluding-transitive-deps">Excluding transitive dependencies</a></h3>
<div class="paragraph">
<p>While the previous section showed how you can enforce a certain version of a transitive dependency, this section covers <em>excludes</em> as a way to remove a transitive dependency completely.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Similar as forcing a version of a dependency, excluding a dependency completely requires a conscious decision.
Excluding a transitive dependency might lead to runtime errors if external libraries do not properly function without them.
If you use excludes, make sure that you do not utilise any code path requiring the excluded dependency by sufficient test coverage.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Transitive dependencies can be excluded on the level of a declared dependency.
Exclusions are spelled out as a key/value pair via the attributes <code>group</code> and/or <code>module</code> as shown in the example below.
For more information, refer to <a href="../javadoc/org/gradle/api/artifacts/ModuleDependency.html#exclude-java.util.Map-">ModuleDependency.exclude(java.util.Map)</a>.</p>
</div>
<div class="exampleblock">
<div class="title">Example 75. Excluding a transitive dependency for a particular dependency declaration</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">dependencies {
    implementation('commons-beanutils:commons-beanutils:1.9.4') {
        exclude group: 'commons-collections', module: 'commons-collections'
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">dependencies {
    implementation("commons-beanutils:commons-beanutils:1.9.4") {
        exclude(group = "commons-collections", module = "commons-collections")
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In this example, we add a dependency to <code>commons-beanutils</code> but exclude the transitive dependency <code>commons-collections</code>.
In our code, shown below, we only use one method from the beanutils library, <code>PropertyUtils.setSimpleProperty()</code>.
Using this method for existing setters does not require any functionality from <code>commons-collections</code> as we verified through test coverage.</p>
</div>
<div class="exampleblock">
<div class="title">Example 76. Using a utility from the beanutils library</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">src/main/java/Main.java</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">import org.apache.commons.beanutils.PropertyUtils;

public class Main {
    public static void main(String[] args) throws Exception {
        Object person = new Person();
        PropertyUtils.setSimpleProperty(person, "name", "Bart Simpson");
        PropertyUtils.setSimpleProperty(person, "age", 38);
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Effectively, we are expressing that we only use a <em>subset</em> of the library, which does not require the <code>commons-collection</code> library.
This can be seen as implicitly defining a <a href="#">feature variant</a> that has not been explicitly declared by <code>commons-beanutils</code> itself.
However, the risk of breaking an untested code path increased by doing this.</p>
</div>
<div class="paragraph">
<p>For example, here we use the <code>setSimpleProperty()</code> method to modify properties defined by setters in the <code>Person</code> class, which works fine.
If we would attempt to set a property not existing on the class, we <em>should</em> get an error like <code>Unknown property on class Person</code>.
However, because the error handling path uses a class from <code>commons-collections</code>, the error we now get is <code>NoClassDefFoundError: org/apache/commons/collections/FastHashMap</code>.
So if our code would be more dynamic, and we would forget to cover the error case sufficiently, consumers of our library might be confronted with unexpected errors.</p>
</div>
<div class="paragraph">
<p>This is only an example to illustrate potential pitfalls.
In practice, larger libraries or frameworks can bring in a huge set of dependencies.
If those libraries fail to declare features separately and can only be consumed in a "all or nothing" fashion, excludes can be a valid method to reduce the library to the feature set actually required.</p>
</div>
<div class="paragraph">
<p>On the upside, Gradle&#8217;s exclude handling is, in contrast to Maven, taking the whole dependency graph into account.
So if there are multiple dependencies on a library, excludes are only exercised if all dependencies agree on them.
For example, if we add <code>opencsv</code> as another dependency to our project above, which also depends on <code>commons-beanutils</code>, <code>commons-collection</code> is no longer excluded as <code>opencsv</code> itself does <strong>not</strong> exclude it.</p>
</div>
<div class="exampleblock">
<div class="title">Example 77. Excludes only apply if all dependency declarations agree on an exclude</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">    dependencies {
        implementation('commons-beanutils:commons-beanutils:1.9.4') {
            exclude group: 'commons-collections', module: 'commons-collections'
        }
        implementation 'com.opencsv:opencsv:4.6' // depends on 'commons-beanutils' without exclude and brings back 'commons-collections'
    }</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">dependencies {
    implementation("commons-beanutils:commons-beanutils:1.9.4") {
        exclude(group = "commons-collections", module = "commons-collections")
    }
    implementation("com.opencsv:opencsv:4.6") // depends on 'commons-beanutils' without exclude and brings back 'commons-collections'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>If we still want to have <code>commons-collections</code> excluded, because our combined usage of <code>commons-beanutils</code> and <code>opencsv</code> does not need it, we need to exclude it from the transitive dependencies of <code>opencsv</code> as well.</p>
</div>
<div class="exampleblock">
<div class="title">Example 78. Excluding a transitive dependency for multiple dependency declaration</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">    dependencies {
        implementation('commons-beanutils:commons-beanutils:1.9.4') {
            exclude group: 'commons-collections', module: 'commons-collections'
        }
        implementation('com.opencsv:opencsv:4.6') {
            exclude group: 'commons-collections', module: 'commons-collections'
        }
    }</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">    dependencies {
        implementation("commons-beanutils:commons-beanutils:1.9.4") {
            exclude(group = "commons-collections", module = "commons-collections")
        }
        implementation("com.opencsv:opencsv:4.6") {
            exclude(group = "commons-collections", module = "commons-collections")
        }
    }</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Historically, excludes were also used as a band aid to fix other issues not supported by some dependency management systems.
Gradle however, offers a variety of features that might be better suited to solve a certain use case.
You may consider to look into the following features:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#sec:enforcing_dependency_version">Update</a> or <a href="#sec:enforcing_dependency_version">downgrade</a> dependency versions:
If versions of dependencies clash, it is usually better to adjust the version through a dependency constraint, instead of attempting to exclude the dependency with the undesired version.</p>
</li>
<li>
<p><a href="#">Component Metadata Rules</a>:
If a library&#8217;s metadata is clearly wrong, for example if it includes a compile time dependency which is never needed at compile time, a possible solution is to remove the dependency in a component metadata rule.
By this, you tell Gradle that a dependency between two modules is never needed  i.e. the metadata was wrong  and therefore should <strong>never</strong> be considered.
If you are developing a library, you have to be aware that this information is not published, and so sometimes an <em>exclude</em> can be the better alternative.</p>
</li>
<li>
<p><a href="#">Resolving mutually exclusive dependency conflicts</a>:
Another situation that you often see solved by excludes is that two dependencies cannot be used together because they represent two implementations of the same thing (the same <a href="#sub:capabilities">capability</a>).
A popular example are clashing logging API implementations (like <code>log4j</code> and <code>log4j-over-slf4j</code>) or modules that have different coordinates in different versions (like <code>com.google.collections</code> and <code>guava</code>).
In this case, if this information is not known to Gradle, it is recommended to add the missing capability information via component metadata rules as described in the <a href="#sub:declaring-component-capabilities">declaring component capabilities</a> section.
Even if you are developing a library, and your consumers will have to deal with resolving the conflict again, it is often the right solution to leave the decision to the final consumers of libraries.
I.e. you as a library author should not have to decide which logging implementation your consumers use in the end.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec:sharing-dep-versions-between-projects"><a class="anchor" href="#sec:sharing-dep-versions-between-projects"></a><a class="link" href="#sec:sharing-dep-versions-between-projects">Sharing dependency versions between projects</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="sub:using-platform-to-control-transitive-deps"><a class="anchor" href="#sub:using-platform-to-control-transitive-deps"></a><a class="link" href="#sub:using-platform-to-control-transitive-deps">Using a platform to control transitive versions</a></h3>
<div class="paragraph">
<p>A <a href="#sub::terminology_platform">platform</a> is a special software component which can be used to control transitive dependency versions.
In most cases it&#8217;s exclusively composed of <a href="#sec:adding-constraints-transitive-deps">dependency constraints</a> which will either <em>suggest</em> dependency versions or <em>enforce</em> some versions.
As such, this is a perfect tool whenever you need to <em>share dependency versions between projects</em>.
In this case, a project will typically be organized this way:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a <code>platform</code> project which defines constraints for the various dependencies found in the different sub-projects</p>
</li>
<li>
<p>a number of sub-projects which <em>depend on</em> the platform and declare dependencies <em>without version</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In the Java ecosystem, Gradle provides a <a href="java_platform_plugin.html#java_platform_plugin">plugin</a> for this purpose.</p>
</div>
<div class="paragraph">
<p>It&#8217;s also common to find platforms published as Maven BOMs which <a href="#sub:bom_import">Gradle supports natively</a>.</p>
</div>
<div class="paragraph">
<p>A dependency on a platform is created using the <code>platform</code> keyword:</p>
</div>
<div class="exampleblock">
<div class="title">Example 79. Getting versions declared in a platform</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">dependencies {
    // get recommended versions from the platform project
    api platform(project(':platform'))
    // no version required
    api 'commons-httpclient:commons-httpclient'
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">dependencies {
    // get recommended versions from the platform project
    api(platform(project(":platform")))
    // no version required
    api("commons-httpclient:commons-httpclient")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This <code>platform</code> notation is a short-hand notation which actually performs several operations under the hood:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>it sets the <a href="../javadoc/org/gradle/api/attributes/Category.html">org.gradle.category attribute</a> to <code>platform</code>, which means that Gradle will select the <em>platform</em> component of the dependency.</p>
</li>
<li>
<p>it sets the <a href="../javadoc/org/gradle/api/artifacts/ModuleDependency.html#endorseStrictVersions--">endorseStrictVersions</a> behavior by default, meaning that if the platform declares strict dependencies, they will be enforced.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This means that by default, a dependency to a platform triggers the inheritance of all <a href="#sec:strict-version">strict versions</a> defined in that platform, which can be useful for platform authors to make sure that all consumers respect their decisions in terms of versions of dependencies.
This can be turned off by explicitly calling the <code>doNotEndorseStrictVersions</code> method.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="sub:bom_import"><a class="anchor" href="#sub:bom_import"></a><a class="link" href="#sub:bom_import">Importing Maven BOMs</a></h3>
<div class="paragraph">
<p>Gradle provides support for importing <a href="https://maven.apache.org/guides/introduction/introduction-to-dependency-mechanism.html#Importing_Dependencies">bill of materials (BOM) files</a>, which are effectively <code>.pom</code> files that use <code>&lt;dependencyManagement&gt;</code> to control the dependency versions of direct and transitive dependencies.
The BOM support in Gradle works similar to using <code>&lt;scope&gt;import&lt;/scope&gt;</code> when depending on a BOM in Maven.
In Gradle however, it is done via a regular dependency declaration on the BOM:</p>
</div>
<div class="exampleblock">
<div class="title">Example 80. Depending on a BOM to import its dependency constraints</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">dependencies {
    // import a BOM
    implementation platform('org.springframework.boot:spring-boot-dependencies:1.5.8.RELEASE')

    // define dependencies without versions
    implementation 'com.google.code.gson:gson'
    implementation 'dom4j:dom4j'
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">dependencies {
    // import a BOM
    implementation(platform("org.springframework.boot:spring-boot-dependencies:1.5.8.RELEASE"))

    // define dependencies without versions
    implementation("com.google.code.gson:gson")
    implementation("dom4j:dom4j")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In the example, the versions of <code>gson</code> and <code>dom4j</code> are provided by the Spring Boot BOM.
This way, if you are developing for a platform like Spring Boot, you do not have to declare any versions yourself but can rely on the versions the platform provides.</p>
</div>
<div class="paragraph">
<p>Gradle treats all entries in the <code>&lt;dependencyManagement&gt;</code> block of a BOM similar to <a href="#sec:adding-constraints-transitive-deps">Gradle&#8217;s dependency constraints</a>.
This means that any version defined in the <code>&lt;dependencyManagement&gt;</code> block can impact the dependency resolution result.
In order to qualify as a BOM, a <code>.pom</code> file needs to have <code>&lt;packaging&gt;pom&lt;/packaging&gt;</code> set.</p>
</div>
<div class="paragraph">
<p>However often BOMs are not only providing versions as recommendations, but also a way to override any other version found in the graph.
You can enable this behavior by using the <code>enforcedPlatform</code> keyword, instead of <code>platform</code>, when importing the BOM:</p>
</div>
<div class="exampleblock">
<div class="title">Example 81. Importing a BOM, making sure the versions it defines override any other version found</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">dependencies {
    // import a BOM. The versions used in this file will override any other version found in the graph
    implementation enforcedPlatform('org.springframework.boot:spring-boot-dependencies:1.5.8.RELEASE')

    // define dependencies without versions
    implementation 'com.google.code.gson:gson'
    implementation 'dom4j:dom4j'

    // this version will be overridden by the one found in the BOM
    implementation 'org.codehaus.groovy:groovy:1.8.6'
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">dependencies {
    // import a BOM. The versions used in this file will override any other version found in the graph
    implementation(enforcedPlatform("org.springframework.boot:spring-boot-dependencies:1.5.8.RELEASE"))

    // define dependencies without versions
    implementation("com.google.code.gson:gson")
    implementation("dom4j:dom4j")

    // this version will be overridden by the one found in the BOM
    implementation("org.codehaus.groovy:groovy:1.8.6")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="version_alignment"><a class="anchor" href="#version_alignment"></a><a class="link" href="#version_alignment">Aligning dependency versions</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Dependency version alignment allows different modules belonging to the same logical group (a <em>platform</em>) to have identical versions in a dependency graph.</p>
</div>
<div class="sect2">
<h3 id="handling_inconsistent_module_versions"><a class="anchor" href="#handling_inconsistent_module_versions"></a><a class="link" href="#handling_inconsistent_module_versions">Handling inconsistent module versions</a></h3>
<div class="paragraph">
<p>Gradle supports aligning versions of modules which belong to the same "platform".
It is often preferable, for example, that the API and implementation modules of a component are using the same version.
However, because of the game of transitive dependency resolution, it is possible that different modules belonging to the same platform end up using different versions.
For example, your project may depend on the <code>jackson-databind</code> and <code>vert.x</code> libraries, as illustrated below:</p>
</div>
<div class="exampleblock">
<div class="title">Example 82. Declaring dependencies</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">dependencies {
    // a dependency on Jackson Databind
    implementation 'com.fasterxml.jackson.core:jackson-databind:2.8.9'

    // and a dependency on vert.x
    implementation 'io.vertx:vertx-core:3.5.3'
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">dependencies {
    // a dependency on Jackson Databind
    implementation("com.fasterxml.jackson.core:jackson-databind:2.8.9")

    // and a dependency on vert.x
    implementation("io.vertx:vertx-core:3.5.3")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Because <code>vert.x</code> depends on <code>jackson-core</code>, we would actually resolve the following dependency versions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>jackson-core</code> version <code>2.9.5</code> (brought by <code>vertx-core</code>)</p>
</li>
<li>
<p><code>jackson-databind</code> version <code>2.9.5</code> (by conflict resolution)</p>
</li>
<li>
<p><code>jackson-annotation</code> version <code>2.9.0</code> (dependency of <code>jackson-databind:2.9.5</code>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It&#8217;s easy to end up with a set of versions which do not work well together.
To fix this, Gradle supports dependency version alignment, which is supported by the concept of platforms.
A platform represents a set of modules which "work well together".
Either because they are actually published as a whole (when one of the members of the platform is published, all other modules are also published with the same version), or because someone tested the modules and indicates that they work well together (typically, the Spring Platform).</p>
</div>
</div>
<div class="sect2">
<h3 id="aligning_versions_natively_with_gradle"><a class="anchor" href="#aligning_versions_natively_with_gradle"></a><a class="link" href="#aligning_versions_natively_with_gradle">Aligning versions natively with Gradle</a></h3>
<div class="paragraph">
<p>Gradle natively supports alignment of modules produced by Gradle.
This is a direct consequence of the transitivity of <a href="#sec:adding-constraints-transitive-deps">dependency constraints</a>.
So if you have a multi-project build, and you wish that consumers get the same version of all your modules, Gradle provides a simple way to do this using the <a href="java_platform_plugin.html">Java Platform Plugin</a>.</p>
</div>
<div class="paragraph">
<p>For example, if you have a project that consists of 3 modules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>lib</code></p>
</li>
<li>
<p><code>utils</code></p>
</li>
<li>
<p><code>core</code>, depending on <code>lib</code> and <code>utils</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>And a consumer that declares the following dependencies:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>core</code> version 1.0</p>
</li>
<li>
<p><code>lib</code> version 1.1</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Then by default resolution would select <code>core:1.0</code> and <code>lib:1.1</code>, because <code>lib</code> has no dependency on <code>core</code>.
We can fix this by adding a new module in our project, a <em>platform</em>, that will add constraints on all the modules of your project:</p>
</div>
<div class="exampleblock">
<div class="title">Example 83. The platform module</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">plugins {
    id 'java-platform'
}

dependencies {
    // The platform declares constraints on all components that
    // require alignment
    constraints {
        api(project(":core"))
        api(project(":lib"))
        api(project(":utils"))
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">plugins {
    `java-platform`
}

dependencies {
    // The platform declares constraints on all components that
    // require alignment
    constraints {
        api(project(":core"))
        api(project(":lib"))
        api(project(":utils"))
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Once this is done, we need to make sure that all modules now <em>depend on the platform</em>, like this:</p>
</div>
<div class="exampleblock">
<div class="title">Example 84. Declaring a dependency on the platform</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">dependencies {
    // Each project has a dependency on the platform
    api(platform(project(":platform")))

    // And any additional dependency required
    implementation(project(":lib"))
    implementation(project(":utils"))
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">dependencies {
    // Each project has a dependency on the platform
    api(platform(project(":platform")))

    // And any additional dependency required
    implementation(project(":lib"))
    implementation(project(":utils"))
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>It is important that the platform contains a constraint on all the components, but also that each component has a dependency on the platform.
By doing this, whenever Gradle will add a dependency to a module of the platform on the graph, it will <em>also</em> include constraints on the other modules of the platform.
This means that if we see another module belonging to the same platform, we will automatically upgrade to the same version.</p>
</div>
<div class="paragraph">
<p>In our example, it means that we first see <code>core:1.0</code>, which brings a platform <code>1.0</code> with constraints on <code>lib:1.0</code> and <code>lib:1.0</code>.
Then we add <code>lib:1.1</code> which has a dependency on <code>platform:1.1</code>.
By conflict resolution, we select the <code>1.1</code> platform, which has a constraint on <code>core:1.1</code>.
Then we conflict resolve between <code>core:1.0</code> and <code>core:1.1</code>, which means that <code>core</code> and <code>lib</code> are now aligned properly.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This behavior is enforced for published components only if you use Gradle Module Metadata.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="sec:align-versions-unpublished"><a class="anchor" href="#sec:align-versions-unpublished"></a><a class="link" href="#sec:align-versions-unpublished">Aligning versions of modules not published with Gradle</a></h3>
<div class="paragraph">
<p>Whenever the publisher doesn&#8217;t use Gradle, like in our Jackson example, we can explain to Gradle that all Jackson modules "belong to" the same platform and benefit from the same behavior as with native alignment.
There are two options to express that a set of modules belong to a platform:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A platform is <strong>published</strong> as a <a href="#sub:bom_import">BOM</a> and can be used:
For example, <code>com.fasterxml.jackson:jackson-bom</code> can be used as platform.
The information missing to Gradle in that case is that the platform should be added to the dependencies if one of its members is used.</p>
</li>
<li>
<p>No existing platform can be used. Instead, a <strong>virtual platform</strong> should be created by Gradle:
In this case, Gradle builds up the platform itself based on all the members that are used.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>To provide the missing information to Gradle, you can define <a href="#">component metadata rules</a> as explained in the following.</p>
</div>
<div class="sect3">
<h4 id="sec:align_bom_platform"><a class="anchor" href="#sec:align_bom_platform"></a><a class="link" href="#sec:align_bom_platform">Align versions of modules using a published BOM</a></h4>
<div class="exampleblock">
<div class="title">Example 85. A dependency version alignment rule</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">class JacksonBomAlignmentRule implements ComponentMetadataRule {
    void execute(ComponentMetadataContext ctx) {
        ctx.details.with {
            if (id.group.startsWith("com.fasterxml.jackson")) {
                // declare that Jackson modules belong to the platform defined by the Jackson BOM
                belongsTo("com.fasterxml.jackson:jackson-bom:${id.version}", false)
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">open class JacksonBomAlignmentRule: ComponentMetadataRule {
    override fun execute(ctx: ComponentMetadataContext) {
        ctx.details.run {
            if (id.group.startsWith("com.fasterxml.jackson")) {
                // declare that Jackson modules belong to the platform defined by the Jackson BOM
                belongsTo("com.fasterxml.jackson:jackson-bom:${id.version}", false)
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>By using the <code>belongsTo</code> with <code>false</code> (<strong>not</strong> virtual), we declare that all modules belong to the same <em>published platform</em>.
In this case, the platform is <code>com.fasterxml.jackson:jackson-bom</code> and Gradle will look for it, as for any other module, in the declared repositories.</p>
</div>
<div class="exampleblock">
<div class="title">Example 86. Making use of a dependency version alignment rule</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">dependencies {
    components.all(JacksonBomAlignmentRule)
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">dependencies {
    components.all&lt;JacksonBomAlignmentRule&gt;()
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Using the rule, the versions in the example above align to whatever the selected version of <code>com.fasterxml.jackson:jackson-bom</code> defines.
In this case, <code>com.fasterxml.jackson:jackson-bom:2.9.5</code> will be selected as <code>2.9.5</code> is the highest version of a module selected.
In that BOM, the following versions are defined and will be used:
<code>jackson-core:2.9.5</code>,
<code>jackson-databind:2.9.5</code> and
<code>jackson-annotation:2.9.0</code>.
The lower versions of <code>jackson-annotation</code> here might be the desired result as it is what the BOM recommends.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This behavior is working reliable since Gradle 6.1. Effectively, it is similar to a <a href="#">component metadata rule</a> that adds a platform dependency to all members of the platform using <code>withDependencies</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="sec:virtual_platform"><a class="anchor" href="#sec:virtual_platform"></a><a class="link" href="#sec:virtual_platform">Align versions of modules without a published platform</a></h4>
<div class="exampleblock">
<div class="title">Example 87. A dependency version alignment rule</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">class JacksonAlignmentRule implements ComponentMetadataRule {
    void execute(ComponentMetadataContext ctx) {
        ctx.details.with {
            if (id.group.startsWith("com.fasterxml.jackson")) {
                // declare that Jackson modules all belong to the Jackson virtual platform
                belongsTo("com.fasterxml.jackson:jackson-virtual-platform:${id.version}")
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">open class JacksonAlignmentRule: ComponentMetadataRule {
    override fun execute(ctx: ComponentMetadataContext) {
        ctx.details.run {
            if (id.group.startsWith("com.fasterxml.jackson")) {
                // declare that Jackson modules all belong to the Jackson virtual platform
                belongsTo("com.fasterxml.jackson:jackson-virtual-platform:${id.version}")
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>By using the <code>belongsTo</code> keyword without further parameter (platform <strong>is</strong> virtual), we declare that all modules belong to the same <em>virtual platform</em>, which is treated specially by the engine.
A virtual platform will not be retrieved from a repository.
The identifier, in this case <code>com.fasterxml.jackson:jackson-virtual-platform</code>, is something you as the build author define yourself.
The "content" of the platform is then created by Gradle on the fly by collecting all <code>belongsTo</code> statements pointing at the same virtual platform.</p>
</div>
<div class="exampleblock">
<div class="title">Example 88. Making use of a dependency version alignment rule</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">dependencies {
    components.all(JacksonAlignmentRule)
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">dependencies {
    components.all&lt;JacksonAlignmentRule&gt;()
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Using the rule, all versions in the example above would align to <code>2.9.5</code>.
In this case, also <code>jackson-annotation:2.9.5</code> will be taken, as that is how we defined our local virtual platform.</p>
</div>
<div class="paragraph">
<p>For both published and virtual platforms, Gradle lets you override the version choice of the platform itself by specifying an <em>enforced</em> dependency on the platform:</p>
</div>
<div class="exampleblock">
<div class="title">Example 89. Forceful platform downgrade</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">dependencies {
    // Forcefully downgrade the virtual Jackson platform to 2.8.9
    implementation enforcedPlatform('com.fasterxml.jackson:jackson-virtual-platform:2.8.9')
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">dependencies {
    // Forcefully downgrade the virtual Jackson platform to 2.8.9
    implementation(enforcedPlatform("com.fasterxml.jackson:jackson-virtual-platform:2.8.9"))
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec:handling-mutually-exclusive-deps"><a class="anchor" href="#sec:handling-mutually-exclusive-deps"></a><a class="link" href="#sec:handling-mutually-exclusive-deps">Handling mutually exclusive dependencies</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="sub:capabilities"><a class="anchor" href="#sub:capabilities"></a><a class="link" href="#sub:capabilities">Introduction to component capabilities</a></h3>
<div class="paragraph">
<p>Often a dependency graph would accidentally contain multiple implementations of the same API.
This is particularly common with logging frameworks, where multiple bindings are available, and that one library chooses a binding when another transitive dependency chooses another.
Because those implementations live at different GAV coordinates, the build tool has usually no way to find out that there&#8217;s a conflict between those libraries.
To solve this, Gradle provides the concept of <em>capability</em>.</p>
</div>
<div class="paragraph">
<p>It&#8217;s illegal to find two components providing the same <em>capability</em> in a single dependency graph.
Intuitively, it means that if Gradle finds two components that provide the same thing on classpath, it&#8217;s going to fail with an error indicating what modules are in conflict.
In our example, it means that different bindings of a logging framework provide the same capability.</p>
</div>
</div>
<div class="sect2">
<h3 id="capability_coordinates"><a class="anchor" href="#capability_coordinates"></a><a class="link" href="#capability_coordinates">Capability coordinates</a></h3>
<div class="paragraph">
<p>A <em>capability</em> is defined by a <code>(group, module, version)</code> triplet.
Each component defines an implicit capability corresponding to its GAV coordinates (group, artifact, version).
For example, the <code>org.apache.commons:commons-lang3:3.8</code> module has an implicit capability with group <code>org.apache.commons</code>, name <code>commons-lang3</code> and version <code>3.8</code>.
It is important to realize that capabilities are <em>versioned</em>.</p>
</div>
</div>
<div class="sect2">
<h3 id="sub:declaring-component-capabilities"><a class="anchor" href="#sub:declaring-component-capabilities"></a><a class="link" href="#sub:declaring-component-capabilities">Declaring component capabilities</a></h3>
<div class="paragraph">
<p>By default, Gradle will fail if two components in the dependency graph provide the same capability.
Because most modules are currently published without Gradle Module Metadata, capabilities are not always automatically discovered by Gradle.
It is however interesting to use <em>rules</em> to declare component capabilities in order to discover conflicts as soon as possible, during the build instead of runtime.</p>
</div>
<div class="paragraph">
<p>A typical example is whenever a component is relocated at different coordinates in a new release.
For example, the ASM library lived at <code>asm:asm</code> coordinates until version <code>3.3.1</code>, then changed to <code>org.ow2.asm:asm</code> since <code>4.0</code>.
It is illegal to have both ASM &lt;= 3.3.1 and 4.0+ on the classpath, because they provide the same feature, it&#8217;s just that the component has been relocated.
Because each component has an implicit capability corresponding to its GAV coordinates, we can "fix" this by having a rule that will declare that the <code>asm:asm</code> module provides the <code>org.ow2.asm:asm</code> capability:</p>
</div>
<div class="exampleblock">
<div class="title">Example 90. Conflict resolution by capability</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">@CompileStatic
class AsmCapability implements ComponentMetadataRule {
    void execute(ComponentMetadataContext context) {
        context.details.with {
            if (id.group == "asm" &amp;&amp; id.name == "asm") {
                allVariants {
                    it.withCapabilities {
                        // Declare that ASM provides the org.ow2.asm:asm capability, but with an older version
                        it.addCapability("org.ow2.asm", "asm", id.version)
                    }
                }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">class AsmCapability : ComponentMetadataRule {
    override
    fun execute(context: ComponentMetadataContext) = context.details.run {
        if (id.group == "asm" &amp;&amp; id.name == "asm") {
            allVariants {
                withCapabilities {
                    // Declare that ASM provides the org.ow2.asm:asm capability, but with an older version
                    addCapability("org.ow2.asm", "asm", id.version)
                }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Now the build is going to <em>fail</em> whenever the two components are found in the same dependency graph.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>At this stage, Gradle will <em>only</em> make more builds fail.
It will <strong>not</strong> automatically fix the problem for you, but it helps you realize that you have a problem.
It is recommended to write such rules in <em>plugins</em> which are then applied to your builds.
Then, users <em>have to</em> express their preferences, if possible, or fix the problem of having incompatible things on the classpath, as explained in the following section.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="sub:selecting-between-candidates"><a class="anchor" href="#sub:selecting-between-candidates"></a><a class="link" href="#sub:selecting-between-candidates">Selecting between candidates</a></h3>
<div class="paragraph">
<p>At some point, a dependency graph is going to include either <em>incompatible modules</em>, or modules which are <em>mutually exclusive</em>.
For example, you may have different logger implementations and you need to choose one binding.
<a href="#sub:capabilities">Capabilities</a> help <em>realizing</em> that you have a conflict, but Gradle also provides tools to express how to solve the conflicts.</p>
</div>
<div class="sect3">
<h4 id="sub:selecting-preferred-capability-provider"><a class="anchor" href="#sub:selecting-preferred-capability-provider"></a><a class="link" href="#sub:selecting-preferred-capability-provider">Selecting between different capability candidates</a></h4>
<div class="paragraph">
<p>In the relocation example above, Gradle was able to tell you that you have two versions of the same API on classpath: an "old" module and a "relocated" one.
Now we can solve the conflict by automatically choosing the component which has the highest capability version:</p>
</div>
<div class="exampleblock">
<div class="title">Example 91. Conflict resolution by capability versioning</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">configurations.all {
    resolutionStrategy.capabilitiesResolution.withCapability('org.ow2.asm:asm') {
        selectHighestVersion()
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">configurations.all {
    resolutionStrategy.capabilitiesResolution.withCapability("org.ow2.asm:asm") {
        selectHighestVersion()
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>However, fixing by choosing the highest capability version conflict resolution is not always suitable.
For a logging framework, for example, it doesn&#8217;t matter what version of the logging frameworks we use, we should always select Slf4j.</p>
</div>
<div class="paragraph">
<p>In this case, we can fix it by explicitly selecting slf4j as the winner:</p>
</div>
<div class="exampleblock">
<div class="title">Example 92. Substitute log4j with slf4j</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">    configurations.all {
        resolutionStrategy.capabilitiesResolution.withCapability("log4j:log4j") {
            def toBeSelected = candidates.find { it.id instanceof ModuleComponentIdentifier &amp;&amp; it.id.module == 'log4j-over-slf4j' }
            if (toBeSelected != null) {
                select(toBeSelected)
            }
            because 'use slf4j in place of log4j'
        }
    }</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">    configurations.all {
        resolutionStrategy.capabilitiesResolution.withCapability("log4j:log4j") {
            val toBeSelected = candidates.firstOrNull { it.id.let { id -&gt; id is ModuleComponentIdentifier &amp;&amp; id.module == "log4j-over-slf4j" } }
            if (toBeSelected != null) {
                select(toBeSelected)
            }
            because("use slf4j in place of log4j")
        }
    }</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Note that this approach works also well if you have multiple <em>Slf4j bindings</em> on the classpath:
bindings are basically different logger implementations and you need only one.
However, the selected implementation may depend on the configuration being resolved.
For example, for tests, <code>slf4j-simple</code> may be enough but for production, <code>slf4-over-log4j</code> may be better.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Resolution can only be made in favor of a module <em>found</em> in the graph.</p>
</div>
<div class="paragraph">
<p>The <code>select</code> method only accepts a module found in the <em>current</em> candidates.
If the module you want to select is not part of the conflict, you can abstain from performing a selection, effectively not resolving <em>this</em> conflict.
It might be that another conflict exists in the graph for the same capability and will have the module you want to select.</p>
</div>
<div class="paragraph">
<p>If no resolution is given for all conflicts on a given capability, the build will fail given the module chosen for resolution was not part of the graph at all.</p>
</div>
<div class="paragraph">
<p>In addition <code>select(null)</code> will result in an error and so should be avoided.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For more information, check out the <a href="../javadoc/org/gradle/api/artifacts/ResolutionStrategy.html#capabilitiesResolution">the capabilities resolution API</a>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec:component_metadata_rules"><a class="anchor" href="#sec:component_metadata_rules"></a><a class="link" href="#sec:component_metadata_rules">Fixing metadata with component metadata rules</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Each module that is pulled from a repository has metadata associated with it, such as its group, name, version as well as the different variants it provides with their artifacts and dependencies.
Sometimes, this metadata is incomplete or incorrect.
To manipulate such incomplete metadata from within the build script, Gradle offers an API to write <em>component metadata rules</em>.
These rules take effect after a module&#8217;s metadata has been downloaded, but before it is used in dependency resolution.</p>
</div>
<div class="sect2">
<h3 id="basics_of_writing_a_component_metadata_rule"><a class="anchor" href="#basics_of_writing_a_component_metadata_rule"></a><a class="link" href="#basics_of_writing_a_component_metadata_rule">Basics of writing a component metadata rule</a></h3>
<div class="paragraph">
<p>Component metadata rules are applied in the components (<a href="../dsl/org.gradle.api.artifacts.dsl.ComponentMetadataHandler.html">ComponentMetadataHandler</a>) section of the dependencies block (<a href="../dsl/org.gradle.api.artifacts.dsl.DependencyHandler.html">DependencyHandler</a>) of a build script.
The rules can be defined in two different ways:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>As an action directly when they are applied in the <em>components</em> section</p>
</li>
<li>
<p>As an isolated class implementing the <a href="../javadoc/org/gradle/api/artifacts/ComponentMetadataRule.html">ComponentMetadataRule</a> interface</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>While defining rules inline as action can be convenient for experimentation, it is generally recommended to define rules as separate classes.
Rules that are written as isolated classes can be annotated with <code>@CacheableRule</code> to cache the results of their application such that they do not need to be re-executed each time dependencies are resolved.</p>
</div>
<div class="exampleblock">
<div class="title">Example 93. Example of a configurable component metadata rule</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">class TargetJvmVersionRule implements ComponentMetadataRule {
    final Integer jvmVersion
    @Inject TargetJvmVersionRule(Integer jvmVersion) {
        this.jvmVersion = jvmVersion
    }

    @Inject ObjectFactory getObjects() { }

    void execute(ComponentMetadataContext context) {
        context.details.withVariant("compile") {
            attributes {
                attribute(TargetJvmVersion.TARGET_JVM_VERSION_ATTRIBUTE, jvmVersion)
                attribute(Usage.USAGE_ATTRIBUTE, objects.named(Usage, Usage.JAVA_API))
            }
        }
    }
}
dependencies {
    components {
        withModule("commons-io:commons-io", TargetJvmVersionRule) {
            params(7)
        }
        withModule("commons-collections:commons-collections", TargetJvmVersionRule) {
            params(8)
        }
    }
    implementation("commons-io:commons-io:2.6")
    implementation("commons-collections:commons-collections:3.2.2")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">open class TargetJvmVersionRule @Inject constructor(val jvmVersion: Int) : ComponentMetadataRule {
    @Inject open fun getObjects(): ObjectFactory = throw UnsupportedOperationException()

    override fun execute(context: ComponentMetadataContext) {
        context.details.withVariant("compile") {
            attributes {
                attribute(TargetJvmVersion.TARGET_JVM_VERSION_ATTRIBUTE, jvmVersion)
                attribute(Usage.USAGE_ATTRIBUTE, getObjects().named(Usage.JAVA_API))
            }
        }
    }
}
dependencies {
    components {
        withModule&lt;TargetJvmVersionRule&gt;("commons-io:commons-io") {
            params(7)
        }
        withModule&lt;TargetJvmVersionRule&gt;("commons-collections:commons-collections") {
            params(8)
        }
    }
    implementation("commons-io:commons-io:2.6")
    implementation("commons-collections:commons-collections:3.2.2")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>As can be seen in the examples above, component metadata rules are defined by implementing <a href="../javadoc/org/gradle/api/artifacts/ComponentMetadataRule.html">ComponentMetadataRule</a> which has a single <code>execute</code> method receiving an instance of <a href="../javadoc/org/gradle/api/artifacts/ComponentMetadataContext.html">ComponentMetadataContext</a> as parameter.
In this example, the rule is also further configured through an <a href="../javadoc/org/gradle/api/ActionConfiguration.html">ActionConfiguration</a>.
This is supported by having a constructor in your implementation of <code>ComponentMetadataRule</code> accepting the parameters that were configured and the services that need injecting.</p>
</div>
<div class="paragraph">
<p>Gradle enforces isolation of instances of <code>ComponentMetadataRule</code>.
This means that all parameters must be <code>Serializable</code> or known Gradle types that can be isolated.</p>
</div>
<div class="paragraph">
<p>In addition, Gradle services can be injected into your <code>ComponentMetadataRule</code>.
Because of this, the moment you have a constructor, it must be annotated with <code>@javax.inject.Inject</code>.
A commonly required service is <a href="../javadoc/org/gradle/api/model/ObjectFactory.html">ObjectFactory</a> to create instances of strongly typed value objects like a value for setting an <a href="../javadoc/org/gradle/api/attributes/Attribute.html">Attribute</a>.
A service which is helpful for advanced usage of component metadata rules with custom metadata is the <a href="../javadoc/org/gradle/api/artifacts/repositories/RepositoryResourceAccessor.html">RepositoryResourceAccessor</a>.</p>
</div>
<div class="paragraph">
<p>A component metadata rule can be applied to all modules  <code>all(rule)</code>  or to a selected module  <code>withModule(groupAndName, rule)</code>.
Usually, a rule is specifically written to enrich metadata of one specific module and hence the <code>withModule</code> API should be preferred.</p>
</div>
</div>
<div class="sect2">
<h3 id="sec:component_metadata_rules_details"><a class="anchor" href="#sec:component_metadata_rules_details"></a><a class="link" href="#sec:component_metadata_rules_details">Which parts of metadata can be modified?</a></h3>
<div class="paragraph">
<p>The component metadata rules API is oriented at the features supported by <a href="https://github.com/gradle/gradle/blob/master/subprojects/docs/src/docs/design/gradle-module-metadata-latest-specification.md">Gradle Module Metadata</a> and the <em>dependencies</em> API in build scripts.
The main difference between writing rules and defining dependencies and artifacts in the build script is that component metadata rules, following the structure of Gradle Module Metadata, operate on <a href="#understanding-variant-selection">variants</a> directly.
On the contrary, in build scripts you often influence the shape of multiple variants at once (e.g. an <em>api</em> dependency is added to the <em>api</em> and <em>runtime</em> variant of a Java library, the artifact produced by the <em>jar</em> task is also added to these two variants).</p>
</div>
<div class="paragraph">
<p>Variants can be addressed for modification through the following methods:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>allVariants</code>: modify all variants of a component</p>
</li>
<li>
<p><code>withVariant(name)</code>: modify a single variant identified by its name</p>
</li>
<li>
<p><code>addVariant(name)</code> or <code>addVariant(name, base)</code>: add a new variant to the component either <em>from scratch</em> or by <em>copying</em> the details of an existing variant (base)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following details of each variant can be adjusted:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <a href="#sec:abm_configuration_attributes">attributes</a> that identify the variant  <code>attributes {}</code> block</p>
</li>
<li>
<p>The <a href="#declaring-component-capabilities">capabilities</a> the variant provides  <code>withCapabilities { }</code> block</p>
</li>
<li>
<p>The <a href="#">dependencies</a> of the variant, including <a href="#">rich versions</a>  <code>withDependencies {}</code> block</p>
</li>
<li>
<p>The <a href="#sec:adding-constraints-transitive-deps">dependency constraints</a> of the variant, including <a href="#">rich versions</a>  <code>withDependencyConstraints {}</code> block</p>
</li>
<li>
<p>The location of the published files that make up the actual content of the variant  <code>withFiles { }</code> block</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There are also a few properties of the whole component that can be changed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <em>component level attributes</em>, currently the only meaningful attribute there is <code>org.gradle.status</code></p>
</li>
<li>
<p>The <em>status scheme</em> to influence interpretation of the <code>org.gradle.status</code> attribute during version selection</p>
</li>
<li>
<p>The <em>belongsTo</em> property for <a href="#sec:declaring-capabilities-external-modules">version alignment through virtual platforms</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Depending on the format of the metadata of a module, it is mapped differently to the variant-centric representation of the metadata:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the module has Gradle Module Metadata, the data structure the rule operates on is very similar to what you find in the module&#8217;s <code>.module</code> file.</p>
</li>
<li>
<p>If the module was published only with <code>.pom</code> metadata, a number of fixed variants is derived as explained in the <a href="#sub:maven-mapping-to-variants">mapping of POM files to variants</a> section.</p>
</li>
<li>
<p>If the module was published only with an <code>ivy.xml</code> file, the <em>Ivy configurations</em> defined in the file can be accessed instead of variants.
Their dependencies, dependency constraints and files can be modified.
Additionally, the <code>addVariant(name, baseVariantOrConfiguration) { }</code> API can be used to derive variants from <em>Ivy configurations</em> if desired (for example, <a href="#sub:ivy-mapping-to-variants"><em>compile</em> and <em>runtime</em> variants for the Java library plugin</a> can be defined with this).</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="when_to_use_component_metadata_rules"><a class="anchor" href="#when_to_use_component_metadata_rules"></a><a class="link" href="#when_to_use_component_metadata_rules">When to use Component Metadata Rules?</a></h3>
<div class="paragraph">
<p>In general, if you consider using component metadata rules to adjust the metadata of a certain module, you should check first if that module was published with Gradle Module Metadata (<code>.module</code> file) or traditional metadata only (<code>.pom</code> or <code>ivy.xml</code>).</p>
</div>
<div class="paragraph">
<p>If a module was published with Gradle Module Metadata, the metadata is likely complete although there can still be cases where something is just plainly wrong.
For these modules you should only use component metadata rules if you have clearly identified a problem with the metadata itself.
If you have an issue with the dependency resolution result, you should first check if you can solve the issue by declaring <a href="#">dependency constraints with rich versions</a>.
In particular, if you are developing a library that you publish, you should remember that dependency constraints, in contrast to component metadata rules, are published as part of the metadata of your own library.
So with dependency constraints, you automatically share the solution of dependency resolution issues with your consumers, while component metadata rules are only applied to your own build.</p>
</div>
<div class="paragraph">
<p>If a module was published with traditional metadata (<code>.pom</code> or <code>ivy.xml</code> only, no <code>.module</code> file) it is more likely that the metadata is incomplete as features such as variants or dependency constraints are not supported in these formats.
Still, conceptually such modules can contain different variants or might have dependency constraints they just omitted (or wrongly defined as dependencies).
In the next sections, we explore a number existing oss modules with such incomplete metadata and the rules for adding the missing metadata information.</p>
</div>
<div class="paragraph">
<p>As a rule of thumb, you should contemplate if the rule you are writing also works out of context of your build.
That is, does the rule still produce a correct and useful result if applied in any other build that uses the module(s) it affects?</p>
</div>
</div>
<div class="sect2">
<h3 id="fixing_wrong_dependency_details"><a class="anchor" href="#fixing_wrong_dependency_details"></a><a class="link" href="#fixing_wrong_dependency_details">Fixing wrong dependency details</a></h3>
<div class="paragraph">
<p>Let&#8217;s consider as an example the publication of the Jaxen XPath Engine on <a href="https://repo1.maven.org/maven2/jaxen/jaxen">Maven central</a>.
The pom of version 1.1.3 declares a number of dependencies in the compile scope which are not actually needed for compilation.
These have been removed in the 1.1.4 pom.
Assuming that we need to work with 1.1.3 for some reason, we can fix the metadata with the following rule:</p>
</div>
<div class="exampleblock">
<div class="title">Example 94. Rule to remove unused dependencies of Jaxen metadata</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">class JaxenDependenciesRule implements ComponentMetadataRule {
    void execute(ComponentMetadataContext context) {
        context.details.allVariants {
            withDependencies {
                removeAll { it.group in ["dom4j", "jdom", "xerces",  "maven-plugins", "xml-apis", "xom"] }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">open class JaxenDependenciesRule: ComponentMetadataRule {
    override fun execute(context: ComponentMetadataContext) {
        context.details.allVariants {
            withDependencies {
                removeAll { it.group in listOf("dom4j", "jdom", "xerces",  "maven-plugins", "xml-apis", "xom") }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Within the <code>withDependencies</code> block you have access to the full list of dependencies and can use all methods available on the Java collection interface to inspect and modify that list.
In addition, there are <code>add(notation, configureAction)</code> methods accepting the usual notations similar to <a href="#">declaring dependencies</a> in the build script.
Dependency constraints can be inspected and modified the same way in the <code>withDependencyConstraints</code> block.</p>
</div>
<div class="paragraph">
<p>If we take a closer look at the Jaxen 1.1.4 pom, we observe that the <em>dom4j</em>, <em>jdom</em> and <em>xerces</em> dependencies are still there but marked as <em>optional</em>.
Optional dependencies in poms are not automatically processed by Gradle nor Maven.
The reason is that they indicate that there are <a href="#">optional feature variants</a> provided by the Jaxen library which require one or more of these dependencies, but the information what these features are and which dependency belongs to which is missing.
Such information cannot be represented in pom files, but in Gradle Module Metadata through variants and <a href="#declaring-component-capabilities">capabilities</a>.
Hence, we can add this information in a rule as well.</p>
</div>
<div class="exampleblock">
<div class="title">Example 95. Rule to add optional feature to Jaxen metadata</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">class JaxenCapabilitiesRule implements ComponentMetadataRule {
    void execute(ComponentMetadataContext context) {
        context.details.addVariant("runtime-dom4j", "runtime") {
            withCapabilities {
                removeCapability("jaxen", "jaxen")
                addCapability("jaxen", "jaxen-dom4j", context.details.id.version)
            }
            withDependencies {
                add("dom4j:dom4j:1.6.1")
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">open class JaxenCapabilitiesRule: ComponentMetadataRule {
    override fun execute(context: ComponentMetadataContext) {
        context.details.addVariant("runtime-dom4j", "runtime") {
            withCapabilities {
                removeCapability("jaxen", "jaxen")
                addCapability("jaxen", "jaxen-dom4j", context.details.id.version)
            }
            withDependencies {
                add("dom4j:dom4j:1.6.1")
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Here, we first use the <code>addVariant(name, baseVariant)</code> method to create an additional variant, which we identify as <em>feature variant</em> by defining a new capability <em>jaxen-dom4j</em> to represent the optional dom4j integration feature of Jaxen.
This works similar to <a href="#sec::declare_feature_variants">defining optional feature variants</a> in build scripts.
We then use one of the <code>add</code> methods for adding dependencies to define which dependencies this optional feature needs.</p>
</div>
<div class="paragraph">
<p>In the build script, we can then add a <a href="#sec::consuming_feature_variants">dependency to the optional feature</a> and Gradle will use the enriched metadata to discover the correct transitive dependencies.</p>
</div>
<div class="exampleblock">
<div class="title">Example 96. Applying and utilising rules for Jaxen metadata</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">dependencies {
    components {
        withModule("jaxen:jaxen", JaxenDependenciesRule)
        withModule("jaxen:jaxen", JaxenCapabilitiesRule)
    }
    implementation("jaxen:jaxen:1.1.3")
    runtimeOnly("jaxen:jaxen:1.1.3") {
        capabilities { requireCapability("jaxen:jaxen-dom4j") }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">dependencies {
    components {
        withModule&lt;JaxenDependenciesRule&gt;("jaxen:jaxen")
        withModule&lt;JaxenCapabilitiesRule&gt;("jaxen:jaxen")
    }
    implementation("jaxen:jaxen:1.1.3")
    runtimeOnly("jaxen:jaxen:1.1.3") {
        capabilities { requireCapability("jaxen:jaxen-dom4j") }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="making_variants_published_as_classified_jars_explicit"><a class="anchor" href="#making_variants_published_as_classified_jars_explicit"></a><a class="link" href="#making_variants_published_as_classified_jars_explicit">Making variants published as classified jars explicit</a></h3>
<div class="paragraph">
<p>While in the previous example, all variants, "main variants" and optional features, were packaged in one jar file, it is common to publish certain variants as separate files.
In particular, when the variants are mutual exclusive  i.e. they are <strong>not</strong> feature variants, but different variants offering alternative choices.
One example <strong>all</strong> pom-based libraries already have are the <em>runtime</em> and <em>compile</em> variants, where Gradle can choose only one depending on the task at hand.
Another of such alternatives discovered often in the Java ecosystems are jars targeting different Java versions.</p>
</div>
<div class="paragraph">
<p>As example, we look at version 0.7.9 of the asynchronous programming library Quasar published on <a href="https://repo1.maven.org/maven2/co/paralleluniverse/quasar-core/0.7.9">Maven central</a>.
If we inspect the directory listing, we discover that a <code>quasar-core-0.7.9-jdk8.jar</code> was published, in addition to <code>quasar-core-0.7.9.jar</code>.
Publishing additional jars with a <em>classifier</em> (here <em>jdk8</em>) is common practice in maven repositories.
And while both Maven and Gradle allow you to reference such jars by classifier, they are not mentioned at all in the metadata.
Thus, there is no information that these jars exist and if there are any other differences, like different dependencies, between the variants represented by such jars.</p>
</div>
<div class="paragraph">
<p>In Gradle Module Metadata, this variant information would be present and for the already published Quasar library, we can add it using the following rule:</p>
</div>
<div class="exampleblock">
<div class="title">Example 97. Rule to add JDK 8 variants to Quasar metadata</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">class QuasarRule implements ComponentMetadataRule {
    void execute(ComponentMetadataContext context) {
        ["compile", "runtime"].each { base -&gt;
            context.details.addVariant("jdk8${base.capitalize()}", base) {
                attributes {
                    attribute(TargetJvmVersion.TARGET_JVM_VERSION_ATTRIBUTE, 8)
                }
                withFiles {
                    removeAllFiles()
                    addFile("${context.details.id.name}-${context.details.id.version}-jdk8.jar")
                }
            }
            context.details.withVariant(base) {
                attributes {
                    attribute(TargetJvmVersion.TARGET_JVM_VERSION_ATTRIBUTE, 7)
                }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">open class QuasarRule: ComponentMetadataRule {
    override fun execute(context: ComponentMetadataContext) {
        listOf("compile", "runtime").forEach { base -&gt;
            context.details.addVariant("jdk8${base.capitalize()}", base) {
                attributes {
                    attribute(TargetJvmVersion.TARGET_JVM_VERSION_ATTRIBUTE, 8)
                }
                withFiles {
                    removeAllFiles()
                    addFile("${context.details.id.name}-${context.details.id.version}-jdk8.jar")
                }
            }
            context.details.withVariant(base) {
                attributes {
                    attribute(TargetJvmVersion.TARGET_JVM_VERSION_ATTRIBUTE, 7)
                }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In this case, it is pretty clear that the classifier stands for a target Java version, which is a <a href="#sec:variant-aware-matching">known Java ecosystem attribute</a>.
Because we also need both a <em>compile</em> and <em>runtime</em> for Java 8, we create two new variants but use the existing <em>compile</em> and <em>runtime</em> variants as <em>base</em>.
This way, all other Java ecosystem attributes are already set correctly and all dependencies are carried over.
Then we set the <code>TARGET_JVM_VERSION_ATTRIBUTE</code> to <code>8</code> for both variants, remove any existing file from the new variants with <code>removeAllFiles()</code>, and add the jdk8 jar file with <code>addFile()</code>.
The <code>removeAllFiles()</code> is needed, because the reference to the main jar <code>quasar-core-0.7.5.jar</code> is copied from the corresponding base variant.</p>
</div>
<div class="paragraph">
<p>We also enrich the existing <em>compile</em> and <em>runtime</em> variants with the information that they target Java 7  <code>attribute(TARGET_JVM_VERSION_ATTRIBUTE, 7)</code>.</p>
</div>
<div class="paragraph">
<p>Now, we can request a Java 8 versions for all of our dependencies on the compile classpath in the build script and Gradle will automatically select the best fitting variant for each library.
In the case of Quasar this will now be the <em>jdk8Compile</em> variant exposing the <code>quasar-core-0.7.9-jdk8.jar</code>.</p>
</div>
<div class="exampleblock">
<div class="title">Example 98. Applying and utilising rule for Quasar metadata</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">configurations.compileClasspath.attributes {
    attribute(TargetJvmVersion.TARGET_JVM_VERSION_ATTRIBUTE, 8)
}
dependencies {
    components {
        withModule("co.paralleluniverse:quasar-core", QuasarRule)
    }
    implementation("co.paralleluniverse:quasar-core:0.7.9")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">configurations["compileClasspath"].attributes {
    attribute(TargetJvmVersion.TARGET_JVM_VERSION_ATTRIBUTE, 8)
}
dependencies {
    components {
        withModule&lt;QuasarRule&gt;("co.paralleluniverse:quasar-core")
    }
    implementation("co.paralleluniverse:quasar-core:0.7.9")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="making_variants_encoded_in_versions_explicit"><a class="anchor" href="#making_variants_encoded_in_versions_explicit"></a><a class="link" href="#making_variants_encoded_in_versions_explicit">Making variants encoded in versions explicit</a></h3>
<div class="paragraph">
<p>Another solution to publish multiple alternatives for the same library is the usage of a a versioning pattern as done by the popular Guava library.
Here, each new version is published twice by appending the classifier to the version instead of the jar artifact.
In the case of Guava 28 for example, we can find a <em>28.0-jre</em> (Java 8) and <em>28.0-android</em> (Java 6) version on <a href="https://repo1.maven.org/maven2/com/google/guava/guava">Maven central</a>.
The advantage of using this pattern when working only with pom metadata is that both variants are discoverable through the version.
The disadvantage is that there is no information what the different version suffixes mean semantically.
So in the case of conflict, Gradle would just pick the highest version when comparing the version strings.</p>
</div>
<div class="paragraph">
<p>Turning this into proper variants is a bit more tricky, as Gradle first selects a version of a module and then selects the best fitting variant.
So the concept that variants are encoded as versions is not supported directly.
However, since both variants are always published together we can assume that the files are physically located in the same repository.
And since they are published with Maven repository conventions, we know the location of each file if we know module name and version.
We can write the following rule:</p>
</div>
<div class="exampleblock">
<div class="title">Example 99. Rule to add JDK 6 and JDK 8 variants to Guava metadata</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">class GuavaRule implements ComponentMetadataRule {
    void execute(ComponentMetadataContext context) {
        def variantVersion = context.details.id.version
        def version = variantVersion.substring(0, variantVersion.indexOf("-"))
        ["compile", "runtime"].each { base -&gt;
            [6: "android", 8: "jre"].each { targetJvmVersion, jarName -&gt;
                context.details.addVariant("jdk$targetJvmVersion${base.capitalize()}", base) {
                    attributes {
                        attributes.attribute(TargetJvmVersion.TARGET_JVM_VERSION_ATTRIBUTE, targetJvmVersion)
                    }
                    withFiles {
                        removeAllFiles()
                        addFile("guava-$version-${jarName}.jar", "../$version-$jarName/guava-$version-${jarName}.jar")
                    }
                }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">open class GuavaRule: ComponentMetadataRule {
    override fun execute(context: ComponentMetadataContext) {
        val variantVersion = context.details.id.version
        val version = variantVersion.substring(0, variantVersion.indexOf("-"))
        listOf("compile", "runtime").forEach { base -&gt;
            mapOf(6 to "android", 8 to "jre").forEach { (targetJvmVersion, jarName) -&gt;
                context.details.addVariant("jdk$targetJvmVersion${base.capitalize()}", base) {
                    attributes {
                        attributes.attribute(TargetJvmVersion.TARGET_JVM_VERSION_ATTRIBUTE, targetJvmVersion)
                    }
                    withFiles {
                        removeAllFiles()
                        addFile("guava-$version-$jarName.jar", "../$version-$jarName/guava-$version-$jarName.jar")
                    }
                }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Similar to the previous example, we add runtime and compile variants for both Java versions.
In the <code>withFiles</code> block however, we now also specify a relative path for the corresponding jar file which allows Gradle to find the file no matter if it has selected a <em>-jre</em> or <em>-android</em> version.
The path is always relative to the location of the metadata (in this case <code>pom</code>) file of the selection module version.
So with this rules, both Guava 28 "versions" carry both the <em>jdk6</em> and <em>jdk8</em> variants.
So it does not matter to which one Gradle resolves.
The variant, and with it the correct jar file, is determined based on the requested <code>TARGET_JVM_VERSION_ATTRIBUTE</code> value.</p>
</div>
<div class="exampleblock">
<div class="title">Example 100. Applying and utilising rule for Guava metadata</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">configurations.compileClasspath.attributes {
    attribute(TargetJvmVersion.TARGET_JVM_VERSION_ATTRIBUTE, 6)
}
dependencies {
    components {
        withModule("com.google.guava:guava", GuavaRule)
    }
    // '23.3-android' and '23.3-jre' are now the same as both offer both variants
    implementation("com.google.guava:guava:23.3+")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">configurations["compileClasspath"].attributes {
    attribute(TargetJvmVersion.TARGET_JVM_VERSION_ATTRIBUTE, 6)
}
dependencies {
    components {
        withModule&lt;GuavaRule&gt;("com.google.guava:guava")
    }
    // '23.3-android' and '23.3-jre' are now the same as both offer both variants
    implementation("com.google.guava:guava:23.3+")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="adding_variants_for_native_jars"><a class="anchor" href="#adding_variants_for_native_jars"></a><a class="link" href="#adding_variants_for_native_jars">Adding variants for native jars</a></h3>
<div class="paragraph">
<p>Jars with classifiers are also used to separate parts of a library for which multiple alternatives exists, for example native code, from the main artifact.
This is for example done by the Lightweight Java Game Library (LWGJ), which publishes several platform specific jars to <a href="https://repo1.maven.org/maven2/org/lwjgl/lwjgl/3.2.3">Maven central</a> from which always one is needed, in addition to the main jar, at runtime.
It is not possible to convey this information in pom metadata as there is no concept of putting multiple artifacts in relation through the metadata.
In Gradle Module Metadata, each variant can have arbitrary many files and we can leverage that by writing the following rule:</p>
</div>
<div class="exampleblock">
<div class="title">Example 101. Rule to add native runtime variants to LWGJ metadata</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">class LwjglRule implements ComponentMetadataRule { //val os: String, val arch: String, val classifier: String)
    private def nativeVariants = [
        [os: OperatingSystemFamily.LINUX,   arch: "arm32",  classifier: "natives-linux-arm32"],
        [os: OperatingSystemFamily.LINUX,   arch: "arm64",  classifier: "natives-linux-arm64"],
        [os: OperatingSystemFamily.WINDOWS, arch: "x86",    classifier: "natives-windows-x86"],
        [os: OperatingSystemFamily.WINDOWS, arch: "x86-64", classifier: "natives-windows"],
        [os: OperatingSystemFamily.MACOS,   arch: "x86-64", classifier: "natives-macos"]
    ]

    @Inject ObjectFactory getObjects() { }

    void execute(ComponentMetadataContext context) {
        context.details.withVariant("runtime") {
            attributes {
                attributes.attribute(OperatingSystemFamily.OPERATING_SYSTEM_ATTRIBUTE, objects.named(OperatingSystemFamily, "none"))
                attributes.attribute(MachineArchitecture.ARCHITECTURE_ATTRIBUTE, objects.named(MachineArchitecture, "none"))
            }
        }
        nativeVariants.each { variantDefinition -&gt;
            context.details.addVariant("${variantDefinition.classifier}-runtime", "runtime") {
                attributes {
                    attributes.attribute(OperatingSystemFamily.OPERATING_SYSTEM_ATTRIBUTE, objects.named(OperatingSystemFamily, variantDefinition.os))
                    attributes.attribute(MachineArchitecture.ARCHITECTURE_ATTRIBUTE, objects.named(MachineArchitecture, variantDefinition.arch))
                }
                withFiles {
                    addFile("${context.details.id.name}-${context.details.id.version}-${variantDefinition.classifier}.jar")
                }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">open class LwjglRule: ComponentMetadataRule {
    data class NativeVariant(val os: String, val arch: String, val classifier: String)

    private val nativeVariants = listOf(
        NativeVariant(OperatingSystemFamily.LINUX,   "arm32",  "natives-linux-arm32"),
        NativeVariant(OperatingSystemFamily.LINUX,   "arm64",  "natives-linux-arm64"),
        NativeVariant(OperatingSystemFamily.WINDOWS, "x86",    "natives-windows-x86"),
        NativeVariant(OperatingSystemFamily.WINDOWS, "x86-64", "natives-windows"),
        NativeVariant(OperatingSystemFamily.MACOS,   "x86-64", "natives-macos")
    )

    @Inject open fun getObjects(): ObjectFactory = throw UnsupportedOperationException()

    override fun execute(context: ComponentMetadataContext) {
        context.details.withVariant("runtime") {
            attributes {
                attributes.attribute(OperatingSystemFamily.OPERATING_SYSTEM_ATTRIBUTE, getObjects().named("none"))
                attributes.attribute(MachineArchitecture.ARCHITECTURE_ATTRIBUTE, getObjects().named("none"))
            }
        }
        nativeVariants.forEach { variantDefinition -&gt;
            context.details.addVariant("${variantDefinition.classifier}-runtime", "runtime") {
                attributes {
                    attributes.attribute(OperatingSystemFamily.OPERATING_SYSTEM_ATTRIBUTE, getObjects().named(variantDefinition.os))
                    attributes.attribute(MachineArchitecture.ARCHITECTURE_ATTRIBUTE, getObjects().named(variantDefinition.arch))
                }
                withFiles {
                    addFile("${context.details.id.name}-${context.details.id.version}-${variantDefinition.classifier}.jar")
                }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This rule is quite similar to the Quasar library example above.
Only this time we have five different runtime variants we add and nothing we need to change for the compile variant.
The runtime variants are all based on the existing <em>runtime</em> variant and we do not change any existing information.
All Java ecosystem attributes, the dependencies and the main jar file stay part of each of the runtime variants.
We only set the additional attributes <code>OPERATING_SYSTEM_ATTRIBUTE</code> and <code>ARCHITECTURE_ATTRIBUTE</code> which are defined as part of Gradle&#8217;s <a href="building_cpp_projects.html">native support</a>.
And we add the corresponding native jar file so that each runtime variant now carries two files: the main jar and the native jar.</p>
</div>
<div class="paragraph">
<p>In the build script, we can now request a specific variant and Gradle will fail with a selection error if more information is needed to make a decision.</p>
</div>
<div class="exampleblock">
<div class="title">Example 102. Applying and utilising rule for LWGJ metadata</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">configurations["runtimeClasspath"].attributes {
    attribute(OperatingSystemFamily.OPERATING_SYSTEM_ATTRIBUTE, objects.named(OperatingSystemFamily, "windows"))
}
dependencies {
    components {
        withModule("org.lwjgl:lwjgl", LwjglRule)
    }
    implementation("org.lwjgl:lwjgl:3.2.3")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">configurations["runtimeClasspath"].attributes {
    attribute(OperatingSystemFamily.OPERATING_SYSTEM_ATTRIBUTE, objects.named("windows"))
}
dependencies {
    components {
        withModule&lt;LwjglRule&gt;("org.lwjgl:lwjgl")
    }
    implementation("org.lwjgl:lwjgl:3.2.3")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Gradle fails to select a variant because a machine architecture needs to be chosen</div>
<div class="content">
<pre>&gt; Could not resolve all files for configuration ':runtimeClasspath'.
   &gt; Could not resolve org.lwjgl:lwjgl:3.2.3.
     Required by:
         project :
      &gt; Cannot choose between the following variants of org.lwjgl:lwjgl:3.2.3:
          - natives-windows-runtime
          - natives-windows-x86-runtime</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="making_different_flavors_of_a_library_available_through_capabilities"><a class="anchor" href="#making_different_flavors_of_a_library_available_through_capabilities"></a><a class="link" href="#making_different_flavors_of_a_library_available_through_capabilities">Making different flavors of a library available through capabilities</a></h3>
<div class="paragraph">
<p>Because it is difficult to model <a href="#">optional feature variants</a> as separate jars with pom metadata, libraries sometimes compose different jars with a different feature set.
That is, instead of composing your flavor of the library from different feature variants, you select one of the pre-composed variants (offering everything in one jar).
One such library is the well-known dependency injection framework Guice, published on <a href="https://repo1.maven.org/maven2/com/google/inject/guice/4.2.2">Maven central</a>, which offers a complete flavor (the main jar) and a reduced variant without aspect-oriented programming support (<code>guice-4.2.2-no_aop.jar</code>).
That second variant with a classifier is not mentioned in the pom metadata.
With the following rule, we create compile and runtime variants based on that file and make it selectable through a capability named <code>com.google.inject:guice-no_aop</code>.</p>
</div>
<div class="exampleblock">
<div class="title">Example 103. Rule to add no_aop feature variant to Guice metadata</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">class GuiceRule implements ComponentMetadataRule {
    void execute(ComponentMetadataContext context) {
        ["compile", "runtime"].each { base -&gt;
            context.details.addVariant("noAop${base.capitalize()}", base) {
                withCapabilities {
                    addCapability("com.google.inject", "guice-no_aop", context.details.id.version)
                }
                withFiles {
                    removeAllFiles()
                    addFile("guice-${context.details.id.version}-no_aop.jar")
                }
                withDependencies {
                    removeAll { it.group == "aopalliance" }
                }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">open class GuiceRule: ComponentMetadataRule {
    override fun execute(context: ComponentMetadataContext) {
        listOf("compile", "runtime").forEach { base -&gt;
            context.details.addVariant("noAop${base.capitalize()}", base) {
                withCapabilities {
                    addCapability("com.google.inject", "guice-no_aop", context.details.id.version)
                }
                withFiles {
                    removeAllFiles()
                    addFile("guice-${context.details.id.version}-no_aop.jar")
                }
                withDependencies {
                    removeAll { it.group == "aopalliance" }
                }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The new variants also have the dependency on the standardized aop interfaces library <code>aopalliance:aopalliance</code> removed, as this is clearly not needed by these variants.
Again, this is information that cannot be expressed in pom metadata.
We can now select a <code>guice-no_aop</code> variant and will get the correct jar file <strong>and</strong> the correct dependencies.</p>
</div>
<div class="exampleblock">
<div class="title">Example 104. Applying and utilising rule for Guice metadata</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">dependencies {
    components {
        withModule("com.google.inject:guice", GuiceRule)
    }
    implementation("com.google.inject:guice:4.2.2") {
        capabilities { requireCapability("com.google.inject:guice-no_aop") }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">dependencies {
    components {
        withModule&lt;GuiceRule&gt;("com.google.inject:guice")
    }
    implementation("com.google.inject:guice:4.2.2") {
        capabilities { requireCapability("com.google.inject:guice-no_aop") }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="adding_missing_capabilities_to_detect_conflicts"><a class="anchor" href="#adding_missing_capabilities_to_detect_conflicts"></a><a class="link" href="#adding_missing_capabilities_to_detect_conflicts">Adding missing capabilities to detect conflicts</a></h3>
<div class="paragraph">
<p>Another usage of capabilities is to express that two different modules, for example <code>log4j</code> and <code>log4j-over-slf4j</code>, provide alternative implementations of the same thing.
By declaring that both provide the same capability, Gradle only accepts one of them in a dependency graph.
This example, and how it can be tackled with a component metadata rule, is described in detail in the  <a href="#sec:declaring-capabilities-external-modules">feature modelling</a> section.</p>
</div>
</div>
<div class="sect2">
<h3 id="making_ivy_modules_variant_aware"><a class="anchor" href="#making_ivy_modules_variant_aware"></a><a class="link" href="#making_ivy_modules_variant_aware">Making Ivy modules variant-aware</a></h3>
<div class="paragraph">
<p>Modules with Ivy metadata, do not have variants by default.
However, <em>Ivy configurations</em> can be mapped to variants as the <code>addVariant(name, baseVariantOrConfiguration)</code> accepts any Ivy configuration that was published as base.
This can be used, for example, to define runtime and compile variants.
An example of a corresponding rule can be found <a href="#sub:ivy-mapping-to-variants">here</a>.
Ivy details of Ivy configurations (e.g. dependencies and files) can also be modified using the <code>withVariant(configurationName)</code> API.
However, modifying attributes or capabilities on Ivy configurations has no effect.</p>
</div>
<div class="paragraph">
<p>For very Ivy specific use cases, the component metadata rules API also offers access to other details only found in Ivy metadata.
These are available through the <a href="../javadoc/org/gradle/api/artifacts/ivy/IvyModuleDescriptor.html">IvyModuleDescriptor</a> interface and can be accessed using <code>getDescriptor(IvyModuleDescriptor)</code> on the <a href="../javadoc/org/gradle/api/artifacts/ComponentMetadataContext.html">ComponentMetadataContext</a>.</p>
</div>
<div class="exampleblock">
<div class="title">Example 105. Ivy component metadata rule</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">class IvyComponentRule implements ComponentMetadataRule {
    void execute(ComponentMetadataContext context) {
        def descriptor = context.getDescriptor(IvyModuleDescriptor)
        if (descriptor != null &amp;&amp; descriptor.branch == "testing") {
            context.details.status = "rc"
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">open class IvyComponentRule : ComponentMetadataRule {
    override fun execute(context: ComponentMetadataContext) {
        val descriptor = context.getDescriptor(IvyModuleDescriptor::class)
        if (descriptor != null &amp;&amp; descriptor.branch == "testing") {
            context.details.status = "rc"
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="filter_using_maven_metadata"><a class="anchor" href="#filter_using_maven_metadata"></a><a class="link" href="#filter_using_maven_metadata">Filter using Maven metadata</a></h3>
<div class="paragraph">
<p>For Maven specific use cases, the component metadata rules API also offers access to other details only found in POM metadata.
These are available through the <a href="../javadoc/org/gradle/api/artifacts/maven/PomModuleDescriptor.html">PomModuleDescriptor</a> interface and can be accessed using <code>getDescriptor(PomModuleDescriptor)</code> on the <a href="../javadoc/org/gradle/api/artifacts/ComponentMetadataContext.html">ComponentMetadataContext</a>.</p>
</div>
<div class="exampleblock">
<div class="title">Example 106. Access pom packaging type in component metadata rule</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">class MavenComponentRule implements ComponentMetadataRule {
    void execute(ComponentMetadataContext context) {
        def descriptor = context.getDescriptor(PomModuleDescriptor)
        if (descriptor != null &amp;&amp; descriptor.packaging == "war") {
            // ...
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">open class MavenComponentRule : ComponentMetadataRule {
    override fun execute(context: ComponentMetadataContext) {
        val descriptor = context.getDescriptor(PomModuleDescriptor::class)
        if (descriptor != null &amp;&amp; descriptor.packaging == "war") {
            // ...
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="modifying_metadata_on_the_component_level_for_alignment"><a class="anchor" href="#modifying_metadata_on_the_component_level_for_alignment"></a><a class="link" href="#modifying_metadata_on_the_component_level_for_alignment">Modifying metadata on the component level for alignment</a></h3>
<div class="paragraph">
<p>While all the examples above made modifications to variants of a component, there is also a limited set of modifications that can be done to the metadata of the component itself.
This information can influence the <a href="#">version selection</a> process for a module during dependency resolution, which is performed <em>before</em> one or multiple variants of a component are selected.</p>
</div>
<div class="paragraph">
<p>The first API available on the component is <code>belongsTo()</code> to create virtual platforms for aligning versions of multiple modules without Gradle Module Metadata.
It is explained in detail in the section on <a href="#sec:align-versions-unpublished">aligning versions of modules not published with Gradle</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="sec:custom_status_scheme"><a class="anchor" href="#sec:custom_status_scheme"></a><a class="link" href="#sec:custom_status_scheme">Modifying metadata on the component level for version selection based on status</a></h3>
<div class="paragraph">
<p>Gradle and Gradle Module Metadata also allow attributes to be set on the whole component instead of a single variant.
Each of these attributes carries special semantics as they influence version selection which is done <em>before</em> variant selection.
While variant selection can handle <a href="#sec:declaring_attributes">any custom attribute</a>, version selection only considers attributes for which specific semantics are implemented.
At the moment, the only attribute with meaning here is <code>org.gradle.status</code>.
It is therefore recommended to only modify this attribute, if any, on the component level.
A dedicated API <code>setStatus(value)</code> is available for this.
To modify another attribute for all variants of a component <code>withAllVariants { attributes {} }</code> should be utilised instead.</p>
</div>
<div class="paragraph">
<p>A module&#8217;s status is taken into consideration when a <a href="#"><em>latest</em> version selector</a> is resolved.
Specifically, <code>latest.someStatus</code> will resolve to the highest module version that has status <code>someStatus</code> or a more mature status.
For example, <code>latest.integration</code> will select the highest module version regardless of its status (because <code>integration</code> is the least mature status as explained below), whereas <code>latest.release</code> will select the highest module version with status <code>release</code>.</p>
</div>
<div class="paragraph">
<p>The interpretation of the status can be influenced by changing a module&#8217;s <em>status scheme</em> through the <code>setStatusScheme(valueList)</code> API.
This concept models the different levels of maturity that a module transitions through over time with different publications.
The default status scheme, ordered from least to most mature status, is <code>integration</code>, <code>milestone</code>, <code>release</code>.
The <code>org.gradle.status</code> attribute must be set, to one of the values in the components status scheme.
Thus each component always has a status which is determined from the metadata as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Gradle Module Metadata: the value that was published for the <code>org.gradle.status</code> attribute on the component</p>
</li>
<li>
<p>Ivy metadata: <code>status</code> defined in the ivy.xml, defaults to <code>integration</code> if missing</p>
</li>
<li>
<p>Pom metadata: <code>integration</code> for modules with a SNAPSHOT version, <code>release</code> for all others</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following example demonstrates <code>latest</code> selectors based on a custom status scheme declared in a component metadata rule that applies to all modules:</p>
</div>
<div class="exampleblock">
<div class="title">Example 107. Custom status scheme</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">class CustomStatusRule implements ComponentMetadataRule {
    void execute(ComponentMetadataContext context) {
        context.details.statusScheme = ["nightly", "milestone", "rc", "release"]
        if (context.details.status == "integration") {
            context.details.status = "nightly"
        }
    }
}

dependencies {
    components {
        all(CustomStatusRule)
    }
    implementation("org.apache.commons:commons-lang3:latest.rc")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">open class CustomStatusRule : ComponentMetadataRule {
    override fun execute(context: ComponentMetadataContext) {
        context.details.statusScheme = listOf("nightly", "milestone", "rc", "release")
        if (context.details.status == "integration") {
            context.details.status = "nightly"
        }
    }
}

dependencies {
    components {
        all&lt;CustomStatusRule&gt;()
    }
    implementation("org.apache.commons:commons-lang3:latest.rc")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Compared to the default scheme, the rule inserts a new status <code>rc</code> and replaces <code>integration</code> with <code>nightly</code>.
Existing modules with the state <code>integration</code> are mapped to <code>nightly</code>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="resolution_rules"><a class="anchor" href="#resolution_rules"></a><a class="link" href="#resolution_rules">Customizing resolution of a dependency directly</a></h2>
<div class="sectionbody">
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This section covers mechanisms Gradle offers to directly influence the behavior of the dependency resolution engine.
In contrast to the other concepts covered in this chapter, like <a href="#">dependency constraints</a> or <a href="#">component metadata rules</a>, which are all <strong>inputs</strong> to resolution, the following mechanisms allow you to write rules which are directly injected into the resolution engine.
Because of this, they can be seen as <em>brute force</em> solutions, that may hide future problems (e.g. if new dependencies are added).
Therefore, the general advice is to only use the following mechanisms if other means are not sufficient.
If you are authoring a <a href="#">library</a>, you should always prefer <a href="#">dependency constraints</a> as they are published for your consumers.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="sec:dependency_resolve_rules"><a class="anchor" href="#sec:dependency_resolve_rules"></a><a class="link" href="#sec:dependency_resolve_rules">Using dependency resolve rules</a></h3>
<div class="paragraph">
<p>A dependency resolve rule is executed for each resolved dependency, and offers a powerful api for manipulating a requested dependency prior to that dependency being resolved.
The feature currently offers the ability to change the group, name and/or version of a requested dependency, allowing a dependency to be substituted with a completely different module during resolution.</p>
</div>
<div class="paragraph">
<p>Dependency resolve rules provide a very powerful way to control the dependency resolution process, and can be used to implement all sorts of advanced patterns in dependency management.
Some of these patterns are outlined below.
For more information and code samples see the <a href="../dsl/org.gradle.api.artifacts.ResolutionStrategy.html">ResolutionStrategy</a> class in the API documentation.</p>
</div>
<div class="sect3">
<h4 id="sec:custom_versioning_scheme"><a class="anchor" href="#sec:custom_versioning_scheme"></a><a class="link" href="#sec:custom_versioning_scheme">Implementing a custom versioning scheme</a></h4>
<div class="paragraph">
<p>In some corporate environments, the list of module versions that can be declared in Gradle builds is maintained and audited externally.
Dependency resolve rules provide a neat implementation of this pattern:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In the build script, the developer declares dependencies with the module group and name, but uses a placeholder version, for example: <code>default</code>.</p>
</li>
<li>
<p>The <code>default</code> version is resolved to a specific version via a dependency resolve rule, which looks up the version in a corporate catalog of approved modules.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This rule implementation can be neatly encapsulated in a corporate plugin, and shared across all builds within the organisation.</p>
</div>
<div class="exampleblock">
<div class="title">Example 108. Using a custom versioning scheme</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">configurations.all {
    resolutionStrategy.eachDependency { DependencyResolveDetails details -&gt;
        if (details.requested.version == 'default') {
            def version = findDefaultVersionInCatalog(details.requested.group, details.requested.name)
            details.useVersion version.version
            details.because version.because
        }
    }
}

def findDefaultVersionInCatalog(String group, String name) {
    //some custom logic that resolves the default version into a specific version
    [version: "1.0", because: 'tested by QA']
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">configurations.all {
    resolutionStrategy.eachDependency {
        if (requested.version == "default") {
            val version = findDefaultVersionInCatalog(requested.group, requested.name)
            useVersion(version.version)
            because(version.because)
        }
    }
}

data class DefaultVersion(val version: String, val because: String)

fun findDefaultVersionInCatalog(group: String, name: String): DefaultVersion {
    //some custom logic that resolves the default version into a specific version
    return DefaultVersion(version = "1.0", because = "tested by QA")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:blacklisting_version"><a class="anchor" href="#sec:blacklisting_version"></a><a class="link" href="#sec:blacklisting_version">Blacklisting a particular version with a replacement</a></h4>
<div class="paragraph">
<p>Dependency resolve rules provide a mechanism for blacklisting a particular version of a dependency and providing a replacement version.
This can be useful if a certain dependency version is broken and should not be used, where a dependency resolve rule causes this version to be replaced with a known good version.
One example of a broken module is one that declares a dependency on a library that cannot be found in any of the public repositories, but there are many other reasons why a particular module version is unwanted and a different version is preferred.</p>
</div>
<div class="paragraph">
<p>In example below, imagine that version <code>1.2.1</code> contains important fixes and should always be used in preference to <code>1.2</code>.
The rule provided will enforce just this: any time version <code>1.2</code> is encountered it will be replaced with <code>1.2.1</code>.
Note that this is different from a forced version as described above, in that any other versions of this module would not be affected.
This means that the 'newest' conflict resolution strategy would still select version <code>1.3</code> if this version was also pulled transitively.</p>
</div>
<div class="exampleblock">
<div class="title">Example 109. Example: Blacklisting a version with a replacement</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">configurations.all {
    resolutionStrategy.eachDependency { DependencyResolveDetails details -&gt;
        if (details.requested.group == 'org.software' &amp;&amp; details.requested.name == 'some-library' &amp;&amp; details.requested.version == '1.2') {
            details.useVersion '1.2.1'
            details.because 'fixes critical bug in 1.2'
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">configurations.all {
    resolutionStrategy.eachDependency {
        if (requested.group == "org.software" &amp;&amp; requested.name == "some-library" &amp;&amp; requested.version == "1.2") {
            useVersion("1.2.1")
            because("fixes critical bug in 1.2")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>There&#8217;s a difference with using the <em>reject</em> directive of <a href="#rich-version-constraints">rich version constraints</a>: rich versions will cause the build to fail if a rejected version is found in the graph, or select a non rejected version when using dynamic dependencies.
Here, we <em>manipulate the requested versions</em> in order to select a different version when we find a rejected one.
In other words, this is a <em>solution</em> to rejected versions, while rich version constraints allow declaring the <em>intent</em> (you should not use this version).</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec:module_replacement"><a class="anchor" href="#sec:module_replacement"></a><a class="link" href="#sec:module_replacement">Using module replacement rules</a></h3>
<div class="paragraph">
<p>It is preferable to express module conflicts in terms of <a href="#sub:capabilities">capabilities conflicts</a>.
However, if there&#8217;s no such rule declared or that you are working on versions of Gradle which do not support capabilities, Gradle provides tooling to work around those issues.</p>
</div>
<div class="paragraph">
<p>Module replacement rules allow a build to declare that a legacy library has been replaced by a new one.
A good example when a new library replaced a legacy one is the <code>google-collections</code> -&gt; <code>guava</code> migration.
The team that created google-collections decided to change the module name from <code>com.google.collections:google-collections</code> into <code>com.google.guava:guava</code>.
This is a legal scenario in the industry: teams need to be able to change the names of products they maintain, including the module coordinates. Renaming of the module coordinates has impact on conflict resolution.</p>
</div>
<div class="paragraph">
<p>To explain the impact on conflict resolution, let&#8217;s consider the <code>google-collections</code> -&gt; <code>guava</code> scenario.
It may happen that both libraries are pulled into the same dependency graph.
For example, <em>our project</em> depends on <code>guava</code> but some of <em>our dependencies</em> pull in a legacy version of <code>google-collections</code>.
This can cause runtime errors, for example during test or application execution.
Gradle does not automatically resolve the <code>google-collections</code> -&gt; <code>guava</code> conflict because it is not considered as a <em>version conflict</em>.
It&#8217;s because the module coordinates for both libraries are completely different and conflict resolution is activated when <code>group</code> and <code>module</code> coordinates are the same but there are different versions available in the dependency graph (for more info, refer to the section on conflict resolution).
Traditional remedies to this problem are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Declare exclusion rule to avoid pulling in <code>google-collections</code> to graph. It is probably the most popular approach.</p>
</li>
<li>
<p>Avoid dependencies that pull in legacy libraries.</p>
</li>
<li>
<p>Upgrade the dependency version if the new version no longer pulls in a legacy library.</p>
</li>
<li>
<p>Downgrade to <code>google-collections</code>. It&#8217;s not recommended, just mentioned for completeness.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Traditional approaches work but they are not general enough.
For example, an organisation wants to resolve the <code>google-collections</code> -&gt; <code>guava</code> conflict resolution problem in all projects.
It is possible to declare that certain module was replaced by other.
This enables organisations to include the information about module replacement in the corporate plugin suite and resolve the problem holistically for all Gradle-powered projects in the enterprise.</p>
</div>
<div class="exampleblock">
<div class="title">Example 110. Declaring a module replacement</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">dependencies {
    modules {
        module("com.google.collections:google-collections") {
            replacedBy("com.google.guava:guava", "google-collections is now part of Guava")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">dependencies {
    modules {
        module("com.google.collections:google-collections") {
            replacedBy("com.google.guava:guava", "google-collections is now part of Guava")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>For more examples and detailed API, refer to the DSL reference for <a href="../javadoc/org/gradle/api/artifacts/dsl/ComponentMetadataHandler.html">ComponentMetadataHandler</a>.</p>
</div>
<div class="paragraph">
<p>What happens when we declare that <code>google-collections</code> is replaced by <code>guava</code>?
Gradle can use this information for conflict resolution. Gradle will consider every version of <code>guava</code> newer/better than any version of <code>google-collections</code>.
Also, Gradle will ensure that only guava jar is present in the classpath / resolved file list.
Note that if only <code>google-collections</code> appears in the dependency graph (e.g. no <code>guava</code>) Gradle will not eagerly replace it with <code>guava</code>.
Module replacement is an information that Gradle uses for resolving conflicts.
If there is no conflict (e.g. only <code>google-collections</code> or only <code>guava</code> in the graph) the replacement information is not used.</p>
</div>
<div class="paragraph">
<p>Currently it is not possible to declare that a given module is replaced by a set of modules.
However, it is possible to declare that multiple modules are replaced by a single module.</p>
</div>
</div>
<div class="sect2">
<h3 id="sec:dependency_substitution_rules"><a class="anchor" href="#sec:dependency_substitution_rules"></a><a class="link" href="#sec:dependency_substitution_rules">Using dependency substitution rules</a></h3>
<div class="paragraph">
<p>Dependency substitution rules work similarly to dependency resolve rules.
In fact, many capabilities of dependency resolve rules can be implemented with dependency substitution rules.
 They allow project and module dependencies to be transparently substituted with specified replacements.
 Unlike dependency resolve rules, dependency substitution rules allow project and module dependencies to be substituted interchangeably.</p>
</div>
<div class="paragraph">
<p><em>Adding a dependency substitution rule to a configuration changes the timing of when that configuration is resolved.</em>
Instead of being resolved on first use, the configuration is instead resolved when the task graph is being constructed.
This can have unexpected consequences if the configuration is being further modified during task execution, or if the configuration relies on modules that are published during execution of another task.</p>
</div>
<div class="paragraph">
<p>To explain:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A <code>Configuration</code> can be declared as an input to any Task, and that configuration can include project dependencies when it is resolved.</p>
</li>
<li>
<p>If a project dependency is an input to a Task (via a configuration), then tasks to build the project artifacts must be added to the task dependencies.</p>
</li>
<li>
<p>In order to determine the project dependencies that are inputs to a task, Gradle needs to resolve the <code>Configuration</code> inputs.</p>
</li>
<li>
<p>Because the Gradle task graph is fixed once task execution has commenced, Gradle needs to perform this resolution prior to executing any tasks.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In the absence of dependency substitution rules, Gradle knows that an external module dependency will never transitively reference a project dependency.
This makes it easy to determine the full set of project dependencies for a configuration through simple graph traversal.
With this functionality, Gradle can no longer make this assumption, and must perform a full resolve in order to determine the project dependencies.</p>
</div>
<div class="sect3">
<h4 id="sub:module_to_project_substitution"><a class="anchor" href="#sub:module_to_project_substitution"></a><a class="link" href="#sub:module_to_project_substitution">Substituting an external module dependency with a project dependency</a></h4>
<div class="paragraph">
<p>One use case for dependency substitution is to use a locally developed version of a module in place of one that is downloaded from an external repository.
This could be useful for testing a local, patched version of a dependency.</p>
</div>
<div class="paragraph">
<p>The module to be replaced can be declared with or without a version specified.</p>
</div>
<div class="exampleblock">
<div class="title">Example 111. Substituting a module with a project</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">configurations.all {
    resolutionStrategy.dependencySubstitution {
        substitute module("org.utils:api") because "we work with the unreleased development version" with project(":api")
        substitute module("org.utils:util:2.5") with project(":util")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">configurations.all {
    resolutionStrategy.dependencySubstitution {
        substitute(module("org.utils:api")).apply {
            with(project(":api"))
            because("we work with the unreleased development version")
        }
        substitute(module("org.utils:util:2.5")).with(project(":util"))
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Note that a project that is substituted must be included in the multi-project build (via <code>settings.gradle</code>).
Dependency substitution rules take care of replacing the module dependency with the project dependency and wiring up any task dependencies, but do not implicitly include the project in the build.</p>
</div>
</div>
<div class="sect3">
<h4 id="sub:project_to_module_substitution"><a class="anchor" href="#sub:project_to_module_substitution"></a><a class="link" href="#sub:project_to_module_substitution">Substituting a project dependency with a module replacement</a></h4>
<div class="paragraph">
<p>Another way to use substitution rules is to replace a project dependency with a module in a multi-project build.
This can be useful to speed up development with a large multi-project build, by allowing a subset of the project dependencies to be downloaded from a repository rather than being built.</p>
</div>
<div class="paragraph">
<p>The module to be used as a replacement must be declared with a version specified.</p>
</div>
<div class="exampleblock">
<div class="title">Example 112. Substituting a project with a module</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">configurations.all {
    resolutionStrategy.dependencySubstitution {
        substitute project(":api") because "we use a stable version of org.utils:api" with module("org.utils:api:1.3")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">configurations.all {
    resolutionStrategy.dependencySubstitution {
        substitute(project(":api")).apply {
            with(module("org.utils:api:1.3"))
            because("we use a stable version of org.utils:api")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>When a project dependency has been replaced with a module dependency, that project is still included in the overall multi-project build.
However, tasks to build the replaced dependency will not be executed in order to resolve the depending <code>Configuration</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="sub:conditional_dependency_substitution"><a class="anchor" href="#sub:conditional_dependency_substitution"></a><a class="link" href="#sub:conditional_dependency_substitution">Conditionally substituting a dependency</a></h4>
<div class="paragraph">
<p>A common use case for dependency substitution is to allow more flexible assembly of sub-projects within a multi-project build.
This can be useful for developing a local, patched version of an external dependency or for building a subset of the modules within a large multi-project build.</p>
</div>
<div class="paragraph">
<p>The following example uses a dependency substitution rule to replace any module dependency with the group <code>org.example</code>, but only if a local project matching the dependency name can be located.</p>
</div>
<div class="exampleblock">
<div class="title">Example 113. Conditionally substituting a dependency</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">    configurations.all {
        resolutionStrategy.dependencySubstitution.all { DependencySubstitution dependency -&gt;
            if (dependency.requested instanceof ModuleComponentSelector &amp;&amp; dependency.requested.group == "org.example") {
                def targetProject = findProject(":${dependency.requested.module}")
                if (targetProject != null) {
                    dependency.useTarget targetProject
                }
            }
        }
    }</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">    configurations.all {
        resolutionStrategy.dependencySubstitution.all {
            requested.let {
                if (it is ModuleComponentSelector &amp;&amp; it.group == "org.example") {
                    val targetProject = findProject(":${it.module}")
                    if (targetProject != null) {
                        useTarget(targetProject)
                    }
                }
            }
        }
    }</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Note that a project that is substituted must be included in the multi-project build (via <code>settings.gradle</code>).
Dependency substitution rules take care of replacing the module dependency with the project dependency, but do not implicitly include the project in the build.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec:disabling_resolution_transitive_dependencies"><a class="anchor" href="#sec:disabling_resolution_transitive_dependencies"></a><a class="link" href="#sec:disabling_resolution_transitive_dependencies">Disabling transitive resolution</a></h3>
<div class="paragraph">
<p>By default Gradle resolves all transitive dependencies specified by the dependency metadata.
Sometimes this behavior may not be desirable e.g. if the metadata is incorrect or defines a large graph of transitive dependencies.
You can tell Gradle to disable transitive dependency management for a dependency by setting <a href="../javadoc/org/gradle/api/artifacts/ModuleDependency.html#setTransitive-boolean-">ModuleDependency.setTransitive(boolean)</a> to <code>false</code>.
As a result only the main artifact will be resolved for the declared dependency.</p>
</div>
<div class="exampleblock">
<div class="title">Example 114. Disabling transitive dependency resolution for a declared dependency</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">dependencies {
    implementation('com.google.guava:guava:23.0') {
        transitive = false
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">dependencies {
    implementation("com.google.guava:guava:23.0") {
        isTransitive = false
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Disabling transitive dependency resolution will likely require you to declare the necessary runtime dependencies in your build script which otherwise would have been resolved automatically. Not doing so might lead to runtime classpath issues.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A project can decide to disable transitive dependency resolution completely.
You either don&#8217;t want to rely on the metadata published to the consumed repositories or you want to gain full control over the dependencies in your graph.
For more information, see <a href="../javadoc/org/gradle/api/artifacts/Configuration.html#setTransitive-boolean-">Configuration.setTransitive(boolean)</a>.</p>
</div>
<div class="exampleblock">
<div class="title">Example 115. Disabling transitive dependency resolution on the configuration-level</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">configurations.all {
    transitive = false
}

dependencies {
    implementation 'com.google.guava:guava:23.0'
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">configurations.all {
    isTransitive = false
}

dependencies {
    implementation("com.google.guava:guava:23.0")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="changing_configuration_dependencies_prior_to_resolution"><a class="anchor" href="#changing_configuration_dependencies_prior_to_resolution"></a><a class="link" href="#changing_configuration_dependencies_prior_to_resolution">Changing configuration dependencies prior to resolution</a></h3>
<div class="paragraph">
<p>At times, a plugin may want to modify the dependencies of a configuration before it is resolved.
The <code>withDependencies</code> method permits dependencies to be added, removed or modified programmatically.</p>
</div>
<div class="exampleblock">
<div class="title">Example 116. Modifying dependencies on a configuration</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">configurations {
    implementation {
        withDependencies { DependencySet dependencies -&gt;
            ExternalModuleDependency dep = dependencies.find { it.name == 'to-modify' } as ExternalModuleDependency
            dep.version {
                strictly "1.2"
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">configurations {
    create("implementation") {
        withDependencies {
            val dep = this.find { it.name == "to-modify" } as ExternalModuleDependency
            dep.version {
                strictly("1.2")
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec:configuration_defaults"><a class="anchor" href="#sec:configuration_defaults"></a><a class="link" href="#sec:configuration_defaults">Setting default configuration dependencies</a></h3>
<div class="paragraph">
<p>A configuration can be configured with default dependencies to be used if no dependencies are explicitly set for the configuration.
A primary use case of this functionality is for developing plugins that make use of versioned tools that the user might override.
By specifying default dependencies, the plugin can use a default version of the tool only if the user has not specified a particular version to use.</p>
</div>
<div class="exampleblock">
<div class="title">Example 117. Specifying default dependencies on a configuration</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">configurations {
    pluginTool {
        defaultDependencies { dependencies -&gt;
            dependencies.add(project.dependencies.create("org.gradle:my-util:1.0"))
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">configurations {
    create("pluginTool") {
        defaultDependencies {
            add(project.dependencies.create("org.gradle:my-util:1.0"))
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="excluding_a_dependency_from_a_configuration_completely"><a class="anchor" href="#excluding_a_dependency_from_a_configuration_completely"></a><a class="link" href="#excluding_a_dependency_from_a_configuration_completely">Excluding a dependency from a configuration completely</a></h3>
<div class="paragraph">
<p>Similar to <a href="#sec:excluding-transitive-deps">excluding a dependency in a dependency declaration</a>, you can exclude a transitive dependency for a particular configuration completely by using <a href="../dsl/org.gradle.api.artifacts.Configuration.html#org.gradle.api.artifacts.Configuration:exclude(java.util.Map)">Configuration.exclude(java.util.Map)</a>.
This will automatically exclude the transitive dependency for all dependencies declared on the configuration.</p>
</div>
<div class="exampleblock">
<div class="title">Example 118. Excluding transitive dependency for a particular configuration</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">configurations {
    implementation {
        exclude group: 'commons-collections', module: 'commons-collections'
    }
}

dependencies {
    implementation 'commons-beanutils:commons-beanutils:1.9.4'
    implementation 'com.opencsv:opencsv:4.6'
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">configurations {
    "implementation" {
        exclude(group = "commons-collections", module = "commons-collections")
    }
}

dependencies {
    implementation("commons-beanutils:commons-beanutils:1.9.4")
    implementation("com.opencsv:opencsv:4.6")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="matching_dependencies_to_repositories"><a class="anchor" href="#matching_dependencies_to_repositories"></a><a class="link" href="#matching_dependencies_to_repositories">Matching dependencies to repositories</a></h3>
<div class="paragraph">
<p>Gradle exposes an API to declare what a repository may or may not contain.
This feature offers a fine grained control on which repository serve which artifacts, which can be one way of controlling the source of dependencies.</p>
</div>
<div class="paragraph">
<p>Head over to <a href="#sec:repository-content-filtering">the section on repository content filtering</a> to know more about this feature.</p>
</div>
</div>
<div class="sect2">
<h3 id="sec:ivy_dynamic_resolve_mode"><a class="anchor" href="#sec:ivy_dynamic_resolve_mode"></a><a class="link" href="#sec:ivy_dynamic_resolve_mode">Enabling Ivy dynamic resolve mode</a></h3>
<div class="paragraph">
<p>Gradle&#8217;s Ivy repository implementations support the equivalent to Ivy&#8217;s dynamic resolve mode.
Normally, Gradle will use the <code>rev</code> attribute for each dependency definition included in an <code>ivy.xml</code> file.
In dynamic resolve mode, Gradle will instead prefer the <code>revConstraint</code> attribute over the <code>rev</code> attribute for a given dependency definition.
If the <code>revConstraint</code> attribute is not present, the <code>rev</code> attribute is used instead.</p>
</div>
<div class="paragraph">
<p>To enable dynamic resolve mode, you need to set the appropriate option on the repository definition.
A couple of examples are shown below.
Note that dynamic resolve mode is only available for Gradle&#8217;s Ivy repositories.
It is not available for Maven repositories, or custom Ivy <code>DependencyResolver</code> implementations.</p>
</div>
<div class="exampleblock">
<div class="title">Example 119. Enabling dynamic resolve mode</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">// Can enable dynamic resolve mode when you define the repository
repositories {
    ivy {
        url "http://repo.mycompany.com/repo"
        resolve.dynamicMode = true
    }
}

// Can use a rule instead to enable (or disable) dynamic resolve mode for all repositories
repositories.withType(IvyArtifactRepository) {
    resolve.dynamicMode = true
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">// Can enable dynamic resolve mode when you define the repository
repositories {
    ivy {
        url = uri("http://repo.mycompany.com/repo")
        resolve.isDynamicMode = true
    }
}

// Can use a rule instead to enable (or disable) dynamic resolve mode for all repositories
repositories.withType&lt;IvyArtifactRepository&gt; {
    resolve.isDynamicMode = true
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<h1 id="producing_and_consuming_variants_of_libraries" class="sect0"><a class="anchor" href="#producing_and_consuming_variants_of_libraries"></a><a class="link" href="#producing_and_consuming_variants_of_libraries">Producing and Consuming Variants of Libraries</a></h1>
<div class="sect1">
<h2 id="declaring-component-capabilities"><a class="anchor" href="#declaring-component-capabilities"></a><a class="link" href="#declaring-component-capabilities">Declaring Capabilities of a Library</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="capabilities_as_first_level_concept"><a class="anchor" href="#capabilities_as_first_level_concept"></a><a class="link" href="#capabilities_as_first_level_concept">Capabilities as first-level concept</a></h3>
<div class="paragraph">
<p>Components provide a number of features which are often orthogonal to the software architecture used to provide those features.
For example, a library may include several features in a single artifact.
However, such a library would be published at single GAV (group, artifact and version) coordinates.
This means that, at single coordinates, potentially co-exist different "features" of a component.</p>
</div>
<div class="paragraph">
<p>With Gradle it becomes interesting to explicitly declare what features a component provides.
For this, Gradle provides the concept of <a href="#sec:adding-constraints-transitive-deps">capability</a>.</p>
</div>
<div class="paragraph">
<p>A feature is often built by combining different <em>capabilities</em>.</p>
</div>
<div class="paragraph">
<p>In an ideal world, components shouldn&#8217;t declare dependencies on explicit GAVs, but rather express their requirements in terms of capabilities:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>"give me a component which provides logging"</p>
</li>
<li>
<p>"give me a scripting engine"</p>
</li>
<li>
<p>"give me a scripting engine that supports Groovy"</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>By modeling <em>capabilities</em>, the dependency management engine can be smarter and tell you whenever you have <em>incompatible capabilities</em> in a dependency graph, or ask you to choose whenever different modules in a graph provide the same <em>capability</em>.</p>
</div>
</div>
<div class="sect2">
<h3 id="sec:declaring-capabilities-external-modules"><a class="anchor" href="#sec:declaring-capabilities-external-modules"></a><a class="link" href="#sec:declaring-capabilities-external-modules">Declaring capabilities for external modules</a></h3>
<div class="paragraph">
<p>It&#8217;s worth noting that Gradle supports declaring capabilities for components you build, but also for external components in case they didn&#8217;t.</p>
</div>
<div class="paragraph">
<p>For example, if your build file contains the following dependencies:</p>
</div>
<div class="exampleblock">
<div class="title">Example 120. A build file with an implicit conflict of logging frameworks</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">dependencies {
    // This dependency will bring log4:log4j transitively
    implementation 'org.apache.zookeeper:zookeeper:3.4.9'

    // We use log4j over slf4j
    implementation 'org.slf4j:log4j-over-slf4j:1.7.10'
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">dependencies {
    // This dependency will bring log4:log4j transitively
    implementation("org.apache.zookeeper:zookeeper:3.4.9")

    // We use log4j over slf4j
    implementation("org.slf4j:log4j-over-slf4j:1.7.10")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>As is, it&#8217;s pretty hard to figure out that you will end up with two logging frameworks on the classpath.
In fact, <code>zookeeper</code> will bring in <code>log4j</code>, where what we want to use is <code>log4j-over-slf4j</code>.
We can preemptively detect the conflict by adding a rule which will declare that both logging frameworks provide the same capability:</p>
</div>
<div class="exampleblock">
<div class="title">Example 121. A build file with an implicit conflict of logging frameworks</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">dependencies {
    // Activate the "LoggingCapability" rule
    components.all(LoggingCapability)
}

@CompileStatic
class LoggingCapability implements ComponentMetadataRule {
    final static Set&lt;String&gt; LOGGING_MODULES = ["log4j", "log4j-over-slf4j"] as Set&lt;String&gt;

    void execute(ComponentMetadataContext context) {
        context.details.with {
            if (LOGGING_MODULES.contains(id.name)) {
                allVariants {
                    it.withCapabilities {
                        // Declare that both log4j and log4j-over-slf4j provide the same capability
                        it.addCapability("log4j", "log4j", id.version)
                    }
                }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">dependencies {
    // Activate the "LoggingCapability" rule
    components.all(LoggingCapability::class.java)
}

class LoggingCapability : ComponentMetadataRule {
    val loggingModules = setOf("log4j", "log4j-over-slf4j")

    override
    fun execute(context: ComponentMetadataContext) = context.details.run {
        if (loggingModules.contains(id.name)) {
            allVariants {
                withCapabilities {
                    // Declare that both log4j and log4j-over-slf4j provide the same capability
                    addCapability("log4j", "log4j", id.version)
                }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>By adding this rule, we will make sure that Gradle <em>will</em> detect conflicts and properly fail:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt; Could not resolve all files for configuration ':compileClasspath'.
   &gt; Could not resolve org.slf4j:log4j-over-slf4j:1.7.10.
     Required by:
         project :
      &gt; Module 'org.slf4j:log4j-over-slf4j' has been rejected:
           Cannot select module with conflict on capability 'log4j:log4j:1.7.10' also provided by [log4j:log4j:1.2.16(compile)]
   &gt; Could not resolve log4j:log4j:1.2.16.
     Required by:
         project : &gt; org.apache.zookeeper:zookeeper:3.4.9
      &gt; Module 'log4j:log4j' has been rejected:
           Cannot select module with conflict on capability 'log4j:log4j:1.2.16' also provided by [org.slf4j:log4j-over-slf4j:1.7.10(compile)]</pre>
</div>
</div>
<div class="paragraph">
<p>See the <a href="#sub:selecting-between-candidates">capabilities section of the documentation</a> to figure out how to fix capability conflicts.</p>
</div>
</div>
<div class="sect2">
<h3 id="declaring_additional_capabilities_for_a_local_component"><a class="anchor" href="#declaring_additional_capabilities_for_a_local_component"></a><a class="link" href="#declaring_additional_capabilities_for_a_local_component">Declaring additional capabilities for a local component</a></h3>
<div class="paragraph">
<p>All components have an <em>implicit capability</em> corresponding to the same GAV coordinates as the component.
This is convenient whenever a library published at different GAV coordinates is an <em>alternate implementation</em> of the same API.
However, it is also possible to declare additional <em>explicit capabilities</em> for a component:</p>
</div>
<div class="exampleblock">
<div class="title">Example 122. Declaring capabilities of a component</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">configurations {
    apiElements {
        outgoing {
            capability("com.acme:my-library:1.0")
            capability("com.other:module:1.1")
        }
    }
    runtimeElements {
        outgoing {
            capability("com.acme:my-library:1.0")
            capability("com.other:module:1.1")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">configurations {
    apiElements {
        outgoing {
            capability("com.acme:my-library:1.0")
            capability("com.other:module:1.1")
        }
    }
    runtimeElements {
        outgoing {
            capability("com.acme:my-library:1.0")
            capability("com.other:module:1.1")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Capabilities must be attached to <em>outgoing configurations</em>, which are <a href="#sec:resolvable-consumable-configs">consumable configurations</a> of a component.</p>
</div>
<div class="paragraph">
<p>This example shows that we declare two capabilities:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>com.acme:my-library:1.0</code>, which corresponds to the <em>implicit capability</em> of the library</p>
</li>
<li>
<p><code>com.other:module:1.1</code>, which corresponds to another capability of this library</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>It&#8217;s worth noting we need to do 1. because as soon as you start declaring <em>explicit</em> capabilities, then <em>all</em> capabilities need to be declared, including the <em>implicit</em> one.</p>
</div>
<div class="paragraph">
<p>The second capability can be specific to this library, or it can correspond to a capability provided by an external component.
In that case, if <code>com.other:module</code> appears in the same dependency graph, the build will fail and consumers <a href="#sub:selecting-between-candidates">will have to choose what module to use</a>.</p>
</div>
<div class="paragraph">
<p>Capabilities are published to Gradle Module Metadata.
However, they have <em>no equivalent</em> in POM or Ivy metadata files.
As a consequence, when publishing such a component, Gradle will warn you that this feature is only for Gradle consumers:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Maven publication 'maven' contains dependencies that cannot be represented in a published pom file.
  - Declares capability com.acme:my-library:1.0
  - Declares capability com.other:module:1.1</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="feature_variants"><a class="anchor" href="#feature_variants"></a><a class="link" href="#feature_variants">Modeling feature variants and optional dependencies</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Gradle supports the concept of <em>feature variants</em>: when building a library, it&#8217;s often the case that some features should only be available when some dependencies are present, or when special artifacts are used.</p>
</div>
<div class="paragraph">
<p>Feature variants let consumers choose what <em>features</em> of a library they need: the dependency management engine will select the right artifacts and dependencies.</p>
</div>
<div class="paragraph">
<p>This allows for a number of different scenarios (list is non-exhaustive):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a (better) substitute for <a href="https://maven.apache.org/guides/introduction/introduction-to-optional-and-excludes-dependencies.html">Maven optional dependencies</a></p>
</li>
<li>
<p>a <em>main</em> library is built with support for different mutually-exclusive implementations of runtime features; the <a href="#sec::incompatible_variants">user must choose one, and only one, implementation of each such feature</a></p>
</li>
<li>
<p>a <em>main</em> library is built with support for optional runtime features, each of which requires a different set of dependencies</p>
</li>
<li>
<p>a <em>main</em> library comes with secondary variants like <em>test fixtures</em></p>
</li>
<li>
<p>a <em>main</em> library comes with a main artifact, and enabling an additional feature requires additional artifacts</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="sec::feature_variant_selection"><a class="anchor" href="#sec::feature_variant_selection"></a><a class="link" href="#sec::feature_variant_selection">Selection of feature variants and capabilities</a></h3>
<div class="paragraph">
<p>Declaring a dependency on a component is usually done by providing a set of coordinates (group, artifact, version also known as GAV coordinates).
This allows the engine to determine the <em>component</em> we&#8217;re looking for, but such a component may provide different <em>variants</em>.
A <em>variant</em> is typically chosen based on the usage. For example, we might choose a different variant for compiling against a component (in which case we need the API of the component) or when executing code (in which case we need the runtime of the component).
All variants of a component provide a number of <a href="#sub:capabilities">capabilities</a>, which are denoted similarly using GAV coordinates.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>A capability is denoted by GAV coordinates, but you must think of it as feature description:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>"I provide an SLF4J binding"</p>
</li>
<li>
<p>"I provide runtime support for MySQL"</p>
</li>
<li>
<p>"I provide a Groovy runtime"</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>And in general, having two components that provide the <em>same thing</em> in the graph is a problem (they conflict).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This is an important concept because:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>by default a variant provides a capability corresponding to the GAV coordinates of its component</p>
</li>
<li>
<p>it is not allowed to have different components or different variants of a component in a dependency graph if they provide the same capability</p>
</li>
<li>
<p>it is allowed to select two variants of the same component, as long as they provide <em>different capabilities</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A typical component will <strong>only</strong> provide variants with the default capability.
A Java library, for example, exposes two variants (API and runtime) which provide the <em>same capability</em>.
As a consequence, it is an error to have both the <em>API</em> and <em>runtime</em> of a single component in a dependency graph.</p>
</div>
<div class="paragraph">
<p>However, imagine that you need the <em>runtime</em> and the <em>test fixtures</em> of a component.
Then it is allowed as long as the <em>runtime</em> and <em>test fixtures</em> variant of the library declare different capabilities.</p>
</div>
<div class="paragraph">
<p>If we do so, a consumer would then have to declare two dependencies:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>one on the "main" variant, the library</p>
</li>
<li>
<p>one on the "test fixtures" variant, by <em>requiring its capability</em></p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>While the engine supports feature variants independently of the ecosystem, this feature is currently only available using the Java plugins and is incubating.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="sec::declare_feature_variants"><a class="anchor" href="#sec::declare_feature_variants"></a><a class="link" href="#sec::declare_feature_variants">Declaring feature variants</a></h3>
<div class="paragraph">
<p>Feature variants can be declared by applying the <code>java</code> or <code>java-library</code> plugins.
The following code illustrates how to declare a feature named <code>mongodbSupport</code>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 123. Declaring a feature variant</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">group = 'org.gradle.demo'
version = '1.0'

java {
    registerFeature('mongodbSupport') {
        usingSourceSet(sourceSets.main)
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">group = "org.gradle.demo"
version = "1.0"

java {
    registerFeature("mongodbSupport") {
        usingSourceSet(sourceSets["main"])
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Gradle will automatically setup a number of things for you, in a very similar way to how the <a href="java_library_plugin.html#java_library_plugin">Java Library Plugin</a> sets up configurations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the configuration <code>mongodbSupportApi</code>, used to <em>declare API dependencies</em> for this feature</p>
</li>
<li>
<p>the configuration <code>mongodbSupportImplementation</code>, used to <em>declare implementation dependencies</em> for this feature</p>
</li>
<li>
<p>the configuration <code>mongodbSupportApiElements</code>, used by consumers to fetch the artifacts and API dependencies of this feature</p>
</li>
<li>
<p>the configuration <code>mongodbSupportRuntimeElements</code>, used by consumers to fetch the artifacts and runtime dependencies of this feature</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Most users will only need to care about the first two configurations, to declare the specific dependencies of this feature:</p>
</div>
<div class="exampleblock">
<div class="title">Example 124. Declaring dependencies of a feature</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">dependencies {
    mongodbSupportImplementation 'org.mongodb:mongodb-driver-sync:3.9.1'
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">dependencies {
    "mongodbSupportImplementation"("org.mongodb:mongodb-driver-sync:3.9.1")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>By convention, Gradle maps the feature name to a capability whose group and version are the same as the group and version of the main component, respectively, but whose name is the main component name followed by a <code>-</code> followed by the kebab-cased feature name.</p>
</div>
<div class="paragraph">
<p>For example, if the group is <code>org.gradle.demo</code>, the name of the component is <code>provider</code>, its version is <code>1.0</code> and the feature is named <code>mongodbSupport</code>, the feature variant will be <code>org.gradle.demo:provider-mongodb-support:1.0</code>.</p>
</div>
<div class="paragraph">
<p>If you choose the capability name yourself or add more capabilities to a variant, it is recommended to follow the same convention.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="sec:feature_variant_source_set"><a class="anchor" href="#sec:feature_variant_source_set"></a><a class="link" href="#sec:feature_variant_source_set">Feature variant source set</a></h4>
<div class="paragraph">
<p>In the previous example, we&#8217;re declaring a feature variant which uses the <em>main source set</em>.
This is a typical use case in the Java ecosystem, where it&#8217;s, for whatever reason, not possible to split the sources of a project into different subprojects or different source sets.
Gradle will therefore declare the configurations as described, but will also setup the compile classpath and runtime classpath of the <em>main source set</em> so that it extends from the feature configuration.
Said differently, this allows you to declare the dependencies specific to a feature in their own "bucket", but everything is still compiled as a single source set.
There will also be a single artifact (the component Jar) including support for all features.</p>
</div>
<div class="paragraph">
<p>However, it is often preferred to have a <em>separate source set</em> for a feature. Gradle will then perform a similar mapping, but will <em>not</em> make the compile and runtime classpath of the main component extend from the dependencies of the registered features.
It will also, by convention, create a <code>Jar</code> task to bundle the classes built from this feature source set, using a classifier corresponding to the kebab-case name of the feature:</p>
</div>
<div class="exampleblock">
<div class="title">Example 125. Declaring a feature variant using a separate source set</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">sourceSets {
    mongodbSupport {
        java {
            srcDir 'src/mongodb/java'
        }
    }
}

java {
    registerFeature('mongodbSupport') {
        usingSourceSet(sourceSets.mongodbSupport)
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">sourceSets {
    create("mongodbSupport") {
        java {
            srcDir("src/mongodb/java")
        }
    }
}

java {
    registerFeature("mongodbSupport") {
        usingSourceSet(sourceSets["mongodbSupport"])
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec::publishing_feature_variants"><a class="anchor" href="#sec::publishing_feature_variants"></a><a class="link" href="#sec::publishing_feature_variants">Publishing feature variants</a></h3>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Depending on the metadata file format, publishing feature variants may be lossy:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>using <a href="https://github.com/gradle/gradle/blob/master/subprojects/docs/src/docs/design/gradle-module-metadata-latest-specification.md">Gradle Module Metadata</a>, everything is published and consumers will get the full benefit of feature variants</p>
</li>
<li>
<p>using POM metadata (Maven), feature variants are published as <strong>optional dependencies</strong> and artifacts of feature variants are published with different <em>classifiers</em></p>
</li>
<li>
<p>using Ivy metadata, feature variants are published as extra configurations, which are <em>not</em> extended by the <code>default</code> configuration</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Publishing feature variants is supported using the <code>maven-publish</code> and <code>ivy-publish</code> plugins only.
The Java Plugin (or Java Library Plugin) will take care of registering the additional variants for you, so there&#8217;s no additional configuration required, only the regular publications:</p>
</div>
<div class="exampleblock">
<div class="title">Example 126. Publishing a component with feature variants</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">plugins {
    id 'java-library'
    id 'maven-publish'
}
// ...
publishing {
    publications {
        myLibrary(MavenPublication) {
            from components.java
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">plugins {
    `java-library`
    `maven-publish`
}
// ...
publishing {
    publications {
        create("myLibrary", MavenPublication::class.java) {
            from(components["java"])
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sub:javadoc_sources_features_variants"><a class="anchor" href="#sub:javadoc_sources_features_variants"></a><a class="link" href="#sub:javadoc_sources_features_variants">Adding javadoc and sources JARs</a></h4>
<div class="paragraph">
<p>Similar to the <a href="building_java_projects.html#sec:java_packaging">main Javadoc and sources JARs</a>, you can configure the added feature variant so that it produces JARs for the Javadoc and sources.
This however only makes sense when using a source set other than the main one.</p>
</div>
<div class="exampleblock">
<div class="title">Example 127. Producing javadoc and sources JARs for feature variants</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">java {
    registerFeature('mongodbSupport') {
        usingSourceSet(sourceSets.mongodbSupport)
        withJavadocJar()
        withSourcesJar()
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">java {
    registerFeature("mongodbSupport") {
        usingSourceSet(sourceSets["mongodbSupport"])
        withJavadocJar()
        withSourcesJar()
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec::consuming_feature_variants"><a class="anchor" href="#sec::consuming_feature_variants"></a><a class="link" href="#sec::consuming_feature_variants">Dependencies on feature variants</a></h3>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>As mentioned earlier, feature variants can be lossy when published.
As a consequence, a consumer can depend on a feature variant only in these cases:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>with a project dependency (in a multi-project build)</p>
</li>
<li>
<p>with Gradle Module Metadata available, that is the publisher MUST have published it</p>
</li>
<li>
<p>within the Ivy world, by declaring a dependency on the configuration matching the feature</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A consumer can specify that it needs a specific feature of a producer by declaring required capabilities.
For example, if a producer declares a "MySQL support" feature like this:</p>
</div>
<div class="exampleblock">
<div class="title">Example 128. A library declaring a feature to support MySQL</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">java {
    registerFeature('mysqlSupport') {
        usingSourceSet(sourceSets.main)
    }
}

dependencies {
    mysqlSupportImplementation 'mysql:mysql-connector-java:8.0.14'
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">java {
    registerFeature("mysqlSupport") {
        usingSourceSet(sourceSets["main"])
    }
}

dependencies {
    "mysqlSupportImplementation"("mysql:mysql-connector-java:8.0.14")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Then the consumer can declare a dependency on the MySQL support feature by doing this:</p>
</div>
<div class="exampleblock">
<div class="title">Example 129. Consuming specific features in a multi-project build</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">dependencies {
    // This project requires the main producer component
    implementation(project(":producer"))

    // But we also want to use its MySQL support
    runtimeOnly(project(":producer")) {
        capabilities {
            requireCapability("org.gradle.demo:producer-mysql-support")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">dependencies {
    // This project requires the main producer component
    implementation(project(":producer"))

    // But we also want to use its MySQL support
    runtimeOnly(project(":producer")) {
        capabilities {
            requireCapability("org.gradle.demo:producer-mysql-support")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This will automatically bring the <code>mysql-connector-java</code> dependency on the runtime classpath.
If there were more than one dependency, all of them would be brought, meaning that a feature can be used to group dependencies which contribute to a feature together.</p>
</div>
<div class="paragraph">
<p>Similarly, if an external library with feature variants was published with <a href="https://github.com/gradle/gradle/blob/master/subprojects/docs/src/docs/design/gradle-module-metadata-latest-specification.md">Gradle Module Metadata</a>, it is possible to depend on a feature provided by that library:</p>
</div>
<div class="exampleblock">
<div class="title">Example 130. Consuming specific features from an external repository</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">dependencies {
    // This project requires the main producer component
    implementation('org.gradle.demo:producer:1.0')

    // But we also want to use its MongoDB support
    runtimeOnly('org.gradle.demo:producer:1.0') {
        capabilities {
            requireCapability("org.gradle.demo:producer-mongodb-support")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">dependencies {
    // This project requires the main producer component
    implementation("org.gradle.demo:producer:1.0")

    // But we also want to use its MongoDB support
    runtimeOnly("org.gradle.demo:producer:1.0") {
        capabilities {
            requireCapability("org.gradle.demo:producer-mongodb-support")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec::incompatible_variants"><a class="anchor" href="#sec::incompatible_variants"></a><a class="link" href="#sec::incompatible_variants">Handling mutually exclusive variants</a></h3>
<div class="paragraph">
<p>The main advantage of using <em>capabilities</em> as a way to handle features is that you can precisely handle compatibility of variants.
The rule is simple:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>It&#8217;s not allowed to have two variants of components that provide the same capability in a single dependency graph.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>We can leverage that to ask Gradle to fail whenever the user mis-configures dependencies.
Imagine, for example, that your library supports MySQL, Postgres and MongoDB, but that it&#8217;s only allowed to choose <em>one</em> of those at the same time.
Not allowed should directly translate to "provide the same capability", so there must be a capability provided by all three features:</p>
</div>
<div class="exampleblock">
<div class="title">Example 131. A producer of multiple features that are mutually exclusive</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">java {
    registerFeature('mysqlSupport') {
        usingSourceSet(sourceSets.main)
        capability('org.gradle.demo', 'producer-db-support', '1.0')
        capability('org.gradle.demo', 'producer-mysql-support', '1.0')
    }
    registerFeature('postgresSupport') {
        usingSourceSet(sourceSets.main)
        capability('org.gradle.demo', 'producer-db-support', '1.0')
        capability('org.gradle.demo', 'producer-postgres-support', '1.0')
    }
    registerFeature('mongoSupport') {
        usingSourceSet(sourceSets.main)
        capability('org.gradle.demo', 'producer-db-support', '1.0')
        capability('org.gradle.demo', 'producer-mongo-support', '1.0')
    }
}

dependencies {
    mysqlSupportImplementation 'mysql:mysql-connector-java:8.0.14'
    postgresSupportImplementation 'org.postgresql:postgresql:42.2.5'
    mongoSupportImplementation 'org.mongodb:mongodb-driver-sync:3.9.1'
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">java {
    registerFeature("mysqlSupport") {
        usingSourceSet(sourceSets["main"])
        capability("org.gradle.demo", "producer-db-support", "1.0")
        capability("org.gradle.demo", "producer-mysql-support", "1.0")
    }
    registerFeature("postgresSupport") {
        usingSourceSet(sourceSets["main"])
        capability("org.gradle.demo", "producer-db-support", "1.0")
        capability("org.gradle.demo", "producer-postgres-support", "1.0")
    }
    registerFeature("mongoSupport") {
        usingSourceSet(sourceSets["main"])
        capability("org.gradle.demo", "producer-db-support", "1.0")
        capability("org.gradle.demo", "producer-mongo-support", "1.0")
    }
}

dependencies {
    "mysqlSupportImplementation"("mysql:mysql-connector-java:8.0.14")
    "postgresSupportImplementation"("org.postgresql:postgresql:42.2.5")
    "mongoSupportImplementation"("org.mongodb:mongodb-driver-sync:3.9.1")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Here, the producer declares 3 variants, one for each database runtime support:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>mysql-support</code> provides both the <code>db-support</code> and <code>mysql-support</code> capabilities</p>
</li>
<li>
<p><code>postgres-support</code> provides both the <code>db-support</code> and <code>postgres-support</code> capabilities</p>
</li>
<li>
<p><code>mongo-support</code> provides both the <code>db-support</code> and <code>mongo-support</code> capabilities</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Then if the consumer tries to get both the <code>postgres-support</code> and <code>mysql-support</code> like this (this also works transitively):</p>
</div>
<div class="exampleblock">
<div class="title">Example 132. A consumer trying to use 2 incompatible variants at the same time</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">dependencies {
    implementation(project(":producer"))

    // Let's try to ask for both MySQL and Postgres support
    runtimeOnly(project(":producer")) {
        capabilities {
            requireCapability("org.gradle.demo:producer-mysql-support")
        }
    }
    runtimeOnly(project(":producer")) {
        capabilities {
            requireCapability("org.gradle.demo:producer-postgres-support")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">dependencies {
    // This project requires the main producer component
    implementation(project(":producer"))

    // Let's try to ask for both MySQL and Postgres support
    runtimeOnly(project(":producer")) {
        capabilities {
            requireCapability("org.gradle.demo:producer-mysql-support")
        }
    }
    runtimeOnly(project(":producer")) {
        capabilities {
            requireCapability("org.gradle.demo:producer-postgres-support")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Dependency resolution would fail with the following error:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Cannot choose between
   org.gradle.demo:producer:1.0 variant mysqlSupportRuntimeElements and
   org.gradle.demo:producer:1.0 variant postgresSupportRuntimeElements
   because they provide the same capability: org.gradle.demo:producer-db-support:1.0</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="understanding-variant-selection"><a class="anchor" href="#understanding-variant-selection"></a><a class="link" href="#understanding-variant-selection">Understanding variant selection</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Gradle&#8217;s dependency management engine is known as <em>variant aware</em>.
In a traditional dependency management engine like Apache Maven, dependencies are bound to components published at GAV coordinates.
This means that the set of transitive dependencies for a component is solely determined by the GAV coordinates of this component.
It doesn&#8217;t matter what <em>artifact</em> is actually resolved, the set of dependencies is <em>always the same</em>.
In addition, selecting a different artifact for a component (for example, using the <code>jdk7</code> artifact) is cumbersome as it requires the use of <em>classifiers</em>.
One issue with this model is that it cannot guarantee global graph consistency because there are no common semantics associated with <em>classifiers</em>.
What this means is that there&#8217;s nothing which prevents from having both the <code>jdk7</code> and <code>jdk8</code> versions of a single module on classpath, because the engine has no idea what semantics are associated with the classifier name.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/component-model-maven.png" alt="component model maven">
</div>
<div class="title">Figure 11. The Maven component model</div>
</div>
<div class="paragraph">
<p>Gradle, in addition to the concept of a <em>module</em> published at GAV coordinates, introduces the concept of <em>variants</em> of this module.
Variants correspond to the different "views" of a component that is published at the same GAV coordinates.
In the Gradle model, artifacts are attached to <em>variants</em>, not modules.
This means, in practice, that different <em>artifacts</em> can have a different set of dependencies:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/component-model-gradle.png" alt="component model gradle">
</div>
<div class="title">Figure 12. The Gradle component model</div>
</div>
<div class="paragraph">
<p>This intermediate level, which associates artifacts and dependencies to variants instead of directly to the component, allows Gradle to model properly what each artifact is used for.</p>
</div>
<div class="paragraph">
<p>However, this raises the question about how variants are selected: how does Gradle know which variant to choose when there&#8217;s more than one?
In practice, variants are selected thanks to the use of <a href="#">attributes</a>, which provide semantics to the variants and help the engine in achieving a <em>consistent resolution result</em>.</p>
</div>
<div class="paragraph">
<p>For historical reasons, Gradle differentiates between two kind of components:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>local components, built from sources, for which <a href="#sec:abm_configuration_attributes">variants are mapped to outgoing configurations</a></p>
</li>
<li>
<p>external components, published on repositories, in which case either the module was published with Gradle Module Metadata and variants are natively supported, or the module is using Ivy/Maven metadata and <a href="#sec:mapping-maven-ivy-to-variants">variants are derived from metadata</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In both cases, Gradle performs <em>variant aware selection</em>.</p>
</div>
<div class="sect2">
<h3 id="sec:abm_configuration_attributes"><a class="anchor" href="#sec:abm_configuration_attributes"></a><a class="link" href="#sec:abm_configuration_attributes">Configuration and variant attributes</a></h3>
<div class="paragraph">
<p>Local components expose variants as <em>outgoing configurations</em>, which are <a href="#sec:resolvable-consumable-configs">consumable configurations</a>.
When dependency resolution happens, the engine will select one variant of an outgoing component by selecting one of its <em>consumable configurations</em>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>There are 2 noticeable exception to this rule:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>whenever a producer does <em>not</em> expose any consumable configuration</p>
</li>
<li>
<p>whenever the consumer <em>explicitly selects a target configuration</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In this case, <em>variant aware resolution is bypassed</em>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Attributes are used on both <em>resolvable configurations</em> (also known as a <em>consumer</em>) and <em>consumable configurations</em> (on the <em>producer</em>).
Adding attributes to other kinds of configurations simply has no effect, as attributes are not inherited between configurations.</p>
</div>
<div class="paragraph">
<p>The role of the dependency resolution engine is to find a suitable <em>variant</em> of a <em>producer</em> given the constraints expressed by a <em>consumer</em>.</p>
</div>
<div class="paragraph">
<p>This is where attributes come into play: their role is to perform the selection of the right <em>variant</em> of a component.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Variants vs configurations</div>
<div class="paragraph">
<p>For external components, the terminology is to use the word <em>variants</em>, not <em>configurations</em>. Configurations are a super-set of variants.</p>
</div>
<div class="paragraph">
<p>This means that an external component provides <em>variants</em>, which also have attributes.
However, sometimes the term <em>configuration</em> may leak into the DSL for historical reasons, or because you use Ivy which also has this concept of <em>configuration</em>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="sec:variant-visual"><a class="anchor" href="#sec:variant-visual"></a><a class="link" href="#sec:variant-visual">Visualizing variant information</a></h3>
<div class="paragraph">
<p>Gradle offers a report task called <code>outgoingVariants</code> that displays the variants of a project, with their capabilities, attributes and artifacts.
It is conceptually similar to the <code>dependencyInsight</code> <a href="#sec:identifying_reason_dependency_selection">reporting task</a>.</p>
</div>
<div class="paragraph">
<p>By default, <code>outgoingVariants</code> prints information about all variants.
It offers the optional parameter <code>--variant &lt;variantName&gt;</code> to select a single variant to display.
It also accepts the <code>-all</code> flag to include information about legacy and deprecated configurations.</p>
</div>
<div class="paragraph">
<p>Here is the output of the <code>outgoingVariants</code> task on a freshly generated <code>java-library</code> project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt; Task :outgoingVariants
--------------------------------------------------
Variant apiElements
--------------------------------------------------
Description = API elements for main.

Capabilities
    - [default capability]
Attributes
    - org.gradle.category            = library
    - org.gradle.dependency.bundling = external
    - org.gradle.jvm.version         = 8
    - org.gradle.libraryelements     = jar
    - org.gradle.usage               = java-api

Artifacts
    - build/libs/variant-report.jar (artifactType = jar)

Secondary variants (*)
    - Variant : classes
       - Attributes
          - org.gradle.category            = library
          - org.gradle.dependency.bundling = external
          - org.gradle.jvm.version         = 8
          - org.gradle.libraryelements     = classes
          - org.gradle.usage               = java-api
       - Artifacts
          - build/classes/java/main (artifactType = java-classes-directory)

--------------------------------------------------
Variant runtimeElements
--------------------------------------------------
Description = Elements of runtime for main.

Capabilities
    - [default capability]
Attributes
    - org.gradle.category            = library
    - org.gradle.dependency.bundling = external
    - org.gradle.jvm.version         = 8
    - org.gradle.libraryelements     = jar
    - org.gradle.usage               = java-runtime

Artifacts
    - build/libs/variant-report.jar (artifactType = jar)

Secondary variants (*)
    - Variant : classes
       - Attributes
          - org.gradle.category            = library
          - org.gradle.dependency.bundling = external
          - org.gradle.jvm.version         = 8
          - org.gradle.libraryelements     = classes
          - org.gradle.usage               = java-runtime
       - Artifacts
          - build/classes/java/main (artifactType = java-classes-directory)
    - Variant : resources
       - Attributes
          - org.gradle.category            = library
          - org.gradle.dependency.bundling = external
          - org.gradle.jvm.version         = 8
          - org.gradle.libraryelements     = resources
          - org.gradle.usage               = java-runtime
       - Artifacts
          - build/resources/main (artifactType = java-resources-directory)


(*) Secondary variants are variants created via the Configuration#getOutgoing(): ConfigurationPublications API which also participate in selection, in addition to the configuration itself.</pre>
</div>
</div>
<div class="paragraph">
<p>From this you can see the two main variants that are exposed by a java library, <code>apiElements</code> and <code>runtimeElements</code>.
Notice that the main difference is on the <code>org.gradle.usage</code> attribute, with values <code>java-api</code> and <code>java-runtime</code>.
As they indicate, this is where the difference is made between what needs to be on the <em>compile</em> classpath of consumers, versus what&#8217;s needed on the <em>runtime</em> classpath.</p>
</div>
<div class="paragraph">
<p>It also shows <em>secondary</em> variants, which are exclusive to Gradle projects and not published.
For example, the secondary variant <code>classes</code> from <code>apiElements</code> is what allows Gradle to skip the JAR creation when compiling against a <a href="java_library_plugin.html#sec:java_library_classes_usage"><code>java-library</code> project</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="sec:variant-aware-matching"><a class="anchor" href="#sec:variant-aware-matching"></a><a class="link" href="#sec:variant-aware-matching">Variant aware matching</a></h3>
<div class="paragraph">
<p>Let&#8217;s take the example of a <code>lib</code> library which exposes 2 variants: its API (via a variant named <code>exposedApi</code>) and its runtime (via a variant named <code>exposedRuntime</code>).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">About producer variants</div>
<div class="paragraph">
<p>The variant <em>name</em> is there mostly for debugging purposes and to get a nicer display in error messages.
The name, in particular, doesn&#8217;t participate in the <em>id</em> of a variant: only its attributes do.
That is to say that to search for a particular variant, one <em>must</em> rely on its attributes, <em>not</em> its name.</p>
</div>
<div class="paragraph">
<p>There are no restrictions on the number of variants a component can expose.
Traditionally, a component would expose an API and an implementation, but we may, for example, want to expose the test fixtures of a component too.
It is also possible to expose <em>different APIs</em> for different consumers (think about different environments, like Linux vs Windows).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A consumer needs to explain <em>what</em> variant it needs and this is done by setting <em>attributes</em> on the <em>consumer</em>.</p>
</div>
<div class="paragraph">
<p>Attributes consist of a <em>name</em> and a <em>value</em> pair.
For example, Gradle comes with a standard attribute named <code>org.gradle.usage</code> specifically to deal with the concept of selecting the right variant of a component based on the usage of the consumer (compile, runtime &#8230;&#8203;).
It is however possible to define an arbitrary number of attributes.
As a producer, we can express that a consumable configuration represents the API of a component by attaching the <code>(org.gradle.usage,JAVA_API)</code> attribute to the variant.
As a consumer, we can express that we need the API of the dependencies of a resolvable configuration by attaching the <code>(org.gradle.usage,JAVA_API)</code> attribute to it.
Doing this, Gradle has a way to <em>automatically select the appropriate variant</em> by looking at the configuration attributes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the consumer wants <code>org.gradle.usage=JAVA_API</code></p>
</li>
<li>
<p>the producer, <code>lib</code> exposes 2 different variants. One with <code>org.gradle.usage=JAVA_API</code>, the other with <code>org.gradle.usage=JAVA_RUNTIME</code>.</p>
</li>
<li>
<p>Gradle chooses the <code>org.gradle.usage=JAVA_API</code> variant of the producer because it <em>matches the consumer attributes</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In other words: attributes are used to perform the selection based on the values of the attributes.</p>
</div>
<div class="paragraph">
<p>A more elaborate example involves more than one attribute.
Typically, a Java Library project in Gradle will involve 4 different attributes, found both on the producer and consumer sides:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>org.gradle.usage</code>, explaining if the variant is the API of a component, or its implementation</p>
</li>
<li>
<p><code>org.gradle.dependency.bundling</code>, which declares how the dependencies of the component are bundled (for example, if the artifact is a fat jar, then the bundling is <code>EMBEDDED</code>)</p>
</li>
<li>
<p><code>org.gradle.libraryelements</code>, which is used to explain what <em>parts</em> of the library the variant contains (classes, resources or everything)</p>
</li>
<li>
<p><code>org.gradle.jvm.version</code>, which is used to explain what <em>minimal version</em> of Java this variant is targeted at</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Now imagine that our library comes in two different flavors:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>one for JDK 8</p>
</li>
<li>
<p>one for JDK 9+</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This is typically achieved, in Maven, by producing 2 different artifacts, a "main" artifact and a "classified" one.
However, in Maven a consumer cannot express the fact it needs the <em>most appropriate</em> version of the library based on the runtime.</p>
</div>
<div class="paragraph">
<p>With Gradle, this is elegantly solved by having the producer declare 2 variants:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>one with <code>org.gradle.jvm.version=8</code>, for consumers <em>at least running on JDK 8</em></p>
</li>
<li>
<p>one with <code>org.gradle.jvm.version=9</code>, for consumers starting from JDK 9</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note that the artifacts for both variants will be different, but their dependencies <em>may</em> be different too.
Typically, the JDK 8 variant may need a "backport" library of JDK 9+ to work, that only consumers running on JDK 8 should get.</p>
</div>
<div class="paragraph">
<p>On the consumer side, the <em>resolvable configuration</em> will set all four attributes above, and, depending on the runtime, will set its <code>org.gradle.jvm.version</code> to 8 or more.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">A note about compatibility of variants</div>
<div class="paragraph">
<p>What if the consumer sets <code>org.gradle.jvm.version</code> to 7?</p>
</div>
<div class="paragraph">
<p>Then resolution would <em>fail</em> with an error message explaining that there&#8217;s no matching variant of the producer.
This is because Gradle recognizes that the consumer wants a Java 7 compatible library, but the <em>minimal</em> version of Java available on the producer is 8.
If, on the other hand, the consumer needs <em>11</em>, then Gradle knows both the <em>8</em> and <em>9</em> variant would work, but it will select <em>9</em> because it&#8217;s the highest compatible version.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="sec:variant-select-errors"><a class="anchor" href="#sec:variant-select-errors"></a><a class="link" href="#sec:variant-select-errors">Variant selection errors</a></h3>
<div class="paragraph">
<p>In the process of identifying the right variant of a component, two situations will result in a resolution error:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>More than one variant from the producer match the consumer attributes, there is variant ambiguity</p>
</li>
<li>
<p>No variant from the producer match the consumer attributes</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="sub:variant-ambiguity"><a class="anchor" href="#sub:variant-ambiguity"></a><a class="link" href="#sub:variant-ambiguity">Dealing with ambiguous variant selection errors</a></h4>
<div class="paragraph">
<p>An ambiguous variant selection looks somewhat like the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt; Could not resolve all files for configuration ':compileClasspath'.
   &gt; Could not resolve project :lib.
     Required by:
         project :ui
      &gt; Cannot choose between the following variants of project :lib:
          - feature1ApiElements
          - feature2ApiElements
        All of them match the consumer attributes:
          - Variant 'feature1ApiElements' capability org.test:test-capability:1.0:
              - Unmatched attribute:
                  - Found org.gradle.category 'library' but wasn't required.
              - Compatible attributes:
                  - Provides org.gradle.dependency.bundling 'external'
                  - Provides org.gradle.jvm.version '11'
                  - Required org.gradle.libraryelements 'classes' and found value 'jar'.
                  - Provides 'java-api'
          - Variant 'feature2ApiElements' capability org.test:test-capability:1.0:
              - Unmatched attribute:
                  - Found org.gradle.category 'library' but wasn't required.
              - Compatible attributes:
                  - Provides org.gradle.dependency.bundling 'external'
                  - Provides org.gradle.jvm.version '11'
                  - Required org.gradle.libraryelements 'classes' and found value 'jar'.
                  - Provides org.gradle.usage 'java-api'</pre>
</div>
</div>
<div class="paragraph">
<p>As can be seen, all <em>compatible</em> candidate variants are displayed, with their attributes.
These are then grouped into two sections:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Unmatched attributes are presented first, as they might be the missing piece in selecting the proper variant.</p>
</li>
<li>
<p>Compatible attributes are presented second as they indicate what the consumer wanted and how these variants do match that request.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There cannot be any mismatched attributes as the variant would not be a candidate then.
Similarly, the set of displayed variants also excludes the ones that have been disambiguated.</p>
</div>
<div class="paragraph">
<p>In the example above, the fix does not lie in attribute matching but in <a href="#sec:adding-constraints-transitive-deps">capability matching</a>, which are shown next to the variant name.
Because these two variants effectively provide the same attributes and capabilities, they cannot be disambiguated.
So in this case, the fix is most likely to provide different capabilities on the producer side (<code>project :lib</code>) and express a capability choice on the consumer side (<code>project :ui</code>).</p>
</div>
</div>
<div class="sect3">
<h4 id="sub:variant-no-match"><a class="anchor" href="#sub:variant-no-match"></a><a class="link" href="#sub:variant-no-match">Dealing with no matching variant errors</a></h4>
<div class="paragraph">
<p>A no matching variant error looks somewhat like the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt; No variants of project :lib match the consumer attributes:
  - Configuration ':lib:compile':
      - Incompatible attribute:
          - Required artifactType 'dll' and found incompatible value 'jar'.
      - Other compatible attribute:
          - Provides usage 'api'
  - Configuration ':lib:compile' variant debug:
      - Incompatible attribute:
          - Required artifactType 'dll' and found incompatible value 'jar'.
      - Other compatible attributes:
          - Found buildType 'debug' but wasn't required.
          - Provides usage 'api'
  - Configuration ':lib:compile' variant release:
      - Incompatible attribute:
          - Required artifactType 'dll' and found incompatible value 'jar'.
      - Other compatible attributes:
          - Found buildType 'release' but wasn't required.
          - Provides usage 'api'</pre>
</div>
</div>
<div class="paragraph">
<p>As can be seen, <em>all</em> candidate variants are displayed, with their attributes.
These are then grouped into two sections:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Incompatible attributes are presented first, as they usually are the key in understanding why a variant could not be selected.</p>
</li>
<li>
<p>Other attributes are presented second, this includes <em>required</em> and <em>compatible</em> ones as well as all extra <em>producer</em> attributes that are not requested by the consumer.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Similarly with the ambiguous variant error, the goal is then to understand which variant is to be selected and see which attribute or capability can be tweaked on the consumer for this to happen.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec:mapping-maven-ivy-to-variants"><a class="anchor" href="#sec:mapping-maven-ivy-to-variants"></a><a class="link" href="#sec:mapping-maven-ivy-to-variants">Mapping from Maven/Ivy to variants</a></h3>
<div class="paragraph">
<p>Neither Maven nor Ivy have the concept of <em>variants</em>, which are only natively supported by Gradle Module Metadata.
However, it doesn&#8217;t prevent Gradle from working with them thanks to different strategies.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Relationship with Gradle Module Metadata</div>
<div class="paragraph">
<p>Gradle Module Metadata is a metadata format for modules published on Maven, Ivy or other kind of repositories.
It is similar to <code>pom.xml</code> or <code>ivy.xml</code> files, but this format is <em>aware of variants</em>.
This means that if your project produces additional variants, those are available and published as part of the module metadata, which greatly improves the user experience.</p>
</div>
<div class="paragraph">
<p>See the <a href="https://github.com/gradle/gradle/blob/master/subprojects/docs/src/docs/design/gradle-module-metadata-latest-specification.md">Gradle Module Metadata specification</a> for more information.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="sub:maven-mapping-to-variants"><a class="anchor" href="#sub:maven-mapping-to-variants"></a><a class="link" href="#sub:maven-mapping-to-variants">Mapping of POM files to variants</a></h4>
<div class="paragraph">
<p>Modules published on a Maven repository are converted into variant-aware modules.
A particularity of Maven modules is that there is no way to know what kind of component is published.
In particular, there&#8217;s no way to make the difference between a BOM representing a <em>platform</em>, and a BOM used as a super-POM.
Sometimes, it is even possible for a POM file to act both as a platform <em>and</em> a library.</p>
</div>
<div class="paragraph">
<p>As a consequence, Maven modules are derived into 6 distinct variants, which allows Gradle users to explain precisely what they depend on:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>2 "library" variants (attribute <code>org.gradle.category</code> = <code>library</code>)</p>
<div class="ulist">
<ul>
<li>
<p>the <code>compile</code> variant maps the <code>&lt;scope&gt;compile&lt;/scope&gt;</code> dependencies.
This variant is equivalent to the <code>apiElements</code> variant of the <a href="java_library_plugin.html">Java Library plugin</a>.
All dependencies of this scope are considered <em>API dependencies</em>.</p>
</li>
<li>
<p>the <code>runtime</code> variant maps both the <code>&lt;scope&gt;compile&lt;/scope&gt;</code> and <code>&lt;scope&gt;runtime&lt;/scope&gt;</code> dependencies.
This variant is equivalent to the <code>runtimeElements</code> variant of the <a href="java_library_plugin.html">Java Library plugin</a>.
All dependencies of those scopes are considered <em>runtime dependencies</em>.</p>
<div class="ulist">
<ul>
<li>
<p>in both cases, the <code>&lt;dependencyManagement&gt;</code> dependencies are <em>not converted to constraints</em></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>4 "platform" variants derived from the <code>&lt;dependencyManagement&gt;</code> block (attribute <code>org.gradle.category</code> = <code>platform</code>):</p>
<div class="ulist">
<ul>
<li>
<p>the <code>platform-compile</code> variant maps the  <code>&lt;scope&gt;compile&lt;/scope&gt;</code> dependency management dependencies as <em>dependency constraints</em>.</p>
</li>
<li>
<p>the <code>platform-runtime</code> variant maps both the <code>&lt;scope&gt;compile&lt;/scope&gt;</code> and <code>&lt;scope&gt;runtime&lt;/scope&gt;</code> dependency management dependencies as <em>dependency constraints</em>.</p>
</li>
<li>
<p>the <code>enforced-platform-compile</code> is similar to <code>platform-compile</code> but all the constraints are <em>forced</em></p>
</li>
<li>
<p>the <code>enforced-platform-runtime</code> is similar to <code>platform-runtime</code> but all the constraints are <em>forced</em></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can understand more about the use of platform and enforced platforms variants by looking at the <a href="#sub:bom_import">importing BOMs</a> section of the manual.
By default, whenever you declare a dependency on a Maven module, Gradle is going to look for the <code>library</code> variants.
However, using the <code>platform</code> or <code>enforcedPlatform</code> keyword, Gradle is now looking for one of the "platform" variants, which allows you to import the constraints from the POM files, instead of the dependencies.</p>
</div>
</div>
<div class="sect3">
<h4 id="sub:ivy-mapping-to-variants"><a class="anchor" href="#sub:ivy-mapping-to-variants"></a><a class="link" href="#sub:ivy-mapping-to-variants">Mapping of Ivy files to variants</a></h4>
<div class="paragraph">
<p>Contrary to <a href="#sub:maven-mapping-to-variants">Maven</a>, there is no derivation strategy implemented for Ivy files by default.
The reason fo this is that, contrary to pom, Ivy is a flexible format that allows you to publish arbitrary many and customized <em>configurations</em>.
So there is no notion of compile/runtime scope or compile/runtime variants in Ivy in general.
Only if you use the <a href="publishing_ivy.html#publishing_ivy">ivy-publish plugin</a> to publish ivy files with Gradle, you get a structure that follows a similar pattern as pom files.
But since there is not guarantee that <strong>all</strong> ivy metadata files consumed by a build follow this pattern, Gradle cannot enforce a derivation strategy based on it.</p>
</div>
<div class="paragraph">
<p>However, if you want to implement a derivation strategy for <em>compile</em> and <em>runtime</em> variants for Ivy, you can do so with <a href="#sec:component_metadata_rules">component metadata rule</a>.
The component metadata rules API allows you to <a href="#sec:component_metadata_rules_details">access ivy configurations</a> and create variants based on them.
If you know that all the ivy modules your are consuming have been published with Gradle without further customizations of the <code>ivy.xml</code> file, you can add the following rule to your build:</p>
</div>
<div class="exampleblock">
<div class="title">Example 133. Deriving compile and runtime variants for Ivy metadata</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">class IvyVariantDerivationRule implements ComponentMetadataRule {
    @Inject ObjectFactory getObjects() { }

    void execute(ComponentMetadataContext context) {
        // This filters out any non Ivy module
        if(context.getDescriptor(IvyModuleDescriptor) == null) {
            return
        }

        context.details.addVariant("runtimeElements", "default") {
            attributes {
                attribute(LibraryElements.LIBRARY_ELEMENTS_ATTRIBUTE, getObjects().named(LibraryElements, LibraryElements.JAR))
                attribute(Category.CATEGORY_ATTRIBUTE, getObjects().named(Category, Category.LIBRARY))
                attribute(Usage.USAGE_ATTRIBUTE, getObjects().named(Usage, Usage.JAVA_RUNTIME))
            }
        }
        context.details.addVariant("apiElements", "compile") {
            attributes {
                attribute(LibraryElements.LIBRARY_ELEMENTS_ATTRIBUTE, getObjects().named(LibraryElements, LibraryElements.JAR))
                attribute(Category.CATEGORY_ATTRIBUTE, getObjects().named(Category, Category.LIBRARY))
                attribute(Usage.USAGE_ATTRIBUTE, getObjects().named(Usage, Usage.JAVA_API))
            }
        }
    }
}

dependencies {
    components { all(IvyVariantDerivationRule) }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">open class IvyVariantDerivationRule : ComponentMetadataRule {
    @Inject open fun getObjects(): ObjectFactory = throw UnsupportedOperationException()

    override fun execute(context: ComponentMetadataContext) {
        // This filters out any non Ivy module
        if(context.getDescriptor(IvyModuleDescriptor::class) == null) {
            return
        }

        context.details.addVariant("runtimeElements", "default") {
            attributes {
                attribute(LibraryElements.LIBRARY_ELEMENTS_ATTRIBUTE, getObjects().named(LibraryElements.JAR))
                attribute(Category.CATEGORY_ATTRIBUTE, getObjects().named(Category.LIBRARY))
                attribute(Usage.USAGE_ATTRIBUTE, getObjects().named(Usage.JAVA_RUNTIME))
            }
        }
        context.details.addVariant("apiElements", "compile") {
            attributes {
                attribute(LibraryElements.LIBRARY_ELEMENTS_ATTRIBUTE, getObjects().named(LibraryElements.JAR))
                attribute(Category.CATEGORY_ATTRIBUTE, getObjects().named(Category.LIBRARY))
                attribute(Usage.USAGE_ATTRIBUTE, getObjects().named(Usage.JAVA_API))
            }
        }
    }
}

dependencies {
    components { all&lt;IvyVariantDerivationRule&gt;() }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The rule creates an <code>apiElements</code> variant based on the <code>compile</code> configuration and a <code>runtimeElements</code> variant based on the <code>default</code> configuration of each ivy module.
For each variant, it sets the corresponding <a href="#sec:variant-aware-matching">Java ecosystem attributes</a>.
Dependencies and artifacts of the variants are taken from the underlying configurations.
If not all consumed ivy modules follow this pattern, the rule can be adjusted or only applied to a selected set of modules.</p>
</div>
<div class="paragraph">
<p>For all ivy modules without variants, Gradle falls back to legacy configuration selection (i.e. Gradle does <em>not</em> perform variant aware resolution for these modules).
This means either the <code>default</code> configuration or the configuration explicitly defined in the dependency to the corresponding module is selected.
(Note that explicit configuration selection is only possible from build scripts or ivy metadata, and should be avoided in favor of variant selection.)</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="variant_attributes"><a class="anchor" href="#variant_attributes"></a><a class="link" href="#variant_attributes">Working with Variant Attributes</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>As explained in the section on <a href="#sec:variant-aware-matching">variant aware matching</a>, attributes give semantics to variants and are used to perform the selection between them.</p>
</div>
<div class="paragraph">
<p>As a user of Gradle, attributes are often hidden as implementation details.
But it might be useful to understand the <em>standard attributes</em> defined by Gradle and its core plugins.</p>
</div>
<div class="paragraph">
<p>As a plugin author, these attributes, and the way they are defined, can serve as a basis for <a href="#sec:declaring_attributes">building your own set of attributes</a> in your eco system plugin.</p>
</div>
<div class="sect2">
<h3 id="sec:standard_attributes"><a class="anchor" href="#sec:standard_attributes"></a><a class="link" href="#sec:standard_attributes">Standard attributes defined by Gradle</a></h3>
<div class="paragraph">
<p>Gradle defines a list of standard attributes used by Gradle&#8217;s core plugins.</p>
</div>
<div class="sect3">
<h4 id="ecosystem_independent_standard_attributes"><a class="anchor" href="#ecosystem_independent_standard_attributes"></a><a class="link" href="#ecosystem_independent_standard_attributes">Ecosystem-independent standard attributes</a></h4>
<table class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 6. Ecosystem-independent standard variant attributes</caption>
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Values</th>
<th class="tableblock halign-left valign-top">compatibility and disambiguation rules</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../javadoc/org/gradle/api/attributes/Usage.html#USAGE_ATTRIBUTE"><code>org.gradle.usage</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates main purpose of variant</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Usage</code> values built from constants defined in <a href="../javadoc/org/gradle/api/attributes/Usage.html">Usage</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Following ecosystem semantics (e.g. <code>java-runtime</code> can be used in place of <code>java-api</code> but not the opposite)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../javadoc/org/gradle/api/attributes/Category.html#CATEGORY_ATTRIBUTE"><code>org.gradle.category</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the category of this software component</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Category</code> values built from constants defined in <a href="../javadoc/org/gradle/api/attributes/Category.html">Category</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Following ecosystem semantics (e.g. <code>library</code> is default on the JVM, no compatibility otherwise)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../javadoc/org/gradle/api/attributes/LibraryElements.html#LIBRARY_ELEMENTS_ATTRIBUTE"><code>org.gradle.libraryelements</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the contents of a <code>org.gradle.category=library</code> variant</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LibraryElements</code> values built from constants defined in <a href="../javadoc/org/gradle/api/attributes/LibraryElements.html">LibraryElements</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Following ecosystem semantics(e.g. in the JVM world, <code>jar</code> is the default and is compatible with <code>classes</code>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../javadoc/org/gradle/api/attributes/DocsType.html#DOCS_TYPE_ATTRIBUTE"><code>org.gradle.docstype</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the contents of a <code>org.gradle.category=documentation</code> variant</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DocsType</code> values built from constants defined in <a href="../javadoc/org/gradle/api/attributes/DocsType.html">DocsType</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No default, no compatibility</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../javadoc/org/gradle/api/attributes/Bundling.html#BUNDLING_ATTRIBUTE"><code>org.gradle.dependency.bundling</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates how dependencies of a variant are accessed.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Bundling</code> values built from constants defined in <a href="../javadoc/org/gradle/api/attributes/Bundling.html">Bundling</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Following ecosystem semantics (e.g. in the JVM world, <code>embedded</code> is compatible with <code>external</code>)</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 7. Ecosystem-independent standard component attributes</caption>
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Values</th>
<th class="tableblock halign-left valign-top">compatibility and disambiguation rules</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.gradle.status</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Component level attribute, derived</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Based on <a href="#sec:custom_status_scheme">a status scheme</a>, with a default one existing based on the source repository.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Based on the scheme in use</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="sub:jvm_default_attributes"><a class="anchor" href="#sub:jvm_default_attributes"></a><a class="link" href="#sub:jvm_default_attributes">JVM ecosystem specific attributes</a></h4>
<div class="paragraph">
<p>In addition to the ecosystem independent attributes defined above, the JVM ecosystem adds the following attribute:</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 8. JVM ecosystem standard component attributes</caption>
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Values</th>
<th class="tableblock halign-left valign-top">compatibility and disambiguation rules</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../javadoc/org/gradle/api/attributes/java/TargetJvmVersion.html#TARGET_JVM_VERSION_ATTRIBUTE"><code>org.gradle.jvm.version</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the JVM version compatibility.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer using the version after the <code>1.</code> for Java 1.4 and before, the major version for Java 5 and beyond.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defaults to the JVM version used by Gradle, lower is compatible with higher, prefers highest compatible.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The JVM ecosystem also contains a number of compatibility and disambiguation rules over the different attributes.
The reader willing to know more can take a look at the code for <code>org.gradle.api.internal.artifacts.JavaEcosystemSupport</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="native_ecosystem_specific_attributes"><a class="anchor" href="#native_ecosystem_specific_attributes"></a><a class="link" href="#native_ecosystem_specific_attributes">Native ecosystem specific attributes</a></h4>
<div class="paragraph">
<p>In addition to the ecosystem independent attributes defined above, the native ecosystem adds the following attributes:</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 9. Native ecosystem standard component attributes</caption>
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Values</th>
<th class="tableblock halign-left valign-top">compatibility and disambiguation rules</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../javadoc/org/gradle/language/cpp/CppBinary.html#DEBUGGABLE_ATTRIBUTE"><code>org.gradle.native.debuggable</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates if the binary was built with debugging symbols</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N/A</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../javadoc/org/gradle/language/cpp/CppBinary.html#OPTIMIZED_ATTRIBUTE"><code>org.gradle.native.optimized</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates if the binary was built with optimization flags</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N/A</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../javadoc/org/gradle/nativeplatform/MachineArchitecture.html#ARCHITECTURE_ATTRIBUTE"><code>org.gradle.native.architecture</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the target architecture of the binary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>MachineArchitecture</code> values built from constants defined in <a href="../javadoc/org/gradle/nativeplatform/MachineArchitecture.html">MachineArchitecture</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../javadoc/org/gradle/nativeplatform/OperatingSystemFamily.html#OPERATING_SYSTEM_ATTRIBUTE"><code>org.gradle.native.operatingSystem</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the target operating system of the binary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>OperatingSystemFamily</code> values built from constants defined in <a href="../javadoc/org/gradle/nativeplatform/OperatingSystemFamily.html">OperatingSystemFamily</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="sec:declaring_attributes"><a class="anchor" href="#sec:declaring_attributes"></a><a class="link" href="#sec:declaring_attributes">Declaring custom attributes</a></h3>
<div class="paragraph">
<p>If you are extending Gradle, e.g. by writing a plugin for another ecosystem, declaring custom attributes could be an option if you want to support variant-aware dependency management features in your plugin.
However, you should be cautious if you also attempt to publish libraries.
Semantics of new attributes are usually defined through a plugin, which can carry <a href="#sec:abm_compatibility_rules">compatibility</a> and <a href="#sec:abm_disambiguation_rules">disambiguation</a> rules.
Consequently, builds that consume libraries published for a certain ecosystem, also need to apply the corresponding plugin to interpret attributes correctly.
If your plugin is intended for a larger audience, i.e. if it is openly available and libraries are published to public repositories, defining new attributes effectively extends the semantics of Gradle Module Metadata and comes with responsibilities.
E.g., support for attributes that are already published should not be removed again, or should be handled in some kind of compatibility layer in future versions of the plugin.</p>
</div>
</div>
<div class="sect2">
<h3 id="creating_attributes_in_a_build_script_or_plugin"><a class="anchor" href="#creating_attributes_in_a_build_script_or_plugin"></a><a class="link" href="#creating_attributes_in_a_build_script_or_plugin">Creating attributes in a build script or plugin</a></h3>
<div class="paragraph">
<p>Attributes are <em>typed</em>. An attribute can be created via the <code>Attribute&lt;T&gt;.of</code> method:</p>
</div>
<div class="exampleblock">
<div class="title">Example 134. Define attributes</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">// An attribute of type `String`
def myAttribute = Attribute.of("my.attribute.name", String)
// An attribute of type `Usage`
def myUsage = Attribute.of("my.usage.attribute", Usage)</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">// An attribute of type `String`
val myAttribute = Attribute.of("my.attribute.name", String::class.java)
// An attribute of type `Usage`
val myUsage = Attribute.of("my.usage.attribute", Usage::class.java)</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Currently, only attribute types of <code>String</code>, or anything extending <code>Named</code> is supported.
Attributes must be declared in the <em>attribute schema</em> found on the <code>dependencies</code> handler:</p>
</div>
<div class="exampleblock">
<div class="title">Example 135. Registering attributes on the attributes schema</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">dependencies.attributesSchema {
    // registers this attribute to the attributes schema
    attribute(myAttribute)
    attribute(myUsage)
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">dependencies.attributesSchema {
    // registers this attribute to the attributes schema
    attribute(myAttribute)
    attribute(myUsage)
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Then configurations can be configured to set values for attributes:</p>
</div>
<div class="exampleblock">
<div class="title">Example 136. Setting attributes on configurations</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">configurations {
    myConfiguration {
        attributes {
            attribute(myAttribute, 'my-value')
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">configurations {
    create("myConfiguration") {
        attributes {
            attribute(myAttribute, "my-value")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>For attributes which type extends <code>Named</code>, the value of the attribute <strong>must</strong> be created via the <em>object factory</em>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 137. Named attributes</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">configurations {
    myConfiguration {
        attributes {
            attribute(myUsage, project.objects.named(Usage, 'my-value'))
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">configurations {
    "myConfiguration" {
        attributes {
            attribute(myUsage, project.objects.named(Usage::class.java, "my-value"))
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:abm_compatibility_rules"><a class="anchor" href="#sec:abm_compatibility_rules"></a><a class="link" href="#sec:abm_compatibility_rules">Attribute compatibility rules</a></h4>
<div class="paragraph">
<p>Attributes let the engine select <em>compatible variants</em>.
However, there are cases where a provider may not have <em>exactly</em> what the consumer wants, but still something that it can use.
For example, if the consumer is asking for the API of a library, there&#8217;s a possibility that the producer doesn&#8217;t have such a variant, but only a <em>runtime</em> variant.
This is typical of libraries published on external repositories.
In this case, we know that even if we don&#8217;t have an exact match (API), we can still compile against the runtime variant (it contains <em>more</em> than what we need to compile but it&#8217;s still ok to use).
To deal with this, Gradle provides <a href="../javadoc/org/gradle/api/attributes/AttributeCompatibilityRule.html">attribute compatibility rules</a>.
The role of a compatibility rule is to explain what variants are <em>compatible</em> with what the consumer asked for.</p>
</div>
<div class="paragraph">
<p>Attribute compatibility rules have to be registered via the <a href="../javadoc/org/gradle/api/attributes/AttributeMatchingStrategy.html">attribute matching strategy</a> that you can obtain from the <a href="../javadoc/org/gradle/api/attributes/AttributesSchema.html">attributes schema</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:abm_disambiguation_rules"><a class="anchor" href="#sec:abm_disambiguation_rules"></a><a class="link" href="#sec:abm_disambiguation_rules">Attribute disambiguation rules</a></h4>
<div class="paragraph">
<p>Because multiple values for an attribute can be <em>compatible</em> with the requested attribute, Gradle needs to choose between the candidates.
This is done by implementing an <a href="../javadoc/org/gradle/api/attributes/AttributeDisambiguationRule.html">attribute disambiguation rule</a>.</p>
</div>
<div class="paragraph">
<p>Attribute disambiguation rules have to be registered via the <a href="../javadoc/org/gradle/api/attributes/AttributeMatchingStrategy.html">attribute matching strategy</a> that you can obtain from the <a href="../javadoc/org/gradle/api/attributes/AttributesSchema.html">attributes schema</a>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cross_project_publications"><a class="anchor" href="#cross_project_publications"></a><a class="link" href="#cross_project_publications">Sharing outputs between projects</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>A common pattern, in multi-project builds, is that one project consumes the artifacts of another project.
In general, the simplest consumption form in the Java ecosystem is that when <code>A</code> depends on <code>B</code>, then <code>A</code> would depend on the <code>jar</code> produced by project <code>B</code>.
As previously described in this chapter, this is modeled by <code>A</code> depending on a <em>variant of</em> <code>B</code>, where the variant is selected based on the needs of <code>A</code>.
For compilation, we need the API dependencies of <code>B</code>, provided by the <code>apiElements</code> variant.
For runtime, we need the runtime dependencies of <code>B</code>, provided by the <code>runtimeElements</code> variant.</p>
</div>
<div class="paragraph">
<p>However, what if you need a <em>different</em> artifact than the main one?
Gradle provides, for example, built-in support for depending on the <a href="java_testing.html#sec:java_test_fixtures">test fixtures</a> of another project, but sometimes the artifact you need to depend on simply isn&#8217;t exposed as a variant.</p>
</div>
<div class="paragraph">
<p>In order to be <em>safe to share</em> between projects and allow maximum performance (parallelism), such artifacts must be exposed via <em>outgoing configurations</em>.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="title">Don&#8217;t reference other project tasks directly</div>
<div class="paragraph">
<p>A frequent anti-pattern to declare cross-project dependencies is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">dependencies {
   // this is unsafe!
   implementation project(":other").tasks.someOtherJar
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This publication model is <em>unsafe</em> and can lead to non-reproducible and hard to parallelize builds.
This section explains how to <em>properly create cross-project boundaries</em> by defining "exchanges" between projects by using <em>variants</em>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>There are two, complementary, options to share artifacts between projects.
The <a href="#sec:simple-sharing-artifacts-between-projects">simplified version</a> is only suitable if what you need to share is a simple artifact that doesn&#8217;t depend on the consumer.
The simple solution is also limited to cases where this artifact is not published to a repository.
This also implies that the consumer does not publish a dependency to this artifact.
In cases where the consumer resolves to different artifacts in different contexts (e.g., different target platforms) or that publication is required, you need to use the <a href="#sec:variant-aware-sharing">advanced version</a>.</p>
</div>
<div class="sect2">
<h3 id="sec:simple-sharing-artifacts-between-projects"><a class="anchor" href="#sec:simple-sharing-artifacts-between-projects"></a><a class="link" href="#sec:simple-sharing-artifacts-between-projects">Simple sharing of artifacts between projects</a></h3>
<div class="paragraph">
<p>First, a producer needs to declare a configuration which is going to be <em>exposed</em> to consumers.
As explained in the <a href="#sec:resolvable-consumable-configs">configurations chapter</a>, this corresponds to a <em>consumable configuration</em>.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s imagine that the consumer requires <em>instrumented classes</em> from the producer, but that this artifact is <em>not</em> the main one.
The producer can expose its instrumented classes by creating a configuration that will "carry" this artifact:</p>
</div>
<div class="exampleblock">
<div class="title">Example 138. Declaring an outgoing variant</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">producer/build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">configurations {
    instrumentedJars {
        canBeConsumed = true
        canBeResolved = false
        // If you want this configuration to share the same dependencies, otherwise omit this line
        extendsFrom implementation, runtimeOnly
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">producer/build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">val instrumentedJars by configurations.creating {
    isCanBeConsumed = true
    isCanBeResolved = false
    // If you want this configuration to share the same dependencies, otherwise omit this line
    extendsFrom(configurations["implementation"], configurations["runtimeOnly"])
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This configuration is <em>consumable</em>, which means it&#8217;s an "exchange" meant for consumers.
We&#8217;re now going to add artifacts to this configuration, that consumers would get when they consume it:</p>
</div>
<div class="exampleblock">
<div class="title">Example 139. Attaching an artifact to an outgoing configuration</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">producer/build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">artifacts {
    instrumentedJars(instrumentedJar)
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">producer/build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">artifacts {
    add("instrumentedJars", instrumentedJar)
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Here the "artifact" we&#8217;re attaching is a <em>task</em> that actually generates a Jar.
Doing so, Gradle can automatically track dependencies of this task and build them as needed.
This is possible because the <code>Jar</code> task extends <code>AbstractArchiveTask</code>.
If it&#8217;s not the case, you will need to explicitly declare how the artifact is generated.</p>
</div>
<div class="exampleblock">
<div class="title">Example 140. Explicitly declaring the task dependency of an artifact</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">producer/build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">artifacts {
    instrumentedJars(someTask.outputFile) {
        builtBy(someTask)
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">producer/build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">artifacts {
    add("instrumentedJars", someTask.outputFile) {
        builtBy(someTask)
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Now the <em>consumer</em> needs to depend on this configuration in order to get the right artifact:</p>
</div>
<div class="exampleblock">
<div class="title">Example 141. An explicit configuration dependency</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">consumer/build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">dependencies {
    instrumentedClasspath(project(path: ":producer", configuration: 'instrumentedJars'))
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">consumer/build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">dependencies {
    instrumentedClasspath(project(mapOf(
        "path" to ":producer",
        "configuration" to "instrumentedJars")))
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Declaring a dependency on an explicit target configuration is <em>not recommended</em> if you plan to publish the component which has this dependency:
this would likely lead to broken metadata.
If you need to publish the component on a remote repository, follow the instructions of the <a href="#sec:variant-aware-sharing">variant-aware cross publication documentation</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In this case, we&#8217;re adding the dependency to the <em>instrumentedClasspath</em> configuration, which is a <em>consumer specific configuration</em>.
In Gradle terminology, this is called a <a href="#sec:resolvable-consumable-configs">resolvable configuration</a>, which is defined this way:</p>
</div>
<div class="exampleblock">
<div class="title">Example 142. Declaring a resolvable configuration on the consumer</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">consumer/build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">configurations {
    instrumentedClasspath {
        canBeConsumed = false
        canBeResolved = true
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">consumer/build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">val instrumentedClasspath by configurations.creating {
    isCanBeConsumed = false
    isCanBeResolved = true
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec:variant-aware-sharing"><a class="anchor" href="#sec:variant-aware-sharing"></a><a class="link" href="#sec:variant-aware-sharing">Variant-aware sharing of artifacts between projects</a></h3>
<div class="paragraph">
<p>In the <a href="#sec:simple-sharing-artifacts-between-projects">simple sharing solution</a>, we defined a configuration on the producer side which serves as an exchange of artifacts between the producer and the consumer.
However, the consumer has to explicitly tell which configuration it depends on, which is something we want to avoid in <em>variant aware resolution</em>.
In fact, we also <a href="#understanding-variant-selection">have explained</a> that it is possible for a consumer to express requirements using <em>attributes</em> and that the producer should provide the appropriate outgoing variants using attributes too.
This allows for smarter selection, because using a single dependency declaration, without any explicit target configuration, the consumer may resolve different things.
The typical example is that using a single dependency declaration <code>project(":myLib")</code>, we would either choose the <code>arm64</code> or <code>i386</code> version of <code>myLib</code> depending on the architecture.</p>
</div>
<div class="paragraph">
<p>To do this, we will add attributes to both the consumer and the producer.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>It is important to understand that once configurations have attributes, they participate in <em>variant aware resolution</em>, which means that they are candidates considered whenever <em>any</em> notation like <code>project(":myLib")</code> is used.
In other words, the attributes set on the producer <em>must be consistent with the other variants produced on the same project</em>.
They must not, in particular, introduce ambiguity for the existing selection.</p>
</div>
<div class="paragraph">
<p>In practice, it means that the attribute set used on the configuration you create are likely to be dependent on the <em>ecosystem</em> in use (Java, C++, &#8230;&#8203;) because the relevant plugins for those ecosystems often use different attributes.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Let&#8217;s enhance our previous example which happens to be a Java Library project.
Java libraries expose a couple of variants to their consumers, <code>apiElements</code> and <code>runtimeElements</code>. Now, we&#8217;re adding a 3rd one, <code>instrumentedJars</code>.</p>
</div>
<div class="paragraph">
<p>Therefore, we need to understand what our new variant is used for in order to set the proper attributes on it.
Let&#8217;s look at the attributes we find on the <code>runtimeElements</code> configuration:</p>
</div>
<div class="listingblock">
<div class="title">gradle outgoingVariants --variant runtimeElements</div>
<div class="content">
<pre>Attributes
    - org.gradle.category            = library
    - org.gradle.dependency.bundling = external
    - org.gradle.jvm.version         = 11
    - org.gradle.libraryelements     = jar
    - org.gradle.usage               = java-runtime</pre>
</div>
</div>
<div class="paragraph">
<p>What it tells us is that the Java Library plugin produces variants with 5 attributes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>org.gradle.category</code> tells us that this variant represents a <em>library</em></p>
</li>
<li>
<p><code>org.gradle.dependency.bundling</code> tells us that the dependencies of this variant are found as jars (they are not, for example, repackaged inside the jar)</p>
</li>
<li>
<p><code>org.gradle.jvm.version</code> tells us that the minimum Java version this library supports is Java 11</p>
</li>
<li>
<p><code>org.gradle.libraryelements</code> tells us this variant contains all elements found in a jar (classes and resources)</p>
</li>
<li>
<p><code>org.gradle.usage</code> says that this variant is a Java runtime, therefore suitable for a Java compiler but also at runtime</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As a consequence, if we want our instrumented classes to be used in place of this variant when executing tests, we need to attach similar attributes to our variant.
In fact, the attribute we care about is <code>org.gradle.libraryelements</code> which explains <em>what the variant contains</em>, so we can setup the variant this way:</p>
</div>
<div class="exampleblock">
<div class="title">Example 143. Declaring the variant attributes</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">producer/build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">configurations {
    instrumentedJars {
        canBeConsumed = true
        canBeResolved = false
        attributes {
            attribute(Category.CATEGORY_ATTRIBUTE, objects.named(Category, Category.LIBRARY))
            attribute(Usage.USAGE_ATTRIBUTE, objects.named(Usage, Usage.JAVA_RUNTIME))
            attribute(Bundling.BUNDLING_ATTRIBUTE, objects.named(Bundling, Bundling.EXTERNAL))
            attribute(TargetJvmVersion.TARGET_JVM_VERSION_ATTRIBUTE, JavaVersion.current().majorVersion.toInteger())
            attribute(LibraryElements.LIBRARY_ELEMENTS_ATTRIBUTE, objects.named(LibraryElements, 'instrumented-jar'))
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">producer/build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">val instrumentedJars by configurations.creating {
    isCanBeConsumed = true
    isCanBeResolved = false
    attributes {
        attribute(Category.CATEGORY_ATTRIBUTE, namedAttribute(Category.LIBRARY))
        attribute(Usage.USAGE_ATTRIBUTE, namedAttribute(Usage.JAVA_RUNTIME))
        attribute(Bundling.BUNDLING_ATTRIBUTE, namedAttribute(Bundling.EXTERNAL))
        attribute(TargetJvmVersion.TARGET_JVM_VERSION_ATTRIBUTE, JavaVersion.current().majorVersion.toInt())
        attribute(LibraryElements.LIBRARY_ELEMENTS_ATTRIBUTE, namedAttribute("instrumented-jar"))
    }
}

inline fun &lt;reified T: Named&gt; Project.namedAttribute(value: String) = objects.named(T::class.java, value)</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Choosing the right attributes to set is the hardest thing in this process, because they carry the semantics of the variant.
Therefore, before adding <em>new attributes</em>, you should always ask yourself if there isn&#8217;t an attribute which carries the semantics you need.
If there isn&#8217;t, then you may add a new attribute.
When adding new attributes, you must also be careful because it&#8217;s possible that it creates ambiguity during selection.
Often adding an attribute means adding it to <em>all</em> existing variants.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>What we have done here is that we have added a <em>new</em> variant, which can be used <em>at runtime</em>, but contains instrumented classes instead of the normal classes.
However, it now means that for runtime, the consumer has to choose between two variants:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>runtimeElements</code>, the regular variant offered by the <code>java-library</code> plugin</p>
</li>
<li>
<p><code>instrumentedJars</code>, the variant we have created</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In particular, say we want the instrumented classes on the test runtime classpath.
We can now, on the consumer, declare our dependency as a regular project dependency:</p>
</div>
<div class="exampleblock">
<div class="title">Example 144. Declaring the project dependency</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">consumer/build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">dependencies {
    testImplementation 'junit:junit:4.12'
    testImplementation project(':producer')
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">consumer/build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">dependencies {
    testImplementation("junit:junit:4.12")
    testImplementation(project(":producer"))
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>If we stop here, Gradle will still select the <code>runtimeElements</code> variant in place of our <code>instrumentedJars</code> variant.
This is because the <code>testRuntimeClasspath</code> configuration asks for a configuration which <code>libraryelements</code> attribute is <code>jar</code>, and our new <code>instrumented-jars</code> value is <em>not compatible</em>.</p>
</div>
<div class="paragraph">
<p>So we need to change the requested attributes so that we now look for instrumented jars:</p>
</div>
<div class="exampleblock">
<div class="title">Example 145. Changing the consumer attributes</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">consumer/build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">configurations {
    testRuntimeClasspath {
        attributes {
            attribute(LibraryElements.LIBRARY_ELEMENTS_ATTRIBUTE, objects.named(LibraryElements, 'instrumented-jar'))
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">consumer/build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">configurations {
    testRuntimeClasspath {
        attributes {
            attribute(LibraryElements.LIBRARY_ELEMENTS_ATTRIBUTE, objects.named(LibraryElements::class.java, "instrumented-jar"))
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Now, we&#8217;re telling that whenever we&#8217;re going to resolve the test runtime classpath, what we are looking for is <em>instrumented classes</em>.
There is a problem though: in our dependencies list, we have JUnit, which, obviously, is <em>not</em> instrumented.
So if we stop here, Gradle is going to fail, explaining that there&#8217;s no variant of JUnit which provide instrumented classes.
This is because we didn&#8217;t explain that it&#8217;s fine to use the regular jar, if no instrumented version is available.
To do this, we need to write a <em>compatibility rule</em>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 146. A compatibility rule</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">consumer/build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">class InstrumentedJarsRule implements AttributeCompatibilityRule&lt;LibraryElements&gt; {

    @Override
    void execute(CompatibilityCheckDetails&lt;LibraryElements&gt; details) {
        if (details.consumerValue.name == 'instrumented-jar' &amp;&amp; details.producerValue.name == 'jar') {
            details.compatible()
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">consumer/build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">open class InstrumentedJarsRule: AttributeCompatibilityRule&lt;LibraryElements&gt; {

    override fun execute(details: CompatibilityCheckDetails&lt;LibraryElements&gt;) = details.run {
        if (consumerValue?.name == "instrumented-jar" &amp;&amp; producerValue?.name == "jar") {
            compatible()
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>which we need to declare on the attributes schema:</p>
</div>
<div class="exampleblock">
<div class="title">Example 147. Making use of the compatibility rule</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">consumer/build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">dependencies {
    attributesSchema {
        attribute(LibraryElements.LIBRARY_ELEMENTS_ATTRIBUTE) {
            compatibilityRules.add(InstrumentedJarsRule)
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">consumer/build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">dependencies {
    attributesSchema {
        attribute(LibraryElements.LIBRARY_ELEMENTS_ATTRIBUTE) {
            compatibilityRules.add(InstrumentedJarsRule::class.java)
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>And that&#8217;s it! Now we have:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>added a variant which provides instrumented jars</p>
</li>
<li>
<p>explained that this variant is a substitute for the runtime</p>
</li>
<li>
<p>explained that the consumer needs this variant <em>only for test runtime</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Gradle therefore offers a powerful mechanism to select the right variants based on preferences and compatibility.
More details can be found in the <a href="#">variant aware plugins section of the documentation</a>.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>By adding a value to an existing attribute like we have done, or by defining new attributes, we are extending the model.
This means that <em>all consumers</em> have to know about this extended model.
For local consumers, this is usually not a problem because all projects understand and share the same schema, but if you had to publish this new variant to an external repository, it means that external consumers would have to add the same rules to their builds for them to pass.
This is in general not a problem for <em>ecosystem plugins</em> (e.g: the Kotlin plugin) where consumption is in any case not possible without applying the plugin, but it is a problem if you add custom values or attributes.</p>
</div>
<div class="paragraph">
<p>So, <strong>avoid publishing custom variants</strong> if they are for internal use only.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="targeting-different-platforms"><a class="anchor" href="#targeting-different-platforms"></a><a class="link" href="#targeting-different-platforms">Targeting different platforms</a></h3>
<div class="paragraph">
<p>It is common for a library to target different platforms.
In the Java ecosystem, we often see different artifacts for the same library, distinguished by a different <em>classifier</em>.
A typical example is Guava, which is published as this:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>guava-jre</code> for JDK 8 and above</p>
</li>
<li>
<p><code>guava-android</code> for JDK 7</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The problem with this approach is that there&#8217;s no semantics associated with the classifier.
The dependency resolution engine, in particular, cannot determine automatically which version to use based on the consumer requirements.
For example, it would be better to express that you have a dependency on Guava, and let the engine choose between <code>jre</code> and <code>android</code> based on what is compatible.</p>
</div>
<div class="paragraph">
<p>Gradle provides an improved model for this, which doesn&#8217;t have the weakness of classifiers: attributes.</p>
</div>
<div class="paragraph">
<p>In particular, in the Java ecosystem, Gradle provides a built-in attribute that library authors can use to express compatibility with the Java ecosystem: <code>org.gradle.jvm.version</code>.
This attribute expresses the <em>minimal version that a consumer must have in order to work properly</em>.</p>
</div>
<div class="paragraph">
<p>When you apply the <code>java</code> or <code>java-library</code> plugins, Gradle will automatically associate this attribute to the outgoing variants.
This means that all libraries published with Gradle automatically tell which target platform they use.</p>
</div>
<div class="paragraph">
<p>By default, the <code>org.gradle.jvm.version</code> is set to the <em>target compatibility</em> of the source set.</p>
</div>
<div class="paragraph">
<p>While this attribute is automatically set, Gradle <em>will not</em>, by default, let you build a project for different JVMs.
If you need to do this, then you will need to create additional variants following the <a href="#sec:variant-aware-sharing">instructions on variant-aware matching</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Future versions of Gradle will provide ways to automatically build for different Java platforms.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec:abm_artifact_transforms"><a class="anchor" href="#sec:abm_artifact_transforms"></a><a class="link" href="#sec:abm_artifact_transforms">Transforming dependency artifacts on resolution</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>As described in <a href="#sec:resolvable-consumable-configs">different kinds of configurations</a>, there may be different variants for the same dependency.
For example, an external Maven dependency has a variant which should be used when compiling against the dependency (<code>java-api</code>), and a variant for running an application which uses the dependency (<code>java-runtime</code>).
A project dependency has even more variants, for example the classes of the project which are used for compilation are available as classes directories (<code>org.gradle.usage=java-api, org.gradle.libraryelements=classes</code>) or as JARs (<code>org.gradle.usage=java-api, org.gradle.libraryelements=jar</code>).</p>
</div>
<div class="paragraph">
<p>The variants of a dependency may differ in its transitive dependencies or in the artifact itself.
For example, the <code>java-api</code> and <code>java-runtime</code> variants of a Maven dependency only differ in the transitive dependencies and both use the same artifact  the JAR file.
For a project dependency, the <code>java-api,classes</code> and the <code>java-api,jars</code> variants have the same transitive dependencies and different artifacts  the classes directories and the JAR files respectively.</p>
</div>
<div class="paragraph">
<p>Gradle identifies a variant of a dependency uniquely by its set of <a href="#sec:abm_configuration_attributes">attributes</a>.
The <code>java-api</code> variant of a dependency is the variant identified by the <code>org.gradle.usage</code> attribute with value <code>java-api</code>.</p>
</div>
<div class="paragraph">
<p>When Gradle resolves a configuration, the <a href="#sec:abm_configuration_attributes">attributes</a> on the resolved configuration determine the <em>requested attributes</em>.
For all dependencies in the configuration, the variant with the requested attributes is selected when resolving the configuration.
For example, when the configuration requests <code>org.gradle.usage=java-api, org.gradle.libraryelements=classes</code> on a project dependency, then the classes directory is selected as the artifact.</p>
</div>
<div class="paragraph">
<p>When the dependency does not have a variant with the requested attributes, resolving the configuration fails.
Sometimes it is possible to transform the artifact of the dependency into the requested variant without changing the transitive dependencies.
For example, unzipping a JAR transforms the artifact of the <code>java-api,jars</code> variant into the <code>java-api,classes</code> variant.
Such a transformation is called <em>Artifact Transform</em>.
Gradle allows registering artifact transforms, and when the dependency does not have the requested variant, then Gradle will try to find a chain of artifact transforms for creating the variant.</p>
</div>
<div class="sect2">
<h3 id="artifact_transform_selection_and_execution"><a class="anchor" href="#artifact_transform_selection_and_execution"></a><a class="link" href="#artifact_transform_selection_and_execution">Artifact transform selection and execution</a></h3>
<div class="paragraph">
<p>As described above, when Gradle resolves a configuration and a dependency in the configuration does not have a variant with the requested attributes, Gradle tries to find a chain of artifact transforms to create the variant.
The process of finding a matching chain of artifact transforms is called <em>artifact transform selection</em>.
Each registered transform converts from a set of attributes to a set of attributes.
For example, the unzip transform can convert from <code>org.gradle.usage=java-api, org.gradle.libraryelements=jars</code> to <code>org.gradle.usage=java-api, org.gradle.libraryelements=classes</code>.</p>
</div>
<div class="paragraph">
<p>In order to find a chain, Gradle starts with the requested attributes and then considers all transforms which modify some of the requested attributes as possible paths leading there.
Going backwards, Gradle tries to obtain a path to some existing variant using transforms.</p>
</div>
<div class="paragraph">
<p>For example, consider a <code>minified</code> attribute with two values: <code>true</code> and <code>false</code>.
The minified attribute represents a variant of a dependency with unnecessary class files removed.
There is an artifact transform registered, which can transform <code>minified</code> from <code>false</code> to <code>true</code>.
When <code>minified=true</code> is requested for a dependency, and there are only variants with <code>minified=false</code>, then Gradle selects the registered minify transform.
The minify transform is able to transform the artifact of the dependency with <code>minified=false</code> to the artifact with <code>minified=true</code>.</p>
</div>
<div class="paragraph">
<p>Of all the found transform chains, Gradle tries to select the best one:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If there is only one transform chain, it is selected.</p>
</li>
<li>
<p>If there are two transform chains, and one is a suffix of the other one, it is selected.</p>
</li>
<li>
<p>If there is a shortest transform chain, then it is selected.</p>
</li>
<li>
<p>In all other cases, the selection fails and an error is reported.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Gradle does not try to select artifact transforms when there is already a variant of the dependency matching the requested attributes.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>artifactType</code> attribute is special, since it is only present on resolved artifacts and not on dependencies.
As a consequence, any transform which is only mutating <code>artifactType</code> will never be selected when resolving a configuration with only the <code>artifactType</code> as requested attribute.
It will only be considered when using an <a href="../javadoc/org/gradle/api/artifacts/ArtifactView.html">ArtifactView</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>After selecting the required artifact transforms, Gradle resolves the variants of the dependencies which are necessary for the initial transform in the chain.
As soon as Gradle finishes resolving the artifacts for the variant, either by downloading an external dependency or executing a task producing the artifact, Gradle starts transforming the artifacts of the variant with the selected chain of artifact transforms.
Gradle executes the transform chains in parallel when possible.</p>
</div>
<div class="paragraph">
<p>Picking up the minify example above, consider a configuration with two dependencies, the external <code>guava</code> dependency and a project dependency on the <code>producer</code> project.
The configuration has the attributes <code>org.gradle.usage=java-runtime,org.gradle.libraryelements=jar,minified=true</code>.
The external <code>guava</code> dependency has two variants:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>org.gradle.usage=java-runtime,org.gradle.libraryelements=jar,minified=false</code> and</p>
</li>
<li>
<p><code>org.gradle.usage=java-api,org.gradle.libraryelements=jar,minified=false</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Using the minify transform, Gradle can convert the variant <code>org.gradle.usage=java-runtime,org.gradle.libraryelements=jar,minified=false</code> of <code>guava</code> to <code>org.gradle.usage=java-runtime,org.gradle.libraryelements=jar,minified=true</code>, which are the requested attributes.
The project dependency also has variants:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>org.gradle.usage=java-runtime,org.gradle.libraryelements=jar,minified=false</code>,</p>
</li>
<li>
<p><code>org.gradle.usage=java-runtime,org.gradle.libraryelements=classes,minified=false</code>,</p>
</li>
<li>
<p><code>org.gradle.usage=java-api,org.gradle.libraryelements=jar,minified=false</code>,</p>
</li>
<li>
<p><code>org.gradle.usage=java-api,org.gradle.libraryelements=classes,minified=false</code></p>
</li>
<li>
<p>and a few more.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Again, using the minify transform, Gradle can convert the variant <code>org.gradle.usage=java-runtime,org.gradle.libraryelements=jar,minified=false</code> of the project <code>producer</code> to <code>org.gradle.usage=java-runtime,org.gradle.libraryelements=jar,minified=true</code>, which are the requested attributes.</p>
</div>
<div class="paragraph">
<p>When the configuration is resolved, Gradle needs to download the <code>guava</code> JAR and minify it.
Gradle also needs to execute the <code>producer:jar</code> task to generate the JAR artifact of the project and then minify it.
The downloading and the minification of the <code>guava.jar</code> happens in parallel to the execution of the <code>producer:jar</code> task and the minification of the resulting JAR.</p>
</div>
<div class="paragraph">
<p>Here is how to setup the <code>minified</code> attribute so that the above works.
You need to register the new attribute in the schema, add it to all JAR artifacts and request it on all resolvable configurations.</p>
</div>
<div class="exampleblock">
<div class="title">Example 148. Artifact transform attribute setup</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def artifactType = Attribute.of('artifactType', String)
def minified = Attribute.of('minified', Boolean)
dependencies {
    attributesSchema {
        attribute(minified)                      <i class="conum" data-value="1"></i><b>(1)</b>
    }
    artifactTypes.getByName("jar") {
        attributes.attribute(minified, false)    <i class="conum" data-value="2"></i><b>(2)</b>
    }
}

configurations.all {
    afterEvaluate {
        if (canBeResolved) {
            attributes.attribute(minified, true) <i class="conum" data-value="3"></i><b>(3)</b>
        }
    }
}

dependencies {
    registerTransform(Minify) {
        from.attribute(minified, false).attribute(artifactType, "jar")
        to.attribute(minified, true).attribute(artifactType, "jar")
    }
}

dependencies {                                 <i class="conum" data-value="4"></i><b>(4)</b>
    implementation('com.google.guava:guava:27.1-jre')
    implementation(project(':producer'))
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">val artifactType = Attribute.of("artifactType", String::class.java)
val minified = Attribute.of("minified", Boolean::class.javaObjectType)
dependencies {
    attributesSchema {
        attribute(minified)                      <i class="conum" data-value="1"></i><b>(1)</b>
    }
    artifactTypes.getByName("jar") {
        attributes.attribute(minified, false)    <i class="conum" data-value="2"></i><b>(2)</b>
    }
}

configurations.all {
    afterEvaluate {
        if (isCanBeResolved) {
            attributes.attribute(minified, true) <i class="conum" data-value="3"></i><b>(3)</b>
        }
    }
}

dependencies {
    registerTransform(Minify::class) {
        from.attribute(minified, false).attribute(artifactType, "jar")
        to.attribute(minified, true).attribute(artifactType, "jar")
    }
}

dependencies {                                 <i class="conum" data-value="4"></i><b>(4)</b>
    implementation("com.google.guava:guava:27.1-jre")
    implementation(project(":producer"))
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Add the attribute to the schema</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>All JAR files are not minified</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Request <code>minified=true</code> on all resolvable configurations</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Add the dependencies which will be transformed</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can now see what happens when we run the <code>resolveRuntimeClasspath</code> task which resolves the <code>runtimeClasspath</code> configuration.
Observe that Gradle transforms the project dependency before the <code>resolveRuntimeClasspath</code> task starts.
Gradle transforms the binary dependencies when it executes the <code>resolveRuntimeClasspath</code> task.</p>
</div>
<div class="listingblock">
<div class="title">Output when resolving the runtimeClasspath configuration</div>
<div class="content">
<pre>&gt; gradle resolveRuntimeClasspath

&gt; Task :producer:compileJava
&gt; Task :producer:processResources NO-SOURCE
&gt; Task :producer:classes
&gt; Task :producer:jar

&gt; Transform artifact producer.jar (project :producer) with Minify
Nothing to minify - using producer.jar unchanged

&gt; Task :resolveRuntimeClasspath
Minifying guava-27.1-jre.jar
Nothing to minify - using listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar unchanged
Nothing to minify - using jsr305-3.0.2.jar unchanged
Nothing to minify - using checker-qual-2.5.2.jar unchanged
Nothing to minify - using error_prone_annotations-2.2.0.jar unchanged
Nothing to minify - using j2objc-annotations-1.1.jar unchanged
Nothing to minify - using animal-sniffer-annotations-1.17.jar unchanged
Nothing to minify - using failureaccess-1.0.1.jar unchanged

BUILD SUCCESSFUL in 0s
3 actionable tasks: 3 executed</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec:implementing-artifact-transforms"><a class="anchor" href="#sec:implementing-artifact-transforms"></a><a class="link" href="#sec:implementing-artifact-transforms">Implementing artifact transforms</a></h3>
<div class="paragraph">
<p>Similar to task types, an artifact transform consists of an action and some parameters.
The major difference to custom task types is that the action and the parameters are implemented as two separate classes.</p>
</div>
<div class="paragraph">
<p>The implementation of the artifact transform action is a class implementing <a href="../dsl/org.gradle.api.artifacts.transform.TransformAction.html">TransformAction</a>.
You need to implement the <code>transform()</code> method on the action, which converts an input artifact into zero, one or multiple of output artifacts.
Most artifact transforms will be one-to-one, so the transform method will transform the input artifact to exactly one output artifact.</p>
</div>
<div class="paragraph">
<p>The implementation of the artifact transform action needs to register each output artifact by calling
 <a href="../dsl/org.gradle.api.artifacts.transform.TransformOutputs.html#org.gradle.api.artifacts.transform.TransformOutputs:dir(java.lang.Object)">TransformOutputs.dir()</a> or <a href="../dsl/org.gradle.api.artifacts.transform.TransformOutputs.html#org.gradle.api.artifacts.transform.TransformOutputs:file(java.lang.Object)">TransformOutputs.file()</a>.</p>
</div>
<div class="paragraph">
<p>You can only supply two types of paths to the <code>dir</code> or <code>file</code> methods:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>An absolute path to the input artifact or in the input artifact (for an input directory).</p>
</li>
<li>
<p>A relative path.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Gradle uses the absolute path as the location of the output artifact.
For example, if the input artifact is an exploded WAR, then the transform action can call <code>TransformOutputs.file()</code> for all jar files in the <code>WEB-INF/lib</code> directory.
The output of the transform would then be the library JARs of the web application.</p>
</div>
<div class="paragraph">
<p>For a relative path, the <code>dir()</code> or <code>file()</code> method returns a workspace to the transform action.
The implementation of the transform action needs to create the transformed artifact at the location of the provided workspace.</p>
</div>
<div class="paragraph">
<p>The output artifacts replace the input artifact in the transformed variant in the order they were registered.
For example, if the configuration consists of the artifacts <code>lib1.jar</code>, <code>lib2.jar</code>, <code>lib3.jar</code>, and the transform action registers a minified output artifact <code>&lt;artifact-name&gt;-min.jar</code> for the input artifact, then the transformed configuration consists of the artifacts <code>lib1-min.jar</code>, <code>lib2-min.jar</code> and <code>lib3-min.jar</code>.</p>
</div>
<div class="paragraph">
<p>Here is the implementation of an <code>Unzip</code> transform which transforms a JAR file into a classes directory by unzipping it.
The <code>Unzip</code> transform does not require any parameters.
Note how the implementation uses <code>@InputArtifact</code> to inject the artifact to transform into the action.
It requests a directory for the unzipped classes by using <code>TransformOutputs.dir()</code> and then unzips the JAR file into this directory.</p>
</div>
<div class="exampleblock">
<div class="title">Example 149. Artifact transform without parameters</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">abstract class Unzip implements TransformAction&lt;TransformParameters.None&gt; { <i class="conum" data-value="1"></i><b>(1)</b>
    @InputArtifact                                                          <i class="conum" data-value="2"></i><b>(2)</b>
    abstract Provider&lt;FileSystemLocation&gt; getInputArtifact()

    @Override
    void transform(TransformOutputs outputs) {
        def input = inputArtifact.get().asFile
        def unzipDir = outputs.dir(input.name)                              <i class="conum" data-value="3"></i><b>(3)</b>
        unzipTo(input, unzipDir)                                            <i class="conum" data-value="4"></i><b>(4)</b>
    }

    private static void unzipTo(File zipFile, File unzipDir) {
        // implementation...
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">abstract class Unzip : TransformAction&lt;TransformParameters.None&gt; {          <i class="conum" data-value="1"></i><b>(1)</b>
    @get:InputArtifact                                                      <i class="conum" data-value="2"></i><b>(2)</b>
    abstract val inputArtifact: Provider&lt;FileSystemLocation&gt;

    override
    fun transform(outputs: TransformOutputs) {
        val input = inputArtifact.get().asFile
        val unzipDir = outputs.dir(input.name)                              <i class="conum" data-value="3"></i><b>(3)</b>
        unzipTo(input, unzipDir)                                            <i class="conum" data-value="4"></i><b>(4)</b>
    }

    private fun unzipTo(zipFile: File, unzipDir: File) {
        // implementation...
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Use <code>TransformParameters.None</code> if the transform does not use parameters</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Inject the input artifact</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Request an output location for the unzipped files</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Do the actual work of the transform</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>An artifact transform may require parameters, like a <code>String</code> determining some filter, or some file collection which is used for supporting the transformation of the input artifact.
In order to pass those parameters to the transform action, you need to define a new type with the desired parameters.
The type needs to implement the marker interface <a href="../javadoc/org/gradle/api/artifacts/transform/TransformParameters.html">TransformParameters</a>.
The parameters must be represented using <a href="custom_gradle_types.html#managed_properties">managed properties</a> and the parameters type must be a <a href="custom_gradle_types.html#managed_types">managed type</a>.
You can use an interface or abstract class declaring the getters and Gradle will generate the implementation.
All getters need to have proper input annotations, see the table in the section on <a href="more_about_tasks.html#table:incremental_build_annotations">incremental build</a>.</p>
</div>
<div class="paragraph">
<p>You can find out more about implementing artifact transform parameters in <a href="custom_gradle_types.html#custom_gradle_types">Developing Custom Gradle Types</a>.</p>
</div>
<div class="paragraph">
<p>Here is the implementation of a <code>Minify</code> transform that makes JARs smaller by only keeping certain classes in them.
The <code>Minify</code> transform requires the classes to keep as parameters.
Observe how you can obtain the parameters by <code>TransformAction.getParameters()</code> in the <code>transform()</code> method.
The implementation of the <code>transform()</code> method requests a location for the minified JAR by using <code>TransformOutputs.file()</code> and then creates the minified JAR at this location.</p>
</div>
<div class="exampleblock">
<div class="title">Example 150. Minify transform implementation</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">abstract class Minify implements TransformAction&lt;Parameters&gt; { <i class="conum" data-value="1"></i><b>(1)</b>
    interface Parameters extends TransformParameters {         <i class="conum" data-value="2"></i><b>(2)</b>
        @Input
        Map&lt;String, Set&lt;String&gt;&gt; getKeepClassesByArtifact()
        void setKeepClassesByArtifact(Map&lt;String, Set&lt;String&gt;&gt; keepClasses)
    }

    @PathSensitive(PathSensitivity.NAME_ONLY)
    @InputArtifact
    abstract Provider&lt;FileSystemLocation&gt; getInputArtifact()

    @Override
    void transform(TransformOutputs outputs) {
        def fileName = inputArtifact.get().asFile.name
        for (entry in parameters.keepClassesByArtifact) {      <i class="conum" data-value="3"></i><b>(3)</b>
            if (fileName.startsWith(entry.key)) {
                def nameWithoutExtension = fileName.substring(0, fileName.length() - 4)
                minify(inputArtifact.get().asFile, entry.value, outputs.file("${nameWithoutExtension}-min.jar"))
                return
            }
        }
        println "Nothing to minify - using ${fileName} unchanged"
        outputs.file(inputArtifact)                            <i class="conum" data-value="4"></i><b>(4)</b>
    }

    private void minify(File artifact, Set&lt;String&gt; keepClasses, File jarFile) {
        println "Minifying ${artifact.name}"
        // Implementation ...
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">abstract class Minify : TransformAction&lt;Minify.Parameters&gt; {   <i class="conum" data-value="1"></i><b>(1)</b>
    interface Parameters : TransformParameters {               <i class="conum" data-value="2"></i><b>(2)</b>
        @get:Input
        var keepClassesByArtifact: Map&lt;String, Set&lt;String&gt;&gt;

    }

    @get:PathSensitive(PathSensitivity.NAME_ONLY)
    @get:InputArtifact
    abstract val inputArtifact: Provider&lt;FileSystemLocation&gt;

    override
    fun transform(outputs: TransformOutputs) {
        val fileName = inputArtifact.get().asFile.name
        for (entry in parameters.keepClassesByArtifact) {      <i class="conum" data-value="3"></i><b>(3)</b>
            if (fileName.startsWith(entry.key)) {
                val nameWithoutExtension = fileName.substring(0, fileName.length - 4)
                minify(inputArtifact.get().asFile, entry.value, outputs.file("${nameWithoutExtension}-min.jar"))
                return
            }
        }
        println("Nothing to minify - using ${fileName} unchanged")
        outputs.file(inputArtifact)                            <i class="conum" data-value="4"></i><b>(4)</b>
    }

    private fun minify(artifact: File, keepClasses: Set&lt;String&gt;, jarFile: File) {
        println("Minifying ${artifact.name}")
        // Implementation ...
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Declare the parameter type</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Interface for the transform parameters</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Use the parameters</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Use the unchanged input artifact when no minification is required</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Remember that the input artifact is a dependency, which may have its own dependencies.
If your artifact transform needs access to those transitive dependencies, it can declare an abstract getter returning a <code>FileCollection</code> and annotate it with <a href="../javadoc/org/gradle/api/artifacts/transform/InputArtifactDependencies.html">@InputArtifactDependencies</a>.
When your transform runs, Gradle will inject the transitive dependencies into that <code>FileCollection</code> property by implementing the getter.
Note that using input artifact dependencies in a transform has performance implications, only inject them when you really need them.</p>
</div>
<div class="paragraph">
<p>Moreover, artifact transforms can make use of the <a href="build_cache.html#build_cache">build cache</a> for their outputs.
To enable the build cache for an artifact transform, add the <code>@<a href="../javadoc/org/gradle/api/artifacts/transform/CacheableTransform.html">CacheableTransform</a></code> annotation on the action class.
For cacheable transforms, you must annotate its <a href="../javadoc/org/gradle/api/artifacts/transform/InputArtifact.html">@InputArtifact</a> property  and any property marked with <a href="../javadoc/org/gradle/api/artifacts/transform/InputArtifactDependencies.html">@InputArtifactDependencies</a>  with normalization annotations such as <a href="../javadoc/org/gradle/api/tasks/PathSensitive.html">@PathSensitive</a>.</p>
</div>
<div class="paragraph">
<p>The following example shows a more complicated transform.
It moves some selected classes of a JAR to a different package, rewriting the byte code of the moved classes and all classes using the moved classes (class relocation).
In order to determine the classes to relocate, it looks at the packages of the input artifact and the dependencies of the input artifact.
It also does not relocate packages contained in JAR files in an external classpath.</p>
</div>
<div class="exampleblock">
<div class="title">Example 151. Artifact transform for class relocation</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">@CacheableTransform                                                          <i class="conum" data-value="1"></i><b>(1)</b>
abstract class ClassRelocator implements TransformAction&lt;Parameters&gt; {
    interface Parameters extends TransformParameters {                       <i class="conum" data-value="2"></i><b>(2)</b>
        @CompileClasspath                                                    <i class="conum" data-value="3"></i><b>(3)</b>
        ConfigurableFileCollection getExternalClasspath()
        @Input
        Property&lt;String&gt; getExcludedPackage()
    }

    @Classpath                                                               <i class="conum" data-value="4"></i><b>(4)</b>
    @InputArtifact
    abstract Provider&lt;FileSystemLocation&gt; getPrimaryInput()

    @CompileClasspath
    @InputArtifactDependencies                                               <i class="conum" data-value="5"></i><b>(5)</b>
    abstract FileCollection getDependencies()

    @Override
    void transform(TransformOutputs outputs) {
        def primaryInputFile = primaryInput.get().asFile
        if (parameters.externalClasspath.contains(primaryInput)) {           <i class="conum" data-value="6"></i><b>(6)</b>
            outputs.file(primaryInput)
        } else {
            def baseName = primaryInputFile.name.substring(0, primaryInputFile.name.length - 4)
            relocateJar(outputs.file("$baseName-relocated.jar"))
        }
    }

    private relocateJar(File output) {
        // implementation...
        def relocatedPackages = (dependencies.collectMany { readPackages(it) } + readPackages(primaryInput.get().asFile)) as Set
        def nonRelocatedPackages = parameters.externalClasspath.collectMany { readPackages(it) }
        def relocations = (relocatedPackages - nonRelocatedPackages).collect { packageName -&gt;
            def toPackage = "relocated.$packageName"
            println("$packageName -&gt; $toPackage")
            new Relocation(packageName, toPackage)
        }
        new JarRelocator(primaryInput.get().asFile, output, relocations).run()
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">@CacheableTransform                                                          <i class="conum" data-value="1"></i><b>(1)</b>
abstract class ClassRelocator : TransformAction&lt;ClassRelocator.Parameters&gt; {
    interface Parameters : TransformParameters {                             <i class="conum" data-value="2"></i><b>(2)</b>
        @get:CompileClasspath                                                <i class="conum" data-value="3"></i><b>(3)</b>
        val externalClasspath: ConfigurableFileCollection
        @get:Input
        val excludedPackage: Property&lt;String&gt;
    }

    @get:Classpath                                                           <i class="conum" data-value="4"></i><b>(4)</b>
    @get:InputArtifact
    abstract val primaryInput: Provider&lt;FileSystemLocation&gt;

    @get:CompileClasspath
    @get:InputArtifactDependencies                                           <i class="conum" data-value="5"></i><b>(5)</b>
    abstract val dependencies: FileCollection

    override
    fun transform(outputs: TransformOutputs) {
        val primaryInputFile = primaryInput.get().asFile
        if (parameters.externalClasspath.contains(primaryInputFile)) {       <i class="conum" data-value="6"></i><b>(6)</b>
            outputs.file(primaryInput)
        } else {
            val baseName = primaryInputFile.name.substring(0, primaryInputFile.name.length - 4)
            relocateJar(outputs.file("$baseName-relocated.jar"))
        }
    }

    private fun relocateJar(output: File) {
        // implementation...
        val relocatedPackages = (dependencies.flatMap { it.readPackages() } + primaryInput.get().asFile.readPackages()).toSet()
        val nonRelocatedPackages = parameters.externalClasspath.flatMap { it.readPackages() }
        val relocations = (relocatedPackages - nonRelocatedPackages).map { packageName -&gt;
            val toPackage = "relocated.$packageName"
            println("$packageName -&gt; $toPackage")
            Relocation(packageName, toPackage)
        }
        JarRelocator(primaryInput.get().asFile, output, relocations).run()
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Declare the transform cacheable</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Interface for the transform parameters</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Declare input type for each parameter</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Declare a normalization for the input artifact</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Inject the input artifact dependencies</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Use the parameters</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="registering_artifact_transforms"><a class="anchor" href="#registering_artifact_transforms"></a><a class="link" href="#registering_artifact_transforms">Registering artifact transforms</a></h3>
<div class="paragraph">
<p>You need to register the artifact transform actions, providing parameters if necessary, so that they can be selected when resolving dependencies.</p>
</div>
<div class="paragraph">
<p>In order to register an artifact transform, you must use <a href="../dsl/org.gradle.api.artifacts.dsl.DependencyHandler.html#org.gradle.api.artifacts.dsl.DependencyHandler:registerTransform(java.lang.Class,%20org.gradle.api.Action)">registerTransform()</a> within the <code>dependencies {}</code> block.</p>
</div>
<div class="paragraph">
<p>There are a few points to consider when using <code>registerTransform()</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>from</code> and <code>to</code> attributes are required.</p>
</li>
<li>
<p>The transform action itself can have configuration options. You can configure them with the <code>parameters {}</code> block.</p>
</li>
<li>
<p>You must register the transform on the project that has the configuration that will be resolved.</p>
</li>
<li>
<p>You can supply any type implementing <a href="../dsl/org.gradle.api.artifacts.transform.TransformAction.html">TransformAction</a> to the <code>registerTransform()</code> method.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example, imagine you want to unpack some dependencies and put the unpacked directories and files on the classpath.
You can do so by registering an artifact transform action of type <code>Unzip</code>, as shown here:</p>
</div>
<div class="exampleblock">
<div class="title">Example 152. Artifact transform registration without parameters</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def artifactType = Attribute.of('artifactType', String)

dependencies {
    registerTransform(Unzip) {
        from.attribute(artifactType, 'jar')
        to.attribute(artifactType, 'java-classes-directory')
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">val artifactType = Attribute.of("artifactType", String::class.java)

dependencies {
    registerTransform(Unzip::class) {
        from.attribute(artifactType, "jar")
        to.attribute(artifactType, "java-classes-directory")
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Another example is that you want to minify JARs by only keeping some <code>class</code> files from them.
Note the use of the <code>parameters {}</code> block to provide the classes to keep in the minified JARs to the <code>Minify</code> transform.</p>
</div>
<div class="exampleblock">
<div class="title">Example 153. Artifact transform registration with parameters</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def artifactType = Attribute.of('artifactType', String)
def minified = Attribute.of('minified', Boolean)
def keepPatterns = [
    "guava": [
        "com.google.common.base.Optional",
        "com.google.common.base.AbstractIterator"
    ] as Set
]


dependencies {
    registerTransform(Minify) {
        from.attribute(minified, false).attribute(artifactType, "jar")
        to.attribute(minified, true).attribute(artifactType, "jar")

        parameters {
            keepClassesByArtifact = keepPatterns
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">val artifactType = Attribute.of("artifactType", String::class.java)
val minified = Attribute.of("minified", Boolean::class.javaObjectType)
val keepPatterns = mapOf(
    "guava" to setOf(
        "com.google.common.base.Optional",
        "com.google.common.base.AbstractIterator"
    )
)


dependencies {
    registerTransform(Minify::class) {
        from.attribute(minified, false).attribute(artifactType, "jar")
        to.attribute(minified, true).attribute(artifactType, "jar")

        parameters {
            keepClassesByArtifact = keepPatterns
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="implementing_incremental_artifact_transforms"><a class="anchor" href="#implementing_incremental_artifact_transforms"></a><a class="link" href="#implementing_incremental_artifact_transforms">Implementing incremental artifact transforms</a></h3>
<div class="paragraph">
<p>Similar to <a href="custom_tasks.html#incremental_tasks">incremental tasks</a>, artifact transforms can avoid work by only processing changed files from the last execution.
This is done by using the <a href="../dsl/org.gradle.work.InputChanges.html">InputChanges</a> interface.
For artifact transforms, only the input artifact is an incremental input, and therefore the transform can only query for changes there.
In order to use <a href="../dsl/org.gradle.work.InputChanges.html">InputChanges</a> in the transform action, inject it into the action.
For more information on how to use <a href="../dsl/org.gradle.work.InputChanges.html">InputChanges</a>, see the corresponding documentation for <a href="custom_tasks.html#incremental_tasks">incremental tasks</a>.</p>
</div>
<div class="paragraph">
<p>Here is an example of an incremental transform that counts the lines of code in Java source files:</p>
</div>
<div class="exampleblock">
<div class="title">Example 154. Artifact transform for lines of code counting</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">abstract class CountLoc implements TransformAction&lt;TransformParameters.None&gt; {

    @Inject                                                             <i class="conum" data-value="1"></i><b>(1)</b>
    abstract InputChanges getInputChanges()

    @PathSensitive(PathSensitivity.RELATIVE)
    @InputArtifact
    abstract Provider&lt;FileSystemLocation&gt; getInput()

    @Override
    void transform(TransformOutputs outputs) {
        def outputDir = outputs.dir("${input.get().asFile.name}.loc")
        println("Running transform on ${input.get().asFile.name}, incremental: ${inputChanges.incremental}")
        inputChanges.getFileChanges(input).forEach { change -&gt;          <i class="conum" data-value="2"></i><b>(2)</b>
            def changedFile = change.file
            if (change.fileType != FileType.FILE) {
                return
            }
            def outputLocation = new File(outputDir, "${change.normalizedPath}.loc")
            switch (change.changeType) {
                case ADDED:
                case MODIFIED:
                    println("Processing file ${changedFile.name}")
                    outputLocation.parentFile.mkdirs()

                    outputLocation.text = changedFile.readLines().size()

                case REMOVED:
                    println("Removing leftover output file ${outputLocation.name}")
                    outputLocation.delete()

            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">abstract class CountLoc : TransformAction&lt;TransformParameters.None&gt; {

    @get:Inject                                                         <i class="conum" data-value="1"></i><b>(1)</b>
    abstract val inputChanges: InputChanges

    @get:PathSensitive(PathSensitivity.RELATIVE)
    @get:InputArtifact
    abstract val input: Provider&lt;FileSystemLocation&gt;

    override
    fun transform(outputs: TransformOutputs) {
        val outputDir = outputs.dir("${input.get().asFile.name}.loc")
        println("Running transform on ${input.get().asFile.name}, incremental: ${inputChanges.isIncremental}")
        inputChanges.getFileChanges(input).forEach { change -&gt;          <i class="conum" data-value="2"></i><b>(2)</b>
            val changedFile = change.file
            if (change.fileType != FileType.FILE) {
                return@forEach
            }
            val outputLocation = outputDir.resolve("${change.normalizedPath}.loc")
            when (change.changeType) {
                ChangeType.ADDED, ChangeType.MODIFIED -&gt; {

                    println("Processing file ${changedFile.name}")
                    outputLocation.parentFile.mkdirs()

                    outputLocation.writeText(changedFile.readLines().size.toString())
                }
                ChangeType.REMOVED -&gt; {
                    println("Removing leftover output file ${outputLocation.name}")
                    outputLocation.delete()
                }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Inject <code>InputChanges</code></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Query for changes in the input artifact</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<h1 id="working_in_a_multi_repo_environment" class="sect0"><a class="anchor" href="#working_in_a_multi_repo_environment"></a><a class="link" href="#working_in_a_multi_repo_environment">Working in a Multi-repo Environment</a></h1>
<div class="sect1">
<h2 id="composite_builds"><a class="anchor" href="#composite_builds"></a><a class="link" href="#composite_builds">Composing builds</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="composite_build_intro"><a class="anchor" href="#composite_build_intro"></a><a class="link" href="#composite_build_intro">What is a composite build?</a></h3>
<div class="paragraph">
<p>A composite build is simply a build that includes other builds.
In many ways a composite build is similar to a Gradle multi-project build, except that instead of including single <code>projects</code>, complete <code>builds</code> are included.</p>
</div>
<div class="paragraph">
<p>Composite builds allow you to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>combine builds that are usually developed independently, for instance when trying out a bug fix in a library that your application uses</p>
</li>
<li>
<p>decompose a large multi-project build into smaller, more isolated chunks that can be worked in independently or together as needed</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A build that is included in a composite build is referred to, naturally enough, as an "included build". Included builds do not share any configuration with the composite build, or the other included builds. Each included build is configured and executed in isolation.</p>
</div>
<div class="paragraph">
<p>Included builds interact with other builds via <a href="#sec:dependency_substitution_rules"><em>dependency substitution</em></a>.
If any build in the composite has a dependency that can be satisfied by the included build, then that dependency will be replaced by a project dependency on the included build.
<em>Because of the reliance on dependency substitution, composite builds may force configurations to be resolved earlier, when composing the task execution graph.
This can have a negative impact on overall build performance, because these configurations are not resolved in parallel.</em></p>
</div>
<div class="paragraph">
<p>By default, Gradle will attempt to determine the dependencies that can be substituted by an included build. However for more flexibility, it is possible to explicitly declare these substitutions if the default ones determined by Gradle are not correct for the composite. See <a href="#included_build_declaring_substitutions">Declaring substitutions</a>.</p>
</div>
<div class="paragraph">
<p>As well as consuming outputs via project dependencies, a composite build can directly declare task dependencies on included builds. Included builds are isolated, and are not able to declare task dependencies on the composite build or on other included builds.
See <a href="#included_build_task_dependencies">Depending on tasks in an included build</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="defining_composite_builds"><a class="anchor" href="#defining_composite_builds"></a><a class="link" href="#defining_composite_builds">Defining a composite build</a></h3>
<div class="paragraph">
<p>The following examples demonstrate the various ways that 2 Gradle builds that are normally developed separately can be combined into a composite build. For these examples, the <code>my-utils</code> multi-project build produces 2 different java libraries (<code>number-utils</code> and <code>string-utils</code>), and the <code>my-app</code> build produces an executable using functions from those libraries.</p>
</div>
<div class="paragraph">
<p>The <code>my-app</code> build does not have direct dependencies on <code>my-utils</code>.
Instead, it declares binary dependencies on the libraries produced by <code>my-utils</code>.</p>
</div>
<div class="exampleblock">
<div class="title">Example 155. Dependencies of my-app</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">my-app/build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">plugins {
    id 'java'
    id 'application'
    id 'idea'
}

group "org.sample"
version "1.0"

application {
    mainClass = "org.sample.myapp.Main"
}

dependencies {
    implementation "org.sample:number-utils:1.0"
    implementation "org.sample:string-utils:1.0"
}

repositories {
    jcenter()
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">my-app/build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">plugins {
    java
    application
    idea
}

group = "org.sample"
version = "1.0"

application {
    mainClass.set("org.sample.myapp.Main")
}

dependencies {
    implementation("org.sample:number-utils:1.0")
    implementation("org.sample:string-utils:1.0")
}

repositories {
    jcenter()
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="command_line_composite"><a class="anchor" href="#command_line_composite"></a><a class="link" href="#command_line_composite">Defining a composite build via <code>--include-build</code></a></h4>
<div class="paragraph">
<p>The <code>--include-build</code> command-line argument turns the executed build into a composite, substituting dependencies from the included build into the executed build.</p>
</div>
</div>
<div class="sect3">
<h4 id="example_declaring_a_command_line_composite"><a class="anchor" href="#example_declaring_a_command_line_composite"></a><a class="link" href="#example_declaring_a_command_line_composite">Example: Declaring a command-line composite</a></h4>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle --include-build ../my-utils run</code></strong></div>
<div class="content">
<pre>&gt; gradle --include-build ../my-utils run
&gt; Task :processResources NO-SOURCE
&gt; Task :my-utils:string-utils:compileJava
&gt; Task :my-utils:string-utils:processResources NO-SOURCE
&gt; Task :my-utils:string-utils:classes
&gt; Task :my-utils:string-utils:jar
&gt; Task :my-utils:number-utils:compileJava
&gt; Task :my-utils:number-utils:processResources NO-SOURCE
&gt; Task :my-utils:number-utils:classes
&gt; Task :my-utils:number-utils:jar
&gt; Task :compileJava
&gt; Task :classes

&gt; Task :run
The answer is 42


BUILD SUCCESSFUL in 0s
2 actionable tasks: 2 executed</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="settings_defined_composite"><a class="anchor" href="#settings_defined_composite"></a><a class="link" href="#settings_defined_composite">Defining a composite build via the settings file</a></h4>
<div class="paragraph">
<p>It&#8217;s possible to make the above arrangement persistent, by using <a href="../dsl/org.gradle.api.initialization.Settings.html#org.gradle.api.initialization.Settings:includeBuild(java.lang.Object)">Settings.includeBuild(java.lang.Object)</a> to declare the included build in the <code>settings.gradle</code> (or <code>settings.gradle.kts</code> in Kotlin) file.
The settings file can be used to add subprojects and included builds at the same time. Included builds are added by location.
See the examples below for more details.</p>
</div>
</div>
<div class="sect3">
<h4 id="separate_composite"><a class="anchor" href="#separate_composite"></a><a class="link" href="#separate_composite">Defining a separate composite build</a></h4>
<div class="paragraph">
<p>One downside of the above approach is that it requires you to modify an existing build, rendering it less useful as a standalone build. One way to avoid this is to define a separate composite build, whose only purpose is to combine otherwise separate builds.</p>
</div>
<div class="exampleblock">
<div class="title">Example 156. Declaring a separate composite</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">composite/settings.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">rootProject.name = 'adhoc'

includeBuild '../my-app'
includeBuild '../my-utils'</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">composite/settings.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">rootProject.name = "adhoc"

includeBuild("../my-app")
includeBuild("../my-utils")</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In this scenario, the 'main' build that is executed is the composite, and it doesn&#8217;t define any useful tasks to execute itself. In order to execute the 'run' task in the 'my-app' build, the composite build must define a delegating task.</p>
</div>
<div class="exampleblock">
<div class="title">Example 157. Depending on task from included build</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">composite/build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">task run {
    dependsOn gradle.includedBuild('my-app').task(':run')
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">composite/build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">tasks.register("run") {
    dependsOn(gradle.includedBuild("my-app").task(":run"))
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>More details about tasks that depend on included build tasks are below.</p>
</div>
</div>
<div class="sect3">
<h4 id="included_builds"><a class="anchor" href="#included_builds"></a><a class="link" href="#included_builds">Restrictions on included builds</a></h4>
<div class="paragraph">
<p>Most builds can be included into a composite, including other composite builds.
However there are some limitations.</p>
</div>
<div class="paragraph">
<p>Every included build:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>must not have a <code>rootProject.name</code> the same as another included build.</p>
</li>
<li>
<p>must not have a <code>rootProject.name</code> the same as a top-level project of the composite build.</p>
</li>
<li>
<p>must not have a <code>rootProject.name</code> the same as the composite build <code>rootProject.name</code>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="interacting_with_composite_builds"><a class="anchor" href="#interacting_with_composite_builds"></a><a class="link" href="#interacting_with_composite_builds">Interacting with a composite build</a></h3>
<div class="paragraph">
<p>In general, interacting with a composite build is much the same as a regular multi-project build.
Tasks can be executed, tests can be run, and builds can be imported into the IDE.</p>
</div>
<div class="sect3">
<h4 id="composite_build_executing_tasks"><a class="anchor" href="#composite_build_executing_tasks"></a><a class="link" href="#composite_build_executing_tasks">Executing tasks</a></h4>
<div class="paragraph">
<p>Tasks from the composite build can be executed from the command line, or from your IDE.
Executing a task will result in direct task dependencies being executed, as well as those tasks required to build dependency artifacts from included builds.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>There is not (yet) any means to directly execute a task from an included build via the command line.
Included build tasks are automatically executed in order to generate required dependency artifacts, or the <a href="#included_build_task_dependencies">including build can declare a dependency on a task from an included build</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="composite_build_ide_integration"><a class="anchor" href="#composite_build_ide_integration"></a><a class="link" href="#composite_build_ide_integration">Importing into the IDE</a></h4>
<div class="paragraph">
<p>One of the most useful features of composite builds is IDE integration. By applying the <a href="idea_plugin.html#idea_plugin">idea</a> or <a href="eclipse_plugin.html#eclipse_plugin">eclipse</a> plugin to your build, it is possible to generate a single IDEA or Eclipse project that permits all builds in the composite to be developed together.</p>
</div>
<div class="paragraph">
<p>In addition to these Gradle plugins, recent versions of <a href="https://www.jetbrains.com/idea/">IntelliJ IDEA</a> and <a href="https://projects.eclipse.org/projects/tools.buildship">Eclipse Buildship</a> support direct import of a composite build.</p>
</div>
<div class="paragraph">
<p>Importing a composite build permits sources from separate Gradle builds to be easily developed together. For every included build, each sub-project is included as an IDEA Module or Eclipse Project.
Source dependencies are configured, providing cross-build navigation and refactoring.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="included_build_declaring_substitutions"><a class="anchor" href="#included_build_declaring_substitutions"></a><a class="link" href="#included_build_declaring_substitutions">Declaring the dependencies substituted by an included build</a></h3>
<div class="paragraph">
<p>By default, Gradle will configure each included build in order to determine the dependencies it can provide.
The algorithm for doing this is very simple: Gradle will inspect the group and name for the projects in the included build, and substitute project dependencies for any external dependency matching <code>${project.group}:${project.name}</code>.</p>
</div>
<div class="paragraph">
<p>There are cases when the default substitutions determined by Gradle are not sufficient, or they are not correct for a particular composite.
For these cases it is possible to explicitly declare the substitutions for an included build.
Take for example a single-project build 'anonymous-library', that produces a java utility library but does not declare a value for the group attribute:</p>
</div>
<div class="exampleblock">
<div class="title">Example 158. Build that does not declare group attribute</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">plugins {
    id 'java'
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">plugins {
    java
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>When this build is included in a composite, it will attempt to substitute for the dependency module "undefined:anonymous-library" ("undefined" being the default value for <code>project.group</code>, and "anonymous-library" being the root project name).
Clearly this isn&#8217;t going to be very useful in a composite build.
To use the unpublished library unmodified in a composite build, the composing build can explicitly declare the substitutions that it provides:</p>
</div>
<div class="exampleblock">
<div class="title">Example 159. Declaring the substitutions for an included build</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">rootProject.name = 'app'

includeBuild('../anonymous-library') {
    dependencySubstitution {
        substitute module('org.sample:number-utils') with project(':')
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">rootProject.name = "app"

includeBuild("../anonymous-library") {
    dependencySubstitution {
        substitute(module("org.sample:number-utils")).with(project(":"))
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>With this configuration, the "my-app" composite build will substitute any dependency on <code>org.sample:number-utils</code> with a dependency on the root project of "anonymous-library".</p>
</div>
<div class="sect3">
<h4 id="included_build_substitution_requirements"><a class="anchor" href="#included_build_substitution_requirements"></a><a class="link" href="#included_build_substitution_requirements">Cases where included build substitutions must be declared</a></h4>
<div class="paragraph">
<p>Many builds that use the <code>uploadArchives</code> task to publish artifacts will function automatically as an included build, without declared substitutions.
Here are some common cases where declared substitutions are required:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>When the <code>archivesBaseName</code> property is used to set the name of the published artifact.</p>
</li>
<li>
<p>When a configuration other than <code>default</code> is published: this usually means a task other than <code>uploadArchives</code> is used.</p>
</li>
<li>
<p>When the <code>MavenPom.addFilter()</code> is used to publish artifacts that don&#8217;t match the project name.</p>
</li>
<li>
<p>When the <code>maven-publish</code> or <code>ivy-publish</code> plugins are used for publishing, and the publication coordinates don&#8217;t match <code>${project.group}:${project.name}</code>.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="included_build_substitution_limitations"><a class="anchor" href="#included_build_substitution_limitations"></a><a class="link" href="#included_build_substitution_limitations">Cases where composite build substitutions won&#8217;t work</a></h4>
<div class="paragraph">
<p>Some builds won&#8217;t function correctly when included in a composite, even when dependency substitutions are explicitly declared. This limitation is due to the fact that a project dependency that is substituted will always point to the <code>default</code> configuration of the target project.
Any time that the artifacts and dependencies specified for the default configuration of a project don&#8217;t match what is actually published to a repository, then the composite build may exhibit different behaviour.</p>
</div>
<div class="paragraph">
<p>Here are some cases where the publish module metadata may be different from the project default configuration:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>When a configuration other than <code>default</code> is published.</p>
</li>
<li>
<p>When the <code>maven-publish</code> or <code>ivy-publish</code> plugins are used.</p>
</li>
<li>
<p>When the <code>POM</code> or <code>ivy.xml</code> file is tweaked as part of publication.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Builds using these features function incorrectly when included in a composite build.
We plan to improve this in the future.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="included_build_task_dependencies"><a class="anchor" href="#included_build_task_dependencies"></a><a class="link" href="#included_build_task_dependencies">Depending on tasks in an included build</a></h3>
<div class="paragraph">
<p>While included builds are isolated from one another and cannot declare direct dependencies, a composite build is able to declare task dependencies on its included builds. The included builds are accessed using <a href="../dsl/org.gradle.api.invocation.Gradle.html#org.gradle.api.invocation.Gradle:includedBuilds">Gradle.getIncludedBuilds()</a> or <a href="../dsl/org.gradle.api.invocation.Gradle.html#org.gradle.api.invocation.Gradle:includedBuild(java.lang.String)">Gradle.includedBuild(java.lang.String)</a>, and a task reference is obtained via the <a href="../dsl/org.gradle.api.initialization.IncludedBuild.html#org.gradle.api.initialization.IncludedBuild:task(java.lang.String)">IncludedBuild.task(java.lang.String)</a> method.</p>
</div>
<div class="paragraph">
<p>Using these APIs, it is possible to declare a dependency on a task in a particular included build, or tasks with a certain path in all or some of the included builds.</p>
</div>
<div class="exampleblock">
<div class="title">Example 160. Depending on a single task from an included build</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">composite/build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">task run {
    dependsOn gradle.includedBuild('my-app').task(':run')
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">composite/build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">tasks.register("run") {
    dependsOn(gradle.includedBuild("my-app").task(":run"))
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 161. Depending on a task with path in all included builds</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">task publishDeps {
    dependsOn gradle.includedBuilds*.task(':publishIvyPublicationToIvyRepository')
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">tasks.register("publishDeps") {
    dependsOn(gradle.includedBuilds.map { it.task(":publishIvyPublicationToIvyRepository") })
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="current_limitations_and_future_work"><a class="anchor" href="#current_limitations_and_future_work"></a><a class="link" href="#current_limitations_and_future_work">Current limitations and future plans for composite builds</a></h3>
<div class="paragraph">
<p>We think composite builds are pretty useful already.
However, there are some things that don&#8217;t yet work the way we&#8217;d like, and other improvements that we think will make things work even better.</p>
</div>
<div class="paragraph">
<p>Limitations of the current implementation include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>No support for included builds that have publications that don&#8217;t mirror the project default configuration. See <a href="#included_build_substitution_limitations">Cases where composite builds won&#8217;t work</a>.</p>
</li>
<li>
<p>Software model based native builds are not supported. (Binary dependencies are not yet supported for native builds).</p>
</li>
<li>
<p>Multiple composite builds may conflict when run in parallel, if more than one includes the same build. Gradle does not share the project lock of a shared composite build to between Gradle invocation to prevent concurrent execution.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Improvements we have planned for upcoming releases include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Better detection of dependency substitution, for build that publish with custom coordinates, builds that produce multiple components, etc. This will reduce the cases where dependency substitution needs to be explicitly declared for an included build.</p>
</li>
<li>
<p>The ability to target a task or tasks in an included build directly from the command line. We are currently exploring syntax options for allowing this functionality, which will remove many cases where a delegating task is required in the composite.</p>
</li>
<li>
<p>Making the implicit <code>buildSrc</code> project an included build.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<h1 id="publishing_libraries" class="sect0"><a class="anchor" href="#publishing_libraries"></a><a class="link" href="#publishing_libraries">Publishing Libraries</a></h1>
<div class="sect1">
<h2 id="publishing_components"><a class="anchor" href="#publishing_components"></a><a class="link" href="#publishing_components">Publishing a project as module</a></h2>
<div class="sectionbody">
<div id="publishing_overview" class="paragraph">
<p>The vast majority of software projects build something that aims to be consumed in some way.
It could be a library that other software projects use or it could be an application for end users.
<em>Publishing</em> is the process by which the thing being built is made available to consumers.</p>
</div>
<div class="paragraph">
<p>In Gradle, that process looks like this:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Define <a href="#publishing_overview:what">what</a> to publish</p>
</li>
<li>
<p>Define <a href="#publishing_overview:where">where</a> to publish it to</p>
</li>
<li>
<p><a href="#publishing_overview:how">Do</a> the publishing</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Each of the these steps is dependent on the type of repository to which you want to publish artifacts.
The two most common types are Maven-compatible and Ivy-compatible repositories, or Maven and Ivy repositories for short.</p>
</div>
<div class="paragraph">
<p>As of Gradle 6.0, the <a href="#sec:understanding-gradle-module-md">Gradle Module Metadata</a> will always be published alongside the Ivy XML or Maven POM metadata file.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Looking for information on upload tasks and the <code>archives</code> configuration?
See the <a href="artifact_management.html#artifact_management">Legacy Publishing</a> chapter, a feature which is now deprecated and scheduled for removal.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Gradle makes it easy to publish to these types of repository by providing some prepackaged infrastructure in the form of the <a href="publishing_maven.html#publishing_maven">Maven Publish Plugin</a> and the <a href="publishing_ivy.html#publishing_ivy">Ivy Publish Plugin</a>.
These plugins allow you to configure what to publish and perform the publishing with a minimum of effort.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/publishing-process.png" alt="publishing process">
</div>
<div class="title">Figure 13. The publishing process</div>
</div>
<div class="paragraph">
<p>Let&#8217;s take a look at those steps in more detail:</p>
</div>
<div id="publishing_overview:what" class="dlist">
<dl>
<dt class="hdlist1">What to publish</dt>
<dd>
<p>Gradle needs to know what files and information to publish so that consumers can use your project.
This is typically a combination of <a href="#sub:terminology_artifact">artifacts</a> and metadata that Gradle calls a <a href="#sub:terminology_publication">publication</a>.
Exactly what a publication contains depends on the type of repository it&#8217;s being published to.</p>
<div class="paragraph">
<p>For example, a publication destined for a Maven repository includes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>One or more artifacts  typically built by the project,</p>
</li>
<li>
<p>The Gradle Module Metadata file which will describe the variants of the published component,</p>
</li>
<li>
<p>The Maven POM file will identify the primary artifact and its dependencies.
The primary artifact is typically the project&#8217;s production JAR and secondary artifacts might consist of "-sources" and "-javadoc" JARs.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In addition, Gradle will publish checksums for all of the above, and <a href="#">signatures</a> when configured to do so.
From Gradle 6.0 onwards, this includes <code>SHA256</code> and <code>SHA512</code> checksums.</p>
</div>
</dd>
</dl>
</div>
<div id="publishing_overview:where" class="dlist">
<dl>
<dt class="hdlist1">Where to publish</dt>
<dd>
<p>Gradle needs to know where to publish artifacts so that consumers can get hold of them. This is done via <a href="#sub:terminology_repository">repositories</a>, which store and make available all sorts of artifact.
Gradle also needs to interact with the repository, which is why you must provide the type of the repository and its location.</p>
</dd>
</dl>
</div>
<div id="publishing_overview:how" class="dlist">
<dl>
<dt class="hdlist1">How to publish</dt>
<dd>
<p>Gradle automatically generates publishing tasks for all possible combinations of publication and repository, allowing you to publish any artifact to any repository. If you&#8217;re publishing to a Maven repository, the tasks are of type <a href="../dsl/org.gradle.api.publish.maven.tasks.PublishToMavenRepository.html">PublishToMavenRepository</a>, while for Ivy repositories the tasks are of type <a href="../dsl/org.gradle.api.publish.ivy.tasks.PublishToIvyRepository.html">PublishToIvyRepository</a>.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>What follows is a practical example that demonstrates the entire publishing process.</p>
</div>
<div class="sect2">
<h3 id="sec:basic_publishing"><a class="anchor" href="#sec:basic_publishing"></a><a class="link" href="#sec:basic_publishing">Setting up basic publishing</a></h3>
<div class="paragraph">
<p>The first step in publishing, irrespective of your project type, is to apply the appropriate publishing plugin. As mentioned in the introduction, Gradle supports both Maven and Ivy repositories via the following plugins:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="publishing_maven.html#publishing_maven">Maven Publish Plugin</a></p>
</li>
<li>
<p><a href="publishing_ivy.html#publishing_ivy">Ivy Publish Plugin</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These provide the specific publication and repository classes needed to configure publishing for the corresponding repository type. Since Maven repositories are the most commonly used ones, they will be the basis for this example and for the other samples in the chapter. Don&#8217;t worry, we will explain how to adjust individual samples for Ivy repositories.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s assume we&#8217;re working with a simple Java library project, so only the following plugins are applied:</p>
</div>
<div class="exampleblock">
<div class="title">Example 162. Applying the necessary plugins</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">plugins {
    id 'java-library'
    id 'maven-publish'
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">plugins {
    `java-library`
    `maven-publish`
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Once the appropriate plugin has been applied, you can configure the publications and repositories. For this example, we want to publish the project&#8217;s production JAR file the one produced by the <code>jar</code> task  to a custom, Maven repository. We do that with the following <code>publishing {}</code> block, which is backed by <a href="../dsl/org.gradle.api.publish.PublishingExtension.html">PublishingExtension</a>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 163. Configuring a Java library for publishing</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">group = 'org.example'
version = '1.0'

publishing {
    publications {
        myLibrary(MavenPublication) {
            from components.java
        }
    }

    repositories {
        maven {
            name = 'myRepo'
            url = "file://${buildDir}/repo"
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">group = "org.example"
version = "1.0"

publishing {
    publications {
        create&lt;MavenPublication&gt;("myLibrary") {
            from(components["java"])
        }
    }

    repositories {
        maven {
            name = "myRepo"
            url = uri("file://${buildDir}/repo")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This defines a publication called "myLibrary" that can be published to a Maven repositoryby virtue of its type: <a href="../dsl/org.gradle.api.publish.maven.MavenPublication.html">MavenPublication</a>.
This publication consists of just the production JAR artifact and its metadata, which combined are represented by the <code>java</code> <a href="#sub:terminology_component">component</a> of the project.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Components are the standard way of defining a publication. They are provided by plugins, usually of the language or platform variety. For example, the Java Plugin defines the <code>components.java</code> <a href="../javadoc/org/gradle/api/component/SoftwareComponent.html">SoftwareComponent</a>, while the War Plugin defines <code>components.web</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The example also defines a file-based Maven repository with the name "myRepo". Such a file-based repository is convenient for a sample, but real-world builds typically work with HTTPS-based repository servers, such as Maven Central or an internal company server.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
You may define one, and only one, repository without a name. This translates to an implicit name of "Maven" for Maven repositories and "Ivy" for Ivy repositories. All other repository definitions must be given an explicit name.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In combination with the project&#8217;s <code>group</code> and <code>version</code>, the publication and repository definitions provide everything that Gradle needs to publish the project&#8217;s production JAR. Gradle will then create a dedicated <code>publishMyLibraryPublicationToMyRepoRepository</code> task that does just that. Its name is based on the template <code>publish<em>PubName</em>PublicationTo<em>RepoName</em>Repository</code>. See the appropriate publishing plugin&#8217;s documentation for more details on the nature of this task and any other tasks that may be available to you.</p>
</div>
<div class="paragraph">
<p>You can either execute the individual publishing tasks directly, or you can execute <code>publish</code>, which will run all the available publishing tasks. In this example, <code>publish</code> will just run <code>publishMyLibraryPublicationToMavenRepository</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Basic publishing to an Ivy repository is very similar: you simply use the Ivy Publish Plugin, replace  <code>MavenPublication</code> with <a href="../dsl/org.gradle.api.publish.ivy.IvyPublication.html">IvyPublication</a>, and use <code>ivy</code> instead of <code>maven</code> in the repository definition.</p>
</div>
<div class="paragraph">
<p>There are differences between the two types of repository, particularly around the extra metadata that each support for example, Maven repositories require a POM file while Ivy ones have their own metadata format  so see the plugin chapters for comprehensive information on how to configure both publications and repositories for whichever repository type you&#8217;re working with.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>That&#8217;s everything for the basic use case. However, many projects need more control over what gets published, so we look at several common scenarios in the following sections.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec:understanding-gradle-module-md"><a class="anchor" href="#sec:understanding-gradle-module-md"></a><a class="link" href="#sec:understanding-gradle-module-md">Understanding Gradle Module Metadata</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Gradle Module Metadata is a format used to serialize the Gradle component model.
It is similar to <a href="https://maven.apache.org/pom.html">Apache Maven's POM file</a> or <a href="http://ant.apache.org/ivy/">Apache Ivy ivy.xml</a> files.
The goal of metadata files is to provide <em>to consumers</em> a reasonable model of what is published on a repository.</p>
</div>
<div class="paragraph">
<p>Gradle Module Metadata is a unique format aimed at improving dependency resolution by making it multi-platform and variant-aware.</p>
</div>
<div class="paragraph">
<p>In particular, Gradle Module Metadata supports:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#rich-version-constraints">rich version constraints</a></p>
</li>
<li>
<p><a href="#sec:adding-constraints-transitive-deps">dependency constraints</a></p>
</li>
<li>
<p><a href="#declaring-component-capabilities">component capabilities</a></p>
</li>
<li>
<p><a href="#understanding-variant-selection">variant-aware resolution</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Publication of Gradle Module Metadata will enable better dependency management for your consumers:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>early discovery of problems by detecting <a href="#declaring-component-capabilities">incompatible modules</a></p>
</li>
<li>
<p>consistent selection of <a href="#targeting-different-platforms">platform-specific dependencies</a></p>
</li>
<li>
<p>native <a href="#version_alignment">dependency version alignement</a></p>
</li>
<li>
<p>automatically getting dependencies for specific <a href="#">features of your library</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Gradle Module Metadata is automatically published when using the <a href="publishing_maven.html">Maven Publish plugin</a> or the <a href="publishing_ivy.html">Ivy Publish plugin</a>.
It is <em>not</em> supported on the legacy <code>maven</code> and <code>ivy</code> plugins.</p>
</div>
<div class="paragraph">
<p>The specification for Gradle Module Metadata specification can be found <a href="https://github.com/gradle/gradle/blob/master/subprojects/docs/src/docs/design/gradle-module-metadata-latest-specification.md">here</a>.</p>
</div>
<div class="sect2">
<h3 id="sub:mapping-with-other-formats"><a class="anchor" href="#sub:mapping-with-other-formats"></a><a class="link" href="#sub:mapping-with-other-formats">Mapping with other formats</a></h3>
<div class="paragraph">
<p>Gradle Module Metadata is automatically published on Maven or Ivy repositories.
However, it doesn&#8217;t replace the <em>pom.xml</em> or <em>ivy.xml</em> files: it is published alongside those files.
This is done to maximize compatibility with third-party build tools.</p>
</div>
<div class="paragraph">
<p>Gradle does its best to map Gradle-specific concepts to Maven or Ivy.
When a build file uses features that can only be represented in Gradle Module Metadata, Gradle will warn you at publication time.
The table below summarizes how some Gradle specific features are mapped to Maven and Ivy:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 10. Mapping of Gradle specific concepts to Maven and Ivy</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Gradle</th>
<th class="tableblock halign-left valign-top">Maven</th>
<th class="tableblock halign-left valign-top">Ivy</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#sec:adding-constraints-transitive-deps">dependency constraints</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;dependencyManagement&gt;</code> dependencies</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not published</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gradle dependency constraints are <em>transitive</em>, while Maven&#8217;s dependency management block <em>isn&#8217;t</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#rich-version-constraints">rich version constraints</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Publishes the <em>requires</em> version</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Published the <em>requires</em> version</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#declaring-component-capabilities">component capabilities</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not published</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not published</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Component capabilities are unique to Gradle</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#">Feature variants</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Variant artifacts are uploaded, dependencies are published as _optional dependencies</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Variant artifacts are uploaded, dependencies are not published</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Feature variants are a good replacement for optional dependencies</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#sec:publishing-custom-components">Custom component types</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Artifacts are uploaded, dependencies are those described by the mapping</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Artifacts are uploaded, dependencies are ignored</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Custom component types are probably not consumable from Maven or Ivy in any case. They usually exist in the context of a custom ecosystem.</p></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="disabling_metadata_compatibility_publication_warnings"><a class="anchor" href="#disabling_metadata_compatibility_publication_warnings"></a><a class="link" href="#disabling_metadata_compatibility_publication_warnings">Disabling metadata compatibility publication warnings</a></h4>
<div class="paragraph">
<p>If you want to suppress warnings, you can use the following APIs to do so:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For Maven, see the <code>suppress*</code> methods in <a href="../dsl/org.gradle.api.publish.maven.MavenPublication.html#org.gradle.api.publish.maven.MavenPublication:suppressAllPomMetadataWarnings()">MavenPublication</a></p>
</li>
<li>
<p>For Ivy, see the <code>suppress*</code> methods in <a href="../dsl/org.gradle.api.publish.ivy.IvyPublication.html#org.gradle.api.publish.ivy.IvyPublication:suppressAllIvyMetadataWarnings()">IvyPublication</a></p>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 164. Disabling publication warnings</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">    publications {
        maven(MavenPublication) {
            from components.java
            suppressPomMetadataWarningsFor('runtimeElements')
        }
    }</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">    publications {
        register&lt;MavenPublication&gt;("maven") {
            from(components["java"])
            suppressPomMetadataWarningsFor("runtimeElements")
        }
    }</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sub:interactions-other-build-tools"><a class="anchor" href="#sub:interactions-other-build-tools"></a><a class="link" href="#sub:interactions-other-build-tools">Interactions with other build tools</a></h3>
<div class="paragraph">
<p>Because Gradle Module Metadata is not widely spread and that it aims at <a href="#sub:mapping-with-other-formats">maximizing compatibility with other tools</a>, Gradle does a couple of things:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Gradle Module Metadata is systematically published alongside the normal descriptor for a given repository (Maven or Ivy)</p>
</li>
<li>
<p>the <code>pom.xml</code> or <code>ivy.xml</code> file will contain a <em>marker comment</em> which tells Gradle that Gradle Module Metadata exists for this module</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The goal of the marker is <em>not</em> for other tools to parse module metadata: it&#8217;s for Gradle users only.
It explains to Gradle that a <em>better</em> module metadata file exists and that it should use it instead.
It doesn&#8217;t mean that consumption from Maven or Ivy would be broken either, only that it works in <a href="#sub:mapping-with-other-formats">degraded mode</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This must be seen as a <em>performance optimization</em>: instead of having to do 2 network requests, one to get Gradle Module Metadata, then one to get the POM/Ivy file in case of a miss, Gradle will first look at the file which is most likely to be present, then only perform a 2nd request if the module was actually published with Gradle Module Metadata.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you know that the modules you depend on are always published with Gradle Module Metadata, you can optimize the network calls configuring the metadata sources for a repository:</p>
</div>
<div class="exampleblock">
<div class="title">Example 165. Resolving Gradle Module Metadata only</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">    repositories {
        maven {
            url "http://repo.mycompany.com/repo"
            metadataSources {
                gradleMetadata()
            }
        }
    }</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">    repositories {
        maven {
            setUrl("http://repo.mycompany.com/repo")
            metadataSources {
                gradleMetadata()
            }
        }
    }</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sub:gmm-validation"><a class="anchor" href="#sub:gmm-validation"></a><a class="link" href="#sub:gmm-validation">Gradle Module Metadata validation</a></h3>
<div class="paragraph">
<p>Gradle Module Metadata is validated before being published.</p>
</div>
<div class="paragraph">
<p>The following rules are enforced:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Variant names must be unique,</p>
</li>
<li>
<p>Each variant must have at least <a href="#">one attribute</a>,</p>
</li>
<li>
<p>Two variants cannot have the <a href="#">exact same attributes and capabilities</a>,</p>
</li>
<li>
<p>If there are dependencies, at least one, across all variants, must carry <a href="#">version information</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These rules ensure the quality of the metadata produced, and help confirm that consumption will not be problematic.</p>
</div>
</div>
<div class="sect2">
<h3 id="sub:disabling-gmm-publication"><a class="anchor" href="#sub:disabling-gmm-publication"></a><a class="link" href="#sub:disabling-gmm-publication">Disabling Gradle Module Metadata publication</a></h3>
<div class="paragraph">
<p>There are situations where you might want to disable publication of Gradle Module Metadata:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the repository you are uploading to rejects the metadata file (unknown format)</p>
</li>
<li>
<p>you are using Maven or Ivy specific concepts which are not properly mapped to Gradle Module Metadata</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In this case, disabling the publication of Gradle Module Metadata is done simply by disabling the task which generates the metadata file:</p>
</div>
<div class="exampleblock">
<div class="title">Example 166. Disabling publication of Gradle Module Metadata</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">    tasks.withType(GenerateModuleMetadata) {
        enabled = false
    }</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">    tasks.withType&lt;GenerateModuleMetadata&gt; {
        enabled = false
    }</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="publishing_maven:signing"><a class="anchor" href="#publishing_maven:signing"></a><a class="link" href="#publishing_maven:signing">Signing artifacts</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <a href="signing_plugin.html#signing_plugin">Signing Plugin</a> can be used to sign all artifacts and metadata files that make up a publication, including Maven POM files and Ivy module descriptors. In order to use it:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Apply the Signing Plugin</p>
</li>
<li>
<p>Configure the <a href="signing_plugin.html#sec:signatory_credentials">signatory credentials</a>  follow the link to see how</p>
</li>
<li>
<p>Specify the publications you want signed</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Here&#8217;s an example that configures the plugin to sign the <code>mavenJava</code> publication:</p>
</div>
<div class="exampleblock">
<div class="title">Example 167. Signing a publication</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">signing {
    sign publishing.publications.mavenJava
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">signing {
    sign(publishing.publications["mavenJava"])
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This will create a <code>Sign</code> task for each publication you specify and wire all <code>publish<em>PubName</em>PublicationTo<em>RepoName</em>Repository</code> tasks to depend on it. Thus, publishing any publication will automatically create and publish the signatures for its artifacts and metadata, as you can see from this output:</p>
</div>
<div class="sect2">
<h3 id="example_sign_and_publish_a_project"><a class="anchor" href="#example_sign_and_publish_a_project"></a><a class="link" href="#example_sign_and_publish_a_project">Example: Sign and publish a project</a></h3>
<div class="listingblock">
<div class="title">Output of <code>gradle publish</code></div>
<div class="content">
<pre>&gt; gradle publish
&gt; Task :compileJava
&gt; Task :processResources
&gt; Task :classes
&gt; Task :jar
&gt; Task :javadoc
&gt; Task :javadocJar
&gt; Task :sourcesJar
&gt; Task :generateMetadataFileForMavenJavaPublication
&gt; Task :generatePomFileForMavenJavaPublication
&gt; Task :signMavenJavaPublication
&gt; Task :publishMavenJavaPublicationToMavenRepository
&gt; Task :publish

BUILD SUCCESSFUL in 0s
10 actionable tasks: 10 executed</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="customizing_publishing"><a class="anchor" href="#customizing_publishing"></a><a class="link" href="#customizing_publishing">Customizing publishing</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="sec:adding-variants-to-existing-components"><a class="anchor" href="#sec:adding-variants-to-existing-components"></a><a class="link" href="#sec:adding-variants-to-existing-components">Modifying and adding variants to existing components for publishing</a></h3>
<div class="paragraph">
<p>Gradle&#8217;s publication model is based on the notion of <em>components</em>, which are defined by plugins.
For example, the Java Library plugin defines a <code>java</code> component which corresponds to a library, but the Java Platform plugin defines another kind of component, named <code>javaPlatform</code>, which is effectively a different kind of software component (a <em>platform</em>).</p>
</div>
<div class="paragraph">
<p>Sometimes we want to add <em>more variants</em> to or modify <em>existing variants</em> of an existing component.
For example, if you <a href="#targeting-different-platforms">added a variant of a Java library for a different platform</a>, you may just want to declare this additional variant on the <code>java</code> component itself.
In general, declaring additional variants is often the best solution to publish <em>additional artifacts</em>.</p>
</div>
<div class="paragraph">
<p>To perform such additions or modifications, the <code>AdhocComponentWithVariants</code> interface declares two methods called <code>addVariantsFromConfiguration</code> and <code>withVariantsFromConfiguration</code> which accept two parameters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the <a href="#sec:resolvable-consumable-configs">outgoing configuration</a> that is used as a variant source</p>
</li>
<li>
<p>a customization action which allows you to <em>filter</em> which variants are going to be published</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To utilise these methods, you must make sure that the <code>SoftwareComponent</code> you work with is itself an <code>AdhocComponentWithVariants</code>, which is the case for the components created by the Java plugins (Java, Java Library, Java Platform).
Adding a variant is then very simple:</p>
</div>
<div class="exampleblock">
<div class="title">Example 168. Adding a variant to an existing software component</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">InstrumentedJarsPlugin.groovy</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">        AdhocComponentWithVariants javaComponent = (AdhocComponentWithVariants) project.components.findByName("java")
        javaComponent.addVariantsFromConfiguration(outgoing) {
            // dependencies for this variant are considered runtime dependencies
            it.mapToMavenScope("runtime")
            // and also optional dependencies, because we don't want them to leak
            it.mapToOptional()
        }</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">InstrumentedJarsPlugin.kt</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">        val javaComponent = components.findByName("java") as AdhocComponentWithVariants
        javaComponent.addVariantsFromConfiguration(outgoing) {
            // dependencies for this variant are considered runtime dependencies
            mapToMavenScope("runtime")
            // and also optional dependencies, because we don't want them to leak
            mapToOptional()
        }</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In other cases, you might want to modify a variant that was added by one of the Java plugins already.
For example, if you activate publishing of Javadoc and sources, these become additional variants of the <code>java</code> component.
If you only want to publish one of them, e.g. only Javadoc but no sources, you can modify the <code>sources</code> variant to not being published:</p>
</div>
<div class="exampleblock">
<div class="title">Example 169. Publish a java library with Javadoc but without sources</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">java {
    withJavadocJar()
    withSourcesJar()
}

components.java.withVariantsFromConfiguration(configurations.sourcesElements) {
    skip()
}

publishing {
    publications {
        mavenJava(MavenPublication) {
            from components.java
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">java {
    withJavadocJar()
    withSourcesJar()
}

val javaComponent = components["java"] as AdhocComponentWithVariants
javaComponent.withVariantsFromConfiguration(configurations["sourcesElements"]) {
    skip()
}

publishing {
    publications {
        create&lt;MavenPublication&gt;("mavenJava") {
            from(components["java"])
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec:publishing-custom-components"><a class="anchor" href="#sec:publishing-custom-components"></a><a class="link" href="#sec:publishing-custom-components">Creating and publishing custom components</a></h3>
<div class="paragraph">
<p>In the <a href="#sec:adding-variants-to-existing-components">previous example</a>, we have demonstrated how to extend or modify an existing component, like the components provided by the Java plugins.
But Gradle also allows you to build a custom component (not a Java Library, not a Java Platform, not something supported natively by Gradle).</p>
</div>
<div class="paragraph">
<p>To create a custom component, you first need to create an empty <em>adhoc</em> component.
At the moment, this is only possible via a plugin because you need to get a handle on the <a href="../javadoc/org/gradle/api/component/SoftwareComponentFactory.html">SoftwareComponentFactory</a> :</p>
</div>
<div class="exampleblock">
<div class="title">Example 170. Injecting the software component factory</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">InstrumentedJarsPlugin.groovy</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">    private final SoftwareComponentFactory softwareComponentFactory

    @Inject
    InstrumentedJarsPlugin(SoftwareComponentFactory softwareComponentFactory) {
        this.softwareComponentFactory = softwareComponentFactory
    }</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">InstrumentedJarsPlugin.kt</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">class InstrumentedJarsPlugin @Inject constructor(
    private val softwareComponentFactory: SoftwareComponentFactory) : Plugin&lt;Project&gt; {</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Declaring <em>what</em> a custom component publishes is still done via the <a href="../javadoc/org/gradle/api/component/AdhocComponentWithVariants.html">AdhocComponentWithVariants</a> API.
For a custom component, the first step is to create custom outgoing variants, following the instructions in <a href="#sec:variant-aware-sharing">this chapter</a>.
At this stage, what you should have is variants which can be used in cross-project dependencies, but that we are now going to publish to external repositories.</p>
</div>
<div class="exampleblock">
<div class="title">Example 171. Creating a custom, adhoc component</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">InstrumentedJarsPlugin.groovy</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">        // create an adhoc component
        def adhocComponent = softwareComponentFactory.adhoc("myAdhocComponent")
        // add it to the list of components that this project declares
        project.components.add(adhocComponent)
        // and register a variant for publication
        adhocComponent.addVariantsFromConfiguration(outgoing) {
            it.mapToMavenScope("runtime")
        }</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">InstrumentedJarsPlugin.kt</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">        // create an adhoc component
        val adhocComponent = softwareComponentFactory.adhoc("myAdhocComponent")
        // add it to the list of components that this project declares
        components.add(adhocComponent)
        // and register a variant for publication
        adhocComponent.addVariantsFromConfiguration(outgoing) {
            mapToMavenScope("runtime")
        }</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>First we use the factory to create a new adhoc component.
Then we add a variant through the <code>addVariantsFromConfiguration</code> method, which is described in more detail in the <a href="#sec:adding-variants-to-existing-components">previous section</a>.</p>
</div>
<div class="paragraph">
<p>In simple cases, there&#8217;s a one-to-one mapping between a <code>Configuration</code> and a variant, in which case you can publish all variants issued from a single <code>Configuration</code> because they are effectively the same thing.
However, there are cases where a <code>Configuration</code> is associated with additional <a href="../javadoc/org/gradle/api/artifacts/ConfigurationPublications.html">configuration publications</a> that we also call <em>secondary variants</em>.
Such configurations make sense in the <a href="#">cross-project publications</a> use case, but not when publishing externally.
This is for example the case when between projects you share a <em>directory of files</em>, but there&#8217;s no way you can publish a <em>directory</em> directly on a Maven repository (only packaged things like jars or zips).
Look at the <a href="../javadoc/org/gradle/api/component/ConfigurationVariantDetails.html">ConfigurationVariantDetails</a> class for details about how to skip publication of a particular variant.
If <code>addVariantsFromConfiguration</code> has already been called for a configuration, further modification of the resulting variants can be performed using <code>withVariantsFromConfiguration</code>.</p>
</div>
<div class="paragraph">
<p>When publishing an adhoc component like this:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Gradle Module Metadata will <em>exactly</em> represent the published variants. In particular, all outgoing variants will inherit dependencies, artifacts and attributes of the published configuration.</p>
</li>
<li>
<p>Maven and Ivy metadata files will be generated, but you need to declare how the dependencies are mapped to Maven scopes via the <a href="../javadoc/org/gradle/api/component/ConfigurationVariantDetails.html">ConfigurationVariantDetails</a> class.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In practice, it means that components created this way can be consumed by Gradle the same way as if they were "local components".</p>
</div>
</div>
<div class="sect2">
<h3 id="sec:publishing_custom_artifacts_to_maven"><a class="anchor" href="#sec:publishing_custom_artifacts_to_maven"></a><a class="link" href="#sec:publishing_custom_artifacts_to_maven">Adding custom artifacts to a publication</a></h3>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Instead of thinking in terms of artifacts, you should embrace the variant aware model of Gradle.
It is expected that a single module may need multiple artifacts.
However this rarely stops there, if the additional artifacts represent an <a href="#">optional feature</a>, they might also have different dependencies and more.</p>
</div>
<div class="paragraph">
<p>Gradle, via <em>Gradle Module Metadata</em>, supports the publication of <em>additional variants</em> which make those artifacts known to the dependency resolution engine.
Please refer to the <a href="#sec:variant-aware-sharing">variant-aware sharing</a> section of the documentation to see how to declare such variants and <a href="#sec:publishing-custom-components">check out how to publish custom components</a>.</p>
</div>
<div class="paragraph">
<p>If you attach extra artifacts to a publication directly, they are published "out of context".
That means, they are not referenced in the metadata at all and can then only be addressed directly through a classifier on a dependency.
In contrast to Gradle Module Metadata, Maven pom metadata will not contain information on additional artifacts regardless of whether they are added through a variant or directly, as variants cannot be represented in the pom format.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following section describes how you publish artifacts directly if you are sure that metadata, for example Gradle or POM metadata, is irrelevant for your use case.
For example, if your project doesn&#8217;t need to be consumed by other projects and the only thing required as result of the publishing are the artifacts themselves.</p>
</div>
<div class="paragraph">
<p>In general, there are two options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Create a publication only with artifacts</p>
</li>
<li>
<p>Add artifacts to a publication based on a component with metadata (not recommended, instead <a href="#sec:adding-variants-to-existing-components">adjust a component</a> or use a <a href="#sec:publishing-custom-components">adhoc component publication</a> which will both also produce metadata fitting your artifacts)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To create a publication based on artifacts, start by defining a custom artifact and attaching it to a Gradle <a href="#sub:terminology_configuration">configuration</a> of your choice.
The following sample defines an RPM artifact that is produced by an <code>rpm</code> task (not shown) and attaches that artifact to the <code>archives</code> configuration:</p>
</div>
<div class="exampleblock">
<div class="title">Example 172. Defining a custom artifact for a configuration</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def rpmFile = file("$buildDir/rpms/my-package.rpm")
def rpmArtifact = artifacts.add('archives', rpmFile) {
    type 'rpm'
    builtBy 'rpm'
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">val rpmFile = file("$buildDir/rpms/my-package.rpm")
val rpmArtifact = artifacts.add("archives", rpmFile) {
    type = "rpm"
    builtBy("rpm")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The <code>artifacts.add()</code> method from <a href="../dsl/org.gradle.api.artifacts.dsl.ArtifactHandler.html">ArtifactHandler</a>  returns an artifact object of type <a href="../javadoc/org/gradle/api/artifacts/PublishArtifact.html">PublishArtifact</a> that can then be used in defining a publication, as shown in the following sample:</p>
</div>
<div class="exampleblock">
<div class="title">Example 173. Attaching a custom PublishArtifact to a publication</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">publishing {
    publications {
        maven(MavenPublication) {
            artifact rpmArtifact
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">publishing {
    publications {
        create&lt;MavenPublication&gt;("maven") {
            artifact(rpmArtifact)
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>artifact()</code> method accepts <em>publish artifacts</em> as argument  like <code>rpmArtifact</code> in the sample  as well as any type of argument accepted by <a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:file(java.lang.Object)">Project.file(java.lang.Object)</a>, such as a <code>File</code> instance, a string file path or a archive task.</p>
</li>
<li>
<p>Publishing plugins support different artifact configuration properties, so always check the plugin documentation for more details. The <code>classifier</code> and <code>extension</code> properties are supported by both the <a href="publishing_maven.html#publishing_maven">Maven Publish Plugin</a> and the <a href="publishing_ivy.html#publishing_ivy">Ivy Publish Plugin</a>.</p>
</li>
<li>
<p>Custom artifacts need to be distinct within a publication, typically via a unique combination of <code>classifier</code> and <code>extension</code>. See the documentation for the plugin you&#8217;re using for the precise requirements.</p>
</li>
<li>
<p>If you use <code>artifact()</code> with an archive task, Gradle automatically populates the artifact&#8217;s metadata with the <code>classifier</code> and <code>extension</code> properties from that task.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Now you can publish the RPM.</p>
</div>
<div class="paragraph">
<p>If you really want to add an artifact to a publication based on a component, instead of <a href="#sec:adding-variants-to-existing-components">adjusting the component</a> itself, you can combine the <code>from components.someComponent</code> and <code>artifact someArtifact</code> notations.</p>
</div>
</div>
<div class="sect2">
<h3 id="sec:publishing_maven:conditional_publishing"><a class="anchor" href="#sec:publishing_maven:conditional_publishing"></a><a class="link" href="#sec:publishing_maven:conditional_publishing">Restricting publications to specific repositories</a></h3>
<div class="paragraph">
<p>When you have defined multiple publications or repositories, you often want to control which publications are published to which repositories. For instance, consider the following sample that defines two publications one that consists of just a binary and another that contains the binary and associated sources and two repositories  one for internal use and one for external consumers:</p>
</div>
<div class="exampleblock">
<div class="title">Example 174. Adding multiple publications and repositories</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">publishing {
    publications {
        binary(MavenPublication) {
            from components.java
        }
        binaryAndSources(MavenPublication) {
            from components.java
            artifact sourcesJar
        }
    }
    repositories {
        // change URLs to point to your repos, e.g. http://my.org/repo
        maven {
            name = 'external'
            url = "$buildDir/repos/external"
        }
        maven {
            name = 'internal'
            url = "$buildDir/repos/internal"
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">publishing {
    publications {
        create&lt;MavenPublication&gt;("binary") {
            from(components["java"])
        }
        create&lt;MavenPublication&gt;("binaryAndSources") {
            from(components["java"])
            artifact(tasks["sourcesJar"])
        }
    }
    repositories {
        // change URLs to point to your repos, e.g. http://my.org/repo
        maven {
            name = "external"
            url = uri("$buildDir/repos/external")
        }
        maven {
            name = "internal"
            url = uri("$buildDir/repos/internal")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The publishing plugins will create tasks that allow you to publish either of the publications to either repository. They also attach those tasks to the <code>publish</code> aggregate task. But let&#8217;s say you want to restrict the binary-only publication to the external repository and the binary-with-sources publication to the internal one. To do that, you need to make the publishing <em>conditional</em>.</p>
</div>
<div class="paragraph">
<p>Gradle allows you to skip any task you want based on a condition via the <a href="../dsl/org.gradle.api.Task.html#org.gradle.api.Task:onlyIf(org.gradle.api.specs.Spec)">Task.onlyIf(org.gradle.api.specs.Spec)</a> method. The following sample demonstrates how to implement the constraints we just mentioned:</p>
</div>
<div class="exampleblock">
<div class="title">Example 175. Configuring which artifacts should be published to which repositories</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">tasks.withType(PublishToMavenRepository) {
    onlyIf {
        (repository == publishing.repositories.external &amp;&amp;
            publication == publishing.publications.binary) ||
        (repository == publishing.repositories.internal &amp;&amp;
            publication == publishing.publications.binaryAndSources)
    }
}
tasks.withType(PublishToMavenLocal) {
    onlyIf {
        publication == publishing.publications.binaryAndSources
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">tasks.withType&lt;PublishToMavenRepository&gt;().configureEach {
    onlyIf {
        (repository == publishing.repositories["external"] &amp;&amp;
            publication == publishing.publications["binary"]) ||
        (repository == publishing.repositories["internal"] &amp;&amp;
            publication == publishing.publications["binaryAndSources"])
    }
}
tasks.withType&lt;PublishToMavenLocal&gt;().configureEach {
    onlyIf {
        publication == publishing.publications["binaryAndSources"]
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <code>gradle publish</code></div>
<div class="content">
<pre>&gt; gradle publish
&gt; Task :compileJava
&gt; Task :processResources
&gt; Task :classes
&gt; Task :jar
&gt; Task :generateMetadataFileForBinaryAndSourcesPublication
&gt; Task :generatePomFileForBinaryAndSourcesPublication
&gt; Task :sourcesJar
&gt; Task :publishBinaryAndSourcesPublicationToExternalRepository SKIPPED
&gt; Task :publishBinaryAndSourcesPublicationToInternalRepository
&gt; Task :generateMetadataFileForBinaryPublication
&gt; Task :generatePomFileForBinaryPublication
&gt; Task :publishBinaryPublicationToExternalRepository
&gt; Task :publishBinaryPublicationToInternalRepository SKIPPED
&gt; Task :publish

BUILD SUCCESSFUL in 0s
10 actionable tasks: 10 executed</pre>
</div>
</div>
<div class="paragraph">
<p>You may also want to define your own aggregate tasks to help with your workflow. For example, imagine that you have several publications that should be published to the external repository. It could be very useful to publish all of them in one go without publishing the internal ones.</p>
</div>
<div class="paragraph">
<p>The following sample demonstrates how you can do this by defining an aggregate task <code>publishToExternalRepository</code> that depends on all the relevant publish tasks:</p>
</div>
<div class="exampleblock">
<div class="title">Example 176. Defining your own shorthand tasks for publishing</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">task publishToExternalRepository {
    group = 'publishing'
    description = 'Publishes all Maven publications to the external Maven repository.'
    dependsOn tasks.withType(PublishToMavenRepository).matching {
        it.repository == publishing.repositories.external
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">tasks.register("publishToExternalRepository") {
    group = "publishing"
    description = "Publishes all Maven publications to the external Maven repository."
    dependsOn(tasks.withType&lt;PublishToMavenRepository&gt;().matching {
        it.repository == publishing.repositories["external"]
    })
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This particular sample automatically handles the introduction or removal of the relevant publishing tasks by using <a href="../javadoc/org/gradle/api/tasks/TaskCollection.html#withType-java.lang.Class-">TaskCollection.withType(java.lang.Class)</a> with the <a href="../dsl/org.gradle.api.publish.maven.tasks.PublishToMavenRepository.html">PublishToMavenRepository</a> task type. You can do the same with <a href="../dsl/org.gradle.api.publish.ivy.tasks.PublishToIvyRepository.html">PublishToIvyRepository</a> if you&#8217;re publishing to Ivy-compatible repositories.</p>
</div>
</div>
<div class="sect2">
<h3 id="sec:configuring_publishing_tasks"><a class="anchor" href="#sec:configuring_publishing_tasks"></a><a class="link" href="#sec:configuring_publishing_tasks">Configuring publishing tasks</a></h3>
<div class="paragraph">
<p>The publishing plugins create their non-aggregate tasks after the project has been evaluated, which means you cannot directly reference them from your build script. If you would like to configure any of these tasks, you should use deferred task configuration. This can be done in a number of ways via the project&#8217;s <code>tasks</code> collection.</p>
</div>
<div class="paragraph">
<p>For example, imagine you want to change where the <code>generatePomFileFor<em>PubName</em>Publication</code> tasks write their POM files. You can do this by using the <a href="../javadoc/org/gradle/api/tasks/TaskCollection.html#withType-java.lang.Class-">TaskCollection.withType(java.lang.Class)</a> method, as demonstrated by this sample:</p>
</div>
<div class="exampleblock">
<div class="title">Example 177. Configuring a dynamically named task created by the publishing plugins</div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">tasks.withType(GenerateMavenPom).all {
    def matcher = name =~ /generatePomFileFor(\w+)Publication/
    def publicationName = matcher[0][1]
    destination = "$buildDir/poms/${publicationName}-pom.xml"
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-kotlin" data-lang="kotlin">tasks.withType&lt;GenerateMavenPom&gt;().configureEach {
    val matcher = Regex("""generatePomFileFor(\w+)Publication""").matchEntire(name)
    val publicationName = matcher?.let { it.groupValues[1] }
    destination = file("$buildDir/poms/$publicationName-pom.xml")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The above sample uses a regular expression to extract the name of the publication from the name of the task. This is so that there is no conflict between the file paths of all the POM files that might be generated. If you only have one publication, then you don&#8217;t have to worry about such conflicts since there will only be one POM file.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="dependency_management_terminology"><a class="anchor" href="#dependency_management_terminology"></a><a class="link" href="#dependency_management_terminology">Dependency Management Terminology</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Dependency management comes with a wealth of terminology.
Here you can find the most commonly-used terms including references to the user guide to learn about their practical application.</p>
</div>
<div class="sect2">
<h3 id="sub:terminology_artifact"><a class="anchor" href="#sub:terminology_artifact"></a><a class="link" href="#sub:terminology_artifact">Artifact</a></h3>
<div class="paragraph">
<p>A file or directory produced by a build, such as a JAR, a ZIP distribution, or a native executable.</p>
</div>
<div class="paragraph">
<p>Artifacts are typically designed to be used or consumed by users or other projects, or deployed to hosting systems.
In such cases, the artifact is a single file.
Directories are common in the case of inter-project dependencies to avoid the cost of producing the publishable artifact.</p>
</div>
</div>
<div class="sect2">
<h3 id="sub:terminology_capability"><a class="anchor" href="#sub:terminology_capability"></a><a class="link" href="#sub:terminology_capability">Capability</a></h3>
<div class="paragraph">
<p>A capability identifies a feature offered by one or multiple components.
A capability is identified by coordinates similar to the coordinates used for <a href="#sub:terminology_module_version">module versions</a>.
By default, each module version offers a capability that matches its coordinates, for example <code>com.google:guava:18.0</code>.
Capabilities can be used to express that a component provides multiple <a href="#sub:terminology_feature_variant">feature variants</a> or that two different components implement the same feature (and thus cannot be used together).
For more details, see the section on <a href="#">capabilities</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="sub:terminology_component"><a class="anchor" href="#sub:terminology_component"></a><a class="link" href="#sub:terminology_component">Component</a></h3>
<div class="paragraph">
<p>Any single version of a <a href="#sub:terminology_module">module</a>.</p>
</div>
<div class="paragraph">
<p>For external libraries, the term component refers to one published version of the library.</p>
</div>
<div class="paragraph">
<p>In a build, components are defined by plugins (e.g. the Java Library plugin) and provide a simple way to define a publication for publishing.
They comprise <a href="#sub:terminology_artifact">artifacts</a> as well as the appropriate <a href="#sub:terminology_artifact">metadata</a> that describes a component&#8217;s <a href="#sub:terminology_variant">variants</a> in detail.
For example, the <code>java</code> component in its default setup consists of a JAR produced by the <code>jar</code> task and the dependency information of the Java <em>api</em> and <em>runtime</em> variants.
It may also define additional variants, for example <em>sources</em> and <em>Javadoc</em>, with the corresponding artifacts.</p>
</div>
</div>
<div class="sect2">
<h3 id="sub:terminology_configuration"><a class="anchor" href="#sub:terminology_configuration"></a><a class="link" href="#sub:terminology_configuration">Configuration</a></h3>
<div class="paragraph">
<p>A configuration is a named set of <a href="#sub:terminology_dependency">dependencies</a> grouped together for a specific goal.
Configurations provide access to the underlying, resolved <a href="#sub:terminology_module">modules</a> and their artifacts.
For more information, see the sections on <a href="#sec:what-are-dependency-configurations">dependency configurations</a> as well as <a href="#sec:resolvable-consumable-configs">resolvable and consumable configurations</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The word "configuration" is an overloaded term and has a different meaning outside of the context of dependency management.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="sub:terminology_dependency"><a class="anchor" href="#sub:terminology_dependency"></a><a class="link" href="#sub:terminology_dependency">Dependency</a></h3>
<div class="paragraph">
<p>A dependency is a pointer to another piece of software required to build, test or run a <a href="#sub:terminology_module">module</a>.
For more information, see the section on <a href="#">declaring dependencies</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="sub:terminology_dependency_constraint"><a class="anchor" href="#sub:terminology_dependency_constraint"></a><a class="link" href="#sub:terminology_dependency_constraint">Dependency constraint</a></h3>
<div class="paragraph">
<p>A dependency constraint defines requirements that need to be met by a module to make it a valid resolution result for the dependency.
For example, a dependency constraint can narrow down the set of supported module versions.
Dependency constraints can be used to express such requirements for transitive dependencies.
For more information, see the sections on <a href="#">upgrading</a> and <a href="#">downgrading</a> transitive dependencies.</p>
</div>
</div>
<div class="sect2">
<h3 id="sub:terminology_feature_variant"><a class="anchor" href="#sub:terminology_feature_variant"></a><a class="link" href="#sub:terminology_feature_variant">Feature Variant</a></h3>
<div class="paragraph">
<p>A feature variant is a <a href="#sub:terminology_variant">variant</a> representing a feature of a component that can be individually selected or not.
A feature variant is identified by one or more <a href="#sub:terminology_capability">capabilities</a>.
For more information, see the sections on <a href="#">modeling feature variants and optional dependencies</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="sub:terminology_module"><a class="anchor" href="#sub:terminology_module"></a><a class="link" href="#sub:terminology_module">Module</a></h3>
<div class="paragraph">
<p>A piece of software that evolves over time e.g. <a href="https://github.com/google/guava">Google Guava</a>.
Every module has a name. Each release of a module is optimally represented by a <a href="#sub:terminology_module_version">module version</a>.
For convenient consumption, modules can be hosted in a <a href="#sub:terminology_repository">repository</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="sub:terminology_module_metadata"><a class="anchor" href="#sub:terminology_module_metadata"></a><a class="link" href="#sub:terminology_module_metadata">Module metadata</a></h3>
<div class="paragraph">
<p>Releases of a <a href="#sub:terminology_module">module</a> provide metadata.
Metadata is the data that describes the module in more detail e.g. information about the location of artifacts or required <a href="#sub:terminology_transitive_dependency">transitive dependencies</a>.
Gradle offers its own metadata format called <a href="https://github.com/gradle/gradle/blob/master/subprojects/docs/src/docs/design/gradle-module-metadata-latest-specification.md">Gradle Module Metadata</a> (<code>.module</code> file) but also supports Maven (<code>.pom</code>) and Ivy (<code>ivy.xml</code>) metadata.
See the section on <a href="#">understanding Gradle Module Metadata</a> for more information on the supported metadata formats.</p>
</div>
</div>
<div class="sect2">
<h3 id="component_metadata_rule"><a class="anchor" href="#component_metadata_rule"></a><a class="link" href="#component_metadata_rule">Component metadata rule</a></h3>
<div class="paragraph">
<p>A component metadata rule is a rule that modifies a component&#8217;s metadata after it was fetched from a repository, e.g. to add missing information or to correct wrong information.
In contrast to <a href="#sub:terminology_resolution_rule">resolution rules</a>, component metadata rules are applied <strong>before</strong> resolution starts.
Component metadata rules are defined as part of the build logic and can be shared through plugins.
For more information, see the section on <a href="#">fixing metadata with component metadata rules</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="sub:terminology_module_version"><a class="anchor" href="#sub:terminology_module_version"></a><a class="link" href="#sub:terminology_module_version">Module version</a></h3>
<div class="paragraph">
<p>A module version represents a distinct set of changes of a released <a href="#sub:terminology_module">module</a>.
For example <code>18.0</code> represents the version of the module with the coordinates <code>com.google:guava:18.0</code>.
In practice there&#8217;s no limitation to the scheme of the module version.
Timestamps, numbers, special suffixes like <code>-GA</code> are all allowed identifiers.
The most widely-used versioning strategy is <a href="https://semver.org/">semantic versioning</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="sub::terminology_platform"><a class="anchor" href="#sub::terminology_platform"></a><a class="link" href="#sub::terminology_platform">Platform</a></h3>
<div class="paragraph">
<p>A platform is a set of modules aimed to be used together. There are different categories of platforms, corresponding to different use cases:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>module set: often a set of modules published together as a whole. Using one module of the set often means we want to use the same version for all modules of the set. For example, if using <code>groovy</code> 1.2, also use <code>groovy-json</code> 1.2.</p>
</li>
<li>
<p>runtime environment: a set of libraries known to work well together. e.g., the Spring Platform, recommending versions for both Spring and components that work well with Spring.</p>
</li>
<li>
<p>deployment environment: Java runtime, application server, &#8230;&#8203;</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In addition Gradle defines <a href="#sec:virtual_platform">virtual platforms</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Maven&#8217;s BOM (bill-of-material) is a popular kind of platform that <a href="#sub:bom_import">Gradle supports</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="sub:terminology_publication"><a class="anchor" href="#sub:terminology_publication"></a><a class="link" href="#sub:terminology_publication">Publication</a></h3>
<div class="paragraph">
<p>A description of the files and metadata that should be published to a repository as a single entity for use by consumers.</p>
</div>
<div class="paragraph">
<p>A publication has a name and consists of one or more artifacts plus information about those artifacts (the <a href="#sub:terminology_module_metadata">metadata</a>).</p>
</div>
</div>
<div class="sect2">
<h3 id="sub:terminology_repository"><a class="anchor" href="#sub:terminology_repository"></a><a class="link" href="#sub:terminology_repository">Repository</a></h3>
<div class="paragraph">
<p>A repository hosts a set of <a href="#sub:terminology_module">modules</a>, each of which may provide one or many releases (components) indicated by a <a href="#sub:terminology_module_version">module version</a>.
The repository can be based on a binary repository product (e.g. Artifactory or Nexus) or a directory structure in the filesystem.
For more information, see <a href="#">Declaring Repositories</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="sub:terminology_resolution_rule"><a class="anchor" href="#sub:terminology_resolution_rule"></a><a class="link" href="#sub:terminology_resolution_rule">Resolution rule</a></h3>
<div class="paragraph">
<p>A resolution rule influences the behavior of how a <a href="#sub:terminology_dependency">dependency</a> is resolved directly.
Resolution rules are defined as part of the build logic.
For more information, see the section on <a href="#">customizing resolution of a dependency directly</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="sub:terminology_transitive_dependency"><a class="anchor" href="#sub:terminology_transitive_dependency"></a><a class="link" href="#sub:terminology_transitive_dependency">Transitive dependency</a></h3>
<div class="paragraph">
<p>A variant of a <a href="#sub:terminology_component">component</a> can have dependencies on other modules to work properly, so-called transitive dependencies.
Releases of a module hosted on a <a href="#sub:terminology_repository">repository</a> can provide <a href="#sub:terminology_module_metadata">metadata</a> to declare those transitive dependencies.
By default, Gradle resolves transitive dependencies automatically.
The version selection for transitive dependencies can be influenced by declaring <a href="#">dependency constraints</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="sub:terminology_variant"><a class="anchor" href="#sub:terminology_variant"></a><a class="link" href="#sub:terminology_variant">Variant (of a component)</a></h3>
<div class="paragraph">
<p>Each <a href="#sub:terminology_component">component</a> consists of one or more variants.
A variant consists of a set of artifacts and defines a set of dependencies.
It is identified by a set of <a href="#sub:terminology_attribute">attributes</a> and <a href="#sub:terminology_capability">capabilities</a>.</p>
</div>
<div class="paragraph">
<p>Gradle&#8217;s dependency resolution is variant-aware and selects one or more variants of each component after a component (i.e. one version of a module) has been selected.
It may also fail if the variant selection result is ambiguous, meaning that Gradle does not have enough information to select one of multiple mutual exclusive variants.
In that case, more information can be provided through <a href="#sub:terminology_attribute">variant attributes</a>.
Examples of variants each Java components typically offers are <em>api</em> and <em>runtime</em> variants.
Others examples are JDK8 and JDK11 variants.
For more information, see the section on <a href="#">variant selection</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="sub:terminology_attribute"><a class="anchor" href="#sub:terminology_attribute"></a><a class="link" href="#sub:terminology_attribute">Variant Attribute</a></h3>
<div class="paragraph">
<p>Attributes are used to identify and select <a href="#sub:terminology_variant">variants</a>.
A variant has one or more attributes defined, for example <code>org.gradle.usage=java-api</code>, <code>org.gradle.jvm.version=11</code>.
When dependencies are resolved, a set of attributes are requested and Gradle finds the best fitting variant(s) for each component in the dependency graph.
Compatibility and disambiguation rules can be implemented for an attribute to express compatibility between values (e.g. Java 8 is compatible with Java 11, but Java 11 should be preferred if the requested version is 11 or higher).
Such rules are typically provided by plugins.
For more information, see the sections on <a href="#">variant selection</a> and <a href="#">declaring attributes</a>.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<!-- end div class="chapter" -->
<aside class="secondary-navigation"></aside>
</main>

<footer class="site-layout__footer site-footer" itemscope="itemscope" itemtype="https://schema.org/WPFooter">
    <nav class="site-footer__navigation" itemtype="https://schema.org/SiteNavigationElement">
        <section class="site-footer__links">
            <div class="site-footer__link-group">
                <header><strong>Docs</strong></header>
                <ul class="site-footer__links-list">
                    <li itemprop="name"><a href="/userguide/userguide.html" itemprop="url">User Manual</a></li>
                    <li itemprop="name"><a href="/dsl/" itemprop="url">DSL Reference</a></li>
                    <li itemprop="name"><a href="/release-notes.html" itemprop="url">Release Notes</a></li>
                    <li itemprop="name"><a href="/javadoc/" itemprop="url">Javadoc</a></li>
                </ul>
            </div>
            <div class="site-footer__link-group">
                <header><strong>News</strong></header>
                <ul class="site-footer__links-list">
                    <li itemprop="name"><a href="https://blog.gradle.org/" itemprop="url">Blog</a></li>
                    <li itemprop="name"><a href="https://newsletter.gradle.com/" itemprop="url">Newsletter</a></li>
                    <li itemprop="name"><a href="https://twitter.com/gradle" itemprop="url">Twitter</a></li>
                </ul>
            </div>
            <div class="site-footer__link-group">
                <header><strong>Products</strong></header>
                <ul class="site-footer__links-list">
                    <li itemprop="name"><a href="https://gradle.com/build-scans/" itemprop="url">Build Scans</a></li>
                    <li itemprop="name"><a href="https://gradle.com/build-cache/" itemprop="url">Build Cache</a></li>
                    <li itemprop="name"><a href="https://gradle.com/enterprise/resources/" itemprop="url">Enterprise Docs</a></li>
                </ul>
            </div>
            <div class="site-footer__link-group">
                <header><strong>Get Help</strong></header>
                <ul class="site-footer__links-list">
                    <li itemprop="name"><a href="https://discuss.gradle.org/c/help-discuss" itemprop="url">Forums</a></li>
                    <li itemprop="name"><a href="https://github.com/gradle/" itemprop="url">GitHub</a></li>
                    <li itemprop="name"><a href="https://gradle.com/training/" itemprop="url">Training</a></li>
                    <li itemprop="name"><a href="https://gradle.org/services/" itemprop="url">Services</a></li>
                </ul>
            </div>
        </section>
        <section class="site-footer__subscribe-newsletter" id="newsletter-form-container">
            <header class="newsletter-form__header"><h5>Stay <code>UP-TO-DATE</code> on new features and news</h5></header>
            <p class="disclaimer">By entering your email, you agree to our <a href="https://gradle.com/legal/terms-of-service/">Terms</a> and <a href="https://gradle.com/legal/privacy/">Privacy Policy</a>, including receipt of emails. You can unsubscribe at any time.</p>
            <div class="newsletter-form__container">
                <form id="newsletter-form" class="newsletter-form" action="https://go.gradle.com/l/68052/2018-09-07/bk6wml" method="post">
                    <input id="email" class="email" name="email" type="email" placeholder="name@email.com" pattern="[^@\s]+@[^@\s]+\.[^@\s]+" maxlength="255" required=""/>
                    <button id="submit" class="submit" type="submit">Subscribe</button>
                </form>
            </div>
        </section>
    </nav>
    <div class="site-footer-secondary">
        <div class="site-footer-secondary__contents">
            <div class="site-footer__copy"> <a href="https://gradle.com">Gradle Inc.</a>
                <time>2018</time>
                All rights reserved.
            </div>
            <div class="site-footer__logo"><a href="/">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 90 66.06">
                    <defs>
                        <style>.cls-1 {
                            fill: #02303a;
                        }</style>
                    </defs>
                    <title>gradle</title>
                    <path class="cls-1"
                          d="M85.11,4.18a14.27,14.27,0,0,0-19.83-.34,1.38,1.38,0,0,0,0,2L67,7.6a1.36,1.36,0,0,0,1.78.12A8.18,8.18,0,0,1,79.5,20.06C68.17,31.38,53.05-.36,18.73,16a4.65,4.65,0,0,0-2,6.54l5.89,10.17a4.64,4.64,0,0,0,6.3,1.73l.14-.08-.11.08L31.53,33a60.29,60.29,0,0,0,8.22-6.13,1.44,1.44,0,0,1,1.87-.06h0a1.34,1.34,0,0,1,.06,2A61.61,61.61,0,0,1,33,35.34l-.09,0-2.61,1.46a7.34,7.34,0,0,1-3.61.94,7.45,7.45,0,0,1-6.47-3.71l-5.57-9.61C4,32-2.54,46.56,1,65a1.36,1.36,0,0,0,1.33,1.11H8.61A1.36,1.36,0,0,0,10,64.87a9.29,9.29,0,0,1,18.42,0,1.35,1.35,0,0,0,1.34,1.19H35.9a1.36,1.36,0,0,0,1.34-1.19,9.29,9.29,0,0,1,18.42,0A1.36,1.36,0,0,0,57,66.06H63.1a1.36,1.36,0,0,0,1.36-1.34c.14-8.6,2.46-18.48,9.07-23.43C96.43,24.16,90.41,9.48,85.11,4.18ZM61.76,30.05l-4.37-2.19h0a2.74,2.74,0,1,1,4.37,2.2Z"/>
                </svg>
            </a></div>
            <div class="site-footer-secondary__links">
                <a href="https://gradle.com/careers/">Careers</a> |
                <a href="https://gradle.com/legal/privacy/">Privacy</a> |
                <a href="https://gradle.com/legal/terms-of-service/">Terms of Service</a> |
                <a href="https://gradle.org/contact/">Contact</a>
            </div>
        </div>
    </div>
</footer>

<script type="text/javascript">
    // Polyfill Element.matches()
    if (!Element.prototype.matches) {
        Element.prototype.matches = Element.prototype.msMatchesSelector || Element.prototype.webkitMatchesSelector;
    }
    // Polyfill Element.closest()
    if (!Element.prototype.closest) {
        Element.prototype.closest = function (s) {
            var el = this;
            if (!document.documentElement.contains(el)) return null;
            do {
                if (typeof el.matches === "function" && el.matches(s)) return el;
                el = el.parentElement || el.parentNode;
            } while (el !== null);
            return null;
        };
    }

    var currentChapterFileName = window.location.pathname.substr(window.location.pathname.lastIndexOf("/") + 1);
    if (currentChapterFileName === "index.html") {
        currentChapterFileName = window.location.pathname.substr(0, window.location.pathname.lastIndexOf("/"));
        currentChapterFileName = currentChapterFileName.substr(currentChapterFileName.lastIndexOf("/") + 1) + "/index.html";
    }
    [].forEach.call(document.querySelectorAll(".docs-navigation a[href$='" + currentChapterFileName + "']"), function (link) {
        // Add "active" to all links same as current URL
        link.classList.add("active");

        // Expand all parent navigation
        var parentListEl = link.closest("li");
        while (parentListEl !== null) {
            var dropDownEl = parentListEl.querySelector(".nav-dropdown");
            if (dropDownEl !== null) {
                dropDownEl.classList.add("expanded");
            }
            parentListEl = parentListEl.parentNode.closest("li");
        }
    });

    // Expand/contract multi-level side navigation
    [].forEach.call(document.querySelectorAll(".docs-navigation .nav-dropdown"), function registerSideNavActions(collapsibleElement) {
        collapsibleElement.addEventListener("click", function toggleExpandedSideNav(evt) {
            evt.preventDefault();
            evt.target.classList.toggle("expanded");
            evt.target.setAttribute("aria-expanded", evt.target.classList.contains("expanded").toString());
            return false;
        }, false);
    });

    function postProcessCodeBlocks() {
        // Assumptions:
        //  1) All siblings that are marked with class="multi-language-sample" should be grouped
        //  2) Only one language can be selected per domain (to allow selection to persist across all docs pages)
        //  3) There is exactly 1 small set of languages to choose from. This does not allow for multiple language preferences. For example, users cannot prefer both Kotlin and ZSH.
        //  4) Only 1 sample of each language can exist in the same collection.

        var GRADLE_DSLs = ["groovy", "kotlin"];
        var preferredBuildScriptLanguage = initPreferredBuildScriptLanguage();

        // Ensure preferred DSL is valid, defaulting to Groovy DSL
        function initPreferredBuildScriptLanguage() {
            var lang = window.localStorage.getItem("preferred-gradle-dsl");
            if (GRADLE_DSLs.indexOf(lang) === -1) {
                window.localStorage.setItem("preferred-gradle-dsl", "groovy");
                lang = "groovy";
            }
            return lang;
        }

        function capitalizeFirstLetter(string) {
            return string.charAt(0).toUpperCase() + string.slice(1);
        }

        function processSampleEl(sampleEl, prefLangId) {
            var codeEl = sampleEl.querySelector("code[data-lang]");
            if (codeEl != null) {
                sampleEl.setAttribute("data-lang", codeEl.getAttribute("data-lang"));
                if (codeEl.getAttribute("data-lang") !== prefLangId) {
                    sampleEl.classList.add("hidden");
                } else {
                    sampleEl.classList.remove("hidden");
                }
            }
        }

        function switchSampleLanguage(languageId) {
            var multiLanguageSampleElements = [].slice.call(document.querySelectorAll(".multi-language-sample"));

            // Array of Arrays, each top-level array representing a single collection of samples
            var multiLanguageSets = [];
            for (var i = 0; i < multiLanguageSampleElements.length; i++) {
                var currentCollection = [multiLanguageSampleElements[i]];
                var currentSampleElement = multiLanguageSampleElements[i];
                processSampleEl(currentSampleElement, languageId);
                while (currentSampleElement.nextElementSibling != null && currentSampleElement.nextElementSibling.classList.contains("multi-language-sample")) {
                    currentCollection.push(currentSampleElement.nextElementSibling);
                    currentSampleElement = currentSampleElement.nextElementSibling;
                    processSampleEl(currentSampleElement, languageId);
                    i++;
                }

                multiLanguageSets.push(currentCollection);
            }

            multiLanguageSets.forEach(function (sampleCollection) {
                // Create selector element if not existing
                if (sampleCollection.length > 1 &&
                    (sampleCollection[0].previousElementSibling == null ||
                        !sampleCollection[0].previousElementSibling.classList.contains("multi-language-selector"))) {
                    var languageSelectorFragment = document.createDocumentFragment();
                    var multiLanguageSelectorElement = document.createElement("div");
                    multiLanguageSelectorElement.classList.add("multi-language-selector");
                    languageSelectorFragment.appendChild(multiLanguageSelectorElement);


                    sampleCollection.forEach(function (sampleEl) {
                        var optionEl = document.createElement("code");
                        var sampleLanguage = sampleEl.getAttribute("data-lang");
                        optionEl.setAttribute("data-lang", sampleLanguage);
                        optionEl.setAttribute("role", "button");
                        optionEl.classList.add("language-option");

                        optionEl.innerText = capitalizeFirstLetter(sampleLanguage);

                        optionEl.addEventListener("click", function updatePreferredLanguage(evt) {
                            var preferredLanguageId = optionEl.getAttribute("data-lang");
                            window.localStorage.setItem("preferred-gradle-dsl", preferredLanguageId);

                            // Record how far down the page the clicked element is before switching all samples
                            var beforeOffset = evt.target.offsetTop;

                            switchSampleLanguage(preferredLanguageId);

                            // Scroll the window to account for content height differences between different sample languages
                            window.scrollBy(0, evt.target.offsetTop - beforeOffset);
                        });
                        multiLanguageSelectorElement.appendChild(optionEl);
                    });
                    sampleCollection[0].parentNode.insertBefore(languageSelectorFragment, sampleCollection[0]);
                }
            });

            [].slice.call(document.querySelectorAll(".multi-language-selector .language-option")).forEach(function (optionEl) {
                if (optionEl.getAttribute("data-lang") === languageId) {
                    optionEl.classList.add("selected");
                } else {
                    optionEl.classList.remove("selected");
                }
            });

            [].slice.call(document.querySelectorAll(".multi-language-text")).forEach(function (el) {
                if (!el.classList.contains("lang-" + languageId)) {
                    el.classList.add("hidden");
                } else {
                    el.classList.remove("hidden");
                }
            });
        }

        switchSampleLanguage(preferredBuildScriptLanguage);
    }

    document.addEventListener("DOMContentLoaded", postProcessCodeBlocks);
</script>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.js"></script>
<script>prettyPrint()</script>
</body>
</html>